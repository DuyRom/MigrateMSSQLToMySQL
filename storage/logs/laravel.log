[2024-07-12 16:34:42] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS unpvt
WHERE     sl <> 0' at line 4 (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS SELECT   NgayCT, KhoHangXuatID, LoaiPhieu, SL
FROM         (SELECT   *
                           FROM         B_DV_Phieu_XuatBanCH_All
                           WHERE     kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL) p  AS unpvt
WHERE     sl <> 0)  
[2024-07-12 16:34:42] local.ERROR: Error creating view A_DV_LoaiPhieu: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.b_dv_phieu_loaiphieu' doesn't exist (SQL: CREATE VIEW `A_DV_LoaiPhieu` AS SELECT    NgayCT, KhoHangXuatID, REPLACE(LoaiPhieu, 'KiemTraDinhKy', 'IsKTDK') AS LoaiPhieu, COUNT(SL) AS SL
FROM         B_DV_Phieu_LoaiPhieu
GROUP BY NgayCT, KhoHangXuatID, LoaiPhieu
ORDER BY NgayCT)  
[2024-07-12 16:34:43] local.ERROR: Error creating view A_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'PIVOT (Sum(ThanhTien) FOR 
                         A IN (`$1`, `$1`, `$1`))...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X PIVOT (Sum(ThanhTien) FOR 
                         A IN (`$1`, `$1`, `$1`)) AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-12 16:34:43] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-12 16:34:43] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'PIVOT (Sum(ThanhTien) FOR A IN (`$1`, `$1`, `$1`)) AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X PIVOT (Sum(ThanhTien) FOR A IN (`$1`, `$1`, `$1`)) AS pvt)  
[2024-07-12 16:34:44] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-12 16:34:45] local.ERROR: Error creating view B_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-12 16:34:45] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-12 16:34:45] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-12 16:34:45] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-12 16:34:47] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS unpvt
WHERE     sl <> 0' at line 4 (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS SELECT   NgayCT, KhoHangXuatID, LoaiPhieu, SL
FROM         (SELECT   *
                           FROM         B_DV_Phieu_XuatBanCH_All
                           WHERE     kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL) p  AS unpvt
WHERE     sl <> 0)  
[2024-07-12 16:34:47] local.ERROR: Error creating view A_DV_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.b_dv_phieu_loaiphieu' doesn't exist (SQL: CREATE VIEW `A_DV_LoaiPhieu` AS SELECT    NgayCT, KhoHangXuatID, REPLACE(LoaiPhieu, 'KiemTraDinhKy', 'IsKTDK') AS LoaiPhieu, COUNT(SL) AS SL
FROM         B_DV_Phieu_LoaiPhieu
GROUP BY NgayCT, KhoHangXuatID, LoaiPhieu
ORDER BY NgayCT)  
[2024-07-12 16:34:47] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'PIVOT (Sum(ThanhTien) FOR 
                         A IN (`$1`, `$1`, `$1`))...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X PIVOT (Sum(ThanhTien) FOR 
                         A IN (`$1`, `$1`, `$1`)) AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-12 16:34:47] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-12 16:34:47] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'PIVOT (Sum(ThanhTien) FOR A IN (`$1`, `$1`, `$1`)) AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X PIVOT (Sum(ThanhTien) FOR A IN (`$1`, `$1`, `$1`)) AS pvt)  
[2024-07-12 16:34:47] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-12 16:34:47] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-12 16:34:47] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-12 16:34:47] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-12 16:34:47] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-12 16:34:47] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS unpvt
WHERE     sl <> 0' at line 4 (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS SELECT   NgayCT, KhoHangXuatID, LoaiPhieu, SL
FROM         (SELECT   *
                           FROM         B_DV_Phieu_XuatBanCH_All
                           WHERE     kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL) p  AS unpvt
WHERE     sl <> 0)  
[2024-07-12 16:34:47] local.ERROR: Error creating view A_DV_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.b_dv_phieu_loaiphieu' doesn't exist (SQL: CREATE VIEW `A_DV_LoaiPhieu` AS SELECT    NgayCT, KhoHangXuatID, REPLACE(LoaiPhieu, 'KiemTraDinhKy', 'IsKTDK') AS LoaiPhieu, COUNT(SL) AS SL
FROM         B_DV_Phieu_LoaiPhieu
GROUP BY NgayCT, KhoHangXuatID, LoaiPhieu
ORDER BY NgayCT)  
[2024-07-12 16:34:47] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'PIVOT (Sum(ThanhTien) FOR 
                         A IN (`$1`, `$1`, `$1`))...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X PIVOT (Sum(ThanhTien) FOR 
                         A IN (`$1`, `$1`, `$1`)) AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-12 16:34:47] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-12 16:34:47] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'PIVOT (Sum(ThanhTien) FOR A IN (`$1`, `$1`, `$1`)) AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X PIVOT (Sum(ThanhTien) FOR A IN (`$1`, `$1`, `$1`)) AS pvt)  
[2024-07-12 16:34:47] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-12 16:34:47] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-12 16:34:47] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-12 16:34:47] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-12 16:34:47] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-12 16:34:47] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS unpvt
WHERE     sl <> 0' at line 4 (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS SELECT   NgayCT, KhoHangXuatID, LoaiPhieu, SL
FROM         (SELECT   *
                           FROM         B_DV_Phieu_XuatBanCH_All
                           WHERE     kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL) p  AS unpvt
WHERE     sl <> 0)  
[2024-07-12 16:34:47] local.ERROR: Error creating view A_DV_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.b_dv_phieu_loaiphieu' doesn't exist (SQL: CREATE VIEW `A_DV_LoaiPhieu` AS SELECT    NgayCT, KhoHangXuatID, REPLACE(LoaiPhieu, 'KiemTraDinhKy', 'IsKTDK') AS LoaiPhieu, COUNT(SL) AS SL
FROM         B_DV_Phieu_LoaiPhieu
GROUP BY NgayCT, KhoHangXuatID, LoaiPhieu
ORDER BY NgayCT)  
[2024-07-12 16:34:47] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'PIVOT (Sum(ThanhTien) FOR 
                         A IN (`$1`, `$1`, `$1`))...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X PIVOT (Sum(ThanhTien) FOR 
                         A IN (`$1`, `$1`, `$1`)) AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-12 16:34:47] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-12 16:34:47] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'PIVOT (Sum(ThanhTien) FOR A IN (`$1`, `$1`, `$1`)) AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X PIVOT (Sum(ThanhTien) FOR A IN (`$1`, `$1`, `$1`)) AS pvt)  
[2024-07-12 16:34:47] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-12 16:34:47] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-12 16:34:47] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-12 16:34:47] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-12 16:34:47] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
