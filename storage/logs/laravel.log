[2024-07-17 10:00:13] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 10:00:15] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 10:00:15] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 10:00:19] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 10:00:19] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 10:00:19] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 10:00:31] local.ERROR: Error creating view A_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
      ...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-17 10:00:31] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:00:32] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:00:33] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:00:34] local.ERROR: Error creating view B_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:00:34] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:00:34] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:00:34] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:00:36] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
      ...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-17 10:00:36] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:00:36] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:00:36] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:00:36] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:00:36] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:00:36] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:00:36] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:00:36] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
      ...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-17 10:00:36] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:00:36] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:00:36] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:00:36] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:00:36] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:00:36] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:00:36] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:00:36] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
      ...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-17 10:00:36] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:00:36] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:00:36] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:00:36] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:00:36] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:00:36] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:00:36] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:01:57] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 10:02:00] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 10:02:00] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 10:02:04] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 10:02:04] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 10:02:05] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 10:02:15] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:02:15] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:02:16] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:02:16] local.ERROR: Error creating view B_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:02:16] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:02:16] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:02:17] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:02:18] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:02:18] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:02:18] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:02:18] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:02:18] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:02:18] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:02:18] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:02:18] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:02:18] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:02:18] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:02:18] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:02:18] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:02:18] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:02:18] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:02:18] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:02:18] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:02:18] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:02:18] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:02:18] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:02:18] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:02:18] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:03:16] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:03:16] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:03:17] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:03:18] local.ERROR: Error creating view B_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:03:18] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:03:18] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:03:19] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:03:20] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:03:20] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:03:20] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:03:20] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:03:21] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:03:21] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:03:21] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:03:21] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:03:21] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:03:21] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:03:21] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:03:21] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:03:21] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:03:21] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:03:21] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:03:21] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:03:21] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:03:21] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:03:21] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:03:21] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:03:21] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:13:19] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 10:13:21] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 10:13:21] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 10:13:24] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 10:13:24] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 10:13:25] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 10:13:38] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:13:39] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:13:40] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:13:41] local.ERROR: Error creating view B_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:13:41] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:13:41] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:13:41] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:13:43] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:13:43] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:13:43] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:13:43] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:13:43] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:13:43] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:13:43] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:13:43] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:13:43] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:13:43] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:13:43] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:13:43] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:13:43] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:13:43] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 10:13:43] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 10:13:43] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 10:13:43] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 10:13:43] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 10:13:43] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 10:13:43] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 10:13:43] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 11:06:09] local.ERROR: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.migration_errors' doesn't exist (SQL: insert into `migration_errors` (`table_name`, `error_message`, `created_at`, `updated_at`) values (SoCongNo, SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.migration_status' doesn't exist (SQL: select exists(select * from `migration_status` where (`table_name` = SoCongNo)) as `exists`), 2024-07-17 11:06:09, 2024-07-17 11:06:09)) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42S02): SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.migration_errors' doesn't exist (SQL: insert into `migration_errors` (`table_name`, `error_message`, `created_at`, `updated_at`) values (SoCongNo, SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.migration_status' doesn't exist (SQL: select exists(select * from `migration_status` where (`table_name` = SoCongNo)) as `exists`), 2024-07-17 11:06:09, 2024-07-17 11:06:09)) at C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php:760)
[stacktrace]
#0 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(720): Illuminate\\Database\\Connection->runQueryCallback('insert into `mi...', Array, Object(Closure))
#1 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(546): Illuminate\\Database\\Connection->run('insert into `mi...', Array, Object(Closure))
#2 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(498): Illuminate\\Database\\Connection->statement('insert into `mi...', Array)
#3 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Query\\Builder.php(3274): Illuminate\\Database\\Connection->insert('insert into `mi...', Array)
#4 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Services\\MigrateTableHandler.php(147): Illuminate\\Database\\Query\\Builder->insert(Array)
#5 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Console\\Commands\\MigrateDatabase.php(39): App\\Services\\MigrateTableHandler::migrateTables()
#6 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(36): App\\Console\\Commands\\MigrateDatabase->handle()
#7 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Util.php(41): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(93): Illuminate\\Container\\Util::unwrapIfClosure(Object(Closure))
#9 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(37): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#10 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Container.php(661): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#11 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(183): Illuminate\\Container\\Container->call(Array)
#12 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Command\\Command.php(291): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#13 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(153): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#14 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(1014): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#15 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(301): Symfony\\Component\\Console\\Application->doRunCommand(Object(App\\Console\\Commands\\MigrateDatabase), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#16 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(171): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#17 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Application.php(102): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#18 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Console\\Kernel.php(155): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#19 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#20 {main}

[previous exception] [object] (PDOException(code: 42S02): SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.migration_errors' doesn't exist at C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php:539)
[stacktrace]
#0 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(539): PDO->prepare('insert into `mi...')
#1 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(753): Illuminate\\Database\\Connection->Illuminate\\Database\\{closure}('insert into `mi...', Array)
#2 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(720): Illuminate\\Database\\Connection->runQueryCallback('insert into `mi...', Array, Object(Closure))
#3 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(546): Illuminate\\Database\\Connection->run('insert into `mi...', Array, Object(Closure))
#4 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(498): Illuminate\\Database\\Connection->statement('insert into `mi...', Array)
#5 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Query\\Builder.php(3274): Illuminate\\Database\\Connection->insert('insert into `mi...', Array)
#6 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Services\\MigrateTableHandler.php(147): Illuminate\\Database\\Query\\Builder->insert(Array)
#7 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Console\\Commands\\MigrateDatabase.php(39): App\\Services\\MigrateTableHandler::migrateTables()
#8 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(36): App\\Console\\Commands\\MigrateDatabase->handle()
#9 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Util.php(41): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#10 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(93): Illuminate\\Container\\Util::unwrapIfClosure(Object(Closure))
#11 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(37): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#12 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Container.php(661): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#13 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(183): Illuminate\\Container\\Container->call(Array)
#14 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Command\\Command.php(291): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#15 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(153): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#16 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(1014): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#17 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(301): Symfony\\Component\\Console\\Application->doRunCommand(Object(App\\Console\\Commands\\MigrateDatabase), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#18 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(171): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#19 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Application.php(102): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#20 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Console\\Kernel.php(155): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#21 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#22 {main}
"} 
[2024-07-17 13:06:25] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:06:26] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:06:27] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:06:28] local.ERROR: Error creating view B_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:06:28] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:06:28] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:06:28] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:06:29] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:06:29] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:06:29] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:06:29] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:06:29] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:06:29] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:06:29] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:06:29] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:06:29] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:06:29] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:06:29] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:06:29] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:06:29] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:06:29] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:06:29] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:06:29] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:06:29] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:06:29] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:06:29] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:06:29] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:06:29] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:08:55] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 13:08:58] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 13:08:58] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 13:09:01] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 13:09:01] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 13:09:01] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 13:09:12] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:09:13] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:09:14] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:09:15] local.ERROR: Error creating view B_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:09:15] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:09:15] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:09:15] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:09:17] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:09:17] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:09:17] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:09:17] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:09:17] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:09:17] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:09:17] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:09:17] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:09:17] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:09:17] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:09:17] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:09:17] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:09:17] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:09:17] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:09:17] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:09:17] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:09:17] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:09:17] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:09:17] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:09:17] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:09:17] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:10:49] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 13:10:51] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 13:10:51] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 13:10:55] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 13:10:55] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 13:10:56] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 13:11:07] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:11:07] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:11:08] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:11:09] local.ERROR: Error creating view B_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:11:10] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:11:10] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:11:10] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:11:12] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:11:12] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:11:12] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:11:12] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:11:12] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:11:12] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:11:12] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:11:12] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:11:12] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:11:12] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:11:12] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:11:12] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:11:12] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:11:12] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:11:12] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:11:12] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:11:12] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:11:12] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:11:12] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:11:12] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:11:12] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:13:54] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:13:55] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:13:55] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:13:57] local.ERROR: Error creating view B_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:13:57] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:13:57] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:13:57] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:13:58] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:13:58] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:13:58] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:13:58] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:13:58] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:13:58] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:13:58] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:13:58] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:13:58] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:13:58] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:13:58] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:13:58] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:13:58] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:13:58] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:13:58] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:13:58] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:13:58] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:13:58] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:13:58] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:13:58] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:13:58] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:17:22] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 13:17:23] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 13:17:23] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 13:17:26] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 13:17:26] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 13:17:26] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 13:17:38] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:17:39] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:17:39] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:17:40] local.ERROR: Error creating view B_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:17:40] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:17:40] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:17:40] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:17:41] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:17:41] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:17:41] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:17:41] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:17:41] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:17:41] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:17:41] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:17:41] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:17:41] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:17:41] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:17:41] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:17:41] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:17:41] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:17:41] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:17:41] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:17:41] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:17:41] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:17:41] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:17:41] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:17:42] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:17:42] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:18:39] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 13:18:40] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 13:18:40] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 13:18:43] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 13:18:43] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 13:18:43] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 13:18:54] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:18:54] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:18:55] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:18:56] local.ERROR: Error creating view B_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:18:56] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:18:56] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:18:56] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:18:57] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:18:57] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:18:57] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:18:57] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:18:57] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:18:57] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:18:57] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:18:57] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:18:57] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:18:57] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:18:57] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:18:57] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:18:57] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:18:57] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:18:57] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:18:57] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:18:57] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:18:57] local.ERROR: Error creating view B_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-17 13:18:57] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:18:57] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:18:57] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:20:49] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 13:20:50] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 13:20:50] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 13:20:54] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 13:20:54] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 13:20:54] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 13:21:04] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:21:04] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:21:05] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:21:06] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:21:06] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:21:06] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:21:07] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:21:07] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:21:07] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:21:07] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:21:07] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:21:07] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:21:07] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:21:07] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:21:07] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:21:07] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:21:07] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:21:07] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 13:21:07] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 13:21:08] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 13:21:08] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 13:21:08] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 13:21:08] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 13:21:08] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 15:04:06] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 15:04:08] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 15:04:08] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 15:04:12] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 15:04:12] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 15:04:12] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 15:04:21] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 15:04:22] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 15:04:22] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 15:04:24] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 15:04:24] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 15:04:24] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 15:04:26] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 15:04:26] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 15:04:26] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 15:04:26] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 15:04:26] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 15:04:26] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 15:04:26] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 15:04:26] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 15:04:26] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 15:04:26] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 15:04:26] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 15:04:26] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 15:04:26] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 15:04:26] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 15:04:26] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 15:04:26] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 15:04:26] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 15:04:26] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 15:50:41] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 15:50:42] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 15:50:43] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 15:50:46] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 15:50:46] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 15:50:47] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 15:50:58] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 15:50:58] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 15:51:00] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 15:51:01] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 15:51:01] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 15:51:01] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 15:51:02] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 15:51:02] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 15:51:02] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 15:51:02] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 15:51:02] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 15:51:02] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 15:51:02] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 15:51:02] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 15:51:02] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 15:51:02] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 15:51:02] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 15:51:02] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 15:51:02] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 15:51:02] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 15:51:02] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 15:51:02] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 15:51:02] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 15:51:02] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 15:57:22] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 15:57:24] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 15:57:24] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 15:57:27] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 15:57:27] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 15:57:28] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 15:57:39] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 15:57:40] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 15:57:41] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 15:57:42] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 15:57:42] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 15:57:42] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 15:57:44] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 15:57:44] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 15:57:44] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 15:57:44] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 15:57:44] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 15:57:44] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 15:57:44] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 15:57:44] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 15:57:44] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 15:57:44] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 15:57:44] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 15:57:44] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 15:57:44] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 15:57:44] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 15:57:44] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 15:57:44] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 15:57:44] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 15:57:44] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:04:03] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:04:03] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:04:04] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:04:05] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:04:05] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:04:05] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:04:06] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:04:06] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:04:06] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:04:06] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:04:06] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:04:06] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:04:06] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:04:06] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:04:06] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:04:06] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:04:06] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:04:06] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:04:06] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:04:06] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:04:06] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:04:06] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:04:06] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:04:06] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:06:40] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:06:41] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:06:41] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:06:43] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:06:43] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:06:43] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:06:44] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:06:44] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:06:44] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:06:44] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:06:44] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:06:44] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:06:44] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:06:44] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:06:44] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:06:44] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:06:44] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:06:44] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:06:44] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:06:44] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:06:44] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:06:44] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:06:44] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:06:44] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:08:35] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:08:35] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:08:36] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:08:37] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:08:37] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:08:38] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:08:39] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:08:39] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:08:39] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:08:39] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:08:39] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:08:39] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:08:39] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:08:39] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:08:39] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:08:39] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:08:39] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:08:39] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:08:39] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:08:39] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:08:39] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:08:39] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:08:39] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:08:39] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:13:16] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 16:13:17] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 16:13:17] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 16:13:20] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 16:13:20] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 16:13:21] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 16:13:31] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:13:31] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:13:32] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:13:33] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:13:33] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:13:34] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:13:35] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:13:35] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:13:35] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:13:35] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:13:35] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:13:35] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:13:35] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:13:35] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:13:35] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:13:35] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:13:35] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:13:35] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:13:35] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:13:35] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:13:35] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:13:35] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:13:35] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:13:35] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:22:03] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:22:03] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:22:04] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:22:05] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:22:05] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:22:06] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:06] local.ERROR: Error creating view vTemp_TestGiaVon on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:06] local.ERROR: Error creating view V_ChiTienPowerApp on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:06] local.ERROR: Error creating view View_1 on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:06] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:06] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:06] local.ERROR: Error creating view vTemp_TestGiaVon on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:06] local.ERROR: Error creating view V_ChiTienPowerApp on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:06] local.ERROR: Error creating view View_1 on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:06] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:06] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:06] local.ERROR: Error creating view vTemp_TestGiaVon on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:06] local.ERROR: Error creating view V_ChiTienPowerApp on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:06] local.ERROR: Error creating view View_1 on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:06] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:22:48] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 16:22:50] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 16:22:50] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 16:22:54] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 16:22:54] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 16:22:54] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 16:23:06] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:23:06] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:23:07] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:23:09] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:23:09] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:23:09] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:23:10] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:23:10] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:23:10] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:26:11] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:26:12] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:26:13] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:26:13] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:26:13] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:32:09] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 16:32:10] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 16:32:10] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 16:32:13] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 16:32:14] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 16:32:14] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 16:32:25] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:32:26] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:32:26] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:32:27] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:32:27] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:32:28] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:32:28] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:32:28] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:32:28] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:36:58] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 16:37:00] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 16:37:00] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 16:37:02] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 16:37:02] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 16:37:03] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 16:37:13] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:37:14] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:37:14] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:37:15] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:37:15] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:37:16] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:42:56] local.ERROR: Cannot use App\Helpers\DataHelper as DataHelper because the name is already in use {"exception":"[object] (Symfony\\Component\\ErrorHandler\\Error\\FatalError(code: 0): Cannot use App\\Helpers\\DataHelper as DataHelper because the name is already in use at C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Services\\MigrateViewHandler.php:9)
[stacktrace]
#0 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Bootstrap\\HandleExceptions.php(259): Symfony\\Component\\ErrorHandler\\Error\\FatalError->__construct(message: ''Cannot use App...', code: '0', error: '['type' => 64, ...', traceOffset: '0', traceArgs: '???', trace: '???')
#1 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Bootstrap\\HandleExceptions.php(246): Illuminate\\Foundation\\Bootstrap\\HandleExceptions->fatalErrorFromPhpError(error: '['type' => 64, ...', traceOffset: '0')
#2 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Bootstrap\\HandleExceptions.php(270): Illuminate\\Foundation\\Bootstrap\\HandleExceptions->handleShutdown()
#3 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Bootstrap\\HandleExceptions.php(0): Illuminate\\Foundation\\Bootstrap\\HandleExceptions->Illuminate\\Foundation\\Bootstrap\\{closure:C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Bootstrap\\HandleExceptions.php:269-271}()
#4 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\composer\\ClassLoader.php(427): Composer\\Autoload\\{closure:C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\composer\\ClassLoader.php:575-577}(file: ''C:\\\\\\\\xampp\\\\\\\\htd...')
#5 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Console\\Commands\\MigrateDatabase.php(40): Composer\\Autoload\\ClassLoader->loadClass(class: ''App\\\\\\\\Services\\\\...')
#6 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(36): App\\Console\\Commands\\MigrateDatabase->handle()
#7 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Util.php(41): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure:C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php:35-37}()
#8 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(93): Illuminate\\Container\\Util::unwrapIfClosure(value: 'class Closure {...')
#9 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(37): Illuminate\\Container\\BoundMethod::callBoundMethod(container: 'class Illuminat...', callback: '[0 => class App...', default: 'class Closure {...')
#10 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Container.php(661): Illuminate\\Container\\BoundMethod::call(container: 'class Illuminat...', callback: '[0 => class App...', parameters: '[]', defaultMethod: 'NULL')
#11 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(183): Illuminate\\Foundation\\Application->call(callback: '[0 => class App...', parameters: '???', defaultMethod: '???')
#12 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Command\\Command.php(291): App\\Console\\Commands\\MigrateDatabase->execute(input: 'class Symfony\\\\C...', output: 'class Illuminat...')
#13 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(153): App\\Console\\Commands\\MigrateDatabase->run(input: 'class Symfony\\\\C...', output: 'class Illuminat...')
#14 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(1014): App\\Console\\Commands\\MigrateDatabase->run(input: 'class Symfony\\\\C...', output: 'class Symfony\\\\C...')
#15 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(301): Illuminate\\Console\\Application->doRunCommand(command: 'class App\\\\Conso...', input: 'class Symfony\\\\C...', output: 'class Symfony\\\\C...')
#16 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(171): Illuminate\\Console\\Application->doRun(input: 'class Symfony\\\\C...', output: 'class Symfony\\\\C...')
#17 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Application.php(102): Illuminate\\Console\\Application->run(input: 'class Symfony\\\\C...', output: 'class Symfony\\\\C...')
#18 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Console\\Kernel.php(155): Illuminate\\Console\\Application->run(input: 'class Symfony\\\\C...', output: 'class Symfony\\\\C...')
#19 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\artisan(37): App\\Console\\Kernel->handle(input: 'class Symfony\\\\C...', output: 'class Symfony\\\\C...')
#20 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\artisan(0): {main}()
#21 {main}
"} 
[2024-07-17 16:43:28] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 16:43:30] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 16:43:30] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 16:43:33] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 16:43:33] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 16:43:33] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 16:43:46] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:43:46] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:43:48] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:43:49] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:43:49] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:43:50] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:51:05] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:51:06] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:51:07] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:51:07] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:51:07] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:51:09] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:51:09] local.ERROR: Error creating view vTemp_TestGiaVon on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:51:09] local.ERROR: Error creating view V_ChiTienPowerApp on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:51:09] local.ERROR: Error creating view View_1 on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:51:09] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:51:09] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:51:09] local.ERROR: Error creating view vTemp_TestGiaVon on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:51:09] local.ERROR: Error creating view V_ChiTienPowerApp on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:51:09] local.ERROR: Error creating view View_1 on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:51:09] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:51:09] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:51:09] local.ERROR: Error creating view vTemp_TestGiaVon on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:51:09] local.ERROR: Error creating view V_ChiTienPowerApp on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:51:09] local.ERROR: Error creating view View_1 on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:51:09] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:28] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 16:55:30] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 16:55:30] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 16:55:33] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 16:55:33] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 16:55:33] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 16:55:45] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 16:55:46] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 16:55:46] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 16:55:48] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 16:55:48] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 16:55:48] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 16:55:49] local.ERROR: Error creating view L_ThuChi_CH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view L_Xe_NhapTraLe on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2 on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view A_ThuChi_All on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view A_ThuChi_CH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view vTemp_PKBH_TON_AM on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view vTemp_TestGiaVon on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view V_ChiTienPowerApp on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view View_1 on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view L_ThuChi_CH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view L_Xe_NhapTraLe on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2 on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view A_ThuChi_All on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view A_ThuChi_CH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view vTemp_PKBH_TON_AM on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view vTemp_TestGiaVon on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view V_ChiTienPowerApp on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view View_1 on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view L_ThuChi_CH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:49] local.ERROR: Error creating view L_Xe_NhapTraLe on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:50] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2 on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:50] local.ERROR: Error creating view A_ThuChi_All on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:50] local.ERROR: Error creating view A_ThuChi_CH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:50] local.ERROR: Error creating view vTemp_PKBH_TON_AM on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:50] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:50] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:50] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:50] local.ERROR: Error creating view vTemp_TestGiaVon on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:50] local.ERROR: Error creating view V_ChiTienPowerApp on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:50] local.ERROR: Error creating view View_1 on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 16:55:50] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 17:24:17] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 17:24:17] local.ERROR: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'viewDefinition' in 'field list' (SQL: insert into `migration_errors` (`table_name`, `error_message`, `viewDefinition`, `updated_at`) values (L_ThuChi_CH, SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26)), SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26), 2024-07-17 17:24:17)) {"exception":"[object] (Illuminate\\Database\\QueryException(code: 42S22): SQLSTATE[42S22]: Column not found: 1054 Unknown column 'viewDefinition' in 'field list' (SQL: insert into `migration_errors` (`table_name`, `error_message`, `viewDefinition`, `updated_at`) values (L_ThuChi_CH, SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*

FROM         L_ThuChi

WHERE     (KhoHangXuatID <> 26)), SELECT   L_ThuChi.*

FROM         L_ThuChi

WHERE     (KhoHangXuatID <> 26), 2024-07-17 17:24:17)) at C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php:760)
[stacktrace]
#0 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(720): Illuminate\\Database\\Connection->runQueryCallback('insert into `mi...', Array, Object(Closure))
#1 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(546): Illuminate\\Database\\Connection->run('insert into `mi...', Array, Object(Closure))
#2 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(498): Illuminate\\Database\\Connection->statement('insert into `mi...', Array)
#3 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Query\\Builder.php(3274): Illuminate\\Database\\Connection->insert('insert into `mi...', Array)
#4 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Query\\Builder.php(3392): Illuminate\\Database\\Query\\Builder->insert(Array)
#5 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Helpers\\DataHelper.php(28): Illuminate\\Database\\Query\\Builder->updateOrInsert(Array, Array)
#6 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Services\\MigrateViewHandler.php(66): App\\Helpers\\DataHelper::migrateErrors(Array, Object(Illuminate\\Database\\QueryException))
#7 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Console\\Commands\\MigrateDatabase.php(40): App\\Services\\MigrateViewHandler::migrateViews()
#8 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(36): App\\Console\\Commands\\MigrateDatabase->handle()
#9 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Util.php(41): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#10 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(93): Illuminate\\Container\\Util::unwrapIfClosure(Object(Closure))
#11 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(37): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#12 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Container.php(661): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#13 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(183): Illuminate\\Container\\Container->call(Array)
#14 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Command\\Command.php(291): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#15 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(153): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#16 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(1014): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#17 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(301): Symfony\\Component\\Console\\Application->doRunCommand(Object(App\\Console\\Commands\\MigrateDatabase), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#18 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(171): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#19 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Application.php(102): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#20 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Console\\Kernel.php(155): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#21 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#22 {main}

[previous exception] [object] (PDOException(code: 42S22): SQLSTATE[42S22]: Column not found: 1054 Unknown column 'viewDefinition' in 'field list' at C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php:539)
[stacktrace]
#0 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(539): PDO->prepare('insert into `mi...')
#1 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(753): Illuminate\\Database\\Connection->Illuminate\\Database\\{closure}('insert into `mi...', Array)
#2 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(720): Illuminate\\Database\\Connection->runQueryCallback('insert into `mi...', Array, Object(Closure))
#3 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(546): Illuminate\\Database\\Connection->run('insert into `mi...', Array, Object(Closure))
#4 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Connection.php(498): Illuminate\\Database\\Connection->statement('insert into `mi...', Array)
#5 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Query\\Builder.php(3274): Illuminate\\Database\\Connection->insert('insert into `mi...', Array)
#6 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Database\\Query\\Builder.php(3392): Illuminate\\Database\\Query\\Builder->insert(Array)
#7 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Helpers\\DataHelper.php(28): Illuminate\\Database\\Query\\Builder->updateOrInsert(Array, Array)
#8 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Services\\MigrateViewHandler.php(66): App\\Helpers\\DataHelper::migrateErrors(Array, Object(Illuminate\\Database\\QueryException))
#9 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Console\\Commands\\MigrateDatabase.php(40): App\\Services\\MigrateViewHandler::migrateViews()
#10 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(36): App\\Console\\Commands\\MigrateDatabase->handle()
#11 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Util.php(41): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#12 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(93): Illuminate\\Container\\Util::unwrapIfClosure(Object(Closure))
#13 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(37): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#14 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Container.php(661): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#15 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(183): Illuminate\\Container\\Container->call(Array)
#16 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Command\\Command.php(291): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#17 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(153): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#18 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(1014): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#19 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(301): Symfony\\Component\\Console\\Application->doRunCommand(Object(App\\Console\\Commands\\MigrateDatabase), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#20 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(171): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#21 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Application.php(102): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#22 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Console\\Kernel.php(155): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#23 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#24 {main}
"} 
[2024-07-17 17:25:09] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-17 17:25:10] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-17 17:25:10] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-17 17:25:13] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-17 17:25:13] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-17 17:25:13] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-17 17:25:23] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-17 17:25:24] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-17 17:25:24] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-17 17:25:26] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-17 17:25:26] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-17 17:25:26] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-17 17:25:27] local.ERROR: Error creating view L_ThuChi_CH on retry: Undefined property: stdClass::$viewDefinition  
[2024-07-17 17:25:27] local.ERROR: Undefined property: stdClass::$viewDefinition {"exception":"[object] (ErrorException(code: 0): Undefined property: stdClass::$viewDefinition at C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Helpers\\ViewHelper.php:210)
[stacktrace]
#0 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Bootstrap\\HandleExceptions.php(270): Illuminate\\Foundation\\Bootstrap\\HandleExceptions->handleError(2, 'Undefined prope...', 'C:\\\\xampp\\\\htdocs...', 210)
#1 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Helpers\\ViewHelper.php(210): Illuminate\\Foundation\\Bootstrap\\HandleExceptions->Illuminate\\Foundation\\Bootstrap\\{closure}(2, 'Undefined prope...', 'C:\\\\xampp\\\\htdocs...', 210)
#2 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Services\\MigrateViewHandler.php(76): App\\Helpers\\ViewHelper::retryFailViews()
#3 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Console\\Commands\\MigrateDatabase.php(40): App\\Services\\MigrateViewHandler::migrateViews()
#4 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(36): App\\Console\\Commands\\MigrateDatabase->handle()
#5 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Util.php(41): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#6 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(93): Illuminate\\Container\\Util::unwrapIfClosure(Object(Closure))
#7 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(37): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#8 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Container.php(661): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#9 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(183): Illuminate\\Container\\Container->call(Array)
#10 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Command\\Command.php(291): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#11 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(153): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#12 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(1014): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#13 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(301): Symfony\\Component\\Console\\Application->doRunCommand(Object(App\\Console\\Commands\\MigrateDatabase), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#14 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(171): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#15 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Application.php(102): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#16 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Console\\Kernel.php(155): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#17 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#18 {main}
"} 
[2024-07-18 08:28:06] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-18 08:28:09] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-18 08:28:09] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-18 08:28:12] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-18 08:28:12] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-18 08:28:13] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-18 08:28:25] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-18 08:28:25] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-18 08:28:26] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-18 08:28:28] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-18 08:28:28] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-18 08:28:28] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-18 08:28:30] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-18 08:28:30] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-18 08:28:30] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-18 08:28:30] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-18 08:28:30] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-18 08:28:30] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-18 08:28:30] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-18 08:28:30] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-18 08:28:30] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-18 08:28:30] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-18 08:28:30] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-18 08:28:30] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-18 08:28:30] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-18 08:28:30] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-18 08:28:30] local.ERROR: Error creating view B_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-18 08:38:54] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-18 08:38:55] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-18 08:38:55] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-18 08:38:57] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-18 08:38:57] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-18 08:38:57] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-18 08:38:57] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-18 08:38:57] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-18 08:38:57] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-18 08:38:57] local.ERROR: Error creating view vTemp_TestGiaVon on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-18 08:38:57] local.ERROR: Error creating view V_ChiTienPowerApp on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-18 08:38:57] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-18 08:42:46] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-18 08:42:47] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-18 08:42:47] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-18 08:42:47] local.ERROR: Error creating view View_1 on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-18 09:08:58] local.ERROR: Undefined variable $viewName {"exception":"[object] (ErrorException(code: 0): Undefined variable $viewName at C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Helpers\\ViewHelper.php:161)
[stacktrace]
#0 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Bootstrap\\HandleExceptions.php(270): Illuminate\\Foundation\\Bootstrap\\HandleExceptions->handleError(2, 'Undefined varia...', 'C:\\\\xampp\\\\htdocs...', 161)
#1 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Helpers\\ViewHelper.php(161): Illuminate\\Foundation\\Bootstrap\\HandleExceptions->Illuminate\\Foundation\\Bootstrap\\{closure}(2, 'Undefined varia...', 'C:\\\\xampp\\\\htdocs...', 161)
#2 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Services\\MigrateViewHandler.php(43): App\\Helpers\\ViewHelper::createCustomView()
#3 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Console\\Commands\\MigrateDatabase.php(40): App\\Services\\MigrateViewHandler::migrateViews()
#4 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(36): App\\Console\\Commands\\MigrateDatabase->handle()
#5 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Util.php(41): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#6 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(93): Illuminate\\Container\\Util::unwrapIfClosure(Object(Closure))
#7 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(37): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#8 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Container.php(661): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#9 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(183): Illuminate\\Container\\Container->call(Array)
#10 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Command\\Command.php(291): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#11 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(153): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#12 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(1014): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#13 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(301): Symfony\\Component\\Console\\Application->doRunCommand(Object(App\\Console\\Commands\\MigrateDatabase), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#14 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(171): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#15 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Application.php(102): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#16 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Console\\Kernel.php(155): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#17 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#18 {main}
"} 
[2024-07-18 09:13:34] local.ERROR: Undefined variable $viewName {"exception":"[object] (ErrorException(code: 0): Undefined variable $viewName at C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Helpers\\ViewHelper.php:161)
[stacktrace]
#0 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Bootstrap\\HandleExceptions.php(270): Illuminate\\Foundation\\Bootstrap\\HandleExceptions->handleError(2, 'Undefined varia...', 'C:\\\\xampp\\\\htdocs...', 161)
#1 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Helpers\\ViewHelper.php(161): Illuminate\\Foundation\\Bootstrap\\HandleExceptions->Illuminate\\Foundation\\Bootstrap\\{closure}(2, 'Undefined varia...', 'C:\\\\xampp\\\\htdocs...', 161)
#2 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Services\\MigrateViewHandler.php(43): App\\Helpers\\ViewHelper::createCustomView()
#3 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Console\\Commands\\MigrateDatabase.php(40): App\\Services\\MigrateViewHandler::migrateViews()
#4 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(36): App\\Console\\Commands\\MigrateDatabase->handle()
#5 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Util.php(41): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#6 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(93): Illuminate\\Container\\Util::unwrapIfClosure(Object(Closure))
#7 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(37): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#8 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Container.php(661): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#9 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(183): Illuminate\\Container\\Container->call(Array)
#10 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Command\\Command.php(291): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#11 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(153): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#12 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(1014): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#13 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(301): Symfony\\Component\\Console\\Application->doRunCommand(Object(App\\Console\\Commands\\MigrateDatabase), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#14 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(171): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#15 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Application.php(102): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#16 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Console\\Kernel.php(155): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#17 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#18 {main}
"} 
[2024-07-18 09:16:07] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-18 09:16:08] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-18 09:16:09] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-18 09:16:11] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-18 09:16:12] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-18 09:16:12] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-18 09:16:23] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS unpvt
WHERE     sl <> 0' at line 4 (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS SELECT   NgayCT, KhoHangXuatID, LoaiPhieu, SL
FROM         (SELECT   *
                           FROM         B_DV_Phieu_XuatBanCH_All
                           WHERE     kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL) p  AS unpvt
WHERE     sl <> 0)  
[2024-07-18 09:16:24] local.ERROR: Error creating view A_DV_LoaiPhieu: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.b_dv_phieu_loaiphieu' doesn't exist (SQL: CREATE VIEW `A_DV_LoaiPhieu` AS SELECT    NgayCT, KhoHangXuatID, REPLACE(LoaiPhieu, 'KiemTraDinhKy', 'IsKTDK') AS LoaiPhieu, COUNT(SL) AS SL
FROM         B_DV_Phieu_LoaiPhieu
GROUP BY NgayCT, KhoHangXuatID, LoaiPhieu
ORDER BY NgayCT)  
[2024-07-18 09:16:29] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS unpvt
WHERE     sl <> 0' at line 4 (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS SELECT   NgayCT, KhoHangXuatID, LoaiPhieu, SL
FROM         (SELECT   *
                           FROM         B_DV_Phieu_XuatBanCH_All
                           WHERE     kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL) p  AS unpvt
WHERE     sl <> 0)  
[2024-07-18 09:16:29] local.ERROR: Error creating view A_DV_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.b_dv_phieu_loaiphieu' doesn't exist (SQL: CREATE VIEW `A_DV_LoaiPhieu` AS SELECT    NgayCT, KhoHangXuatID, REPLACE(LoaiPhieu, 'KiemTraDinhKy', 'IsKTDK') AS LoaiPhieu, COUNT(SL) AS SL
FROM         B_DV_Phieu_LoaiPhieu
GROUP BY NgayCT, KhoHangXuatID, LoaiPhieu
ORDER BY NgayCT)  
[2024-07-18 09:16:29] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS unpvt
WHERE     sl <> 0' at line 4 (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS SELECT   NgayCT, KhoHangXuatID, LoaiPhieu, SL
FROM         (SELECT   *
                           FROM         B_DV_Phieu_XuatBanCH_All
                           WHERE     kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL) p  AS unpvt
WHERE     sl <> 0)  
[2024-07-18 09:16:29] local.ERROR: Error creating view A_DV_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.b_dv_phieu_loaiphieu' doesn't exist (SQL: CREATE VIEW `A_DV_LoaiPhieu` AS SELECT    NgayCT, KhoHangXuatID, REPLACE(LoaiPhieu, 'KiemTraDinhKy', 'IsKTDK') AS LoaiPhieu, COUNT(SL) AS SL
FROM         B_DV_Phieu_LoaiPhieu
GROUP BY NgayCT, KhoHangXuatID, LoaiPhieu
ORDER BY NgayCT)  
[2024-07-18 09:16:29] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS unpvt
WHERE     sl <> 0' at line 4 (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS SELECT   NgayCT, KhoHangXuatID, LoaiPhieu, SL
FROM         (SELECT   *
                           FROM         B_DV_Phieu_XuatBanCH_All
                           WHERE     kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL) p  AS unpvt
WHERE     sl <> 0)  
[2024-07-18 09:16:29] local.ERROR: Error creating view A_DV_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.b_dv_phieu_loaiphieu' doesn't exist (SQL: CREATE VIEW `A_DV_LoaiPhieu` AS SELECT    NgayCT, KhoHangXuatID, REPLACE(LoaiPhieu, 'KiemTraDinhKy', 'IsKTDK') AS LoaiPhieu, COUNT(SL) AS SL
FROM         B_DV_Phieu_LoaiPhieu
GROUP BY NgayCT, KhoHangXuatID, LoaiPhieu
ORDER BY NgayCT)  
[2024-07-18 09:20:12] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-18 09:20:14] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-18 09:20:14] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-18 09:20:17] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-18 09:20:17] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-18 09:20:17] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-18 09:20:29] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-18 09:26:45] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-18 09:26:46] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-18 09:26:46] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-18 09:26:49] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS SELECT DISTINCT C.CuaHangID, B.XeID, X.MaXe, X.TenXe,
                                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) ApDungTu,
                                        FIRST_VALUE(GiaHaiQuan) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) GiaHaiQuan
                                    FROM    XeBangGia AS A INNER JOIN
                                            XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID INNER JOIN
                                            XeBangGiaCuaHang AS C ON A.ID = C.XeBangGiaID INNER JOIN
                                            Xe AS X ON B.XeID = X.ID
                                    WHERE (A.IsActive = 1);)  
[2024-07-18 09:26:50] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
	                                    FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
	                                    FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
	                                    FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                                    FROM XeBangGiaNhapMua AS M INNER JOIN
                                        Xe AS X ON M.XeID = X.ID;)  
[2024-07-18 09:26:50] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-18 09:26:50] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-18 09:26:50] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-18 09:27:00] local.ERROR: Call to private method App\Services\SpecialViewHandler::BDVPhieuLoaiPhieu() from scope App\Services\MigrateViewHandler {"exception":"[object] (Error(code: 0): Call to private method App\\Services\\SpecialViewHandler::BDVPhieuLoaiPhieu() from scope App\\Services\\MigrateViewHandler at C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Services\\MigrateViewHandler.php:45)
[stacktrace]
#0 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Console\\Commands\\MigrateDatabase.php(40): App\\Services\\MigrateViewHandler::migrateViews()
#1 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(36): App\\Console\\Commands\\MigrateDatabase->handle()
#2 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Util.php(41): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#3 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(93): Illuminate\\Container\\Util::unwrapIfClosure(Object(Closure))
#4 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(37): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#5 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Container.php(661): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#6 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(183): Illuminate\\Container\\Container->call(Array)
#7 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Command\\Command.php(291): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#8 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(153): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#9 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(1014): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#10 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(301): Symfony\\Component\\Console\\Application->doRunCommand(Object(App\\Console\\Commands\\MigrateDatabase), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#11 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(171): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#12 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Application.php(102): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#13 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Console\\Kernel.php(155): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#14 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#15 {main}
"} 
[2024-07-18 09:28:47] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-18 09:28:49] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-18 09:28:49] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-18 09:28:52] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS SELECT DISTINCT C.CuaHangID, B.XeID, X.MaXe, X.TenXe,
                                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) ApDungTu,
                                        FIRST_VALUE(GiaHaiQuan) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) GiaHaiQuan
                                    FROM    XeBangGia AS A INNER JOIN
                                            XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID INNER JOIN
                                            XeBangGiaCuaHang AS C ON A.ID = C.XeBangGiaID INNER JOIN
                                            Xe AS X ON B.XeID = X.ID
                                    WHERE (A.IsActive = 1);)  
[2024-07-18 09:28:52] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
	                                    FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
	                                    FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
	                                    FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                                    FROM XeBangGiaNhapMua AS M INNER JOIN
                                        Xe AS X ON M.XeID = X.ID;)  
[2024-07-18 09:28:53] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-18 09:28:53] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-18 09:28:53] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-18 09:29:03] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-18 09:29:07] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS SELECT DISTINCT C.CuaHangID, B.XeID, X.MaXe, X.TenXe,
                                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) ApDungTu,
                                        FIRST_VALUE(GiaHaiQuan) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) GiaHaiQuan
                                    FROM    XeBangGia AS A INNER JOIN
                                            XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID INNER JOIN
                                            XeBangGiaCuaHang AS C ON A.ID = C.XeBangGiaID INNER JOIN
                                            Xe AS X ON B.XeID = X.ID
                                    WHERE (A.IsActive = 1);)  
[2024-07-18 09:29:07] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
	                                    FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
	                                    FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
	                                    FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                                    FROM XeBangGiaNhapMua AS M INNER JOIN
                                        Xe AS X ON M.XeID = X.ID;)  
[2024-07-18 09:29:07] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS SELECT DISTINCT C.CuaHangID, B.XeID, X.MaXe, X.TenXe,
                                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) ApDungTu,
                                        FIRST_VALUE(GiaHaiQuan) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) GiaHaiQuan
                                    FROM    XeBangGia AS A INNER JOIN
                                            XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID INNER JOIN
                                            XeBangGiaCuaHang AS C ON A.ID = C.XeBangGiaID INNER JOIN
                                            Xe AS X ON B.XeID = X.ID
                                    WHERE (A.IsActive = 1);)  
[2024-07-18 09:29:07] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
	                                    FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
	                                    FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
	                                    FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                                    FROM XeBangGiaNhapMua AS M INNER JOIN
                                        Xe AS X ON M.XeID = X.ID;)  
[2024-07-18 09:29:07] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS SELECT DISTINCT C.CuaHangID, B.XeID, X.MaXe, X.TenXe,
                                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) ApDungTu,
                                        FIRST_VALUE(GiaHaiQuan) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) GiaHaiQuan
                                    FROM    XeBangGia AS A INNER JOIN
                                            XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID INNER JOIN
                                            XeBangGiaCuaHang AS C ON A.ID = C.XeBangGiaID INNER JOIN
                                            Xe AS X ON B.XeID = X.ID
                                    WHERE (A.IsActive = 1);)  
[2024-07-18 09:29:07] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
	                                    FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
	                                    FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
	                                    FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                                    FROM XeBangGiaNhapMua AS M INNER JOIN
                                        Xe AS X ON M.XeID = X.ID;)  
[2024-07-18 09:34:28] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-18 09:34:29] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-18 09:34:29] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-18 09:34:32] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-18 09:34:33] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-18 09:34:33] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-18 09:34:44] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-18 09:38:43] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-18 09:38:45] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-18 09:38:45] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-18 09:38:47] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-18 09:38:47] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-18 09:38:48] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-18 09:38:57] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-18 09:39:00] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS 
                     SELECT DISTINCT C.CuaHangID, B.XeID, X.MaXe, X.TenXe,
                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) ApDungTu,
                        FIRST_VALUE(GiaHaiQuan) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) GiaHaiQuan
                    FROM XeBangGia AS A 
                    INNER JOIN XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID 
                    INNER JOIN XeBangGiaCuaHang AS C ON A.ID = C.XeBangGiaID 
                    INNER JOIN Xe AS X ON B.XeID = X.ID
                    WHERE A.IsActive = 1
                )  
[2024-07-18 09:39:00] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS 
                    SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
                        FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
                        FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                    FROM XeBangGiaNhapMua AS M 
                    INNER JOIN Xe AS X ON M.XeID = X.ID
                )  
[2024-07-18 09:39:00] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS 
                     SELECT DISTINCT C.CuaHangID, B.XeID, X.MaXe, X.TenXe,
                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) ApDungTu,
                        FIRST_VALUE(GiaHaiQuan) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) GiaHaiQuan
                    FROM XeBangGia AS A 
                    INNER JOIN XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID 
                    INNER JOIN XeBangGiaCuaHang AS C ON A.ID = C.XeBangGiaID 
                    INNER JOIN Xe AS X ON B.XeID = X.ID
                    WHERE A.IsActive = 1
                )  
[2024-07-18 09:39:00] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS 
                    SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
                        FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
                        FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                    FROM XeBangGiaNhapMua AS M 
                    INNER JOIN Xe AS X ON M.XeID = X.ID
                )  
[2024-07-18 09:39:00] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS 
                     SELECT DISTINCT C.CuaHangID, B.XeID, X.MaXe, X.TenXe,
                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) ApDungTu,
                        FIRST_VALUE(GiaHaiQuan) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) GiaHaiQuan
                    FROM XeBangGia AS A 
                    INNER JOIN XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID 
                    INNER JOIN XeBangGiaCuaHang AS C ON A.ID = C.XeBangGiaID 
                    INNER JOIN Xe AS X ON B.XeID = X.ID
                    WHERE A.IsActive = 1
                )  
[2024-07-18 09:39:00] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS 
                    SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
                        FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
                        FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                    FROM XeBangGiaNhapMua AS M 
                    INNER JOIN Xe AS X ON M.XeID = X.ID
                )  
[2024-07-18 09:41:56] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS 
                    SELECT DISTINCT CuaHangID, XeID, MaXe, TenXe, ApDungTu, GiaHaiQuan
                    FROM (
                        SELECT 
                            C.CuaHangID, 
                            B.XeID, 
                            X.MaXe, 
                            X.TenXe,
                            FIRST_VALUE(ApDungTu) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) AS ApDungTu,
                            FIRST_VALUE(GiaHaiQuan) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) AS GiaHaiQuan,
                            ROW_NUMBER() OVER(PARTITION BY C.CuaHangID, B.XeID ORDER BY ApDungTu DESC, C.ID DESC) AS rn
                        FROM XeBangGia AS A 
                        INNER JOIN XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID 
                        INNER JOIN XeBangGiaCuaHang AS C ON A.ID = C.XeBangGiaID 
                        INNER JOIN Xe AS X ON B.XeID = X.ID
                        WHERE A.IsActive = 1
                    ) subquery
                    WHERE rn = 1
                )  
[2024-07-18 09:41:56] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS 
                    SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
                        FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
                        FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                    FROM XeBangGiaNhapMua AS M 
                    INNER JOIN Xe AS X ON M.XeID = X.ID
                )  
[2024-07-18 09:41:56] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS 
                    SELECT DISTINCT CuaHangID, XeID, MaXe, TenXe, ApDungTu, GiaHaiQuan
                    FROM (
                        SELECT 
                            C.CuaHangID, 
                            B.XeID, 
                            X.MaXe, 
                            X.TenXe,
                            FIRST_VALUE(ApDungTu) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) AS ApDungTu,
                            FIRST_VALUE(GiaHaiQuan) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) AS GiaHaiQuan,
                            ROW_NUMBER() OVER(PARTITION BY C.CuaHangID, B.XeID ORDER BY ApDungTu DESC, C.ID DESC) AS rn
                        FROM XeBangGia AS A 
                        INNER JOIN XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID 
                        INNER JOIN XeBangGiaCuaHang AS C ON A.ID = C.XeBangGiaID 
                        INNER JOIN Xe AS X ON B.XeID = X.ID
                        WHERE A.IsActive = 1
                    ) subquery
                    WHERE rn = 1
                )  
[2024-07-18 09:41:56] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS 
                    SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
                        FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
                        FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                    FROM XeBangGiaNhapMua AS M 
                    INNER JOIN Xe AS X ON M.XeID = X.ID
                )  
[2024-07-18 09:41:56] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS 
                    SELECT DISTINCT CuaHangID, XeID, MaXe, TenXe, ApDungTu, GiaHaiQuan
                    FROM (
                        SELECT 
                            C.CuaHangID, 
                            B.XeID, 
                            X.MaXe, 
                            X.TenXe,
                            FIRST_VALUE(ApDungTu) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) AS ApDungTu,
                            FIRST_VALUE(GiaHaiQuan) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) AS GiaHaiQuan,
                            ROW_NUMBER() OVER(PARTITION BY C.CuaHangID, B.XeID ORDER BY ApDungTu DESC, C.ID DESC) AS rn
                        FROM XeBangGia AS A 
                        INNER JOIN XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID 
                        INNER JOIN XeBangGiaCuaHang AS C ON A.ID = C.XeBangGiaID 
                        INNER JOIN Xe AS X ON B.XeID = X.ID
                        WHERE A.IsActive = 1
                    ) subquery
                    WHERE rn = 1
                )  
[2024-07-18 09:41:56] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS 
                    SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
                        FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
                        FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                    FROM XeBangGiaNhapMua AS M 
                    INNER JOIN Xe AS X ON M.XeID = X.ID
                )  
[2024-07-18 09:44:50] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '' at line 1 (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS )  
[2024-07-18 09:44:50] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS 
                    SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
                        FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
                        FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                    FROM XeBangGiaNhapMua AS M 
                    INNER JOIN Xe AS X ON M.XeID = X.ID
                )  
[2024-07-18 09:44:50] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '' at line 1 (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS )  
[2024-07-18 09:44:50] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS 
                    SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
                        FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
                        FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                    FROM XeBangGiaNhapMua AS M 
                    INNER JOIN Xe AS X ON M.XeID = X.ID
                )  
[2024-07-18 09:44:50] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '' at line 1 (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS )  
[2024-07-18 09:44:50] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS 
                    SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
                        FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
                        FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                    FROM XeBangGiaNhapMua AS M 
                    INNER JOIN Xe AS X ON M.XeID = X.ID
                )  
[2024-07-18 09:49:06] local.ERROR: Undefined array key "viewName" {"exception":"[object] (ErrorException(code: 0): Undefined array key \"viewName\" at C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Helpers\\DataHelper.php:24)
[stacktrace]
#0 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Bootstrap\\HandleExceptions.php(270): Illuminate\\Foundation\\Bootstrap\\HandleExceptions->handleError(2, 'Undefined array...', 'C:\\\\xampp\\\\htdocs...', 24)
#1 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Helpers\\DataHelper.php(24): Illuminate\\Foundation\\Bootstrap\\HandleExceptions->Illuminate\\Foundation\\Bootstrap\\{closure}(2, 'Undefined array...', 'C:\\\\xampp\\\\htdocs...', 24)
#2 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Services\\SpecialViewHandler.php(494): App\\Helpers\\DataHelper::migrateErrors(Array, Object(Illuminate\\Database\\QueryException))
#3 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Services\\SpecialViewHandler.php(501): App\\Services\\SpecialViewHandler::createIntermediateTable()
#4 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Services\\MigrateViewHandler.php(90): App\\Services\\SpecialViewHandler::ABHXeBangGiaXuatBanCH()
#5 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\app\\Console\\Commands\\MigrateDatabase.php(40): App\\Services\\MigrateViewHandler::migrateViews()
#6 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(36): App\\Console\\Commands\\MigrateDatabase->handle()
#7 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Util.php(41): Illuminate\\Container\\BoundMethod::Illuminate\\Container\\{closure}()
#8 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(93): Illuminate\\Container\\Util::unwrapIfClosure(Object(Closure))
#9 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\BoundMethod.php(37): Illuminate\\Container\\BoundMethod::callBoundMethod(Object(Illuminate\\Foundation\\Application), Array, Object(Closure))
#10 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Container\\Container.php(661): Illuminate\\Container\\BoundMethod::call(Object(Illuminate\\Foundation\\Application), Array, Array, NULL)
#11 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(183): Illuminate\\Container\\Container->call(Array)
#12 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Command\\Command.php(291): Illuminate\\Console\\Command->execute(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#13 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Command.php(153): Symfony\\Component\\Console\\Command\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Illuminate\\Console\\OutputStyle))
#14 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(1014): Illuminate\\Console\\Command->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#15 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(301): Symfony\\Component\\Console\\Application->doRunCommand(Object(App\\Console\\Commands\\MigrateDatabase), Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#16 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\symfony\\console\\Application.php(171): Symfony\\Component\\Console\\Application->doRun(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#17 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Console\\Application.php(102): Symfony\\Component\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#18 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Console\\Kernel.php(155): Illuminate\\Console\\Application->run(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#19 C:\\xampp\\htdocs\\migrate-mssql-to-mysql\\artisan(37): Illuminate\\Foundation\\Console\\Kernel->handle(Object(Symfony\\Component\\Console\\Input\\ArgvInput), Object(Symfony\\Component\\Console\\Output\\ConsoleOutput))
#20 {main}
"} 
[2024-07-18 09:53:04] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
	                                    FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
	                                    FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
	                                    FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                                    FROM XeBangGiaNhapMua AS M INNER JOIN
                                        Xe AS X ON M.XeID = X.ID;)  
[2024-07-18 09:53:18] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
	                                    FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
	                                    FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
	                                    FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                                    FROM XeBangGiaNhapMua AS M INNER JOIN
                                        Xe AS X ON M.XeID = X.ID;)  
[2024-07-18 09:53:18] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
	                                    FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
	                                    FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
	                                    FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                                    FROM XeBangGiaNhapMua AS M INNER JOIN
                                        Xe AS X ON M.XeID = X.ID;)  
[2024-07-18 09:53:18] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua on retry: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
	                                    FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
	                                    FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
	                                    FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                                    FROM XeBangGiaNhapMua AS M INNER JOIN
                                        Xe AS X ON M.XeID = X.ID;)  
[2024-07-18 09:57:18] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-18 09:57:20] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-18 09:57:20] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-18 09:57:23] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS SELECT DISTINCT C.CuaHangID, B.XeID, X.MaXe, X.TenXe,
                                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) ApDungTu,
                                        FIRST_VALUE(GiaHaiQuan) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) GiaHaiQuan
                                    FROM    XeBangGia AS A INNER JOIN
                                            XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID INNER JOIN
                                            XeBangGiaCuaHang AS C ON A.ID = C.XeBangGiaID INNER JOIN
                                            Xe AS X ON B.XeID = X.ID
                                    WHERE (A.IsActive = 1);)  
[2024-07-18 09:57:23] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
	                                    FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
	                                    FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
	                                    FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                                    FROM XeBangGiaNhapMua AS M INNER JOIN
                                        Xe AS X ON M.XeID = X.ID;)  
[2024-07-18 09:57:23] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-18 09:57:23] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-18 09:57:24] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-18 09:57:33] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS unpvt
WHERE     sl <> 0' at line 4 (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS SELECT   NgayCT, KhoHangXuatID, LoaiPhieu, SL
FROM         (SELECT   *
                           FROM         B_DV_Phieu_XuatBanCH_All
                           WHERE     kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL) p  AS unpvt
WHERE     sl <> 0)  
[2024-07-18 09:57:34] local.ERROR: Error creating view A_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
      ...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-18 09:57:34] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-18 09:57:35] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-18 09:57:36] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-18 09:57:37] local.ERROR: Error creating view B_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-18 09:57:37] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-18 09:57:37] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-18 09:57:37] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-18 09:57:38] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
      ...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-18 09:57:38] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-18 09:57:38] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-18 09:57:38] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
      ...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-18 09:57:38] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-18 09:57:39] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-18 09:57:39] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
      ...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-18 09:57:39] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-18 09:57:39] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-18 09:58:14] local.ERROR: Error creating view A_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
      ...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-18 09:58:14] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-18 09:59:22] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-18 09:59:24] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-18 09:59:24] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-18 09:59:27] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-18 09:59:27] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-18 09:59:28] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-18 09:59:38] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-18 10:02:17] local.ERROR: Error creating view L_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_thuchi' doesn't exist (SQL: CREATE VIEW `L_ThuChi_CH` AS SELECT   L_ThuChi.*
FROM         L_ThuChi
WHERE     (KhoHangXuatID <> 26))  
[2024-07-18 10:02:19] local.ERROR: Error creating view L_Xe_NhapTraLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_baobien_gv' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe` AS 
SELECT   TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, M.SoKhung, M.SoMay, BL.TuVanID, BL.HinhThucBan, TL.ThanhTienXe, 
                         TL.PhiBaoBien AS ThanhTienBB, TL.GiaPhuKien AS ThanhTienPK, M.XeID, BL.GiaSonXe AS ThanhTienSon, M.DonGia_CoVAT AS TienVonXe, 
                         V_XeSonXeMax.GiaNhap AS TienVonSon, V_BaoBien_GV.SoTien AS TienVonBB, V_PK_ThanhTienVon_XeBanLe.TienVonPK
FROM         XeNhapTraLaiBanLe AS TL INNER JOIN
                         XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
                         XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         V_BaoBien_GV ON BL.ID = V_BaoBien_GV.XeBanLeID LEFT OUTER JOIN
                         V_PK_ThanhTienVon_XeBanLe ON BL.ID = V_PK_ThanhTienVon_XeBanLe.XeBanLeID LEFT OUTER JOIN
                         V_XeSonXeMax ON BL.XeNhapMuaID = V_XeSonXeMax.XeNhapMuaID)  
[2024-07-18 10:02:19] local.ERROR: Error creating view L_Xe_NhapTraLe_Master2: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.l_xe_nhaptrale' doesn't exist (SQL: CREATE VIEW `L_Xe_NhapTraLe_Master2` AS SELECT   ID, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, XeID, TienVonXe, TienVonBB, TienVonPK
FROM         L_Xe_NhapTraLe)  
[2024-07-18 10:02:22] local.ERROR: Error creating view A_BH_Xe_BangGiaXuatBanCH: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaXuatBanCH` AS SELECT DISTINCT C.CuaHangID, B.XeID, X.MaXe, X.TenXe,
                                        FIRST_VALUE(ApDungTu) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) ApDungTu,
                                        FIRST_VALUE(GiaHaiQuan) OVER(PARTITION BY C.CuaHangID ORDER BY ApDungTu DESC, C.ID DESC) GiaHaiQuan
                                    FROM    XeBangGia AS A INNER JOIN
                                            XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID INNER JOIN
                                            XeBangGiaCuaHang AS C ON A.ID = C.XeBangGiaID INNER JOIN
                                            Xe AS X ON B.XeID = X.ID
                                    WHERE (A.IsActive = 1);)  
[2024-07-18 10:02:22] local.ERROR: Error creating view A_BH_Xe_BangGiaNhapMua: SQLSTATE[HY000]: General error: 4016 Window function is not allowed in window specification (SQL: CREATE VIEW `A_BH_Xe_BangGiaNhapMua` AS SELECT DISTINCT XeID, KhachHangID, X.MaXe, X.TenXe,
	                                    FIRST_VALUE(ApDungTu) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ApDungTu,
	                                    FIRST_VALUE(DonGia) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) DonGia,
	                                    FIRST_VALUE(M.ID) OVER(PARTITION BY KhachHangID ORDER BY ApDungTu DESC, M.ID DESC) ID
                                    FROM XeBangGiaNhapMua AS M INNER JOIN
                                        Xe AS X ON M.XeID = X.ID;)  
[2024-07-18 10:02:22] local.ERROR: Error creating view A_ThuChi_All: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.v_taikhoantienmat' doesn't exist (SQL: CREATE VIEW `A_ThuChi_All` AS SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeThanhToan AS T ON A.ID = T .XeBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            XeBanSi AS A INNER JOIN
                         XeBanSiThanhToan AS T ON A.ID = T .XeBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, 0 AS TacNghiep, ThuTienLyDoID, NguoiNop AS NguoiNopNhan, T .CreatedBy, T .GhiChu
FROM            ThuTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .NgayHachToan, T .TaiKhoanID, T .SoTien, T .KhoHangID, T .KhoHachToanID, T .KhachHangID, 1 AS TacNghiep, T .ChiTienLyDoID AS LyDoID, NguoiNhan AS NguoiNopNhan, T .CreatedBy, 
                         T .GhiChu
FROM            ChiTien AS T
WHERE        T .SoTien > 0
UNION ALL
SELECT        S.ID, S.SoCT, S.NgayCT, S.ngayct AS NgayHachToan, S.TaiKhoanID, S.GiaNhap AS SoTien, S.KhoHangID, S.khohangid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 102 AS LyDoID, NULL AS NguoiNopNhan, 
                         S.CreatedBy, NULL AS GhiChu
FROM            XeSonXe AS S
WHERE        S.gianhap > 0 AND S.NgayCT IS NOT NULL
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeThanhToan AS T ON A.ID = T .DVBanLeID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiThanhToan AS T ON A.ID = T .DVBanSiID
WHERE        T .SoTien > 0
UNION ALL
SELECT        T .ID, T .SoCT, T .NgayCT, T .ngayct AS NgayHachToan, T .TaiKhoanID, T .SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, A.KhachHangID, T .TacNghiep, T .LyDoID, NULL AS NguoiNopNhan, 
                         T .CreatedBy, NULL AS GhiChu
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonThanhToan AS T ON A.ID = T .DVBanBuonID
WHERE        T .SoTien > 0
UNION ALL
SELECT        G.ID, A.SoCT, G.NgayGC AS NgayCT, G.NgayGC AS NgayHachToan, T .TaiKhoanID, G.ChiPhi AS SoTien, A.KhoHangXuatID AS KhoHangID, A.khohangxuatid AS KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, 
                         103 AS LyDoID, NULL AS NguoiNopNhan, G.CreatedBy, NULL AS GhiChu
FROM            DVBanLe AS A INNER JOIN
                         V_TaiKhoanTienMat AS T ON A.KhoHangXuatID = T .KhoHangID INNER JOIN
                         DVBanLeGiaCong AS G ON A.ID = G.DVBanLeID
WHERE        G.ChiPhi > 0
UNION ALL
SELECT        ID, NULL AS SoCT, Thang AS NgayCT, Thang AS NgayHachToan, 20 AS TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, NULL AS KhachHangID, 1 AS TacNghiep, CASE WHEN Loai IN ('Luong', 'DCTang', 'DCGiam', 'Phat', 
                         'Them') THEN 149 WHEN Loai IN ('Thuong') THEN 150 WHEN Loai IN ('BH-CN', 'BH-CT') THEN 152 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, 1 AS CreatedBy, NULL AS GhiChu
FROM            BangLuong
WHERE        Loai <> 'CongNo'
UNION ALL
SELECT        A.ID, A.SoCT, B.NgayXuat AS NgayCT, B.NgayXuat AS NgayHachToan, 20 AS TaiKhoanID, B.TienVon AS SoTien, A.KhoHangXuatID AS KhoHangID, A.KhoHangXuatID AS KhoHachToanID, A.KhachHangID, 1 AS TacNghiep, 
                         151 AS LyDoID, NULL AS NguoiNopNhan, B.CreatedBy, B.GhiChu
FROM            XeBanLe AS A INNER JOIN
                         XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID
UNION ALL
SELECT        ID, SoCT, NgayCT, NgayCT AS NgayHachToan, 20 AS TaiKhoanID, GV AS SoTien, KhoHangXuatID AS KhoHangID, KhoHangXuatID AS KhoHachToanID, KhachHangID, 1 AS TacNghiep, 
                         CASE WHEN lydo = 'Xuất khuyến mãi' THEN 104 WHEN lydo = 'Xuất tài sản' THEN 20 ELSE NULL END AS LyDoID, NULL AS NguoiNopNhan, CreatedBy, GhiChu
FROM            A_BH_Xe_XuatKhac
)  
[2024-07-18 10:02:22] local.ERROR: Error creating view A_ThuChi_CH: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_thuchi_all' doesn't exist (SQL: CREATE VIEW `A_ThuChi_CH` AS SELECT        ID, SoCT, NgayCT, NgayHachToan, TaiKhoanID, SoTien, KhoHangID, KhoHachToanID, KhachHangID, TacNghiep, LyDoID, NguoiNopNhan, CreatedBy, GhiChu
FROM            A_ThuChi_All
WHERE        (KhoHangID <> 26))  
[2024-07-18 10:02:23] local.ERROR: Error creating view vTemp_PKBH_TON_AM: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.vtemp_pkbh' doesn't exist (SQL: CREATE VIEW `vTemp_PKBH_TON_AM` AS SELECT        X.VatTuID, X.KhoHangXuatID, X.NAM, X.THANG, N.SL AS SLN, X.SL AS SLX, X.SL - IFNULL(N.SL, 0) AS SLTON
FROM            vTemp_PKBH AS X LEFT OUTER JOIN
                         vTemp_PKBH_Nhap AS N ON X.VatTuID = N.VatTuID AND X.NAM = N.NAM AND X.THANG = N.THANG AND X.KhoHangXuatID = N.KhoHangNhapID)  
[2024-07-18 10:02:33] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS unpvt
WHERE     sl <> 0' at line 4 (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS SELECT   NgayCT, KhoHangXuatID, LoaiPhieu, SL
FROM         (SELECT   *
                           FROM         B_DV_Phieu_XuatBanCH_All
                           WHERE     kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL) p  AS unpvt
WHERE     sl <> 0)  
[2024-07-18 10:02:34] local.ERROR: Error creating view A_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
      ...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-18 10:02:34] local.ERROR: Error creating view L_Xe_XuatBanLe: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-18 10:02:35] local.ERROR: Error creating view A_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-18 10:02:35] local.ERROR: Error creating view vTemp_TestGiaVon: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.Gia...' at line 5 (SQL: CREATE VIEW `vTemp_TestGiaVon` AS SELECT        DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID INNER JOIN
                         VatTu ON DVBanLeVatTu.VatTuID = VatTu.ID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102))
GROUP BY DVBanLeVatTu.VatTuID, DVBanLeVatTu.GiaVon, DVBanLeVatTu.TienVon, DVBanLe.KhoHangXuatID, VatTu.MaVatTu, VatTu.TenVatTu_TiengViet
HAVING        (DVBanLeVatTu.TienVon < 0) AND (DVBanLe.KhoHangXuatID = 1))  
[2024-07-18 10:02:36] local.ERROR: Error creating view B_BH_Xe_XuatBanCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_XuatBanCH` AS SELECT   L.ID, L.SoCT, L.NgayCT, L.NgayBan, L.KhoHangXuatID, L.KhachHangID, L.XeNhapMuaID, L.HinhThucBan, L.TuVanID, L.TuVanID AS NVTinhThuong, M.XeID, M.SoKhung, M.SoMay, 
                         'XuatBanCH' AS NghiepVu, CAST(L.DonGia + L.GiaThayVanh + IFNULL(TG.TienHangXeTG, 0 AS SIGNED)) AS DTXe, CAST(L.PhiBaoBien + IFNULL(TG.TienHangBaoBienTG, 0 AS SIGNED) 
                         - L.BHXMThu) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(IFNULL(GVBB.SoTien, 0 AS SIGNED)) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM         XeBanLe AS L INNER JOIN
                         XeNhapMua AS M ON L.XeNhapMuaID = M.ID LEFT OUTER JOIN
                         XeBanLePhuNano AS N ON L.ID = N.XeBanLeID LEFT OUTER JOIN
                         B_BaoBien_GV AS GVBB ON L.ID = GVBB.XeBanLeID LEFT OUTER JOIN
                         B_XeBanCHGiaTangGiam AS TG ON L.ID = TG.XeBanLeID
WHERE     (L.NgayBan IS NOT NULL))  
[2024-07-18 10:02:36] local.ERROR: Error creating view V_ChiTienPowerApp: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DATEADD(day, - 30, NOW()), 105))' at line 6 (SQL: CREATE VIEW `V_ChiTienPowerApp` AS SELECT        C.TenCuaHang, A.ID, A.KhoHangID, A.SoCT, A.NgayCT, A.KhachHangID, A.NguoiNhan, A.ChiTienLyDoID, A.TaiKhoanID, A.SoTien, A.GhiChu, A.ChuKy_NguoiNhan, A.Status1, A.Approval1By, A.Approval1At, A.Status2, 
                         A.Approval2By, A.Approval2At, A.CreatedBy, A.CreatedAt, A.UpdatedBy, A.UpdatedAt, A.DeletedBy, A.DeletedAt
FROM            ChiTien AS A INNER JOIN
                         KhoHang AS K ON A.KhoHangID = K.ID INNER JOIN
                         CuaHang AS C ON K.CuaHangID = C.ID
WHERE        (A.NgayCT >= CONVERT(date, DATEADD(day, - 30, NOW()), 105)))  
[2024-07-18 10:02:36] local.ERROR: Error creating view View_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanL...' at line 4 (SQL: CREATE VIEW `View_1` AS SELECT        DVBanLeVatTu.VatTuID
FROM            DVBanLe INNER JOIN
                         DVBanLeVatTu ON DVBanLe.ID = DVBanLeVatTu.DVBanLeID
WHERE        (DVBanLe.NgayCT >= CONVERT(DATETIME, '2019-12-19 00:00:00', 102)) AND (DVBanLeVatTu.TienVon <= 0)
GROUP BY DVBanLeVatTu.VatTuID)  
[2024-07-18 10:02:37] local.ERROR: Error creating view B_BH_Xe_NhapTraCH: SQLSTATE[42000]: Syntax error or access violation: 1583 Incorrect parameters in the call to native function 'IFNULL' (SQL: CREATE VIEW `B_BH_Xe_NhapTraCH` AS SELECT TL.ID, TL.SoCT, TL.NgayCT, TL.XeBanLeID, BL.NgayBan, BL.KhoHangXuatID, BL.KhachHangID, BL.XeNhapMuaID, BL.TuVanID, BL.TuVanID AS NVTinhThuong, M.XeID, BL.HinhThucBan, M.SoKhung, M.SoMay, 'NhapTraCH' AS NghiepVu, CAST(TL.ThanhTienXe - IFNULL(BL.TienVonSonXe, 0 AS SIGNED)) AS DTXe, CAST(TL.PhiBaoBien - IFNULL(BL.BHXMThu, 0 AS SIGNED)) AS DTBB, CAST(M.DonGia_CoVAT AS SIGNED) AS GVXe, CAST(GVBB.SoTien AS SIGNED) AS GVBB, CAST(TG.TienHangXeTG AS SIGNED) AS TGXe, CAST(TG.TienHangBaoBienTG AS SIGNED) AS TGBB
FROM   XeNhapTraLaiBanLe AS TL INNER JOIN
             XeBanLe AS BL ON TL.XeBanLeID = BL.ID INNER JOIN
             XeNhapMua AS M ON BL.XeNhapMuaID = M.ID LEFT OUTER JOIN
             B_BaoBien_GV AS GVBB ON BL.ID = GVBB.XeBanLeID LEFT OUTER JOIN
             B_XeBanCHGiaTangGiam AS TG ON BL.ID = TG.XeBanLeID)  
[2024-07-18 10:02:38] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
      ...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-18 10:02:38] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-18 10:02:38] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-18 10:02:38] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
      ...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-18 10:02:38] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-18 10:02:38] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-18 10:02:38] local.ERROR: Error creating view A_BH_Xe_XuatBanCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
      ...' at line 4 (SQL: CREATE VIEW `A_BH_Xe_XuatBanCH` AS SELECT   *
FROM         (SELECT   ID, SoCT, NgayCT, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 
                                                    2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) AS ChiTieu
                           FROM         (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_XuatBanCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt
WHERE     (TG <> 0) OR
                         (DT <> 0) OR
                         (GV <> 0))  
[2024-07-18 10:02:38] local.ERROR: Error creating view L_Xe_XuatBanLe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_db.a_bh_xe_xuatbanch' doesn't exist (SQL: CREATE VIEW `L_Xe_XuatBanLe` AS SELECT        XeBanLe.ID, XeBanLe.SoCT, XeBanLe.NgayCT, XeBanLe.NgayBan, XeBanLe.XeID, A_BH_Xe_XuatBanCH.SoKhung, A_BH_Xe_XuatBanCH.SoMay
FROM            XeBanLe LEFT OUTER JOIN
                         A_BH_Xe_XuatBanCH ON XeBanLe.ID = A_BH_Xe_XuatBanCH.ID)  
[2024-07-18 10:02:38] local.ERROR: Error creating view A_BH_Xe_NhapTraCH on retry: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'AS pvt' at line 4 (SQL: CREATE VIEW `A_BH_Xe_NhapTraCH` AS SELECT *
FROM   (SELECT ID, SoCT, NgayCT, XeBanLeID, NgayBan, KhoHangXuatID, KhachHangID, XeNhapMuaID, TuVanID, NVTinhThuong, XeID, HinhThucBan, SoKhung, SoMay, ThanhTien, SUBSTRING(ChiTieu, 1, 2) AS A, NghiepVu, SUBSTRING(ChiTieu, 3, LEN(ChiTieu)) 
                           AS ChiTieu
             FROM    (SELECT *, 'DTXe' AS `ChiTieu`, `DTXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTXe` <> 0 UNION ALL SELECT *, 'DTBB' AS `ChiTieu`, `DTBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `DTBB` <> 0 UNION ALL SELECT *, 'GVXe' AS `ChiTieu`, `GVXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVXe` <> 0 UNION ALL SELECT *, 'GVBB' AS `ChiTieu`, `GVBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `GVBB` <> 0 UNION ALL SELECT *, 'TGXe' AS `ChiTieu`, `TGXe` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGXe` <> 0 UNION ALL SELECT *, 'TGBB' AS `ChiTieu`, `TGBB` AS `ThanhTien` FROM `B_BH_Xe_NhapTraCH` WHERE `TGBB` <> 0)  AS unpvt) AS X  AS pvt)  
[2024-07-18 10:36:14] local.ERROR: Error creating view L_NhanVienKhoHang on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'nv.chucvuid' in 'field list' (SQL: CREATE VIEW `L_NhanVienKhoHang` AS SELECT   ID AS NhanVienID, CASE WHEN nv.chucvuid IN (1, 2, 5) THEN 26 WHEN nv.chucvuid IN (9) THEN 36 WHEN nv.chucvuid IN (4, 7, 8, 24, 34, 37, 38, 39) THEN 28 WHEN nv.chucvuid IN (6, 10, 12, 13, 
                         16, 36, 43) AND nv.cuahangid = 1 THEN 2 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 2 THEN 6 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 3 THEN 10 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 4 THEN 14 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 5 THEN 18 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 6 THEN 22 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 1 THEN 1 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 2 THEN 5 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 3 THEN 9 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 4 THEN 13 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 5 THEN 17 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 6 THEN 21 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND
                          nv.cuahangid = 12 THEN 37 ELSE NULL END AS KhoHangID
FROM         NhanVien AS NV)  
[2024-07-18 10:36:14] local.ERROR: Error creating view L_NhanVien on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_NhanVienKhoHang' doesn't exist (SQL: CREATE VIEW `L_NhanVien` AS SELECT    NV.ID, NV.HoTen, CV.TenChucVu, L_NhanVienKhoHang.KhoHangID, KhoHang.TenKhoHang, NV.CuaHangID, CH.TenCuaHang, NV.IDQT, NV.IsActive
FROM         KhoHang INNER JOIN
                         L_NhanVienKhoHang ON KhoHang.ID = L_NhanVienKhoHang.KhoHangID INNER JOIN
                         CuaHang AS CH ON KhoHang.CuaHangID = CH.ID INNER JOIN
                         NhanVien AS NV INNER JOIN
                         ChucVu AS CV ON NV.ChucVuID = CV.ID ON L_NhanVienKhoHang.NhanVienID = NV.ID)  
[2024-07-18 10:36:14] local.ERROR: Error creating view B_NhanVienKhoHang on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'nv.chucvuid' in 'field list' (SQL: CREATE VIEW `B_NhanVienKhoHang` AS SELECT       ID AS NhanVienID, CASE WHEN nv.chucvuid IN (1, 2, 5) THEN 26 WHEN nv.chucvuid IN (9) THEN 36 WHEN nv.chucvuid IN (4, 7, 8, 24, 34, 37, 38, 39) THEN 28 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 1 THEN 2 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 2 THEN 6 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 3 THEN 10 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) 
                         AND nv.cuahangid = 4 THEN 14 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 5 THEN 18 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 6 THEN 22 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 
                         43) AND nv.cuahangid = 13 THEN 38 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 1 THEN 1 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 2 THEN 5 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 3 THEN 9 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 4 THEN 13 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 5 THEN 17 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 6 THEN 21 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 12 THEN 37 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 13 THEN 39 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 12 THEN 40 ELSE NULL END AS KhoHangID
FROM            NhanVien AS NV)  
[2024-07-18 10:36:14] local.ERROR: Error creating view 0_NhanVien on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_NhanVienKhoHang' doesn't exist (SQL: CREATE VIEW `0_NhanVien` AS SELECT         NV.ID, NV.HoTen, CV.TenChucVu, B_NhanVienKhoHang.KhoHangID, KhoHang.TenKhoHang, NV.CuaHangID, CH.TenCuaHang, NV.IDQT, NV.IsActive
FROM            KhoHang INNER JOIN
                         B_NhanVienKhoHang ON KhoHang.ID = B_NhanVienKhoHang.KhoHangID INNER JOIN
                         CuaHang AS CH ON KhoHang.CuaHangID = CH.ID INNER JOIN
                         NhanVien AS NV INNER JOIN
                         ChucVu AS CV ON NV.ChucVuID = CV.ID ON B_NhanVienKhoHang.NhanVienID = NV.ID)  
[2024-07-18 10:36:14] local.ERROR: Error creating view V_DT_DV_MuaVe_TraLai on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `V_DT_DV_MuaVe_TraLai` AS SELECT T.ID, T.DVNhapTraLaiBanSiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.DVBanSiID, A.LyDo, T.VatTuID, T.SoLuong, T.ThanhTien AS TienHangVatTu, ROUND(A.TyLeCK * - (0.01 * T.ThanhTien), 0) AS TienHangVatTuTG, ROUND(T.ThanhTien - A.TyLeCK * 0.01 * T.ThanhTien, 0) AS ThanhTienVatTu, T.TienVon, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 
         190, 194, 205, 206) THEN 'Khong' WHEN l.vattuloaiid IN (183) THEN 'Mu' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, 
         CASE WHEN khohangnhapid = 1 THEN 725 WHEN khohangnhapid = 5 THEN 726 WHEN khohangnhapid = 9 THEN 727 WHEN khohangnhapid = 13 THEN 728 WHEN khohangnhapid = 17 THEN 729 WHEN khohangnhapid = 21 THEN 730 ELSE NULL END AS KyThuatVien, KhachHangNhom.MaKhachHangNhom
FROM  KhachHangNhom INNER JOIN
         KhachHang ON KhachHangNhom.ID = KhachHang.KhachHangNhomID INNER JOIN
         DVBanSi ON KhachHang.ID = DVBanSi.KhachHangID INNER JOIN
         VatTuLoai AS N INNER JOIN
         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
         DVNhapTraLaiBanSi AS A INNER JOIN
         DVNhapTraLaiBanSiChiTiet AS T ON A.ID = T.DVNhapTraLaiBanSiID ON L.ID = T.VatTuID ON DVBanSi.ID = A.DVBanSiID)  
[2024-07-18 10:36:15] local.ERROR: Error creating view V_DT_DV_MuaVe on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `V_DT_DV_MuaVe` AS SELECT B.ID, B.DVBanSiID, A.SoCT, A.NgayCT, A.SoHD, A.NgayHD, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, B.SoLuong, N.VatTuNhomID, L.VatTuLoaiID, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206) THEN 'Khong' WHEN l.vattuloaiid IN (183) THEN 'Mu' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) 
         THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (203, 202, 201, 192, 193) THEN 'PTHN' WHEN l.vattuloaiid = 207 THEN 'Khoa' ELSE NULL END AS ChiTieu, 
         (CASE WHEN A.KhoHangXuatID = 1 THEN 725 WHEN A.KhoHangXuatID = 5 THEN 726 WHEN A.KhoHangXuatID = 9 THEN 727 WHEN A.KhoHangXuatID = 13 THEN 728 WHEN A.KhoHangXuatID = 17 THEN 729 WHEN A.KhoHangXuatID = 21 THEN 730 ELSE NULL END) AS KyThuatVien, B.ThanhTien AS TienHang, ROUND(A.TyLeCK * - (0.01 * B.ThanhTien * 0.001), 0) * 1000 AS TienHangTG, 
         ROUND((B.ThanhTien - A.TyLeCK * 0.01 * B.ThanhTien) * 0.001, 0) * 1000 AS ThanhTienVatTu, B.TienVon, KhachHangNhom.MaKhachHangNhom
FROM  DVBanSi AS A INNER JOIN
         DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
         VatTuLoai AS N ON L.VatTuLoaiID = N.ID INNER JOIN
         KhachHang ON A.KhachHangID = KhachHang.ID INNER JOIN
         KhachHangNhom ON KhachHang.KhachHangNhomID = KhachHangNhom.ID)  
[2024-07-18 10:36:15] local.ERROR: Error creating view L_VatTu_XuatKMDV on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatKMDV` AS SELECT   KM.DVBanLeID, BL.KhoHangXuatID, KM.NgayXuat, KM.SoLuong, KM.TienVon, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
                         THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) 
                         THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, KM.VatTuID
FROM         VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
                         DVBanLe AS BL INNER JOIN
                         DVBanLeKhuyenMai AS KM ON BL.ID = KM.DVBanLeID ON L.ID = KM.VatTuID)  
[2024-07-18 10:36:15] local.ERROR: Error creating view L_VatTu_XuatKMBH on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatKMBH` AS SELECT        KM.XeBanLeID, BL.KhoHangXuatID, KM.NgayXuat, KM.VatTuID, KM.SoLuong, KM.TienVon, KM.ThanhTien, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
                         THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) 
                         THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, BL.XeID, BL.TuVanID
FROM            VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
                         XeBanLeKhuyenMai AS KM INNER JOIN
                         XeBanLe AS BL ON KM.XeBanLeID = BL.ID ON L.ID = KM.VatTuID
WHERE        (NOT (KM.NgayXuat IS NULL)))  
[2024-07-18 10:36:15] local.ERROR: Error creating view L_VatTu_XuatKhac on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatKhac` AS SELECT   B.ID, B.DVXuatKhacID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.LyDoID, LD.TenLyDo, A.GhiChu, B.VatTuID, B.SoLuong, B.TienVon, CASE WHEN n.vattunhomid IN (1, 5) 
                         THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) 
                         THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL 
                         END AS ChiTieu
FROM         DVXuatKhac AS A INNER JOIN
                         DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
                         DVXuatKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
                         VatTuLoai AS N ON L.VatTuLoaiID = N.ID)  
[2024-07-18 10:36:15] local.ERROR: Error creating view L_VatTu_XuatDoiDonVi on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatDoiDonVi` AS SELECT   A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID AS VatTuXuatID, A.SoLuong AS TongSoLuongXuat, A.ThanhTien AS TongThanhTienXuat, CASE WHEN n.vattunhomid IN (1, 5) 
                         THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) 
                         THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL 
                         END AS ChiTieu
FROM         DoiDonVi AS A INNER JOIN
                         VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID ON A.VatTuID = L.ID)  
[2024-07-18 10:36:16] local.ERROR: Error creating view L_VatTu_XuatChuyen on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatChuyen` AS SELECT B.ID, B.XeNoiBoID AS NoiBoID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhoHangNhapID, PK.VatTuID, PK.SoLuong, PK.TienVon AS ThanhTienVonVatTu, 'PK' AS ChiTieu
FROM   XeNoiBoPhuKien AS PK INNER JOIN
             XeNoiBoChiTiet AS B ON PK.XeNoiBoChiTietID = B.ID INNER JOIN
             XeNoiBo AS A ON B.XeNoiBoID = A.ID
WHERE (A.IsXacNhan = 1)
UNION ALL
SELECT B.ID, B.DVNoiBoID AS NoiBoID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhoHangNhapID, B.VatTuID, B.SoLuong, B.ThanhTien AS ThanhTienVonVatTu, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
             THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) 
             THEN 'BD' ELSE NULL END AS ChiTieu
FROM   VatTuLoai AS N INNER JOIN
             VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
             DVNoiBo AS A INNER JOIN
             DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON L.ID = B.VatTuID
WHERE (A.IsXacNhan = 1))  
[2024-07-18 10:36:16] local.ERROR: Error creating view L_VatTu_XuatBanDV_All on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'b.ismuave' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatBanDV_All` AS SELECT   B.ID, B.DVBanLeID, A.SoCT, A.NgayCT, L.VatTuNhomID, V.VatTuLoaiID, A.KhoHangXuatID, B.NgayXuat, B.VatTuID, B.SoLuong, B.DonGia, B.DonGiaTG, 
                         B.DonGia * B.SoLuong AS TienHang, IFNULL(B.DonGiaTG, 0) * B.SoLuong AS TienHangTG, B.ThanhTien AS ThanhTienVatTu, B.TienVon, B.IsMuaVe, B.BaoHanhID, B.MaBCKT, B.MaKNBH,
                          B.TinhTrangBaoHanh, B.NgayHVNThanhToan, B.TienHVNThanhToan, B.GhiChuBaoHanh, CASE WHEN V.vattuloaiid IN (181, 187, 191) OR
                         b.ismuave = 1 THEN k.kythuatvienid ELSE a.kythuatvien END AS KyThuatVien, L.ChiTieu
FROM         DVBanLe AS A INNER JOIN
                         DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE     (B.SoLuong <> 0))  
[2024-07-18 10:36:16] local.ERROR: Error creating view L_VatTu_XuatBanDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_VatTu_XuatBanDV_All' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV` AS SELECT   ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, TienVon, 
                         IsMuaVe, BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM         L_VatTu_XuatBanDV_All
WHERE     (BaoHanhID = 0) AND (KyThuatVien IS NOT NULL) AND (NgayXuat IS NOT NULL))  
[2024-07-18 10:36:16] local.ERROR: Error creating view L_VatTu_XuatBanDV_Master2 on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_VatTu_XuatBanDV' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_Master2` AS SELECT ID, DVBanLeID, KhoHangXuatID, NgayXuat, VatTuID, KyThuatVien, TienVon, ChiTieu
FROM   L_VatTu_XuatBanDV)  
[2024-07-18 10:36:16] local.ERROR: Error creating view L_VatTu_XuatBanDV_Master1 on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_VatTu_XuatBanDV' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_Master1` AS SELECT   ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, IsMuaVe, 
                         BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM         L_VatTu_XuatBanDV)  
[2024-07-18 10:36:17] local.ERROR: Error creating view L_VatTu_BaoHanh on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_VatTu_XuatBanDV_All' doesn't exist (SQL: CREATE VIEW `L_VatTu_BaoHanh` AS SELECT        ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, TienVon, IsMuaVe, BaoHanhID, MaBCKT, 
                         MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM            L_VatTu_XuatBanDV_All
WHERE        (BaoHanhID <> 0))  
[2024-07-18 10:36:17] local.ERROR: Error creating view B_DV_VatTu_XuatBanCH_All on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'k.kythuatvienid' in 'field list' (SQL: CREATE VIEW `B_DV_VatTu_XuatBanCH_All` AS SELECT        B.ID, B.DVBanLeID, A.SoCT, A.NgayCT, B.NgayXuat, A.KhoHangXuatID, B.VatTuID, A.KyThuatVien, CASE WHEN V.vattuloaiid IN (181, 187, 191) OR
                         B.Ismuave = 1 THEN k.kythuatvienid ELSE a.kythuatvien END AS NVTinhThuong, CASE WHEN B.ngayxuat >= '2021-01-22' THEN A.kiemtracuoi WHEN (B.ngayxuat < '2021-01-22' AND A.nguoimoinano IS NULL) 
                         THEN A.kiemtracuoi ELSE A.nguoimoinano END AS KiemTraCuoi, L.ChiTieu, A.XeSuaChuaID, A.KhachHangID, CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, S.SoKhung, S.SoMay, S.BienSo, 
                         'XuatBanCH' AS NghiepVu, B.SoLuong AS SL, IFNULL(B.DonGiaTG, 0) * B.SoLuong AS TG, B.ThanhTien AS DT, B.TienVon AS GV, B.IsMuaVe, B.BaoHanhID, B.MaBCKT, B.MaKNBH, B.TinhTrangBaoHanh, B.NgayHVNThanhToan, 
                         B.TienHVNThanhToan, B.GhiChuBaoHanh, CASE WHEN B.TuVanID IS NOT NULL THEN B.TuVanID ELSE CASE WHEN V.IsTinhThuong = 0 THEN A.KiemTraCuoi ELSE NULL END END AS TuVanID
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID INNER JOIN
                         XeSuaChua AS S ON A.XeSuaChuaID = S.ID
WHERE        (B.SoLuong <> 0))  
[2024-07-18 10:36:17] local.ERROR: Error creating view A_DV_VatTu_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_DV_VatTu_XuatBanCH_All' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_XuatBanCH` AS SELECT        ID, DVBanLeID, SoCT, NgayCT, NgayXuat, KhoHangXuatID, VatTuID, KyThuatVien, NVTinhThuong, TuVanID, NghiepVu, ChiTieu, XeSuaChuaID, KhachHangID, XeID, SoKhung, SoMay, BienSo, SL, TG, DT, GV, IsMuaVe, 
                         BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh
FROM            B_DV_VatTu_XuatBanCH_All
WHERE        (NgayXuat >= '2019-12-19') AND (KyThuatVien IS NOT NULL) AND (TuVanID IS NOT NULL))  
[2024-07-18 10:36:17] local.ERROR: Error creating view A_DV_VatTu_XuatChuyenKhacDDV on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'a.ngayct' in 'where clause' (SQL: CREATE VIEW `A_DV_VatTu_XuatChuyenKhacDDV` AS SELECT        B.ID, B.DVNoiBoID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, 'XuatChuyen' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            KhoHang AS K INNER JOIN
                         DVNoiBo AS A INNER JOIN
                         DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON K.ID = A.KhoHangXuatID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.IsXacNhan = 1) AND (K.KhoHangLoaiID = 2) AND (B.SoLuong <> 0) AND a.ngayct >= '2019-12-19'
UNION ALL
SELECT        A.ID, A.ID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, 'XuatDoiDonVi' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, A.SoLuong AS SL, A.ThanhTien AS GV
FROM            DoiDonVi AS A INNER JOIN
                         VatTu AS V ON A.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.NgayCT >= '2019-12-19')
UNION ALL
SELECT        B.ID, B.DVXuatKhacID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, 'XuatKhac' AS NghiepVu, L.ChiTieu, LD.TenLyDo, B.SoLuong AS SL, B.TienVon AS GV
FROM            DVXuatKhac AS A INNER JOIN
                         DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
                         DVXuatKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        (B.SoLuong <> 0) AND (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2))  
[2024-07-18 10:36:17] local.ERROR: Error creating view A_DV_VatTu_XuatBanMVSi on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'a.ngayct' in 'where clause' (SQL: CREATE VIEW `A_DV_VatTu_XuatBanMVSi` AS SELECT        B.ID, B.DVBanSiID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, 3580 as XeID, B.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'XuatBanMV' AS NghiepVu, B.SoLuong AS SL, B.TyLeCK, B.ThanhTien AS DT, 
                         B.TienVon AS GV
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2)
UNION ALL
SELECT        B.ID, B.DVBanBuonID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, 3580 as XeID, B.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'XuatBanSi' AS NghiepVu, B.SoLuong AS SL, IFNULL(B.HeSo, 0) AS TyLeCK, 
                         B.ThanhTien AS DT, B.TienVon AS GV
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonVatTu AS B ON A.ID = B.DVBanBuonID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        a.ngayct >= '2019-12-19')  
[2024-07-18 10:36:17] local.ERROR: Error creating view A_DV_VatTu_NhapTraMVSi on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'a.ngayct' in 'where clause' (SQL: CREATE VIEW `A_DV_VatTu_NhapTraMVSi` AS SELECT        T .ID, A.DVBanSiID AS PhieuBanID, T .DVNhapTraLaiBanSiID AS PhieuTraLaiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, S.KhachHangID,3580 as XeID, T .VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'NhapTraMV' AS NghiepVu, 
                         A.LyDo, T .SoLuong AS SL, T .ThanhTien AS DT, SVT.TienVon AS GV
FROM            VatTuLoai AS L INNER JOIN
                         VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
                         DVNhapTraLaiBanSi AS A INNER JOIN
                         DVNhapTraLaiBanSiChiTiet AS T ON A.ID = T .DVNhapTraLaiBanSiID ON V.ID = T .VatTuID INNER JOIN
                         DVBanSi AS S ON A.DVBanSiID = S.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID INNER JOIN
                         DVBanSiVatTu AS SVT ON T .VatTuID = SVT.VatTuID AND T .DVBanSiID = SVT.DVBanSiID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2)
UNION ALL
SELECT        TL.ID, A.DVBanBuonID AS PhieuBanID, TL.DVNhapTraLaiBanBuonID AS PhieuTraLaiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, BS.KhachHangID,3580 as XeID, TL.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 
                         'NhapTraSi' AS NghiepVu, A.LyDo, TL.SoLuong AS SL, TL.ThanhTien AS DT, BSVT.TienVon AS GV
FROM            DVNhapTraLaiBanBuon AS A INNER JOIN
                         DVBanBuon AS BS ON A.DVBanBuonID = BS.ID INNER JOIN
                         DVNhapTraLaiBanBuonChiTiet AS TL ON A.ID = TL.DVNhapTraLaiBanBuonID INNER JOIN
                         VatTuLoai AS L INNER JOIN
                         VatTu AS V ON L.ID = V.VatTuLoaiID ON TL.VatTuID = V.ID INNER JOIN
                         DVBanBuonVatTu AS BSVT ON TL.DVBanBuonID = BSVT.DVBanBuonID AND TL.VatTuID = BSVT.VatTuID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID
WHERE        a.ngayct >= '2019-12-19')  
[2024-07-18 10:36:18] local.ERROR: Error creating view A_DV_VatTu_NhapChuyenKhacDDV on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'a.ngayct' in 'where clause' (SQL: CREATE VIEW `A_DV_VatTu_NhapChuyenKhacDDV` AS SELECT        B.ID, B.DVNoiBoID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, 'NhapChuyen' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            KhoHang AS K INNER JOIN
                         DVNoiBo AS A INNER JOIN
                         DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON K.ID = A.KhoHangXuatID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.IsXacNhan = 1) AND (K.KhoHangLoaiID = 2) AND a.ngayct >= '2019-12-19'
UNION ALL
SELECT        B.ID, B.DoiDonViID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangID AS KhoHangNhapID, B.VatTuID, 'NhapDoiDonVi' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            DoiDonVi AS A INNER JOIN
                         DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        a.ngayct >= '2019-12-19'
UNION ALL
SELECT        B.ID, B.DVNhapKhacID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, 'NhapKhac' AS NghiepVu, L.ChiTieu, LD.TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            DVNhapKhac AS A INNER JOIN
                         DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID INNER JOIN
                         DVNhapKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2))  
[2024-07-18 10:36:18] local.ERROR: Error creating view B_DV_Phieu_XuatBanCH_All on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'bl.ngayct' in 'field list' (SQL: CREATE VIEW `B_DV_Phieu_XuatBanCH_All` AS SELECT        BL.ID, BL.SoCT, BL.NgayCT, BL.CreatedAt, CAST(REPLACE(DATE_FORMAT(BL.CreatedAt, '%H:%i'), ':', '') AS SIGNED) AS GioTaoPhieu, BL.ThoiGianTraXeThucTe, BL.KhoHangXuatID, BL.KhachHangID, 'XuatBanCH' AS NghiepVu, 
                         S.SoKhung, S.SoMay, S.BienSo, BL.NgayMua, S.TenModel, BL.Km, BL.KyThuatVien, CASE WHEN bl.ngayct < '2021-01-22' AND bl.nguoimoinano IS NOT NULL THEN bl.nguoimoinano ELSE bl.kiemtracuoi END AS KiemTraCuoi, 
                         BL.KiemTraDinhKy, BL.IsBaoDuongToanBo, CAST(BL.IsThayNhot AS SIGNED) AS IsNhot, CAST(BL.IsVeSinhKimPhun AS SIGNED) AS IsKP, CAST(BL.IsVeSinhBuongDot AS SIGNED) AS IsBD, BL.IsLamNano, BL.IsLapPhuKien, 
                         BL.IsLapKhoaChongChom, BL.IsMuaVe, CAST(BL.IsBaoHanhHVN AS SIGNED) AS IsBHHVN, CAST(BL.IsBaoHanhThienChi AS SIGNED) AS IsBHTC, CAST(BL.IsBaoHanhLuuDong AS SIGNED) AS IsSCLD, BL.TongThanhTien, 
                         BL.TongThanhTienTraLai, BL.KhaoSatDiem
FROM            DVBanLe AS BL LEFT OUTER JOIN
                         XeSuaChua AS S ON BL.XeSuaChuaID = S.ID)  
[2024-07-18 10:36:18] local.ERROR: Error creating view A_DV_GC_XuatBanCH on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'bl.kythuatvien' in 'field list' (SQL: CREATE VIEW `A_DV_GC_XuatBanCH` AS SELECT        GC.ID, GC.DVBanLeID, BL.SoCT, BL.NgayCT, GC.NgayGC, BL.KhoHangXuatID, GC.KhachHangID AS DoiTacGC, CASE WHEN GC.GiaCongBy IS NULL THEN bl.kythuatvien ELSE gc.giacongby END AS NhanVienGC, 
                         CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, S.Model2, 'XuatBanCH' AS NghiepVu, 'GC' AS ChiTieu, GC.GiaCongID, GC.GiaBan AS DT, GC.ChiPhi AS GV
FROM            DVBanLe AS BL INNER JOIN
                         DVBanLeGiaCong AS GC ON BL.ID = GC.DVBanLeID INNER JOIN
                         XeSuaChua AS S ON BL.XeSuaChuaID = S.ID
WHERE        (BL.KyThuatVien IS NOT NULL))  
[2024-07-18 10:36:18] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_DV_Phieu_XuatBanCH_All' doesn't exist (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS 
                    SELECT NgayCT, KhoHangXuatID, 'kiemtradinhky' AS LoaiPhieu, kiemtradinhky AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND kiemtradinhky <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsNhot' AS LoaiPhieu, IsNhot AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsNhot <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsKP' AS LoaiPhieu, IsKP AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsKP <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBD' AS LoaiPhieu, IsBD AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBD <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBHHVN' AS LoaiPhieu, IsBHHVN AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBHHVN <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBHTC' AS LoaiPhieu, IsBHTC AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBHTC <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsSCLD' AS LoaiPhieu, IsSCLD AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsSCLD <> 0
                )  
[2024-07-18 10:36:19] local.ERROR: Error creating view A_DV_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_DV_Phieu_LoaiPhieu' doesn't exist (SQL: CREATE VIEW `A_DV_LoaiPhieu` AS SELECT    NgayCT, KhoHangXuatID, REPLACE(LoaiPhieu, 'KiemTraDinhKy', 'IsKTDK') AS LoaiPhieu, COUNT(SL) AS SL
FROM         B_DV_Phieu_LoaiPhieu
GROUP BY NgayCT, KhoHangXuatID, LoaiPhieu
ORDER BY NgayCT)  
[2024-07-18 10:36:19] local.ERROR: Error creating view A_DV_Phieu_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_DV_Phieu_XuatBanCH_All' doesn't exist (SQL: CREATE VIEW `A_DV_Phieu_XuatBanCH` AS SELECT        ID, SoCT, NgayCT, CreatedAt, GioTaoPhieu, ThoiGianTraXeThucTe, KhoHangXuatID, KhachHangID, NghiepVu, SoKhung, SoMay, BienSo, NgayMua, TenModel, Km, KyThuatVien, KiemTraCuoi, KiemTraDinhKy, IsNhot, 
                         TongThanhTien, TongThanhTienTraLai, KhaoSatDiem
FROM            B_DV_Phieu_XuatBanCH_All
WHERE        (KyThuatVien IS NOT NULL) AND (KiemTraCuoi IS NOT NULL))  
[2024-07-18 10:36:20] local.ERROR: Error creating view L_NanoDV_XuatBanLe_Moi on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'b.ngayxuat' in 'field list' (SQL: CREATE VIEW `L_NanoDV_XuatBanLe_Moi` AS SELECT        B.ID, A.ID AS IDPhieu, A.SoCT, B.NgayXuat, L.VatTuLoaiID, B.ThanhTien, A.KhoHangXuatID, B.SoLuong, CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, 
                         CASE WHEN b.ngayxuat < '2021-01-22' THEN a.nguoimoinano ELSE a.kiemtracuoi END AS KiemTraCuoi
FROM            DVBanLeVatTu AS B INNER JOIN
                         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
                         DVBanLe AS A ON B.DVBanLeID = A.ID INNER JOIN
                         XeSuaChua AS S ON A.XeSuaChuaID = S.ID
WHERE        (L.VatTuLoaiID = 201) AND (A.NguoiMoiNano IS NOT NULL) AND (B.ThanhTien > 0) AND (B.NgayXuat < '2021-01-22') OR
                         (L.VatTuLoaiID = 201) AND (B.ThanhTien > 0) AND (A.KiemTraCuoi IS NOT NULL) AND (B.NgayXuat >= '2021-01-22'))  
[2024-07-18 10:36:20] local.ERROR: Error creating view L_NhanVienKhoHang on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'nv.chucvuid' in 'field list' (SQL: CREATE VIEW `L_NhanVienKhoHang` AS SELECT   ID AS NhanVienID, CASE WHEN nv.chucvuid IN (1, 2, 5) THEN 26 WHEN nv.chucvuid IN (9) THEN 36 WHEN nv.chucvuid IN (4, 7, 8, 24, 34, 37, 38, 39) THEN 28 WHEN nv.chucvuid IN (6, 10, 12, 13, 
                         16, 36, 43) AND nv.cuahangid = 1 THEN 2 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 2 THEN 6 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 3 THEN 10 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 4 THEN 14 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 5 THEN 18 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 6 THEN 22 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 1 THEN 1 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 2 THEN 5 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 3 THEN 9 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 4 THEN 13 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 5 THEN 17 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 6 THEN 21 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND
                          nv.cuahangid = 12 THEN 37 ELSE NULL END AS KhoHangID
FROM         NhanVien AS NV)  
[2024-07-18 10:36:20] local.ERROR: Error creating view L_NhanVien on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_NhanVienKhoHang' doesn't exist (SQL: CREATE VIEW `L_NhanVien` AS SELECT    NV.ID, NV.HoTen, CV.TenChucVu, L_NhanVienKhoHang.KhoHangID, KhoHang.TenKhoHang, NV.CuaHangID, CH.TenCuaHang, NV.IDQT, NV.IsActive
FROM         KhoHang INNER JOIN
                         L_NhanVienKhoHang ON KhoHang.ID = L_NhanVienKhoHang.KhoHangID INNER JOIN
                         CuaHang AS CH ON KhoHang.CuaHangID = CH.ID INNER JOIN
                         NhanVien AS NV INNER JOIN
                         ChucVu AS CV ON NV.ChucVuID = CV.ID ON L_NhanVienKhoHang.NhanVienID = NV.ID)  
[2024-07-18 10:36:21] local.ERROR: Error creating view B_NhanVienKhoHang on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'nv.chucvuid' in 'field list' (SQL: CREATE VIEW `B_NhanVienKhoHang` AS SELECT       ID AS NhanVienID, CASE WHEN nv.chucvuid IN (1, 2, 5) THEN 26 WHEN nv.chucvuid IN (9) THEN 36 WHEN nv.chucvuid IN (4, 7, 8, 24, 34, 37, 38, 39) THEN 28 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 1 THEN 2 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 2 THEN 6 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 3 THEN 10 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) 
                         AND nv.cuahangid = 4 THEN 14 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 5 THEN 18 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 6 THEN 22 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 
                         43) AND nv.cuahangid = 13 THEN 38 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 1 THEN 1 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 2 THEN 5 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 3 THEN 9 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 4 THEN 13 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 5 THEN 17 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 6 THEN 21 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 12 THEN 37 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 13 THEN 39 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 12 THEN 40 ELSE NULL END AS KhoHangID
FROM            NhanVien AS NV)  
[2024-07-18 10:36:21] local.ERROR: Error creating view 0_NhanVien on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_NhanVienKhoHang' doesn't exist (SQL: CREATE VIEW `0_NhanVien` AS SELECT         NV.ID, NV.HoTen, CV.TenChucVu, B_NhanVienKhoHang.KhoHangID, KhoHang.TenKhoHang, NV.CuaHangID, CH.TenCuaHang, NV.IDQT, NV.IsActive
FROM            KhoHang INNER JOIN
                         B_NhanVienKhoHang ON KhoHang.ID = B_NhanVienKhoHang.KhoHangID INNER JOIN
                         CuaHang AS CH ON KhoHang.CuaHangID = CH.ID INNER JOIN
                         NhanVien AS NV INNER JOIN
                         ChucVu AS CV ON NV.ChucVuID = CV.ID ON B_NhanVienKhoHang.NhanVienID = NV.ID)  
[2024-07-18 10:36:21] local.ERROR: Error creating view V_DT_DV_MuaVe_TraLai on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `V_DT_DV_MuaVe_TraLai` AS SELECT T.ID, T.DVNhapTraLaiBanSiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.DVBanSiID, A.LyDo, T.VatTuID, T.SoLuong, T.ThanhTien AS TienHangVatTu, ROUND(A.TyLeCK * - (0.01 * T.ThanhTien), 0) AS TienHangVatTuTG, ROUND(T.ThanhTien - A.TyLeCK * 0.01 * T.ThanhTien, 0) AS ThanhTienVatTu, T.TienVon, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 
         190, 194, 205, 206) THEN 'Khong' WHEN l.vattuloaiid IN (183) THEN 'Mu' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, 
         CASE WHEN khohangnhapid = 1 THEN 725 WHEN khohangnhapid = 5 THEN 726 WHEN khohangnhapid = 9 THEN 727 WHEN khohangnhapid = 13 THEN 728 WHEN khohangnhapid = 17 THEN 729 WHEN khohangnhapid = 21 THEN 730 ELSE NULL END AS KyThuatVien, KhachHangNhom.MaKhachHangNhom
FROM  KhachHangNhom INNER JOIN
         KhachHang ON KhachHangNhom.ID = KhachHang.KhachHangNhomID INNER JOIN
         DVBanSi ON KhachHang.ID = DVBanSi.KhachHangID INNER JOIN
         VatTuLoai AS N INNER JOIN
         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
         DVNhapTraLaiBanSi AS A INNER JOIN
         DVNhapTraLaiBanSiChiTiet AS T ON A.ID = T.DVNhapTraLaiBanSiID ON L.ID = T.VatTuID ON DVBanSi.ID = A.DVBanSiID)  
[2024-07-18 10:36:21] local.ERROR: Error creating view V_DT_DV_MuaVe on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `V_DT_DV_MuaVe` AS SELECT B.ID, B.DVBanSiID, A.SoCT, A.NgayCT, A.SoHD, A.NgayHD, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, B.SoLuong, N.VatTuNhomID, L.VatTuLoaiID, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206) THEN 'Khong' WHEN l.vattuloaiid IN (183) THEN 'Mu' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) 
         THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (203, 202, 201, 192, 193) THEN 'PTHN' WHEN l.vattuloaiid = 207 THEN 'Khoa' ELSE NULL END AS ChiTieu, 
         (CASE WHEN A.KhoHangXuatID = 1 THEN 725 WHEN A.KhoHangXuatID = 5 THEN 726 WHEN A.KhoHangXuatID = 9 THEN 727 WHEN A.KhoHangXuatID = 13 THEN 728 WHEN A.KhoHangXuatID = 17 THEN 729 WHEN A.KhoHangXuatID = 21 THEN 730 ELSE NULL END) AS KyThuatVien, B.ThanhTien AS TienHang, ROUND(A.TyLeCK * - (0.01 * B.ThanhTien * 0.001), 0) * 1000 AS TienHangTG, 
         ROUND((B.ThanhTien - A.TyLeCK * 0.01 * B.ThanhTien) * 0.001, 0) * 1000 AS ThanhTienVatTu, B.TienVon, KhachHangNhom.MaKhachHangNhom
FROM  DVBanSi AS A INNER JOIN
         DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
         VatTuLoai AS N ON L.VatTuLoaiID = N.ID INNER JOIN
         KhachHang ON A.KhachHangID = KhachHang.ID INNER JOIN
         KhachHangNhom ON KhachHang.KhachHangNhomID = KhachHangNhom.ID)  
[2024-07-18 10:36:22] local.ERROR: Error creating view L_VatTu_XuatKMDV on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatKMDV` AS SELECT   KM.DVBanLeID, BL.KhoHangXuatID, KM.NgayXuat, KM.SoLuong, KM.TienVon, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
                         THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) 
                         THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, KM.VatTuID
FROM         VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
                         DVBanLe AS BL INNER JOIN
                         DVBanLeKhuyenMai AS KM ON BL.ID = KM.DVBanLeID ON L.ID = KM.VatTuID)  
[2024-07-18 10:36:22] local.ERROR: Error creating view L_VatTu_XuatKMBH on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatKMBH` AS SELECT        KM.XeBanLeID, BL.KhoHangXuatID, KM.NgayXuat, KM.VatTuID, KM.SoLuong, KM.TienVon, KM.ThanhTien, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
                         THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) 
                         THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, BL.XeID, BL.TuVanID
FROM            VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
                         XeBanLeKhuyenMai AS KM INNER JOIN
                         XeBanLe AS BL ON KM.XeBanLeID = BL.ID ON L.ID = KM.VatTuID
WHERE        (NOT (KM.NgayXuat IS NULL)))  
[2024-07-18 10:36:22] local.ERROR: Error creating view L_VatTu_XuatKhac on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatKhac` AS SELECT   B.ID, B.DVXuatKhacID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.LyDoID, LD.TenLyDo, A.GhiChu, B.VatTuID, B.SoLuong, B.TienVon, CASE WHEN n.vattunhomid IN (1, 5) 
                         THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) 
                         THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL 
                         END AS ChiTieu
FROM         DVXuatKhac AS A INNER JOIN
                         DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
                         DVXuatKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
                         VatTuLoai AS N ON L.VatTuLoaiID = N.ID)  
[2024-07-18 10:36:23] local.ERROR: Error creating view L_VatTu_XuatDoiDonVi on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatDoiDonVi` AS SELECT   A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID AS VatTuXuatID, A.SoLuong AS TongSoLuongXuat, A.ThanhTien AS TongThanhTienXuat, CASE WHEN n.vattunhomid IN (1, 5) 
                         THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) 
                         THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL 
                         END AS ChiTieu
FROM         DoiDonVi AS A INNER JOIN
                         VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID ON A.VatTuID = L.ID)  
[2024-07-18 10:36:23] local.ERROR: Error creating view L_VatTu_XuatChuyen on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatChuyen` AS SELECT B.ID, B.XeNoiBoID AS NoiBoID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhoHangNhapID, PK.VatTuID, PK.SoLuong, PK.TienVon AS ThanhTienVonVatTu, 'PK' AS ChiTieu
FROM   XeNoiBoPhuKien AS PK INNER JOIN
             XeNoiBoChiTiet AS B ON PK.XeNoiBoChiTietID = B.ID INNER JOIN
             XeNoiBo AS A ON B.XeNoiBoID = A.ID
WHERE (A.IsXacNhan = 1)
UNION ALL
SELECT B.ID, B.DVNoiBoID AS NoiBoID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhoHangNhapID, B.VatTuID, B.SoLuong, B.ThanhTien AS ThanhTienVonVatTu, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
             THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) 
             THEN 'BD' ELSE NULL END AS ChiTieu
FROM   VatTuLoai AS N INNER JOIN
             VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
             DVNoiBo AS A INNER JOIN
             DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON L.ID = B.VatTuID
WHERE (A.IsXacNhan = 1))  
[2024-07-18 10:36:23] local.ERROR: Error creating view L_VatTu_XuatBanDV_All on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'b.ismuave' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatBanDV_All` AS SELECT   B.ID, B.DVBanLeID, A.SoCT, A.NgayCT, L.VatTuNhomID, V.VatTuLoaiID, A.KhoHangXuatID, B.NgayXuat, B.VatTuID, B.SoLuong, B.DonGia, B.DonGiaTG, 
                         B.DonGia * B.SoLuong AS TienHang, IFNULL(B.DonGiaTG, 0) * B.SoLuong AS TienHangTG, B.ThanhTien AS ThanhTienVatTu, B.TienVon, B.IsMuaVe, B.BaoHanhID, B.MaBCKT, B.MaKNBH,
                          B.TinhTrangBaoHanh, B.NgayHVNThanhToan, B.TienHVNThanhToan, B.GhiChuBaoHanh, CASE WHEN V.vattuloaiid IN (181, 187, 191) OR
                         b.ismuave = 1 THEN k.kythuatvienid ELSE a.kythuatvien END AS KyThuatVien, L.ChiTieu
FROM         DVBanLe AS A INNER JOIN
                         DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE     (B.SoLuong <> 0))  
[2024-07-18 10:36:23] local.ERROR: Error creating view L_VatTu_XuatBanDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_VatTu_XuatBanDV_All' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV` AS SELECT   ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, TienVon, 
                         IsMuaVe, BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM         L_VatTu_XuatBanDV_All
WHERE     (BaoHanhID = 0) AND (KyThuatVien IS NOT NULL) AND (NgayXuat IS NOT NULL))  
[2024-07-18 10:36:23] local.ERROR: Error creating view L_VatTu_XuatBanDV_Master2 on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_VatTu_XuatBanDV' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_Master2` AS SELECT ID, DVBanLeID, KhoHangXuatID, NgayXuat, VatTuID, KyThuatVien, TienVon, ChiTieu
FROM   L_VatTu_XuatBanDV)  
[2024-07-18 10:36:23] local.ERROR: Error creating view L_VatTu_XuatBanDV_Master1 on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_VatTu_XuatBanDV' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_Master1` AS SELECT   ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, IsMuaVe, 
                         BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM         L_VatTu_XuatBanDV)  
[2024-07-18 10:36:24] local.ERROR: Error creating view L_VatTu_BaoHanh on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_VatTu_XuatBanDV_All' doesn't exist (SQL: CREATE VIEW `L_VatTu_BaoHanh` AS SELECT        ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, TienVon, IsMuaVe, BaoHanhID, MaBCKT, 
                         MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM            L_VatTu_XuatBanDV_All
WHERE        (BaoHanhID <> 0))  
[2024-07-18 10:36:24] local.ERROR: Error creating view B_DV_VatTu_XuatBanCH_All on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'k.kythuatvienid' in 'field list' (SQL: CREATE VIEW `B_DV_VatTu_XuatBanCH_All` AS SELECT        B.ID, B.DVBanLeID, A.SoCT, A.NgayCT, B.NgayXuat, A.KhoHangXuatID, B.VatTuID, A.KyThuatVien, CASE WHEN V.vattuloaiid IN (181, 187, 191) OR
                         B.Ismuave = 1 THEN k.kythuatvienid ELSE a.kythuatvien END AS NVTinhThuong, CASE WHEN B.ngayxuat >= '2021-01-22' THEN A.kiemtracuoi WHEN (B.ngayxuat < '2021-01-22' AND A.nguoimoinano IS NULL) 
                         THEN A.kiemtracuoi ELSE A.nguoimoinano END AS KiemTraCuoi, L.ChiTieu, A.XeSuaChuaID, A.KhachHangID, CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, S.SoKhung, S.SoMay, S.BienSo, 
                         'XuatBanCH' AS NghiepVu, B.SoLuong AS SL, IFNULL(B.DonGiaTG, 0) * B.SoLuong AS TG, B.ThanhTien AS DT, B.TienVon AS GV, B.IsMuaVe, B.BaoHanhID, B.MaBCKT, B.MaKNBH, B.TinhTrangBaoHanh, B.NgayHVNThanhToan, 
                         B.TienHVNThanhToan, B.GhiChuBaoHanh, CASE WHEN B.TuVanID IS NOT NULL THEN B.TuVanID ELSE CASE WHEN V.IsTinhThuong = 0 THEN A.KiemTraCuoi ELSE NULL END END AS TuVanID
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID INNER JOIN
                         XeSuaChua AS S ON A.XeSuaChuaID = S.ID
WHERE        (B.SoLuong <> 0))  
[2024-07-18 10:36:24] local.ERROR: Error creating view A_DV_VatTu_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_DV_VatTu_XuatBanCH_All' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_XuatBanCH` AS SELECT        ID, DVBanLeID, SoCT, NgayCT, NgayXuat, KhoHangXuatID, VatTuID, KyThuatVien, NVTinhThuong, TuVanID, NghiepVu, ChiTieu, XeSuaChuaID, KhachHangID, XeID, SoKhung, SoMay, BienSo, SL, TG, DT, GV, IsMuaVe, 
                         BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh
FROM            B_DV_VatTu_XuatBanCH_All
WHERE        (NgayXuat >= '2019-12-19') AND (KyThuatVien IS NOT NULL) AND (TuVanID IS NOT NULL))  
[2024-07-18 10:36:24] local.ERROR: Error creating view A_DV_VatTu_XuatChuyenKhacDDV on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'a.ngayct' in 'where clause' (SQL: CREATE VIEW `A_DV_VatTu_XuatChuyenKhacDDV` AS SELECT        B.ID, B.DVNoiBoID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, 'XuatChuyen' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            KhoHang AS K INNER JOIN
                         DVNoiBo AS A INNER JOIN
                         DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON K.ID = A.KhoHangXuatID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.IsXacNhan = 1) AND (K.KhoHangLoaiID = 2) AND (B.SoLuong <> 0) AND a.ngayct >= '2019-12-19'
UNION ALL
SELECT        A.ID, A.ID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, 'XuatDoiDonVi' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, A.SoLuong AS SL, A.ThanhTien AS GV
FROM            DoiDonVi AS A INNER JOIN
                         VatTu AS V ON A.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.NgayCT >= '2019-12-19')
UNION ALL
SELECT        B.ID, B.DVXuatKhacID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, 'XuatKhac' AS NghiepVu, L.ChiTieu, LD.TenLyDo, B.SoLuong AS SL, B.TienVon AS GV
FROM            DVXuatKhac AS A INNER JOIN
                         DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
                         DVXuatKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        (B.SoLuong <> 0) AND (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2))  
[2024-07-18 10:36:24] local.ERROR: Error creating view A_DV_VatTu_XuatBanMVSi on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'a.ngayct' in 'where clause' (SQL: CREATE VIEW `A_DV_VatTu_XuatBanMVSi` AS SELECT        B.ID, B.DVBanSiID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, 3580 as XeID, B.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'XuatBanMV' AS NghiepVu, B.SoLuong AS SL, B.TyLeCK, B.ThanhTien AS DT, 
                         B.TienVon AS GV
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2)
UNION ALL
SELECT        B.ID, B.DVBanBuonID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, 3580 as XeID, B.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'XuatBanSi' AS NghiepVu, B.SoLuong AS SL, IFNULL(B.HeSo, 0) AS TyLeCK, 
                         B.ThanhTien AS DT, B.TienVon AS GV
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonVatTu AS B ON A.ID = B.DVBanBuonID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        a.ngayct >= '2019-12-19')  
[2024-07-18 10:36:25] local.ERROR: Error creating view A_DV_VatTu_NhapTraMVSi on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'a.ngayct' in 'where clause' (SQL: CREATE VIEW `A_DV_VatTu_NhapTraMVSi` AS SELECT        T .ID, A.DVBanSiID AS PhieuBanID, T .DVNhapTraLaiBanSiID AS PhieuTraLaiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, S.KhachHangID,3580 as XeID, T .VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'NhapTraMV' AS NghiepVu, 
                         A.LyDo, T .SoLuong AS SL, T .ThanhTien AS DT, SVT.TienVon AS GV
FROM            VatTuLoai AS L INNER JOIN
                         VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
                         DVNhapTraLaiBanSi AS A INNER JOIN
                         DVNhapTraLaiBanSiChiTiet AS T ON A.ID = T .DVNhapTraLaiBanSiID ON V.ID = T .VatTuID INNER JOIN
                         DVBanSi AS S ON A.DVBanSiID = S.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID INNER JOIN
                         DVBanSiVatTu AS SVT ON T .VatTuID = SVT.VatTuID AND T .DVBanSiID = SVT.DVBanSiID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2)
UNION ALL
SELECT        TL.ID, A.DVBanBuonID AS PhieuBanID, TL.DVNhapTraLaiBanBuonID AS PhieuTraLaiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, BS.KhachHangID,3580 as XeID, TL.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 
                         'NhapTraSi' AS NghiepVu, A.LyDo, TL.SoLuong AS SL, TL.ThanhTien AS DT, BSVT.TienVon AS GV
FROM            DVNhapTraLaiBanBuon AS A INNER JOIN
                         DVBanBuon AS BS ON A.DVBanBuonID = BS.ID INNER JOIN
                         DVNhapTraLaiBanBuonChiTiet AS TL ON A.ID = TL.DVNhapTraLaiBanBuonID INNER JOIN
                         VatTuLoai AS L INNER JOIN
                         VatTu AS V ON L.ID = V.VatTuLoaiID ON TL.VatTuID = V.ID INNER JOIN
                         DVBanBuonVatTu AS BSVT ON TL.DVBanBuonID = BSVT.DVBanBuonID AND TL.VatTuID = BSVT.VatTuID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID
WHERE        a.ngayct >= '2019-12-19')  
[2024-07-18 10:36:25] local.ERROR: Error creating view A_DV_VatTu_NhapChuyenKhacDDV on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'a.ngayct' in 'where clause' (SQL: CREATE VIEW `A_DV_VatTu_NhapChuyenKhacDDV` AS SELECT        B.ID, B.DVNoiBoID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, 'NhapChuyen' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            KhoHang AS K INNER JOIN
                         DVNoiBo AS A INNER JOIN
                         DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON K.ID = A.KhoHangXuatID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.IsXacNhan = 1) AND (K.KhoHangLoaiID = 2) AND a.ngayct >= '2019-12-19'
UNION ALL
SELECT        B.ID, B.DoiDonViID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangID AS KhoHangNhapID, B.VatTuID, 'NhapDoiDonVi' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            DoiDonVi AS A INNER JOIN
                         DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        a.ngayct >= '2019-12-19'
UNION ALL
SELECT        B.ID, B.DVNhapKhacID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, 'NhapKhac' AS NghiepVu, L.ChiTieu, LD.TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            DVNhapKhac AS A INNER JOIN
                         DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID INNER JOIN
                         DVNhapKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2))  
[2024-07-18 10:36:25] local.ERROR: Error creating view B_DV_Phieu_XuatBanCH_All on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'bl.ngayct' in 'field list' (SQL: CREATE VIEW `B_DV_Phieu_XuatBanCH_All` AS SELECT        BL.ID, BL.SoCT, BL.NgayCT, BL.CreatedAt, CAST(REPLACE(DATE_FORMAT(BL.CreatedAt, '%H:%i'), ':', '') AS SIGNED) AS GioTaoPhieu, BL.ThoiGianTraXeThucTe, BL.KhoHangXuatID, BL.KhachHangID, 'XuatBanCH' AS NghiepVu, 
                         S.SoKhung, S.SoMay, S.BienSo, BL.NgayMua, S.TenModel, BL.Km, BL.KyThuatVien, CASE WHEN bl.ngayct < '2021-01-22' AND bl.nguoimoinano IS NOT NULL THEN bl.nguoimoinano ELSE bl.kiemtracuoi END AS KiemTraCuoi, 
                         BL.KiemTraDinhKy, BL.IsBaoDuongToanBo, CAST(BL.IsThayNhot AS SIGNED) AS IsNhot, CAST(BL.IsVeSinhKimPhun AS SIGNED) AS IsKP, CAST(BL.IsVeSinhBuongDot AS SIGNED) AS IsBD, BL.IsLamNano, BL.IsLapPhuKien, 
                         BL.IsLapKhoaChongChom, BL.IsMuaVe, CAST(BL.IsBaoHanhHVN AS SIGNED) AS IsBHHVN, CAST(BL.IsBaoHanhThienChi AS SIGNED) AS IsBHTC, CAST(BL.IsBaoHanhLuuDong AS SIGNED) AS IsSCLD, BL.TongThanhTien, 
                         BL.TongThanhTienTraLai, BL.KhaoSatDiem
FROM            DVBanLe AS BL LEFT OUTER JOIN
                         XeSuaChua AS S ON BL.XeSuaChuaID = S.ID)  
[2024-07-18 10:36:25] local.ERROR: Error creating view A_DV_GC_XuatBanCH on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'bl.kythuatvien' in 'field list' (SQL: CREATE VIEW `A_DV_GC_XuatBanCH` AS SELECT        GC.ID, GC.DVBanLeID, BL.SoCT, BL.NgayCT, GC.NgayGC, BL.KhoHangXuatID, GC.KhachHangID AS DoiTacGC, CASE WHEN GC.GiaCongBy IS NULL THEN bl.kythuatvien ELSE gc.giacongby END AS NhanVienGC, 
                         CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, S.Model2, 'XuatBanCH' AS NghiepVu, 'GC' AS ChiTieu, GC.GiaCongID, GC.GiaBan AS DT, GC.ChiPhi AS GV
FROM            DVBanLe AS BL INNER JOIN
                         DVBanLeGiaCong AS GC ON BL.ID = GC.DVBanLeID INNER JOIN
                         XeSuaChua AS S ON BL.XeSuaChuaID = S.ID
WHERE        (BL.KyThuatVien IS NOT NULL))  
[2024-07-18 10:36:25] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_DV_Phieu_XuatBanCH_All' doesn't exist (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS 
                    SELECT NgayCT, KhoHangXuatID, 'kiemtradinhky' AS LoaiPhieu, kiemtradinhky AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND kiemtradinhky <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsNhot' AS LoaiPhieu, IsNhot AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsNhot <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsKP' AS LoaiPhieu, IsKP AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsKP <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBD' AS LoaiPhieu, IsBD AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBD <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBHHVN' AS LoaiPhieu, IsBHHVN AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBHHVN <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBHTC' AS LoaiPhieu, IsBHTC AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBHTC <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsSCLD' AS LoaiPhieu, IsSCLD AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsSCLD <> 0
                )  
[2024-07-18 10:36:26] local.ERROR: Error creating view A_DV_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_DV_Phieu_LoaiPhieu' doesn't exist (SQL: CREATE VIEW `A_DV_LoaiPhieu` AS SELECT    NgayCT, KhoHangXuatID, REPLACE(LoaiPhieu, 'KiemTraDinhKy', 'IsKTDK') AS LoaiPhieu, COUNT(SL) AS SL
FROM         B_DV_Phieu_LoaiPhieu
GROUP BY NgayCT, KhoHangXuatID, LoaiPhieu
ORDER BY NgayCT)  
[2024-07-18 10:36:26] local.ERROR: Error creating view A_DV_Phieu_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_DV_Phieu_XuatBanCH_All' doesn't exist (SQL: CREATE VIEW `A_DV_Phieu_XuatBanCH` AS SELECT        ID, SoCT, NgayCT, CreatedAt, GioTaoPhieu, ThoiGianTraXeThucTe, KhoHangXuatID, KhachHangID, NghiepVu, SoKhung, SoMay, BienSo, NgayMua, TenModel, Km, KyThuatVien, KiemTraCuoi, KiemTraDinhKy, IsNhot, 
                         TongThanhTien, TongThanhTienTraLai, KhaoSatDiem
FROM            B_DV_Phieu_XuatBanCH_All
WHERE        (KyThuatVien IS NOT NULL) AND (KiemTraCuoi IS NOT NULL))  
[2024-07-18 10:36:26] local.ERROR: Error creating view L_NanoDV_XuatBanLe_Moi on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'b.ngayxuat' in 'field list' (SQL: CREATE VIEW `L_NanoDV_XuatBanLe_Moi` AS SELECT        B.ID, A.ID AS IDPhieu, A.SoCT, B.NgayXuat, L.VatTuLoaiID, B.ThanhTien, A.KhoHangXuatID, B.SoLuong, CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, 
                         CASE WHEN b.ngayxuat < '2021-01-22' THEN a.nguoimoinano ELSE a.kiemtracuoi END AS KiemTraCuoi
FROM            DVBanLeVatTu AS B INNER JOIN
                         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
                         DVBanLe AS A ON B.DVBanLeID = A.ID INNER JOIN
                         XeSuaChua AS S ON A.XeSuaChuaID = S.ID
WHERE        (L.VatTuLoaiID = 201) AND (A.NguoiMoiNano IS NOT NULL) AND (B.ThanhTien > 0) AND (B.NgayXuat < '2021-01-22') OR
                         (L.VatTuLoaiID = 201) AND (B.ThanhTien > 0) AND (A.KiemTraCuoi IS NOT NULL) AND (B.NgayXuat >= '2021-01-22'))  
[2024-07-18 10:36:27] local.ERROR: Error creating view L_NhanVienKhoHang on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'nv.chucvuid' in 'field list' (SQL: CREATE VIEW `L_NhanVienKhoHang` AS SELECT   ID AS NhanVienID, CASE WHEN nv.chucvuid IN (1, 2, 5) THEN 26 WHEN nv.chucvuid IN (9) THEN 36 WHEN nv.chucvuid IN (4, 7, 8, 24, 34, 37, 38, 39) THEN 28 WHEN nv.chucvuid IN (6, 10, 12, 13, 
                         16, 36, 43) AND nv.cuahangid = 1 THEN 2 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 2 THEN 6 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 3 THEN 10 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 4 THEN 14 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 5 THEN 18 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 6 THEN 22 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 1 THEN 1 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 2 THEN 5 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 3 THEN 9 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 4 THEN 13 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 5 THEN 17 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 6 THEN 21 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND
                          nv.cuahangid = 12 THEN 37 ELSE NULL END AS KhoHangID
FROM         NhanVien AS NV)  
[2024-07-18 10:36:27] local.ERROR: Error creating view L_NhanVien on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_NhanVienKhoHang' doesn't exist (SQL: CREATE VIEW `L_NhanVien` AS SELECT    NV.ID, NV.HoTen, CV.TenChucVu, L_NhanVienKhoHang.KhoHangID, KhoHang.TenKhoHang, NV.CuaHangID, CH.TenCuaHang, NV.IDQT, NV.IsActive
FROM         KhoHang INNER JOIN
                         L_NhanVienKhoHang ON KhoHang.ID = L_NhanVienKhoHang.KhoHangID INNER JOIN
                         CuaHang AS CH ON KhoHang.CuaHangID = CH.ID INNER JOIN
                         NhanVien AS NV INNER JOIN
                         ChucVu AS CV ON NV.ChucVuID = CV.ID ON L_NhanVienKhoHang.NhanVienID = NV.ID)  
[2024-07-18 10:36:27] local.ERROR: Error creating view B_NhanVienKhoHang on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'nv.chucvuid' in 'field list' (SQL: CREATE VIEW `B_NhanVienKhoHang` AS SELECT       ID AS NhanVienID, CASE WHEN nv.chucvuid IN (1, 2, 5) THEN 26 WHEN nv.chucvuid IN (9) THEN 36 WHEN nv.chucvuid IN (4, 7, 8, 24, 34, 37, 38, 39) THEN 28 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 1 THEN 2 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 2 THEN 6 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 3 THEN 10 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) 
                         AND nv.cuahangid = 4 THEN 14 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 5 THEN 18 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 6 THEN 22 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 
                         43) AND nv.cuahangid = 13 THEN 38 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 1 THEN 1 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 2 THEN 5 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 3 THEN 9 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 4 THEN 13 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 5 THEN 17 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 6 THEN 21 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 12 THEN 37 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 13 THEN 39 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 12 THEN 40 ELSE NULL END AS KhoHangID
FROM            NhanVien AS NV)  
[2024-07-18 10:36:27] local.ERROR: Error creating view 0_NhanVien on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_NhanVienKhoHang' doesn't exist (SQL: CREATE VIEW `0_NhanVien` AS SELECT         NV.ID, NV.HoTen, CV.TenChucVu, B_NhanVienKhoHang.KhoHangID, KhoHang.TenKhoHang, NV.CuaHangID, CH.TenCuaHang, NV.IDQT, NV.IsActive
FROM            KhoHang INNER JOIN
                         B_NhanVienKhoHang ON KhoHang.ID = B_NhanVienKhoHang.KhoHangID INNER JOIN
                         CuaHang AS CH ON KhoHang.CuaHangID = CH.ID INNER JOIN
                         NhanVien AS NV INNER JOIN
                         ChucVu AS CV ON NV.ChucVuID = CV.ID ON B_NhanVienKhoHang.NhanVienID = NV.ID)  
[2024-07-18 10:36:27] local.ERROR: Error creating view V_DT_DV_MuaVe_TraLai on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `V_DT_DV_MuaVe_TraLai` AS SELECT T.ID, T.DVNhapTraLaiBanSiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.DVBanSiID, A.LyDo, T.VatTuID, T.SoLuong, T.ThanhTien AS TienHangVatTu, ROUND(A.TyLeCK * - (0.01 * T.ThanhTien), 0) AS TienHangVatTuTG, ROUND(T.ThanhTien - A.TyLeCK * 0.01 * T.ThanhTien, 0) AS ThanhTienVatTu, T.TienVon, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 
         190, 194, 205, 206) THEN 'Khong' WHEN l.vattuloaiid IN (183) THEN 'Mu' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, 
         CASE WHEN khohangnhapid = 1 THEN 725 WHEN khohangnhapid = 5 THEN 726 WHEN khohangnhapid = 9 THEN 727 WHEN khohangnhapid = 13 THEN 728 WHEN khohangnhapid = 17 THEN 729 WHEN khohangnhapid = 21 THEN 730 ELSE NULL END AS KyThuatVien, KhachHangNhom.MaKhachHangNhom
FROM  KhachHangNhom INNER JOIN
         KhachHang ON KhachHangNhom.ID = KhachHang.KhachHangNhomID INNER JOIN
         DVBanSi ON KhachHang.ID = DVBanSi.KhachHangID INNER JOIN
         VatTuLoai AS N INNER JOIN
         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
         DVNhapTraLaiBanSi AS A INNER JOIN
         DVNhapTraLaiBanSiChiTiet AS T ON A.ID = T.DVNhapTraLaiBanSiID ON L.ID = T.VatTuID ON DVBanSi.ID = A.DVBanSiID)  
[2024-07-18 10:36:28] local.ERROR: Error creating view V_DT_DV_MuaVe on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `V_DT_DV_MuaVe` AS SELECT B.ID, B.DVBanSiID, A.SoCT, A.NgayCT, A.SoHD, A.NgayHD, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, B.SoLuong, N.VatTuNhomID, L.VatTuLoaiID, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206) THEN 'Khong' WHEN l.vattuloaiid IN (183) THEN 'Mu' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) 
         THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (203, 202, 201, 192, 193) THEN 'PTHN' WHEN l.vattuloaiid = 207 THEN 'Khoa' ELSE NULL END AS ChiTieu, 
         (CASE WHEN A.KhoHangXuatID = 1 THEN 725 WHEN A.KhoHangXuatID = 5 THEN 726 WHEN A.KhoHangXuatID = 9 THEN 727 WHEN A.KhoHangXuatID = 13 THEN 728 WHEN A.KhoHangXuatID = 17 THEN 729 WHEN A.KhoHangXuatID = 21 THEN 730 ELSE NULL END) AS KyThuatVien, B.ThanhTien AS TienHang, ROUND(A.TyLeCK * - (0.01 * B.ThanhTien * 0.001), 0) * 1000 AS TienHangTG, 
         ROUND((B.ThanhTien - A.TyLeCK * 0.01 * B.ThanhTien) * 0.001, 0) * 1000 AS ThanhTienVatTu, B.TienVon, KhachHangNhom.MaKhachHangNhom
FROM  DVBanSi AS A INNER JOIN
         DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
         VatTuLoai AS N ON L.VatTuLoaiID = N.ID INNER JOIN
         KhachHang ON A.KhachHangID = KhachHang.ID INNER JOIN
         KhachHangNhom ON KhachHang.KhachHangNhomID = KhachHangNhom.ID)  
[2024-07-18 10:36:28] local.ERROR: Error creating view L_VatTu_XuatKMDV on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatKMDV` AS SELECT   KM.DVBanLeID, BL.KhoHangXuatID, KM.NgayXuat, KM.SoLuong, KM.TienVon, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
                         THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) 
                         THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, KM.VatTuID
FROM         VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
                         DVBanLe AS BL INNER JOIN
                         DVBanLeKhuyenMai AS KM ON BL.ID = KM.DVBanLeID ON L.ID = KM.VatTuID)  
[2024-07-18 10:36:28] local.ERROR: Error creating view L_VatTu_XuatKMBH on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatKMBH` AS SELECT        KM.XeBanLeID, BL.KhoHangXuatID, KM.NgayXuat, KM.VatTuID, KM.SoLuong, KM.TienVon, KM.ThanhTien, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
                         THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) 
                         THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, BL.XeID, BL.TuVanID
FROM            VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
                         XeBanLeKhuyenMai AS KM INNER JOIN
                         XeBanLe AS BL ON KM.XeBanLeID = BL.ID ON L.ID = KM.VatTuID
WHERE        (NOT (KM.NgayXuat IS NULL)))  
[2024-07-18 10:36:28] local.ERROR: Error creating view L_VatTu_XuatKhac on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatKhac` AS SELECT   B.ID, B.DVXuatKhacID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.LyDoID, LD.TenLyDo, A.GhiChu, B.VatTuID, B.SoLuong, B.TienVon, CASE WHEN n.vattunhomid IN (1, 5) 
                         THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) 
                         THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL 
                         END AS ChiTieu
FROM         DVXuatKhac AS A INNER JOIN
                         DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
                         DVXuatKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
                         VatTuLoai AS N ON L.VatTuLoaiID = N.ID)  
[2024-07-18 10:36:28] local.ERROR: Error creating view L_VatTu_XuatDoiDonVi on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatDoiDonVi` AS SELECT   A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID AS VatTuXuatID, A.SoLuong AS TongSoLuongXuat, A.ThanhTien AS TongThanhTienXuat, CASE WHEN n.vattunhomid IN (1, 5) 
                         THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) 
                         THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL 
                         END AS ChiTieu
FROM         DoiDonVi AS A INNER JOIN
                         VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID ON A.VatTuID = L.ID)  
[2024-07-18 10:36:29] local.ERROR: Error creating view L_VatTu_XuatChuyen on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'n.vattunhomid' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatChuyen` AS SELECT B.ID, B.XeNoiBoID AS NoiBoID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhoHangNhapID, PK.VatTuID, PK.SoLuong, PK.TienVon AS ThanhTienVonVatTu, 'PK' AS ChiTieu
FROM   XeNoiBoPhuKien AS PK INNER JOIN
             XeNoiBoChiTiet AS B ON PK.XeNoiBoChiTietID = B.ID INNER JOIN
             XeNoiBo AS A ON B.XeNoiBoID = A.ID
WHERE (A.IsXacNhan = 1)
UNION ALL
SELECT B.ID, B.DVNoiBoID AS NoiBoID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhoHangNhapID, B.VatTuID, B.SoLuong, B.ThanhTien AS ThanhTienVonVatTu, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
             THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) 
             THEN 'BD' ELSE NULL END AS ChiTieu
FROM   VatTuLoai AS N INNER JOIN
             VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
             DVNoiBo AS A INNER JOIN
             DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON L.ID = B.VatTuID
WHERE (A.IsXacNhan = 1))  
[2024-07-18 10:36:29] local.ERROR: Error creating view L_VatTu_XuatBanDV_All on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'b.ismuave' in 'field list' (SQL: CREATE VIEW `L_VatTu_XuatBanDV_All` AS SELECT   B.ID, B.DVBanLeID, A.SoCT, A.NgayCT, L.VatTuNhomID, V.VatTuLoaiID, A.KhoHangXuatID, B.NgayXuat, B.VatTuID, B.SoLuong, B.DonGia, B.DonGiaTG, 
                         B.DonGia * B.SoLuong AS TienHang, IFNULL(B.DonGiaTG, 0) * B.SoLuong AS TienHangTG, B.ThanhTien AS ThanhTienVatTu, B.TienVon, B.IsMuaVe, B.BaoHanhID, B.MaBCKT, B.MaKNBH,
                          B.TinhTrangBaoHanh, B.NgayHVNThanhToan, B.TienHVNThanhToan, B.GhiChuBaoHanh, CASE WHEN V.vattuloaiid IN (181, 187, 191) OR
                         b.ismuave = 1 THEN k.kythuatvienid ELSE a.kythuatvien END AS KyThuatVien, L.ChiTieu
FROM         DVBanLe AS A INNER JOIN
                         DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE     (B.SoLuong <> 0))  
[2024-07-18 10:36:29] local.ERROR: Error creating view L_VatTu_XuatBanDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_VatTu_XuatBanDV_All' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV` AS SELECT   ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, TienVon, 
                         IsMuaVe, BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM         L_VatTu_XuatBanDV_All
WHERE     (BaoHanhID = 0) AND (KyThuatVien IS NOT NULL) AND (NgayXuat IS NOT NULL))  
[2024-07-18 10:36:29] local.ERROR: Error creating view L_VatTu_XuatBanDV_Master2 on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_VatTu_XuatBanDV' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_Master2` AS SELECT ID, DVBanLeID, KhoHangXuatID, NgayXuat, VatTuID, KyThuatVien, TienVon, ChiTieu
FROM   L_VatTu_XuatBanDV)  
[2024-07-18 10:36:30] local.ERROR: Error creating view L_VatTu_XuatBanDV_Master1 on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_VatTu_XuatBanDV' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_Master1` AS SELECT   ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, IsMuaVe, 
                         BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM         L_VatTu_XuatBanDV)  
[2024-07-18 10:36:30] local.ERROR: Error creating view L_VatTu_BaoHanh on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.L_VatTu_XuatBanDV_All' doesn't exist (SQL: CREATE VIEW `L_VatTu_BaoHanh` AS SELECT        ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, TienVon, IsMuaVe, BaoHanhID, MaBCKT, 
                         MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM            L_VatTu_XuatBanDV_All
WHERE        (BaoHanhID <> 0))  
[2024-07-18 10:36:30] local.ERROR: Error creating view B_DV_VatTu_XuatBanCH_All on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'k.kythuatvienid' in 'field list' (SQL: CREATE VIEW `B_DV_VatTu_XuatBanCH_All` AS SELECT        B.ID, B.DVBanLeID, A.SoCT, A.NgayCT, B.NgayXuat, A.KhoHangXuatID, B.VatTuID, A.KyThuatVien, CASE WHEN V.vattuloaiid IN (181, 187, 191) OR
                         B.Ismuave = 1 THEN k.kythuatvienid ELSE a.kythuatvien END AS NVTinhThuong, CASE WHEN B.ngayxuat >= '2021-01-22' THEN A.kiemtracuoi WHEN (B.ngayxuat < '2021-01-22' AND A.nguoimoinano IS NULL) 
                         THEN A.kiemtracuoi ELSE A.nguoimoinano END AS KiemTraCuoi, L.ChiTieu, A.XeSuaChuaID, A.KhachHangID, CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, S.SoKhung, S.SoMay, S.BienSo, 
                         'XuatBanCH' AS NghiepVu, B.SoLuong AS SL, IFNULL(B.DonGiaTG, 0) * B.SoLuong AS TG, B.ThanhTien AS DT, B.TienVon AS GV, B.IsMuaVe, B.BaoHanhID, B.MaBCKT, B.MaKNBH, B.TinhTrangBaoHanh, B.NgayHVNThanhToan, 
                         B.TienHVNThanhToan, B.GhiChuBaoHanh, CASE WHEN B.TuVanID IS NOT NULL THEN B.TuVanID ELSE CASE WHEN V.IsTinhThuong = 0 THEN A.KiemTraCuoi ELSE NULL END END AS TuVanID
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID INNER JOIN
                         XeSuaChua AS S ON A.XeSuaChuaID = S.ID
WHERE        (B.SoLuong <> 0))  
[2024-07-18 10:36:30] local.ERROR: Error creating view A_DV_VatTu_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_DV_VatTu_XuatBanCH_All' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_XuatBanCH` AS SELECT        ID, DVBanLeID, SoCT, NgayCT, NgayXuat, KhoHangXuatID, VatTuID, KyThuatVien, NVTinhThuong, TuVanID, NghiepVu, ChiTieu, XeSuaChuaID, KhachHangID, XeID, SoKhung, SoMay, BienSo, SL, TG, DT, GV, IsMuaVe, 
                         BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh
FROM            B_DV_VatTu_XuatBanCH_All
WHERE        (NgayXuat >= '2019-12-19') AND (KyThuatVien IS NOT NULL) AND (TuVanID IS NOT NULL))  
[2024-07-18 10:36:31] local.ERROR: Error creating view A_DV_VatTu_XuatChuyenKhacDDV on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'a.ngayct' in 'where clause' (SQL: CREATE VIEW `A_DV_VatTu_XuatChuyenKhacDDV` AS SELECT        B.ID, B.DVNoiBoID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, 'XuatChuyen' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            KhoHang AS K INNER JOIN
                         DVNoiBo AS A INNER JOIN
                         DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON K.ID = A.KhoHangXuatID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.IsXacNhan = 1) AND (K.KhoHangLoaiID = 2) AND (B.SoLuong <> 0) AND a.ngayct >= '2019-12-19'
UNION ALL
SELECT        A.ID, A.ID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, 'XuatDoiDonVi' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, A.SoLuong AS SL, A.ThanhTien AS GV
FROM            DoiDonVi AS A INNER JOIN
                         VatTu AS V ON A.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.NgayCT >= '2019-12-19')
UNION ALL
SELECT        B.ID, B.DVXuatKhacID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, 'XuatKhac' AS NghiepVu, L.ChiTieu, LD.TenLyDo, B.SoLuong AS SL, B.TienVon AS GV
FROM            DVXuatKhac AS A INNER JOIN
                         DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
                         DVXuatKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        (B.SoLuong <> 0) AND (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2))  
[2024-07-18 10:36:31] local.ERROR: Error creating view A_DV_VatTu_XuatBanMVSi on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'a.ngayct' in 'where clause' (SQL: CREATE VIEW `A_DV_VatTu_XuatBanMVSi` AS SELECT        B.ID, B.DVBanSiID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, 3580 as XeID, B.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'XuatBanMV' AS NghiepVu, B.SoLuong AS SL, B.TyLeCK, B.ThanhTien AS DT, 
                         B.TienVon AS GV
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2)
UNION ALL
SELECT        B.ID, B.DVBanBuonID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, 3580 as XeID, B.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'XuatBanSi' AS NghiepVu, B.SoLuong AS SL, IFNULL(B.HeSo, 0) AS TyLeCK, 
                         B.ThanhTien AS DT, B.TienVon AS GV
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonVatTu AS B ON A.ID = B.DVBanBuonID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        a.ngayct >= '2019-12-19')  
[2024-07-18 10:36:31] local.ERROR: Error creating view A_DV_VatTu_NhapTraMVSi on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'a.ngayct' in 'where clause' (SQL: CREATE VIEW `A_DV_VatTu_NhapTraMVSi` AS SELECT        T .ID, A.DVBanSiID AS PhieuBanID, T .DVNhapTraLaiBanSiID AS PhieuTraLaiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, S.KhachHangID,3580 as XeID, T .VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'NhapTraMV' AS NghiepVu, 
                         A.LyDo, T .SoLuong AS SL, T .ThanhTien AS DT, SVT.TienVon AS GV
FROM            VatTuLoai AS L INNER JOIN
                         VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
                         DVNhapTraLaiBanSi AS A INNER JOIN
                         DVNhapTraLaiBanSiChiTiet AS T ON A.ID = T .DVNhapTraLaiBanSiID ON V.ID = T .VatTuID INNER JOIN
                         DVBanSi AS S ON A.DVBanSiID = S.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID INNER JOIN
                         DVBanSiVatTu AS SVT ON T .VatTuID = SVT.VatTuID AND T .DVBanSiID = SVT.DVBanSiID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2)
UNION ALL
SELECT        TL.ID, A.DVBanBuonID AS PhieuBanID, TL.DVNhapTraLaiBanBuonID AS PhieuTraLaiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, BS.KhachHangID,3580 as XeID, TL.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 
                         'NhapTraSi' AS NghiepVu, A.LyDo, TL.SoLuong AS SL, TL.ThanhTien AS DT, BSVT.TienVon AS GV
FROM            DVNhapTraLaiBanBuon AS A INNER JOIN
                         DVBanBuon AS BS ON A.DVBanBuonID = BS.ID INNER JOIN
                         DVNhapTraLaiBanBuonChiTiet AS TL ON A.ID = TL.DVNhapTraLaiBanBuonID INNER JOIN
                         VatTuLoai AS L INNER JOIN
                         VatTu AS V ON L.ID = V.VatTuLoaiID ON TL.VatTuID = V.ID INNER JOIN
                         DVBanBuonVatTu AS BSVT ON TL.DVBanBuonID = BSVT.DVBanBuonID AND TL.VatTuID = BSVT.VatTuID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID
WHERE        a.ngayct >= '2019-12-19')  
[2024-07-18 10:36:31] local.ERROR: Error creating view A_DV_VatTu_NhapChuyenKhacDDV on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'a.ngayct' in 'where clause' (SQL: CREATE VIEW `A_DV_VatTu_NhapChuyenKhacDDV` AS SELECT        B.ID, B.DVNoiBoID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, 'NhapChuyen' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            KhoHang AS K INNER JOIN
                         DVNoiBo AS A INNER JOIN
                         DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON K.ID = A.KhoHangXuatID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.IsXacNhan = 1) AND (K.KhoHangLoaiID = 2) AND a.ngayct >= '2019-12-19'
UNION ALL
SELECT        B.ID, B.DoiDonViID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangID AS KhoHangNhapID, B.VatTuID, 'NhapDoiDonVi' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            DoiDonVi AS A INNER JOIN
                         DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        a.ngayct >= '2019-12-19'
UNION ALL
SELECT        B.ID, B.DVNhapKhacID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, 'NhapKhac' AS NghiepVu, L.ChiTieu, LD.TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            DVNhapKhac AS A INNER JOIN
                         DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID INNER JOIN
                         DVNhapKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2))  
[2024-07-18 10:36:31] local.ERROR: Error creating view B_DV_Phieu_XuatBanCH_All on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'bl.ngayct' in 'field list' (SQL: CREATE VIEW `B_DV_Phieu_XuatBanCH_All` AS SELECT        BL.ID, BL.SoCT, BL.NgayCT, BL.CreatedAt, CAST(REPLACE(DATE_FORMAT(BL.CreatedAt, '%H:%i'), ':', '') AS SIGNED) AS GioTaoPhieu, BL.ThoiGianTraXeThucTe, BL.KhoHangXuatID, BL.KhachHangID, 'XuatBanCH' AS NghiepVu, 
                         S.SoKhung, S.SoMay, S.BienSo, BL.NgayMua, S.TenModel, BL.Km, BL.KyThuatVien, CASE WHEN bl.ngayct < '2021-01-22' AND bl.nguoimoinano IS NOT NULL THEN bl.nguoimoinano ELSE bl.kiemtracuoi END AS KiemTraCuoi, 
                         BL.KiemTraDinhKy, BL.IsBaoDuongToanBo, CAST(BL.IsThayNhot AS SIGNED) AS IsNhot, CAST(BL.IsVeSinhKimPhun AS SIGNED) AS IsKP, CAST(BL.IsVeSinhBuongDot AS SIGNED) AS IsBD, BL.IsLamNano, BL.IsLapPhuKien, 
                         BL.IsLapKhoaChongChom, BL.IsMuaVe, CAST(BL.IsBaoHanhHVN AS SIGNED) AS IsBHHVN, CAST(BL.IsBaoHanhThienChi AS SIGNED) AS IsBHTC, CAST(BL.IsBaoHanhLuuDong AS SIGNED) AS IsSCLD, BL.TongThanhTien, 
                         BL.TongThanhTienTraLai, BL.KhaoSatDiem
FROM            DVBanLe AS BL LEFT OUTER JOIN
                         XeSuaChua AS S ON BL.XeSuaChuaID = S.ID)  
[2024-07-18 10:36:31] local.ERROR: Error creating view A_DV_GC_XuatBanCH on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'bl.kythuatvien' in 'field list' (SQL: CREATE VIEW `A_DV_GC_XuatBanCH` AS SELECT        GC.ID, GC.DVBanLeID, BL.SoCT, BL.NgayCT, GC.NgayGC, BL.KhoHangXuatID, GC.KhachHangID AS DoiTacGC, CASE WHEN GC.GiaCongBy IS NULL THEN bl.kythuatvien ELSE gc.giacongby END AS NhanVienGC, 
                         CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, S.Model2, 'XuatBanCH' AS NghiepVu, 'GC' AS ChiTieu, GC.GiaCongID, GC.GiaBan AS DT, GC.ChiPhi AS GV
FROM            DVBanLe AS BL INNER JOIN
                         DVBanLeGiaCong AS GC ON BL.ID = GC.DVBanLeID INNER JOIN
                         XeSuaChua AS S ON BL.XeSuaChuaID = S.ID
WHERE        (BL.KyThuatVien IS NOT NULL))  
[2024-07-18 10:36:32] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_DV_Phieu_XuatBanCH_All' doesn't exist (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS 
                    SELECT NgayCT, KhoHangXuatID, 'kiemtradinhky' AS LoaiPhieu, kiemtradinhky AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND kiemtradinhky <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsNhot' AS LoaiPhieu, IsNhot AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsNhot <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsKP' AS LoaiPhieu, IsKP AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsKP <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBD' AS LoaiPhieu, IsBD AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBD <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBHHVN' AS LoaiPhieu, IsBHHVN AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBHHVN <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBHTC' AS LoaiPhieu, IsBHTC AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBHTC <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsSCLD' AS LoaiPhieu, IsSCLD AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsSCLD <> 0
                )  
[2024-07-18 10:36:32] local.ERROR: Error creating view A_DV_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_DV_Phieu_LoaiPhieu' doesn't exist (SQL: CREATE VIEW `A_DV_LoaiPhieu` AS SELECT    NgayCT, KhoHangXuatID, REPLACE(LoaiPhieu, 'KiemTraDinhKy', 'IsKTDK') AS LoaiPhieu, COUNT(SL) AS SL
FROM         B_DV_Phieu_LoaiPhieu
GROUP BY NgayCT, KhoHangXuatID, LoaiPhieu
ORDER BY NgayCT)  
[2024-07-18 10:36:32] local.ERROR: Error creating view A_DV_Phieu_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.B_DV_Phieu_XuatBanCH_All' doesn't exist (SQL: CREATE VIEW `A_DV_Phieu_XuatBanCH` AS SELECT        ID, SoCT, NgayCT, CreatedAt, GioTaoPhieu, ThoiGianTraXeThucTe, KhoHangXuatID, KhachHangID, NghiepVu, SoKhung, SoMay, BienSo, NgayMua, TenModel, Km, KyThuatVien, KiemTraCuoi, KiemTraDinhKy, IsNhot, 
                         TongThanhTien, TongThanhTienTraLai, KhaoSatDiem
FROM            B_DV_Phieu_XuatBanCH_All
WHERE        (KyThuatVien IS NOT NULL) AND (KiemTraCuoi IS NOT NULL))  
[2024-07-18 10:36:32] local.ERROR: Error creating view L_NanoDV_XuatBanLe_Moi on retry: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'b.ngayxuat' in 'field list' (SQL: CREATE VIEW `L_NanoDV_XuatBanLe_Moi` AS SELECT        B.ID, A.ID AS IDPhieu, A.SoCT, B.NgayXuat, L.VatTuLoaiID, B.ThanhTien, A.KhoHangXuatID, B.SoLuong, CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, 
                         CASE WHEN b.ngayxuat < '2021-01-22' THEN a.nguoimoinano ELSE a.kiemtracuoi END AS KiemTraCuoi
FROM            DVBanLeVatTu AS B INNER JOIN
                         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
                         DVBanLe AS A ON B.DVBanLeID = A.ID INNER JOIN
                         XeSuaChua AS S ON A.XeSuaChuaID = S.ID
WHERE        (L.VatTuLoaiID = 201) AND (A.NguoiMoiNano IS NOT NULL) AND (B.ThanhTien > 0) AND (B.NgayXuat < '2021-01-22') OR
                         (L.VatTuLoaiID = 201) AND (B.ThanhTien > 0) AND (A.KiemTraCuoi IS NOT NULL) AND (B.NgayXuat >= '2021-01-22'))  
[2024-07-18 11:08:12] local.ERROR: Error creating view L_NhanVienKhoHang on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.nhanvien' doesn't exist (SQL: CREATE VIEW `L_NhanVienKhoHang` AS SELECT   ID AS NhanVienID, CASE WHEN nv.chucvuid IN (1, 2, 5) THEN 26 WHEN nv.chucvuid IN (9) THEN 36 WHEN nv.chucvuid IN (4, 7, 8, 24, 34, 37, 38, 39) THEN 28 WHEN nv.chucvuid IN (6, 10, 12, 13, 
                         16, 36, 43) AND nv.cuahangid = 1 THEN 2 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 2 THEN 6 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 3 THEN 10 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 4 THEN 14 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 5 THEN 18 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 6 THEN 22 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 1 THEN 1 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 2 THEN 5 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 3 THEN 9 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 4 THEN 13 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 5 THEN 17 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 6 THEN 21 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND
                          nv.cuahangid = 12 THEN 37 ELSE NULL END AS KhoHangID
FROM         NhanVien AS NV)  
[2024-07-18 11:08:13] local.ERROR: Error creating view L_NhanVien on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khohang' doesn't exist (SQL: CREATE VIEW `L_NhanVien` AS SELECT    NV.ID, NV.HoTen, CV.TenChucVu, L_NhanVienKhoHang.KhoHangID, KhoHang.TenKhoHang, NV.CuaHangID, CH.TenCuaHang, NV.IDQT, NV.IsActive
FROM         KhoHang INNER JOIN
                         L_NhanVienKhoHang ON KhoHang.ID = L_NhanVienKhoHang.KhoHangID INNER JOIN
                         CuaHang AS CH ON KhoHang.CuaHangID = CH.ID INNER JOIN
                         NhanVien AS NV INNER JOIN
                         ChucVu AS CV ON NV.ChucVuID = CV.ID ON L_NhanVienKhoHang.NhanVienID = NV.ID)  
[2024-07-18 11:08:13] local.ERROR: Error creating view B_NhanVienKhoHang on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.nhanvien' doesn't exist (SQL: CREATE VIEW `B_NhanVienKhoHang` AS SELECT       ID AS NhanVienID, CASE WHEN nv.chucvuid IN (1, 2, 5) THEN 26 WHEN nv.chucvuid IN (9) THEN 36 WHEN nv.chucvuid IN (4, 7, 8, 24, 34, 37, 38, 39) THEN 28 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 1 THEN 2 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 2 THEN 6 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 3 THEN 10 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) 
                         AND nv.cuahangid = 4 THEN 14 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 5 THEN 18 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 6 THEN 22 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 
                         43) AND nv.cuahangid = 13 THEN 38 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 1 THEN 1 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 2 THEN 5 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 3 THEN 9 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 4 THEN 13 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 5 THEN 17 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 6 THEN 21 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 12 THEN 37 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 13 THEN 39 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 12 THEN 40 ELSE NULL END AS KhoHangID
FROM            NhanVien AS NV)  
[2024-07-18 11:08:13] local.ERROR: Error creating view 0_NhanVien on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khohang' doesn't exist (SQL: CREATE VIEW `0_NhanVien` AS SELECT         NV.ID, NV.HoTen, CV.TenChucVu, B_NhanVienKhoHang.KhoHangID, KhoHang.TenKhoHang, NV.CuaHangID, CH.TenCuaHang, NV.IDQT, NV.IsActive
FROM            KhoHang INNER JOIN
                         B_NhanVienKhoHang ON KhoHang.ID = B_NhanVienKhoHang.KhoHangID INNER JOIN
                         CuaHang AS CH ON KhoHang.CuaHangID = CH.ID INNER JOIN
                         NhanVien AS NV INNER JOIN
                         ChucVu AS CV ON NV.ChucVuID = CV.ID ON B_NhanVienKhoHang.NhanVienID = NV.ID)  
[2024-07-18 11:08:13] local.ERROR: Error creating view V_DT_DV_MuaVe_TraLai on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khachhangnhom' doesn't exist (SQL: CREATE VIEW `V_DT_DV_MuaVe_TraLai` AS SELECT T.ID, T.DVNhapTraLaiBanSiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.DVBanSiID, A.LyDo, T.VatTuID, T.SoLuong, T.ThanhTien AS TienHangVatTu, ROUND(A.TyLeCK * - (0.01 * T.ThanhTien), 0) AS TienHangVatTuTG, ROUND(T.ThanhTien - A.TyLeCK * 0.01 * T.ThanhTien, 0) AS ThanhTienVatTu, T.TienVon, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 
         190, 194, 205, 206) THEN 'Khong' WHEN l.vattuloaiid IN (183) THEN 'Mu' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, 
         CASE WHEN khohangnhapid = 1 THEN 725 WHEN khohangnhapid = 5 THEN 726 WHEN khohangnhapid = 9 THEN 727 WHEN khohangnhapid = 13 THEN 728 WHEN khohangnhapid = 17 THEN 729 WHEN khohangnhapid = 21 THEN 730 ELSE NULL END AS KyThuatVien, KhachHangNhom.MaKhachHangNhom
FROM  KhachHangNhom INNER JOIN
         KhachHang ON KhachHangNhom.ID = KhachHang.KhachHangNhomID INNER JOIN
         DVBanSi ON KhachHang.ID = DVBanSi.KhachHangID INNER JOIN
         VatTuLoai AS N INNER JOIN
         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
         DVNhapTraLaiBanSi AS A INNER JOIN
         DVNhapTraLaiBanSiChiTiet AS T ON A.ID = T.DVNhapTraLaiBanSiID ON L.ID = T.VatTuID ON DVBanSi.ID = A.DVBanSiID)  
[2024-07-18 11:08:13] local.ERROR: Error creating view V_DT_DV_MuaVe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbansi' doesn't exist (SQL: CREATE VIEW `V_DT_DV_MuaVe` AS SELECT B.ID, B.DVBanSiID, A.SoCT, A.NgayCT, A.SoHD, A.NgayHD, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, B.SoLuong, N.VatTuNhomID, L.VatTuLoaiID, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206) THEN 'Khong' WHEN l.vattuloaiid IN (183) THEN 'Mu' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) 
         THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (203, 202, 201, 192, 193) THEN 'PTHN' WHEN l.vattuloaiid = 207 THEN 'Khoa' ELSE NULL END AS ChiTieu, 
         (CASE WHEN A.KhoHangXuatID = 1 THEN 725 WHEN A.KhoHangXuatID = 5 THEN 726 WHEN A.KhoHangXuatID = 9 THEN 727 WHEN A.KhoHangXuatID = 13 THEN 728 WHEN A.KhoHangXuatID = 17 THEN 729 WHEN A.KhoHangXuatID = 21 THEN 730 ELSE NULL END) AS KyThuatVien, B.ThanhTien AS TienHang, ROUND(A.TyLeCK * - (0.01 * B.ThanhTien * 0.001), 0) * 1000 AS TienHangTG, 
         ROUND((B.ThanhTien - A.TyLeCK * 0.01 * B.ThanhTien) * 0.001, 0) * 1000 AS ThanhTienVatTu, B.TienVon, KhachHangNhom.MaKhachHangNhom
FROM  DVBanSi AS A INNER JOIN
         DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
         VatTuLoai AS N ON L.VatTuLoaiID = N.ID INNER JOIN
         KhachHang ON A.KhachHangID = KhachHang.ID INNER JOIN
         KhachHangNhom ON KhachHang.KhachHangNhomID = KhachHangNhom.ID)  
[2024-07-18 11:08:13] local.ERROR: Error creating view L_VatTu_XuatKMDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.vattuloai' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatKMDV` AS SELECT   KM.DVBanLeID, BL.KhoHangXuatID, KM.NgayXuat, KM.SoLuong, KM.TienVon, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
                         THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) 
                         THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, KM.VatTuID
FROM         VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
                         DVBanLe AS BL INNER JOIN
                         DVBanLeKhuyenMai AS KM ON BL.ID = KM.DVBanLeID ON L.ID = KM.VatTuID)  
[2024-07-18 11:08:14] local.ERROR: Error creating view L_VatTu_XuatKMBH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.vattuloai' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatKMBH` AS SELECT        KM.XeBanLeID, BL.KhoHangXuatID, KM.NgayXuat, KM.VatTuID, KM.SoLuong, KM.TienVon, KM.ThanhTien, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
                         THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) 
                         THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, BL.XeID, BL.TuVanID
FROM            VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
                         XeBanLeKhuyenMai AS KM INNER JOIN
                         XeBanLe AS BL ON KM.XeBanLeID = BL.ID ON L.ID = KM.VatTuID
WHERE        (NOT (KM.NgayXuat IS NULL)))  
[2024-07-18 11:08:14] local.ERROR: Error creating view L_VatTu_XuatKhac on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvxuatkhac' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatKhac` AS SELECT   B.ID, B.DVXuatKhacID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.LyDoID, LD.TenLyDo, A.GhiChu, B.VatTuID, B.SoLuong, B.TienVon, CASE WHEN n.vattunhomid IN (1, 5) 
                         THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) 
                         THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL 
                         END AS ChiTieu
FROM         DVXuatKhac AS A INNER JOIN
                         DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
                         DVXuatKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
                         VatTuLoai AS N ON L.VatTuLoaiID = N.ID)  
[2024-07-18 11:08:14] local.ERROR: Error creating view L_VatTu_XuatDoiDonVi on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.doidonvi' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatDoiDonVi` AS SELECT   A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID AS VatTuXuatID, A.SoLuong AS TongSoLuongXuat, A.ThanhTien AS TongThanhTienXuat, CASE WHEN n.vattunhomid IN (1, 5) 
                         THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) 
                         THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL 
                         END AS ChiTieu
FROM         DoiDonVi AS A INNER JOIN
                         VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID ON A.VatTuID = L.ID)  
[2024-07-18 11:08:14] local.ERROR: Error creating view L_VatTu_XuatChuyen on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.xenoibophukien' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatChuyen` AS SELECT B.ID, B.XeNoiBoID AS NoiBoID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhoHangNhapID, PK.VatTuID, PK.SoLuong, PK.TienVon AS ThanhTienVonVatTu, 'PK' AS ChiTieu
FROM   XeNoiBoPhuKien AS PK INNER JOIN
             XeNoiBoChiTiet AS B ON PK.XeNoiBoChiTietID = B.ID INNER JOIN
             XeNoiBo AS A ON B.XeNoiBoID = A.ID
WHERE (A.IsXacNhan = 1)
UNION ALL
SELECT B.ID, B.DVNoiBoID AS NoiBoID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhoHangNhapID, B.VatTuID, B.SoLuong, B.ThanhTien AS ThanhTienVonVatTu, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
             THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) 
             THEN 'BD' ELSE NULL END AS ChiTieu
FROM   VatTuLoai AS N INNER JOIN
             VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
             DVNoiBo AS A INNER JOIN
             DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON L.ID = B.VatTuID
WHERE (A.IsXacNhan = 1))  
[2024-07-18 11:08:14] local.ERROR: Error creating view L_VatTu_XuatBanDV_All on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanle' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_All` AS SELECT   B.ID, B.DVBanLeID, A.SoCT, A.NgayCT, L.VatTuNhomID, V.VatTuLoaiID, A.KhoHangXuatID, B.NgayXuat, B.VatTuID, B.SoLuong, B.DonGia, B.DonGiaTG, 
                         B.DonGia * B.SoLuong AS TienHang, IFNULL(B.DonGiaTG, 0) * B.SoLuong AS TienHangTG, B.ThanhTien AS ThanhTienVatTu, B.TienVon, B.IsMuaVe, B.BaoHanhID, B.MaBCKT, B.MaKNBH,
                          B.TinhTrangBaoHanh, B.NgayHVNThanhToan, B.TienHVNThanhToan, B.GhiChuBaoHanh, CASE WHEN V.vattuloaiid IN (181, 187, 191) OR
                         b.ismuave = 1 THEN k.kythuatvienid ELSE a.kythuatvien END AS KyThuatVien, L.ChiTieu
FROM         DVBanLe AS A INNER JOIN
                         DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE     (B.SoLuong <> 0))  
[2024-07-18 11:08:15] local.ERROR: Error creating view L_VatTu_XuatBanDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.l_vattu_xuatbandv_all' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV` AS SELECT   ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, TienVon, 
                         IsMuaVe, BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM         L_VatTu_XuatBanDV_All
WHERE     (BaoHanhID = 0) AND (KyThuatVien IS NOT NULL) AND (NgayXuat IS NOT NULL))  
[2024-07-18 11:08:15] local.ERROR: Error creating view L_VatTu_XuatBanDV_Master2 on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.l_vattu_xuatbandv' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_Master2` AS SELECT ID, DVBanLeID, KhoHangXuatID, NgayXuat, VatTuID, KyThuatVien, TienVon, ChiTieu
FROM   L_VatTu_XuatBanDV)  
[2024-07-18 11:08:15] local.ERROR: Error creating view L_VatTu_XuatBanDV_Master1 on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.l_vattu_xuatbandv' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_Master1` AS SELECT   ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, IsMuaVe, 
                         BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM         L_VatTu_XuatBanDV)  
[2024-07-18 11:08:15] local.ERROR: Error creating view L_VatTu_BaoHanh on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.l_vattu_xuatbandv_all' doesn't exist (SQL: CREATE VIEW `L_VatTu_BaoHanh` AS SELECT        ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, TienVon, IsMuaVe, BaoHanhID, MaBCKT, 
                         MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM            L_VatTu_XuatBanDV_All
WHERE        (BaoHanhID <> 0))  
[2024-07-18 11:08:15] local.ERROR: Error creating view B_DV_VatTu_XuatBanCH_All on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanle' doesn't exist (SQL: CREATE VIEW `B_DV_VatTu_XuatBanCH_All` AS SELECT        B.ID, B.DVBanLeID, A.SoCT, A.NgayCT, B.NgayXuat, A.KhoHangXuatID, B.VatTuID, A.KyThuatVien, CASE WHEN V.vattuloaiid IN (181, 187, 191) OR
                         B.Ismuave = 1 THEN k.kythuatvienid ELSE a.kythuatvien END AS NVTinhThuong, CASE WHEN B.ngayxuat >= '2021-01-22' THEN A.kiemtracuoi WHEN (B.ngayxuat < '2021-01-22' AND A.nguoimoinano IS NULL) 
                         THEN A.kiemtracuoi ELSE A.nguoimoinano END AS KiemTraCuoi, L.ChiTieu, A.XeSuaChuaID, A.KhachHangID, CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, S.SoKhung, S.SoMay, S.BienSo, 
                         'XuatBanCH' AS NghiepVu, B.SoLuong AS SL, IFNULL(B.DonGiaTG, 0) * B.SoLuong AS TG, B.ThanhTien AS DT, B.TienVon AS GV, B.IsMuaVe, B.BaoHanhID, B.MaBCKT, B.MaKNBH, B.TinhTrangBaoHanh, B.NgayHVNThanhToan, 
                         B.TienHVNThanhToan, B.GhiChuBaoHanh, CASE WHEN B.TuVanID IS NOT NULL THEN B.TuVanID ELSE CASE WHEN V.IsTinhThuong = 0 THEN A.KiemTraCuoi ELSE NULL END END AS TuVanID
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID INNER JOIN
                         XeSuaChua AS S ON A.XeSuaChuaID = S.ID
WHERE        (B.SoLuong <> 0))  
[2024-07-18 11:08:15] local.ERROR: Error creating view A_DV_VatTu_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.b_dv_vattu_xuatbanch_all' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_XuatBanCH` AS SELECT        ID, DVBanLeID, SoCT, NgayCT, NgayXuat, KhoHangXuatID, VatTuID, KyThuatVien, NVTinhThuong, TuVanID, NghiepVu, ChiTieu, XeSuaChuaID, KhachHangID, XeID, SoKhung, SoMay, BienSo, SL, TG, DT, GV, IsMuaVe, 
                         BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh
FROM            B_DV_VatTu_XuatBanCH_All
WHERE        (NgayXuat >= '2019-12-19') AND (KyThuatVien IS NOT NULL) AND (TuVanID IS NOT NULL))  
[2024-07-18 11:08:16] local.ERROR: Error creating view A_DV_VatTu_XuatChuyenKhacDDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khohang' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_XuatChuyenKhacDDV` AS SELECT        B.ID, B.DVNoiBoID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, 'XuatChuyen' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            KhoHang AS K INNER JOIN
                         DVNoiBo AS A INNER JOIN
                         DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON K.ID = A.KhoHangXuatID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.IsXacNhan = 1) AND (K.KhoHangLoaiID = 2) AND (B.SoLuong <> 0) AND a.ngayct >= '2019-12-19'
UNION ALL
SELECT        A.ID, A.ID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, 'XuatDoiDonVi' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, A.SoLuong AS SL, A.ThanhTien AS GV
FROM            DoiDonVi AS A INNER JOIN
                         VatTu AS V ON A.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.NgayCT >= '2019-12-19')
UNION ALL
SELECT        B.ID, B.DVXuatKhacID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, 'XuatKhac' AS NghiepVu, L.ChiTieu, LD.TenLyDo, B.SoLuong AS SL, B.TienVon AS GV
FROM            DVXuatKhac AS A INNER JOIN
                         DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
                         DVXuatKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        (B.SoLuong <> 0) AND (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2))  
[2024-07-18 11:08:16] local.ERROR: Error creating view A_DV_VatTu_XuatBanMVSi on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbansi' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_XuatBanMVSi` AS SELECT        B.ID, B.DVBanSiID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, 3580 as XeID, B.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'XuatBanMV' AS NghiepVu, B.SoLuong AS SL, B.TyLeCK, B.ThanhTien AS DT, 
                         B.TienVon AS GV
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2)
UNION ALL
SELECT        B.ID, B.DVBanBuonID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, 3580 as XeID, B.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'XuatBanSi' AS NghiepVu, B.SoLuong AS SL, IFNULL(B.HeSo, 0) AS TyLeCK, 
                         B.ThanhTien AS DT, B.TienVon AS GV
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonVatTu AS B ON A.ID = B.DVBanBuonID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        a.ngayct >= '2019-12-19')  
[2024-07-18 11:08:16] local.ERROR: Error creating view A_DV_VatTu_NhapTraMVSi on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.vattuloai' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_NhapTraMVSi` AS SELECT        T .ID, A.DVBanSiID AS PhieuBanID, T .DVNhapTraLaiBanSiID AS PhieuTraLaiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, S.KhachHangID,3580 as XeID, T .VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'NhapTraMV' AS NghiepVu, 
                         A.LyDo, T .SoLuong AS SL, T .ThanhTien AS DT, SVT.TienVon AS GV
FROM            VatTuLoai AS L INNER JOIN
                         VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
                         DVNhapTraLaiBanSi AS A INNER JOIN
                         DVNhapTraLaiBanSiChiTiet AS T ON A.ID = T .DVNhapTraLaiBanSiID ON V.ID = T .VatTuID INNER JOIN
                         DVBanSi AS S ON A.DVBanSiID = S.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID INNER JOIN
                         DVBanSiVatTu AS SVT ON T .VatTuID = SVT.VatTuID AND T .DVBanSiID = SVT.DVBanSiID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2)
UNION ALL
SELECT        TL.ID, A.DVBanBuonID AS PhieuBanID, TL.DVNhapTraLaiBanBuonID AS PhieuTraLaiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, BS.KhachHangID,3580 as XeID, TL.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 
                         'NhapTraSi' AS NghiepVu, A.LyDo, TL.SoLuong AS SL, TL.ThanhTien AS DT, BSVT.TienVon AS GV
FROM            DVNhapTraLaiBanBuon AS A INNER JOIN
                         DVBanBuon AS BS ON A.DVBanBuonID = BS.ID INNER JOIN
                         DVNhapTraLaiBanBuonChiTiet AS TL ON A.ID = TL.DVNhapTraLaiBanBuonID INNER JOIN
                         VatTuLoai AS L INNER JOIN
                         VatTu AS V ON L.ID = V.VatTuLoaiID ON TL.VatTuID = V.ID INNER JOIN
                         DVBanBuonVatTu AS BSVT ON TL.DVBanBuonID = BSVT.DVBanBuonID AND TL.VatTuID = BSVT.VatTuID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID
WHERE        a.ngayct >= '2019-12-19')  
[2024-07-18 11:08:17] local.ERROR: Error creating view A_DV_VatTu_NhapChuyenKhacDDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khohang' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_NhapChuyenKhacDDV` AS SELECT        B.ID, B.DVNoiBoID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, 'NhapChuyen' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            KhoHang AS K INNER JOIN
                         DVNoiBo AS A INNER JOIN
                         DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON K.ID = A.KhoHangXuatID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.IsXacNhan = 1) AND (K.KhoHangLoaiID = 2) AND a.ngayct >= '2019-12-19'
UNION ALL
SELECT        B.ID, B.DoiDonViID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangID AS KhoHangNhapID, B.VatTuID, 'NhapDoiDonVi' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            DoiDonVi AS A INNER JOIN
                         DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        a.ngayct >= '2019-12-19'
UNION ALL
SELECT        B.ID, B.DVNhapKhacID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, 'NhapKhac' AS NghiepVu, L.ChiTieu, LD.TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            DVNhapKhac AS A INNER JOIN
                         DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID INNER JOIN
                         DVNhapKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2))  
[2024-07-18 11:08:17] local.ERROR: Error creating view B_DV_Phieu_XuatBanCH_All on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanle' doesn't exist (SQL: CREATE VIEW `B_DV_Phieu_XuatBanCH_All` AS SELECT        BL.ID, BL.SoCT, BL.NgayCT, BL.CreatedAt, CAST(REPLACE(DATE_FORMAT(BL.CreatedAt, '%H:%i'), ':', '') AS SIGNED) AS GioTaoPhieu, BL.ThoiGianTraXeThucTe, BL.KhoHangXuatID, BL.KhachHangID, 'XuatBanCH' AS NghiepVu, 
                         S.SoKhung, S.SoMay, S.BienSo, BL.NgayMua, S.TenModel, BL.Km, BL.KyThuatVien, CASE WHEN bl.ngayct < '2021-01-22' AND bl.nguoimoinano IS NOT NULL THEN bl.nguoimoinano ELSE bl.kiemtracuoi END AS KiemTraCuoi, 
                         BL.KiemTraDinhKy, BL.IsBaoDuongToanBo, CAST(BL.IsThayNhot AS SIGNED) AS IsNhot, CAST(BL.IsVeSinhKimPhun AS SIGNED) AS IsKP, CAST(BL.IsVeSinhBuongDot AS SIGNED) AS IsBD, BL.IsLamNano, BL.IsLapPhuKien, 
                         BL.IsLapKhoaChongChom, BL.IsMuaVe, CAST(BL.IsBaoHanhHVN AS SIGNED) AS IsBHHVN, CAST(BL.IsBaoHanhThienChi AS SIGNED) AS IsBHTC, CAST(BL.IsBaoHanhLuuDong AS SIGNED) AS IsSCLD, BL.TongThanhTien, 
                         BL.TongThanhTienTraLai, BL.KhaoSatDiem
FROM            DVBanLe AS BL LEFT OUTER JOIN
                         XeSuaChua AS S ON BL.XeSuaChuaID = S.ID)  
[2024-07-18 11:08:17] local.ERROR: Error creating view A_DV_GC_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanle' doesn't exist (SQL: CREATE VIEW `A_DV_GC_XuatBanCH` AS SELECT        GC.ID, GC.DVBanLeID, BL.SoCT, BL.NgayCT, GC.NgayGC, BL.KhoHangXuatID, GC.KhachHangID AS DoiTacGC, CASE WHEN GC.GiaCongBy IS NULL THEN bl.kythuatvien ELSE gc.giacongby END AS NhanVienGC, 
                         CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, S.Model2, 'XuatBanCH' AS NghiepVu, 'GC' AS ChiTieu, GC.GiaCongID, GC.GiaBan AS DT, GC.ChiPhi AS GV
FROM            DVBanLe AS BL INNER JOIN
                         DVBanLeGiaCong AS GC ON BL.ID = GC.DVBanLeID INNER JOIN
                         XeSuaChua AS S ON BL.XeSuaChuaID = S.ID
WHERE        (BL.KyThuatVien IS NOT NULL))  
[2024-07-18 11:08:18] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.b_dv_phieu_xuatbanch_all' doesn't exist (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS 
                    SELECT NgayCT, KhoHangXuatID, 'kiemtradinhky' AS LoaiPhieu, kiemtradinhky AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND kiemtradinhky <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsNhot' AS LoaiPhieu, IsNhot AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsNhot <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsKP' AS LoaiPhieu, IsKP AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsKP <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBD' AS LoaiPhieu, IsBD AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBD <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBHHVN' AS LoaiPhieu, IsBHHVN AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBHHVN <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBHTC' AS LoaiPhieu, IsBHTC AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBHTC <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsSCLD' AS LoaiPhieu, IsSCLD AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsSCLD <> 0
                )  
[2024-07-18 11:08:18] local.ERROR: Error creating view A_DV_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.b_dv_phieu_loaiphieu' doesn't exist (SQL: CREATE VIEW `A_DV_LoaiPhieu` AS SELECT    NgayCT, KhoHangXuatID, REPLACE(LoaiPhieu, 'KiemTraDinhKy', 'IsKTDK') AS LoaiPhieu, COUNT(SL) AS SL
FROM         B_DV_Phieu_LoaiPhieu
GROUP BY NgayCT, KhoHangXuatID, LoaiPhieu
ORDER BY NgayCT)  
[2024-07-18 11:08:18] local.ERROR: Error creating view A_DV_Phieu_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.b_dv_phieu_xuatbanch_all' doesn't exist (SQL: CREATE VIEW `A_DV_Phieu_XuatBanCH` AS SELECT        ID, SoCT, NgayCT, CreatedAt, GioTaoPhieu, ThoiGianTraXeThucTe, KhoHangXuatID, KhachHangID, NghiepVu, SoKhung, SoMay, BienSo, NgayMua, TenModel, Km, KyThuatVien, KiemTraCuoi, KiemTraDinhKy, IsNhot, 
                         TongThanhTien, TongThanhTienTraLai, KhaoSatDiem
FROM            B_DV_Phieu_XuatBanCH_All
WHERE        (KyThuatVien IS NOT NULL) AND (KiemTraCuoi IS NOT NULL))  
[2024-07-18 11:08:18] local.ERROR: Error creating view L_NanoDV_XuatBanLe_Moi on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanlevattu' doesn't exist (SQL: CREATE VIEW `L_NanoDV_XuatBanLe_Moi` AS SELECT        B.ID, A.ID AS IDPhieu, A.SoCT, B.NgayXuat, L.VatTuLoaiID, B.ThanhTien, A.KhoHangXuatID, B.SoLuong, CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, 
                         CASE WHEN b.ngayxuat < '2021-01-22' THEN a.nguoimoinano ELSE a.kiemtracuoi END AS KiemTraCuoi
FROM            DVBanLeVatTu AS B INNER JOIN
                         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
                         DVBanLe AS A ON B.DVBanLeID = A.ID INNER JOIN
                         XeSuaChua AS S ON A.XeSuaChuaID = S.ID
WHERE        (L.VatTuLoaiID = 201) AND (A.NguoiMoiNano IS NOT NULL) AND (B.ThanhTien > 0) AND (B.NgayXuat < '2021-01-22') OR
                         (L.VatTuLoaiID = 201) AND (B.ThanhTien > 0) AND (A.KiemTraCuoi IS NOT NULL) AND (B.NgayXuat >= '2021-01-22'))  
[2024-07-18 11:08:19] local.ERROR: Error creating view L_NhanVienKhoHang on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.nhanvien' doesn't exist (SQL: CREATE VIEW `L_NhanVienKhoHang` AS SELECT   ID AS NhanVienID, CASE WHEN nv.chucvuid IN (1, 2, 5) THEN 26 WHEN nv.chucvuid IN (9) THEN 36 WHEN nv.chucvuid IN (4, 7, 8, 24, 34, 37, 38, 39) THEN 28 WHEN nv.chucvuid IN (6, 10, 12, 13, 
                         16, 36, 43) AND nv.cuahangid = 1 THEN 2 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 2 THEN 6 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 3 THEN 10 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 4 THEN 14 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 5 THEN 18 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 6 THEN 22 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 1 THEN 1 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 2 THEN 5 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 3 THEN 9 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 4 THEN 13 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 5 THEN 17 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 6 THEN 21 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND
                          nv.cuahangid = 12 THEN 37 ELSE NULL END AS KhoHangID
FROM         NhanVien AS NV)  
[2024-07-18 11:08:19] local.ERROR: Error creating view L_NhanVien on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khohang' doesn't exist (SQL: CREATE VIEW `L_NhanVien` AS SELECT    NV.ID, NV.HoTen, CV.TenChucVu, L_NhanVienKhoHang.KhoHangID, KhoHang.TenKhoHang, NV.CuaHangID, CH.TenCuaHang, NV.IDQT, NV.IsActive
FROM         KhoHang INNER JOIN
                         L_NhanVienKhoHang ON KhoHang.ID = L_NhanVienKhoHang.KhoHangID INNER JOIN
                         CuaHang AS CH ON KhoHang.CuaHangID = CH.ID INNER JOIN
                         NhanVien AS NV INNER JOIN
                         ChucVu AS CV ON NV.ChucVuID = CV.ID ON L_NhanVienKhoHang.NhanVienID = NV.ID)  
[2024-07-18 11:08:19] local.ERROR: Error creating view B_NhanVienKhoHang on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.nhanvien' doesn't exist (SQL: CREATE VIEW `B_NhanVienKhoHang` AS SELECT       ID AS NhanVienID, CASE WHEN nv.chucvuid IN (1, 2, 5) THEN 26 WHEN nv.chucvuid IN (9) THEN 36 WHEN nv.chucvuid IN (4, 7, 8, 24, 34, 37, 38, 39) THEN 28 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 1 THEN 2 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 2 THEN 6 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 3 THEN 10 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) 
                         AND nv.cuahangid = 4 THEN 14 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 5 THEN 18 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 6 THEN 22 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 
                         43) AND nv.cuahangid = 13 THEN 38 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 1 THEN 1 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 2 THEN 5 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 3 THEN 9 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 4 THEN 13 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 5 THEN 17 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 6 THEN 21 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 12 THEN 37 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 13 THEN 39 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 12 THEN 40 ELSE NULL END AS KhoHangID
FROM            NhanVien AS NV)  
[2024-07-18 11:08:19] local.ERROR: Error creating view 0_NhanVien on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khohang' doesn't exist (SQL: CREATE VIEW `0_NhanVien` AS SELECT         NV.ID, NV.HoTen, CV.TenChucVu, B_NhanVienKhoHang.KhoHangID, KhoHang.TenKhoHang, NV.CuaHangID, CH.TenCuaHang, NV.IDQT, NV.IsActive
FROM            KhoHang INNER JOIN
                         B_NhanVienKhoHang ON KhoHang.ID = B_NhanVienKhoHang.KhoHangID INNER JOIN
                         CuaHang AS CH ON KhoHang.CuaHangID = CH.ID INNER JOIN
                         NhanVien AS NV INNER JOIN
                         ChucVu AS CV ON NV.ChucVuID = CV.ID ON B_NhanVienKhoHang.NhanVienID = NV.ID)  
[2024-07-18 11:08:19] local.ERROR: Error creating view V_DT_DV_MuaVe_TraLai on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khachhangnhom' doesn't exist (SQL: CREATE VIEW `V_DT_DV_MuaVe_TraLai` AS SELECT T.ID, T.DVNhapTraLaiBanSiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.DVBanSiID, A.LyDo, T.VatTuID, T.SoLuong, T.ThanhTien AS TienHangVatTu, ROUND(A.TyLeCK * - (0.01 * T.ThanhTien), 0) AS TienHangVatTuTG, ROUND(T.ThanhTien - A.TyLeCK * 0.01 * T.ThanhTien, 0) AS ThanhTienVatTu, T.TienVon, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 
         190, 194, 205, 206) THEN 'Khong' WHEN l.vattuloaiid IN (183) THEN 'Mu' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, 
         CASE WHEN khohangnhapid = 1 THEN 725 WHEN khohangnhapid = 5 THEN 726 WHEN khohangnhapid = 9 THEN 727 WHEN khohangnhapid = 13 THEN 728 WHEN khohangnhapid = 17 THEN 729 WHEN khohangnhapid = 21 THEN 730 ELSE NULL END AS KyThuatVien, KhachHangNhom.MaKhachHangNhom
FROM  KhachHangNhom INNER JOIN
         KhachHang ON KhachHangNhom.ID = KhachHang.KhachHangNhomID INNER JOIN
         DVBanSi ON KhachHang.ID = DVBanSi.KhachHangID INNER JOIN
         VatTuLoai AS N INNER JOIN
         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
         DVNhapTraLaiBanSi AS A INNER JOIN
         DVNhapTraLaiBanSiChiTiet AS T ON A.ID = T.DVNhapTraLaiBanSiID ON L.ID = T.VatTuID ON DVBanSi.ID = A.DVBanSiID)  
[2024-07-18 11:08:19] local.ERROR: Error creating view V_DT_DV_MuaVe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbansi' doesn't exist (SQL: CREATE VIEW `V_DT_DV_MuaVe` AS SELECT B.ID, B.DVBanSiID, A.SoCT, A.NgayCT, A.SoHD, A.NgayHD, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, B.SoLuong, N.VatTuNhomID, L.VatTuLoaiID, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206) THEN 'Khong' WHEN l.vattuloaiid IN (183) THEN 'Mu' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) 
         THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (203, 202, 201, 192, 193) THEN 'PTHN' WHEN l.vattuloaiid = 207 THEN 'Khoa' ELSE NULL END AS ChiTieu, 
         (CASE WHEN A.KhoHangXuatID = 1 THEN 725 WHEN A.KhoHangXuatID = 5 THEN 726 WHEN A.KhoHangXuatID = 9 THEN 727 WHEN A.KhoHangXuatID = 13 THEN 728 WHEN A.KhoHangXuatID = 17 THEN 729 WHEN A.KhoHangXuatID = 21 THEN 730 ELSE NULL END) AS KyThuatVien, B.ThanhTien AS TienHang, ROUND(A.TyLeCK * - (0.01 * B.ThanhTien * 0.001), 0) * 1000 AS TienHangTG, 
         ROUND((B.ThanhTien - A.TyLeCK * 0.01 * B.ThanhTien) * 0.001, 0) * 1000 AS ThanhTienVatTu, B.TienVon, KhachHangNhom.MaKhachHangNhom
FROM  DVBanSi AS A INNER JOIN
         DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
         VatTuLoai AS N ON L.VatTuLoaiID = N.ID INNER JOIN
         KhachHang ON A.KhachHangID = KhachHang.ID INNER JOIN
         KhachHangNhom ON KhachHang.KhachHangNhomID = KhachHangNhom.ID)  
[2024-07-18 11:08:20] local.ERROR: Error creating view L_VatTu_XuatKMDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.vattuloai' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatKMDV` AS SELECT   KM.DVBanLeID, BL.KhoHangXuatID, KM.NgayXuat, KM.SoLuong, KM.TienVon, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
                         THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) 
                         THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, KM.VatTuID
FROM         VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
                         DVBanLe AS BL INNER JOIN
                         DVBanLeKhuyenMai AS KM ON BL.ID = KM.DVBanLeID ON L.ID = KM.VatTuID)  
[2024-07-18 11:08:20] local.ERROR: Error creating view L_VatTu_XuatKMBH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.vattuloai' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatKMBH` AS SELECT        KM.XeBanLeID, BL.KhoHangXuatID, KM.NgayXuat, KM.VatTuID, KM.SoLuong, KM.TienVon, KM.ThanhTien, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
                         THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) 
                         THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, BL.XeID, BL.TuVanID
FROM            VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
                         XeBanLeKhuyenMai AS KM INNER JOIN
                         XeBanLe AS BL ON KM.XeBanLeID = BL.ID ON L.ID = KM.VatTuID
WHERE        (NOT (KM.NgayXuat IS NULL)))  
[2024-07-18 11:08:20] local.ERROR: Error creating view L_VatTu_XuatKhac on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvxuatkhac' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatKhac` AS SELECT   B.ID, B.DVXuatKhacID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.LyDoID, LD.TenLyDo, A.GhiChu, B.VatTuID, B.SoLuong, B.TienVon, CASE WHEN n.vattunhomid IN (1, 5) 
                         THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) 
                         THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL 
                         END AS ChiTieu
FROM         DVXuatKhac AS A INNER JOIN
                         DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
                         DVXuatKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
                         VatTuLoai AS N ON L.VatTuLoaiID = N.ID)  
[2024-07-18 11:08:20] local.ERROR: Error creating view L_VatTu_XuatDoiDonVi on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.doidonvi' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatDoiDonVi` AS SELECT   A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID AS VatTuXuatID, A.SoLuong AS TongSoLuongXuat, A.ThanhTien AS TongThanhTienXuat, CASE WHEN n.vattunhomid IN (1, 5) 
                         THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) 
                         THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL 
                         END AS ChiTieu
FROM         DoiDonVi AS A INNER JOIN
                         VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID ON A.VatTuID = L.ID)  
[2024-07-18 11:08:20] local.ERROR: Error creating view L_VatTu_XuatChuyen on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.xenoibophukien' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatChuyen` AS SELECT B.ID, B.XeNoiBoID AS NoiBoID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhoHangNhapID, PK.VatTuID, PK.SoLuong, PK.TienVon AS ThanhTienVonVatTu, 'PK' AS ChiTieu
FROM   XeNoiBoPhuKien AS PK INNER JOIN
             XeNoiBoChiTiet AS B ON PK.XeNoiBoChiTietID = B.ID INNER JOIN
             XeNoiBo AS A ON B.XeNoiBoID = A.ID
WHERE (A.IsXacNhan = 1)
UNION ALL
SELECT B.ID, B.DVNoiBoID AS NoiBoID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhoHangNhapID, B.VatTuID, B.SoLuong, B.ThanhTien AS ThanhTienVonVatTu, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
             THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) 
             THEN 'BD' ELSE NULL END AS ChiTieu
FROM   VatTuLoai AS N INNER JOIN
             VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
             DVNoiBo AS A INNER JOIN
             DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON L.ID = B.VatTuID
WHERE (A.IsXacNhan = 1))  
[2024-07-18 11:08:21] local.ERROR: Error creating view L_VatTu_XuatBanDV_All on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanle' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_All` AS SELECT   B.ID, B.DVBanLeID, A.SoCT, A.NgayCT, L.VatTuNhomID, V.VatTuLoaiID, A.KhoHangXuatID, B.NgayXuat, B.VatTuID, B.SoLuong, B.DonGia, B.DonGiaTG, 
                         B.DonGia * B.SoLuong AS TienHang, IFNULL(B.DonGiaTG, 0) * B.SoLuong AS TienHangTG, B.ThanhTien AS ThanhTienVatTu, B.TienVon, B.IsMuaVe, B.BaoHanhID, B.MaBCKT, B.MaKNBH,
                          B.TinhTrangBaoHanh, B.NgayHVNThanhToan, B.TienHVNThanhToan, B.GhiChuBaoHanh, CASE WHEN V.vattuloaiid IN (181, 187, 191) OR
                         b.ismuave = 1 THEN k.kythuatvienid ELSE a.kythuatvien END AS KyThuatVien, L.ChiTieu
FROM         DVBanLe AS A INNER JOIN
                         DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE     (B.SoLuong <> 0))  
[2024-07-18 11:08:21] local.ERROR: Error creating view L_VatTu_XuatBanDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.l_vattu_xuatbandv_all' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV` AS SELECT   ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, TienVon, 
                         IsMuaVe, BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM         L_VatTu_XuatBanDV_All
WHERE     (BaoHanhID = 0) AND (KyThuatVien IS NOT NULL) AND (NgayXuat IS NOT NULL))  
[2024-07-18 11:08:21] local.ERROR: Error creating view L_VatTu_XuatBanDV_Master2 on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.l_vattu_xuatbandv' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_Master2` AS SELECT ID, DVBanLeID, KhoHangXuatID, NgayXuat, VatTuID, KyThuatVien, TienVon, ChiTieu
FROM   L_VatTu_XuatBanDV)  
[2024-07-18 11:08:21] local.ERROR: Error creating view L_VatTu_XuatBanDV_Master1 on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.l_vattu_xuatbandv' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_Master1` AS SELECT   ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, IsMuaVe, 
                         BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM         L_VatTu_XuatBanDV)  
[2024-07-18 11:08:21] local.ERROR: Error creating view L_VatTu_BaoHanh on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.l_vattu_xuatbandv_all' doesn't exist (SQL: CREATE VIEW `L_VatTu_BaoHanh` AS SELECT        ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, TienVon, IsMuaVe, BaoHanhID, MaBCKT, 
                         MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM            L_VatTu_XuatBanDV_All
WHERE        (BaoHanhID <> 0))  
[2024-07-18 11:08:22] local.ERROR: Error creating view B_DV_VatTu_XuatBanCH_All on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanle' doesn't exist (SQL: CREATE VIEW `B_DV_VatTu_XuatBanCH_All` AS SELECT        B.ID, B.DVBanLeID, A.SoCT, A.NgayCT, B.NgayXuat, A.KhoHangXuatID, B.VatTuID, A.KyThuatVien, CASE WHEN V.vattuloaiid IN (181, 187, 191) OR
                         B.Ismuave = 1 THEN k.kythuatvienid ELSE a.kythuatvien END AS NVTinhThuong, CASE WHEN B.ngayxuat >= '2021-01-22' THEN A.kiemtracuoi WHEN (B.ngayxuat < '2021-01-22' AND A.nguoimoinano IS NULL) 
                         THEN A.kiemtracuoi ELSE A.nguoimoinano END AS KiemTraCuoi, L.ChiTieu, A.XeSuaChuaID, A.KhachHangID, CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, S.SoKhung, S.SoMay, S.BienSo, 
                         'XuatBanCH' AS NghiepVu, B.SoLuong AS SL, IFNULL(B.DonGiaTG, 0) * B.SoLuong AS TG, B.ThanhTien AS DT, B.TienVon AS GV, B.IsMuaVe, B.BaoHanhID, B.MaBCKT, B.MaKNBH, B.TinhTrangBaoHanh, B.NgayHVNThanhToan, 
                         B.TienHVNThanhToan, B.GhiChuBaoHanh, CASE WHEN B.TuVanID IS NOT NULL THEN B.TuVanID ELSE CASE WHEN V.IsTinhThuong = 0 THEN A.KiemTraCuoi ELSE NULL END END AS TuVanID
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID INNER JOIN
                         XeSuaChua AS S ON A.XeSuaChuaID = S.ID
WHERE        (B.SoLuong <> 0))  
[2024-07-18 11:08:22] local.ERROR: Error creating view A_DV_VatTu_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.b_dv_vattu_xuatbanch_all' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_XuatBanCH` AS SELECT        ID, DVBanLeID, SoCT, NgayCT, NgayXuat, KhoHangXuatID, VatTuID, KyThuatVien, NVTinhThuong, TuVanID, NghiepVu, ChiTieu, XeSuaChuaID, KhachHangID, XeID, SoKhung, SoMay, BienSo, SL, TG, DT, GV, IsMuaVe, 
                         BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh
FROM            B_DV_VatTu_XuatBanCH_All
WHERE        (NgayXuat >= '2019-12-19') AND (KyThuatVien IS NOT NULL) AND (TuVanID IS NOT NULL))  
[2024-07-18 11:08:22] local.ERROR: Error creating view A_DV_VatTu_XuatChuyenKhacDDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khohang' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_XuatChuyenKhacDDV` AS SELECT        B.ID, B.DVNoiBoID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, 'XuatChuyen' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            KhoHang AS K INNER JOIN
                         DVNoiBo AS A INNER JOIN
                         DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON K.ID = A.KhoHangXuatID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.IsXacNhan = 1) AND (K.KhoHangLoaiID = 2) AND (B.SoLuong <> 0) AND a.ngayct >= '2019-12-19'
UNION ALL
SELECT        A.ID, A.ID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, 'XuatDoiDonVi' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, A.SoLuong AS SL, A.ThanhTien AS GV
FROM            DoiDonVi AS A INNER JOIN
                         VatTu AS V ON A.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.NgayCT >= '2019-12-19')
UNION ALL
SELECT        B.ID, B.DVXuatKhacID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, 'XuatKhac' AS NghiepVu, L.ChiTieu, LD.TenLyDo, B.SoLuong AS SL, B.TienVon AS GV
FROM            DVXuatKhac AS A INNER JOIN
                         DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
                         DVXuatKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        (B.SoLuong <> 0) AND (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2))  
[2024-07-18 11:08:22] local.ERROR: Error creating view A_DV_VatTu_XuatBanMVSi on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbansi' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_XuatBanMVSi` AS SELECT        B.ID, B.DVBanSiID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, 3580 as XeID, B.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'XuatBanMV' AS NghiepVu, B.SoLuong AS SL, B.TyLeCK, B.ThanhTien AS DT, 
                         B.TienVon AS GV
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2)
UNION ALL
SELECT        B.ID, B.DVBanBuonID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, 3580 as XeID, B.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'XuatBanSi' AS NghiepVu, B.SoLuong AS SL, IFNULL(B.HeSo, 0) AS TyLeCK, 
                         B.ThanhTien AS DT, B.TienVon AS GV
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonVatTu AS B ON A.ID = B.DVBanBuonID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        a.ngayct >= '2019-12-19')  
[2024-07-18 11:08:23] local.ERROR: Error creating view A_DV_VatTu_NhapTraMVSi on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.vattuloai' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_NhapTraMVSi` AS SELECT        T .ID, A.DVBanSiID AS PhieuBanID, T .DVNhapTraLaiBanSiID AS PhieuTraLaiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, S.KhachHangID,3580 as XeID, T .VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'NhapTraMV' AS NghiepVu, 
                         A.LyDo, T .SoLuong AS SL, T .ThanhTien AS DT, SVT.TienVon AS GV
FROM            VatTuLoai AS L INNER JOIN
                         VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
                         DVNhapTraLaiBanSi AS A INNER JOIN
                         DVNhapTraLaiBanSiChiTiet AS T ON A.ID = T .DVNhapTraLaiBanSiID ON V.ID = T .VatTuID INNER JOIN
                         DVBanSi AS S ON A.DVBanSiID = S.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID INNER JOIN
                         DVBanSiVatTu AS SVT ON T .VatTuID = SVT.VatTuID AND T .DVBanSiID = SVT.DVBanSiID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2)
UNION ALL
SELECT        TL.ID, A.DVBanBuonID AS PhieuBanID, TL.DVNhapTraLaiBanBuonID AS PhieuTraLaiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, BS.KhachHangID,3580 as XeID, TL.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 
                         'NhapTraSi' AS NghiepVu, A.LyDo, TL.SoLuong AS SL, TL.ThanhTien AS DT, BSVT.TienVon AS GV
FROM            DVNhapTraLaiBanBuon AS A INNER JOIN
                         DVBanBuon AS BS ON A.DVBanBuonID = BS.ID INNER JOIN
                         DVNhapTraLaiBanBuonChiTiet AS TL ON A.ID = TL.DVNhapTraLaiBanBuonID INNER JOIN
                         VatTuLoai AS L INNER JOIN
                         VatTu AS V ON L.ID = V.VatTuLoaiID ON TL.VatTuID = V.ID INNER JOIN
                         DVBanBuonVatTu AS BSVT ON TL.DVBanBuonID = BSVT.DVBanBuonID AND TL.VatTuID = BSVT.VatTuID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID
WHERE        a.ngayct >= '2019-12-19')  
[2024-07-18 11:08:23] local.ERROR: Error creating view A_DV_VatTu_NhapChuyenKhacDDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khohang' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_NhapChuyenKhacDDV` AS SELECT        B.ID, B.DVNoiBoID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, 'NhapChuyen' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            KhoHang AS K INNER JOIN
                         DVNoiBo AS A INNER JOIN
                         DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON K.ID = A.KhoHangXuatID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.IsXacNhan = 1) AND (K.KhoHangLoaiID = 2) AND a.ngayct >= '2019-12-19'
UNION ALL
SELECT        B.ID, B.DoiDonViID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangID AS KhoHangNhapID, B.VatTuID, 'NhapDoiDonVi' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            DoiDonVi AS A INNER JOIN
                         DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        a.ngayct >= '2019-12-19'
UNION ALL
SELECT        B.ID, B.DVNhapKhacID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, 'NhapKhac' AS NghiepVu, L.ChiTieu, LD.TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            DVNhapKhac AS A INNER JOIN
                         DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID INNER JOIN
                         DVNhapKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2))  
[2024-07-18 11:08:23] local.ERROR: Error creating view B_DV_Phieu_XuatBanCH_All on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanle' doesn't exist (SQL: CREATE VIEW `B_DV_Phieu_XuatBanCH_All` AS SELECT        BL.ID, BL.SoCT, BL.NgayCT, BL.CreatedAt, CAST(REPLACE(DATE_FORMAT(BL.CreatedAt, '%H:%i'), ':', '') AS SIGNED) AS GioTaoPhieu, BL.ThoiGianTraXeThucTe, BL.KhoHangXuatID, BL.KhachHangID, 'XuatBanCH' AS NghiepVu, 
                         S.SoKhung, S.SoMay, S.BienSo, BL.NgayMua, S.TenModel, BL.Km, BL.KyThuatVien, CASE WHEN bl.ngayct < '2021-01-22' AND bl.nguoimoinano IS NOT NULL THEN bl.nguoimoinano ELSE bl.kiemtracuoi END AS KiemTraCuoi, 
                         BL.KiemTraDinhKy, BL.IsBaoDuongToanBo, CAST(BL.IsThayNhot AS SIGNED) AS IsNhot, CAST(BL.IsVeSinhKimPhun AS SIGNED) AS IsKP, CAST(BL.IsVeSinhBuongDot AS SIGNED) AS IsBD, BL.IsLamNano, BL.IsLapPhuKien, 
                         BL.IsLapKhoaChongChom, BL.IsMuaVe, CAST(BL.IsBaoHanhHVN AS SIGNED) AS IsBHHVN, CAST(BL.IsBaoHanhThienChi AS SIGNED) AS IsBHTC, CAST(BL.IsBaoHanhLuuDong AS SIGNED) AS IsSCLD, BL.TongThanhTien, 
                         BL.TongThanhTienTraLai, BL.KhaoSatDiem
FROM            DVBanLe AS BL LEFT OUTER JOIN
                         XeSuaChua AS S ON BL.XeSuaChuaID = S.ID)  
[2024-07-18 11:08:23] local.ERROR: Error creating view A_DV_GC_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanle' doesn't exist (SQL: CREATE VIEW `A_DV_GC_XuatBanCH` AS SELECT        GC.ID, GC.DVBanLeID, BL.SoCT, BL.NgayCT, GC.NgayGC, BL.KhoHangXuatID, GC.KhachHangID AS DoiTacGC, CASE WHEN GC.GiaCongBy IS NULL THEN bl.kythuatvien ELSE gc.giacongby END AS NhanVienGC, 
                         CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, S.Model2, 'XuatBanCH' AS NghiepVu, 'GC' AS ChiTieu, GC.GiaCongID, GC.GiaBan AS DT, GC.ChiPhi AS GV
FROM            DVBanLe AS BL INNER JOIN
                         DVBanLeGiaCong AS GC ON BL.ID = GC.DVBanLeID INNER JOIN
                         XeSuaChua AS S ON BL.XeSuaChuaID = S.ID
WHERE        (BL.KyThuatVien IS NOT NULL))  
[2024-07-18 11:08:23] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.b_dv_phieu_xuatbanch_all' doesn't exist (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS 
                    SELECT NgayCT, KhoHangXuatID, 'kiemtradinhky' AS LoaiPhieu, kiemtradinhky AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND kiemtradinhky <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsNhot' AS LoaiPhieu, IsNhot AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsNhot <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsKP' AS LoaiPhieu, IsKP AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsKP <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBD' AS LoaiPhieu, IsBD AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBD <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBHHVN' AS LoaiPhieu, IsBHHVN AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBHHVN <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBHTC' AS LoaiPhieu, IsBHTC AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBHTC <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsSCLD' AS LoaiPhieu, IsSCLD AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsSCLD <> 0
                )  
[2024-07-18 11:08:24] local.ERROR: Error creating view A_DV_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.b_dv_phieu_loaiphieu' doesn't exist (SQL: CREATE VIEW `A_DV_LoaiPhieu` AS SELECT    NgayCT, KhoHangXuatID, REPLACE(LoaiPhieu, 'KiemTraDinhKy', 'IsKTDK') AS LoaiPhieu, COUNT(SL) AS SL
FROM         B_DV_Phieu_LoaiPhieu
GROUP BY NgayCT, KhoHangXuatID, LoaiPhieu
ORDER BY NgayCT)  
[2024-07-18 11:08:24] local.ERROR: Error creating view A_DV_Phieu_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.b_dv_phieu_xuatbanch_all' doesn't exist (SQL: CREATE VIEW `A_DV_Phieu_XuatBanCH` AS SELECT        ID, SoCT, NgayCT, CreatedAt, GioTaoPhieu, ThoiGianTraXeThucTe, KhoHangXuatID, KhachHangID, NghiepVu, SoKhung, SoMay, BienSo, NgayMua, TenModel, Km, KyThuatVien, KiemTraCuoi, KiemTraDinhKy, IsNhot, 
                         TongThanhTien, TongThanhTienTraLai, KhaoSatDiem
FROM            B_DV_Phieu_XuatBanCH_All
WHERE        (KyThuatVien IS NOT NULL) AND (KiemTraCuoi IS NOT NULL))  
[2024-07-18 11:08:24] local.ERROR: Error creating view L_NanoDV_XuatBanLe_Moi on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanlevattu' doesn't exist (SQL: CREATE VIEW `L_NanoDV_XuatBanLe_Moi` AS SELECT        B.ID, A.ID AS IDPhieu, A.SoCT, B.NgayXuat, L.VatTuLoaiID, B.ThanhTien, A.KhoHangXuatID, B.SoLuong, CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, 
                         CASE WHEN b.ngayxuat < '2021-01-22' THEN a.nguoimoinano ELSE a.kiemtracuoi END AS KiemTraCuoi
FROM            DVBanLeVatTu AS B INNER JOIN
                         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
                         DVBanLe AS A ON B.DVBanLeID = A.ID INNER JOIN
                         XeSuaChua AS S ON A.XeSuaChuaID = S.ID
WHERE        (L.VatTuLoaiID = 201) AND (A.NguoiMoiNano IS NOT NULL) AND (B.ThanhTien > 0) AND (B.NgayXuat < '2021-01-22') OR
                         (L.VatTuLoaiID = 201) AND (B.ThanhTien > 0) AND (A.KiemTraCuoi IS NOT NULL) AND (B.NgayXuat >= '2021-01-22'))  
[2024-07-18 11:08:25] local.ERROR: Error creating view L_NhanVienKhoHang on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.nhanvien' doesn't exist (SQL: CREATE VIEW `L_NhanVienKhoHang` AS SELECT   ID AS NhanVienID, CASE WHEN nv.chucvuid IN (1, 2, 5) THEN 26 WHEN nv.chucvuid IN (9) THEN 36 WHEN nv.chucvuid IN (4, 7, 8, 24, 34, 37, 38, 39) THEN 28 WHEN nv.chucvuid IN (6, 10, 12, 13, 
                         16, 36, 43) AND nv.cuahangid = 1 THEN 2 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 2 THEN 6 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 3 THEN 10 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 4 THEN 14 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 5 THEN 18 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 6 THEN 22 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 1 THEN 1 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 2 THEN 5 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 3 THEN 9 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 4 THEN 13 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 5 THEN 17 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 6 THEN 21 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND
                          nv.cuahangid = 12 THEN 37 ELSE NULL END AS KhoHangID
FROM         NhanVien AS NV)  
[2024-07-18 11:08:25] local.ERROR: Error creating view L_NhanVien on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khohang' doesn't exist (SQL: CREATE VIEW `L_NhanVien` AS SELECT    NV.ID, NV.HoTen, CV.TenChucVu, L_NhanVienKhoHang.KhoHangID, KhoHang.TenKhoHang, NV.CuaHangID, CH.TenCuaHang, NV.IDQT, NV.IsActive
FROM         KhoHang INNER JOIN
                         L_NhanVienKhoHang ON KhoHang.ID = L_NhanVienKhoHang.KhoHangID INNER JOIN
                         CuaHang AS CH ON KhoHang.CuaHangID = CH.ID INNER JOIN
                         NhanVien AS NV INNER JOIN
                         ChucVu AS CV ON NV.ChucVuID = CV.ID ON L_NhanVienKhoHang.NhanVienID = NV.ID)  
[2024-07-18 11:08:25] local.ERROR: Error creating view B_NhanVienKhoHang on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.nhanvien' doesn't exist (SQL: CREATE VIEW `B_NhanVienKhoHang` AS SELECT       ID AS NhanVienID, CASE WHEN nv.chucvuid IN (1, 2, 5) THEN 26 WHEN nv.chucvuid IN (9) THEN 36 WHEN nv.chucvuid IN (4, 7, 8, 24, 34, 37, 38, 39) THEN 28 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND 
                         nv.cuahangid = 1 THEN 2 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 2 THEN 6 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 3 THEN 10 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) 
                         AND nv.cuahangid = 4 THEN 14 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 5 THEN 18 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 6 THEN 22 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 
                         43) AND nv.cuahangid = 13 THEN 38 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 1 THEN 1 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 2 THEN 5 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 3 THEN 9 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 4 THEN 13 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 5 THEN 17 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 6 THEN 21 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND nv.cuahangid = 12 THEN 37 WHEN nv.chucvuid IN (17, 18, 19, 20, 22, 24, 25, 26, 35, 40, 41, 42) AND 
                         nv.cuahangid = 13 THEN 39 WHEN nv.chucvuid IN (6, 10, 12, 13, 16, 36, 43) AND nv.cuahangid = 12 THEN 40 ELSE NULL END AS KhoHangID
FROM            NhanVien AS NV)  
[2024-07-18 11:08:25] local.ERROR: Error creating view 0_NhanVien on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khohang' doesn't exist (SQL: CREATE VIEW `0_NhanVien` AS SELECT         NV.ID, NV.HoTen, CV.TenChucVu, B_NhanVienKhoHang.KhoHangID, KhoHang.TenKhoHang, NV.CuaHangID, CH.TenCuaHang, NV.IDQT, NV.IsActive
FROM            KhoHang INNER JOIN
                         B_NhanVienKhoHang ON KhoHang.ID = B_NhanVienKhoHang.KhoHangID INNER JOIN
                         CuaHang AS CH ON KhoHang.CuaHangID = CH.ID INNER JOIN
                         NhanVien AS NV INNER JOIN
                         ChucVu AS CV ON NV.ChucVuID = CV.ID ON B_NhanVienKhoHang.NhanVienID = NV.ID)  
[2024-07-18 11:08:25] local.ERROR: Error creating view V_DT_DV_MuaVe_TraLai on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khachhangnhom' doesn't exist (SQL: CREATE VIEW `V_DT_DV_MuaVe_TraLai` AS SELECT T.ID, T.DVNhapTraLaiBanSiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.DVBanSiID, A.LyDo, T.VatTuID, T.SoLuong, T.ThanhTien AS TienHangVatTu, ROUND(A.TyLeCK * - (0.01 * T.ThanhTien), 0) AS TienHangVatTuTG, ROUND(T.ThanhTien - A.TyLeCK * 0.01 * T.ThanhTien, 0) AS ThanhTienVatTu, T.TienVon, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 
         190, 194, 205, 206) THEN 'Khong' WHEN l.vattuloaiid IN (183) THEN 'Mu' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, 
         CASE WHEN khohangnhapid = 1 THEN 725 WHEN khohangnhapid = 5 THEN 726 WHEN khohangnhapid = 9 THEN 727 WHEN khohangnhapid = 13 THEN 728 WHEN khohangnhapid = 17 THEN 729 WHEN khohangnhapid = 21 THEN 730 ELSE NULL END AS KyThuatVien, KhachHangNhom.MaKhachHangNhom
FROM  KhachHangNhom INNER JOIN
         KhachHang ON KhachHangNhom.ID = KhachHang.KhachHangNhomID INNER JOIN
         DVBanSi ON KhachHang.ID = DVBanSi.KhachHangID INNER JOIN
         VatTuLoai AS N INNER JOIN
         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
         DVNhapTraLaiBanSi AS A INNER JOIN
         DVNhapTraLaiBanSiChiTiet AS T ON A.ID = T.DVNhapTraLaiBanSiID ON L.ID = T.VatTuID ON DVBanSi.ID = A.DVBanSiID)  
[2024-07-18 11:08:26] local.ERROR: Error creating view V_DT_DV_MuaVe on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbansi' doesn't exist (SQL: CREATE VIEW `V_DT_DV_MuaVe` AS SELECT B.ID, B.DVBanSiID, A.SoCT, A.NgayCT, A.SoHD, A.NgayHD, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, B.SoLuong, N.VatTuNhomID, L.VatTuLoaiID, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206) THEN 'Khong' WHEN l.vattuloaiid IN (183) THEN 'Mu' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) 
         THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (203, 202, 201, 192, 193) THEN 'PTHN' WHEN l.vattuloaiid = 207 THEN 'Khoa' ELSE NULL END AS ChiTieu, 
         (CASE WHEN A.KhoHangXuatID = 1 THEN 725 WHEN A.KhoHangXuatID = 5 THEN 726 WHEN A.KhoHangXuatID = 9 THEN 727 WHEN A.KhoHangXuatID = 13 THEN 728 WHEN A.KhoHangXuatID = 17 THEN 729 WHEN A.KhoHangXuatID = 21 THEN 730 ELSE NULL END) AS KyThuatVien, B.ThanhTien AS TienHang, ROUND(A.TyLeCK * - (0.01 * B.ThanhTien * 0.001), 0) * 1000 AS TienHangTG, 
         ROUND((B.ThanhTien - A.TyLeCK * 0.01 * B.ThanhTien) * 0.001, 0) * 1000 AS ThanhTienVatTu, B.TienVon, KhachHangNhom.MaKhachHangNhom
FROM  DVBanSi AS A INNER JOIN
         DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
         VatTuLoai AS N ON L.VatTuLoaiID = N.ID INNER JOIN
         KhachHang ON A.KhachHangID = KhachHang.ID INNER JOIN
         KhachHangNhom ON KhachHang.KhachHangNhomID = KhachHangNhom.ID)  
[2024-07-18 11:08:26] local.ERROR: Error creating view L_VatTu_XuatKMDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.vattuloai' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatKMDV` AS SELECT   KM.DVBanLeID, BL.KhoHangXuatID, KM.NgayXuat, KM.SoLuong, KM.TienVon, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
                         THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) 
                         THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, KM.VatTuID
FROM         VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
                         DVBanLe AS BL INNER JOIN
                         DVBanLeKhuyenMai AS KM ON BL.ID = KM.DVBanLeID ON L.ID = KM.VatTuID)  
[2024-07-18 11:08:26] local.ERROR: Error creating view L_VatTu_XuatKMBH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.vattuloai' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatKMBH` AS SELECT        KM.XeBanLeID, BL.KhoHangXuatID, KM.NgayXuat, KM.VatTuID, KM.SoLuong, KM.TienVon, KM.ThanhTien, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
                         THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) 
                         THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL END AS ChiTieu, BL.XeID, BL.TuVanID
FROM            VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
                         XeBanLeKhuyenMai AS KM INNER JOIN
                         XeBanLe AS BL ON KM.XeBanLeID = BL.ID ON L.ID = KM.VatTuID
WHERE        (NOT (KM.NgayXuat IS NULL)))  
[2024-07-18 11:08:26] local.ERROR: Error creating view L_VatTu_XuatKhac on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvxuatkhac' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatKhac` AS SELECT   B.ID, B.DVXuatKhacID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.LyDoID, LD.TenLyDo, A.GhiChu, B.VatTuID, B.SoLuong, B.TienVon, CASE WHEN n.vattunhomid IN (1, 5) 
                         THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) 
                         THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL 
                         END AS ChiTieu
FROM         DVXuatKhac AS A INNER JOIN
                         DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
                         DVXuatKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
                         VatTuLoai AS N ON L.VatTuLoaiID = N.ID)  
[2024-07-18 11:08:26] local.ERROR: Error creating view L_VatTu_XuatDoiDonVi on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.doidonvi' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatDoiDonVi` AS SELECT   A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID AS VatTuXuatID, A.SoLuong AS TongSoLuongXuat, A.ThanhTien AS TongThanhTienXuat, CASE WHEN n.vattunhomid IN (1, 5) 
                         THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) 
                         THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) THEN 'BD' ELSE NULL 
                         END AS ChiTieu
FROM         DoiDonVi AS A INNER JOIN
                         VatTuLoai AS N INNER JOIN
                         VatTu AS L ON N.ID = L.VatTuLoaiID ON A.VatTuID = L.ID)  
[2024-07-18 11:08:27] local.ERROR: Error creating view L_VatTu_XuatChuyen on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.xenoibophukien' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatChuyen` AS SELECT B.ID, B.XeNoiBoID AS NoiBoID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhoHangNhapID, PK.VatTuID, PK.SoLuong, PK.TienVon AS ThanhTienVonVatTu, 'PK' AS ChiTieu
FROM   XeNoiBoPhuKien AS PK INNER JOIN
             XeNoiBoChiTiet AS B ON PK.XeNoiBoChiTietID = B.ID INNER JOIN
             XeNoiBo AS A ON B.XeNoiBoID = A.ID
WHERE (A.IsXacNhan = 1)
UNION ALL
SELECT B.ID, B.DVNoiBoID AS NoiBoID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhoHangNhapID, B.VatTuID, B.SoLuong, B.ThanhTien AS ThanhTienVonVatTu, CASE WHEN n.vattunhomid IN (1, 5) THEN 'PT' WHEN l.vattuloaiid IN (182, 188, 190, 194, 205, 206, 183) 
             THEN 'Khac' WHEN l.vattuloaiid IN (184, 195, 196, 197, 198, 199, 200, 204) THEN 'Nhot' WHEN l.vattuloaiid IN (181, 187, 191) THEN 'PK' WHEN l.vattuloaiid IN (192, 193) THEN 'PTHN' WHEN l.vattuloaiid IN (201) THEN 'Nano' WHEN l.vattuloaiid IN (202) THEN 'KP' WHEN l.vattuloaiid IN (203) 
             THEN 'BD' ELSE NULL END AS ChiTieu
FROM   VatTuLoai AS N INNER JOIN
             VatTu AS L ON N.ID = L.VatTuLoaiID INNER JOIN
             DVNoiBo AS A INNER JOIN
             DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON L.ID = B.VatTuID
WHERE (A.IsXacNhan = 1))  
[2024-07-18 11:08:27] local.ERROR: Error creating view L_VatTu_XuatBanDV_All on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanle' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_All` AS SELECT   B.ID, B.DVBanLeID, A.SoCT, A.NgayCT, L.VatTuNhomID, V.VatTuLoaiID, A.KhoHangXuatID, B.NgayXuat, B.VatTuID, B.SoLuong, B.DonGia, B.DonGiaTG, 
                         B.DonGia * B.SoLuong AS TienHang, IFNULL(B.DonGiaTG, 0) * B.SoLuong AS TienHangTG, B.ThanhTien AS ThanhTienVatTu, B.TienVon, B.IsMuaVe, B.BaoHanhID, B.MaBCKT, B.MaKNBH,
                          B.TinhTrangBaoHanh, B.NgayHVNThanhToan, B.TienHVNThanhToan, B.GhiChuBaoHanh, CASE WHEN V.vattuloaiid IN (181, 187, 191) OR
                         b.ismuave = 1 THEN k.kythuatvienid ELSE a.kythuatvien END AS KyThuatVien, L.ChiTieu
FROM         DVBanLe AS A INNER JOIN
                         DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE     (B.SoLuong <> 0))  
[2024-07-18 11:08:27] local.ERROR: Error creating view L_VatTu_XuatBanDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.l_vattu_xuatbandv_all' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV` AS SELECT   ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, TienVon, 
                         IsMuaVe, BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM         L_VatTu_XuatBanDV_All
WHERE     (BaoHanhID = 0) AND (KyThuatVien IS NOT NULL) AND (NgayXuat IS NOT NULL))  
[2024-07-18 11:08:27] local.ERROR: Error creating view L_VatTu_XuatBanDV_Master2 on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.l_vattu_xuatbandv' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_Master2` AS SELECT ID, DVBanLeID, KhoHangXuatID, NgayXuat, VatTuID, KyThuatVien, TienVon, ChiTieu
FROM   L_VatTu_XuatBanDV)  
[2024-07-18 11:08:27] local.ERROR: Error creating view L_VatTu_XuatBanDV_Master1 on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.l_vattu_xuatbandv' doesn't exist (SQL: CREATE VIEW `L_VatTu_XuatBanDV_Master1` AS SELECT   ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, IsMuaVe, 
                         BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM         L_VatTu_XuatBanDV)  
[2024-07-18 11:08:27] local.ERROR: Error creating view L_VatTu_BaoHanh on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.l_vattu_xuatbandv_all' doesn't exist (SQL: CREATE VIEW `L_VatTu_BaoHanh` AS SELECT        ID, DVBanLeID, SoCT, NgayCT, VatTuNhomID, VatTuLoaiID, ChiTieu, KhoHangXuatID, NgayXuat, VatTuID, SoLuong, DonGia, DonGiaTG, TienHang, TienHangTG, ThanhTienVatTu, TienVon, IsMuaVe, BaoHanhID, MaBCKT, 
                         MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh, KyThuatVien
FROM            L_VatTu_XuatBanDV_All
WHERE        (BaoHanhID <> 0))  
[2024-07-18 11:08:28] local.ERROR: Error creating view B_DV_VatTu_XuatBanCH_All on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanle' doesn't exist (SQL: CREATE VIEW `B_DV_VatTu_XuatBanCH_All` AS SELECT        B.ID, B.DVBanLeID, A.SoCT, A.NgayCT, B.NgayXuat, A.KhoHangXuatID, B.VatTuID, A.KyThuatVien, CASE WHEN V.vattuloaiid IN (181, 187, 191) OR
                         B.Ismuave = 1 THEN k.kythuatvienid ELSE a.kythuatvien END AS NVTinhThuong, CASE WHEN B.ngayxuat >= '2021-01-22' THEN A.kiemtracuoi WHEN (B.ngayxuat < '2021-01-22' AND A.nguoimoinano IS NULL) 
                         THEN A.kiemtracuoi ELSE A.nguoimoinano END AS KiemTraCuoi, L.ChiTieu, A.XeSuaChuaID, A.KhachHangID, CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, S.SoKhung, S.SoMay, S.BienSo, 
                         'XuatBanCH' AS NghiepVu, B.SoLuong AS SL, IFNULL(B.DonGiaTG, 0) * B.SoLuong AS TG, B.ThanhTien AS DT, B.TienVon AS GV, B.IsMuaVe, B.BaoHanhID, B.MaBCKT, B.MaKNBH, B.TinhTrangBaoHanh, B.NgayHVNThanhToan, 
                         B.TienHVNThanhToan, B.GhiChuBaoHanh, CASE WHEN B.TuVanID IS NOT NULL THEN B.TuVanID ELSE CASE WHEN V.IsTinhThuong = 0 THEN A.KiemTraCuoi ELSE NULL END END AS TuVanID
FROM            DVBanLe AS A INNER JOIN
                         DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID INNER JOIN
                         XeSuaChua AS S ON A.XeSuaChuaID = S.ID
WHERE        (B.SoLuong <> 0))  
[2024-07-18 11:08:28] local.ERROR: Error creating view A_DV_VatTu_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.b_dv_vattu_xuatbanch_all' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_XuatBanCH` AS SELECT        ID, DVBanLeID, SoCT, NgayCT, NgayXuat, KhoHangXuatID, VatTuID, KyThuatVien, NVTinhThuong, TuVanID, NghiepVu, ChiTieu, XeSuaChuaID, KhachHangID, XeID, SoKhung, SoMay, BienSo, SL, TG, DT, GV, IsMuaVe, 
                         BaoHanhID, MaBCKT, MaKNBH, TinhTrangBaoHanh, NgayHVNThanhToan, TienHVNThanhToan, GhiChuBaoHanh
FROM            B_DV_VatTu_XuatBanCH_All
WHERE        (NgayXuat >= '2019-12-19') AND (KyThuatVien IS NOT NULL) AND (TuVanID IS NOT NULL))  
[2024-07-18 11:08:28] local.ERROR: Error creating view A_DV_VatTu_XuatChuyenKhacDDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khohang' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_XuatChuyenKhacDDV` AS SELECT        B.ID, B.DVNoiBoID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, 'XuatChuyen' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            KhoHang AS K INNER JOIN
                         DVNoiBo AS A INNER JOIN
                         DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON K.ID = A.KhoHangXuatID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.IsXacNhan = 1) AND (K.KhoHangLoaiID = 2) AND (B.SoLuong <> 0) AND a.ngayct >= '2019-12-19'
UNION ALL
SELECT        A.ID, A.ID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, 'XuatDoiDonVi' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, A.SoLuong AS SL, A.ThanhTien AS GV
FROM            DoiDonVi AS A INNER JOIN
                         VatTu AS V ON A.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.NgayCT >= '2019-12-19')
UNION ALL
SELECT        B.ID, B.DVXuatKhacID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, 'XuatKhac' AS NghiepVu, L.ChiTieu, LD.TenLyDo, B.SoLuong AS SL, B.TienVon AS GV
FROM            DVXuatKhac AS A INNER JOIN
                         DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
                         DVXuatKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        (B.SoLuong <> 0) AND (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2))  
[2024-07-18 11:08:28] local.ERROR: Error creating view A_DV_VatTu_XuatBanMVSi on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbansi' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_XuatBanMVSi` AS SELECT        B.ID, B.DVBanSiID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, 3580 as XeID, B.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'XuatBanMV' AS NghiepVu, B.SoLuong AS SL, B.TyLeCK, B.ThanhTien AS DT, 
                         B.TienVon AS GV
FROM            DVBanSi AS A INNER JOIN
                         DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2)
UNION ALL
SELECT        B.ID, B.DVBanBuonID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, 3580 as XeID, B.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'XuatBanSi' AS NghiepVu, B.SoLuong AS SL, IFNULL(B.HeSo, 0) AS TyLeCK, 
                         B.ThanhTien AS DT, B.TienVon AS GV
FROM            DVBanBuon AS A INNER JOIN
                         DVBanBuonVatTu AS B ON A.ID = B.DVBanBuonID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangXuatID = K.ID
WHERE        a.ngayct >= '2019-12-19')  
[2024-07-18 11:08:28] local.ERROR: Error creating view A_DV_VatTu_NhapTraMVSi on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.vattuloai' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_NhapTraMVSi` AS SELECT        T .ID, A.DVBanSiID AS PhieuBanID, T .DVNhapTraLaiBanSiID AS PhieuTraLaiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, S.KhachHangID,3580 as XeID, T .VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 'NhapTraMV' AS NghiepVu, 
                         A.LyDo, T .SoLuong AS SL, T .ThanhTien AS DT, SVT.TienVon AS GV
FROM            VatTuLoai AS L INNER JOIN
                         VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
                         DVNhapTraLaiBanSi AS A INNER JOIN
                         DVNhapTraLaiBanSiChiTiet AS T ON A.ID = T .DVNhapTraLaiBanSiID ON V.ID = T .VatTuID INNER JOIN
                         DVBanSi AS S ON A.DVBanSiID = S.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID INNER JOIN
                         DVBanSiVatTu AS SVT ON T .VatTuID = SVT.VatTuID AND T .DVBanSiID = SVT.DVBanSiID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2)
UNION ALL
SELECT        TL.ID, A.DVBanBuonID AS PhieuBanID, TL.DVNhapTraLaiBanBuonID AS PhieuTraLaiID, A.SoCT, A.NgayCT, A.KhoHangNhapID, BS.KhachHangID,3580 as XeID, TL.VatTuID, L.ChiTieu, K.KyThuatVienID AS NVTinhThuong, 
                         'NhapTraSi' AS NghiepVu, A.LyDo, TL.SoLuong AS SL, TL.ThanhTien AS DT, BSVT.TienVon AS GV
FROM            DVNhapTraLaiBanBuon AS A INNER JOIN
                         DVBanBuon AS BS ON A.DVBanBuonID = BS.ID INNER JOIN
                         DVNhapTraLaiBanBuonChiTiet AS TL ON A.ID = TL.DVNhapTraLaiBanBuonID INNER JOIN
                         VatTuLoai AS L INNER JOIN
                         VatTu AS V ON L.ID = V.VatTuLoaiID ON TL.VatTuID = V.ID INNER JOIN
                         DVBanBuonVatTu AS BSVT ON TL.DVBanBuonID = BSVT.DVBanBuonID AND TL.VatTuID = BSVT.VatTuID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID
WHERE        a.ngayct >= '2019-12-19')  
[2024-07-18 11:08:29] local.ERROR: Error creating view A_DV_VatTu_NhapChuyenKhacDDV on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.khohang' doesn't exist (SQL: CREATE VIEW `A_DV_VatTu_NhapChuyenKhacDDV` AS SELECT        B.ID, B.DVNoiBoID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, 'NhapChuyen' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            KhoHang AS K INNER JOIN
                         DVNoiBo AS A INNER JOIN
                         DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID ON K.ID = A.KhoHangXuatID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        (A.IsXacNhan = 1) AND (K.KhoHangLoaiID = 2) AND a.ngayct >= '2019-12-19'
UNION ALL
SELECT        B.ID, B.DoiDonViID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangID AS KhoHangNhapID, B.VatTuID, 'NhapDoiDonVi' AS NghiepVu, L.ChiTieu, '0' AS TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            DoiDonVi AS A INNER JOIN
                         DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID
WHERE        a.ngayct >= '2019-12-19'
UNION ALL
SELECT        B.ID, B.DVNhapKhacID AS PhieuID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, 'NhapKhac' AS NghiepVu, L.ChiTieu, LD.TenLyDo, B.SoLuong AS SL, B.ThanhTien AS GV
FROM            DVNhapKhac AS A INNER JOIN
                         DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID INNER JOIN
                         DVNhapKhacLyDo AS LD ON A.LyDoID = LD.ID INNER JOIN
                         VatTu AS V ON B.VatTuID = V.ID INNER JOIN
                         VatTuLoai AS L ON V.VatTuLoaiID = L.ID INNER JOIN
                         KhoHang AS K ON A.KhoHangNhapID = K.ID
WHERE        (A.NgayCT >= '2019-12-19') AND (K.KhoHangLoaiID = 2))  
[2024-07-18 11:08:29] local.ERROR: Error creating view B_DV_Phieu_XuatBanCH_All on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanle' doesn't exist (SQL: CREATE VIEW `B_DV_Phieu_XuatBanCH_All` AS SELECT        BL.ID, BL.SoCT, BL.NgayCT, BL.CreatedAt, CAST(REPLACE(DATE_FORMAT(BL.CreatedAt, '%H:%i'), ':', '') AS SIGNED) AS GioTaoPhieu, BL.ThoiGianTraXeThucTe, BL.KhoHangXuatID, BL.KhachHangID, 'XuatBanCH' AS NghiepVu, 
                         S.SoKhung, S.SoMay, S.BienSo, BL.NgayMua, S.TenModel, BL.Km, BL.KyThuatVien, CASE WHEN bl.ngayct < '2021-01-22' AND bl.nguoimoinano IS NOT NULL THEN bl.nguoimoinano ELSE bl.kiemtracuoi END AS KiemTraCuoi, 
                         BL.KiemTraDinhKy, BL.IsBaoDuongToanBo, CAST(BL.IsThayNhot AS SIGNED) AS IsNhot, CAST(BL.IsVeSinhKimPhun AS SIGNED) AS IsKP, CAST(BL.IsVeSinhBuongDot AS SIGNED) AS IsBD, BL.IsLamNano, BL.IsLapPhuKien, 
                         BL.IsLapKhoaChongChom, BL.IsMuaVe, CAST(BL.IsBaoHanhHVN AS SIGNED) AS IsBHHVN, CAST(BL.IsBaoHanhThienChi AS SIGNED) AS IsBHTC, CAST(BL.IsBaoHanhLuuDong AS SIGNED) AS IsSCLD, BL.TongThanhTien, 
                         BL.TongThanhTienTraLai, BL.KhaoSatDiem
FROM            DVBanLe AS BL LEFT OUTER JOIN
                         XeSuaChua AS S ON BL.XeSuaChuaID = S.ID)  
[2024-07-18 11:08:29] local.ERROR: Error creating view A_DV_GC_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanle' doesn't exist (SQL: CREATE VIEW `A_DV_GC_XuatBanCH` AS SELECT        GC.ID, GC.DVBanLeID, BL.SoCT, BL.NgayCT, GC.NgayGC, BL.KhoHangXuatID, GC.KhachHangID AS DoiTacGC, CASE WHEN GC.GiaCongBy IS NULL THEN bl.kythuatvien ELSE gc.giacongby END AS NhanVienGC, 
                         CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, S.Model2, 'XuatBanCH' AS NghiepVu, 'GC' AS ChiTieu, GC.GiaCongID, GC.GiaBan AS DT, GC.ChiPhi AS GV
FROM            DVBanLe AS BL INNER JOIN
                         DVBanLeGiaCong AS GC ON BL.ID = GC.DVBanLeID INNER JOIN
                         XeSuaChua AS S ON BL.XeSuaChuaID = S.ID
WHERE        (BL.KyThuatVien IS NOT NULL))  
[2024-07-18 11:08:29] local.ERROR: Error creating view B_DV_Phieu_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.b_dv_phieu_xuatbanch_all' doesn't exist (SQL: CREATE VIEW `B_DV_Phieu_LoaiPhieu` AS 
                    SELECT NgayCT, KhoHangXuatID, 'kiemtradinhky' AS LoaiPhieu, kiemtradinhky AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND kiemtradinhky <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsNhot' AS LoaiPhieu, IsNhot AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsNhot <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsKP' AS LoaiPhieu, IsKP AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsKP <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBD' AS LoaiPhieu, IsBD AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBD <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBHHVN' AS LoaiPhieu, IsBHHVN AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBHHVN <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsBHTC' AS LoaiPhieu, IsBHTC AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsBHTC <> 0
                    UNION ALL
                    SELECT NgayCT, KhoHangXuatID, 'IsSCLD' AS LoaiPhieu, IsSCLD AS SL
                    FROM B_DV_Phieu_XuatBanCH_All
                    WHERE kythuatvien IS NOT NULL AND kiemtracuoi IS NOT NULL AND IsSCLD <> 0
                )  
[2024-07-18 11:08:29] local.ERROR: Error creating view A_DV_LoaiPhieu on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.b_dv_phieu_loaiphieu' doesn't exist (SQL: CREATE VIEW `A_DV_LoaiPhieu` AS SELECT    NgayCT, KhoHangXuatID, REPLACE(LoaiPhieu, 'KiemTraDinhKy', 'IsKTDK') AS LoaiPhieu, COUNT(SL) AS SL
FROM         B_DV_Phieu_LoaiPhieu
GROUP BY NgayCT, KhoHangXuatID, LoaiPhieu
ORDER BY NgayCT)  
[2024-07-18 11:08:29] local.ERROR: Error creating view A_DV_Phieu_XuatBanCH on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.b_dv_phieu_xuatbanch_all' doesn't exist (SQL: CREATE VIEW `A_DV_Phieu_XuatBanCH` AS SELECT        ID, SoCT, NgayCT, CreatedAt, GioTaoPhieu, ThoiGianTraXeThucTe, KhoHangXuatID, KhachHangID, NghiepVu, SoKhung, SoMay, BienSo, NgayMua, TenModel, Km, KyThuatVien, KiemTraCuoi, KiemTraDinhKy, IsNhot, 
                         TongThanhTien, TongThanhTienTraLai, KhaoSatDiem
FROM            B_DV_Phieu_XuatBanCH_All
WHERE        (KyThuatVien IS NOT NULL) AND (KiemTraCuoi IS NOT NULL))  
[2024-07-18 11:08:30] local.ERROR: Error creating view L_NanoDV_XuatBanLe_Moi on retry: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'quoctien_motor_db.dvbanlevattu' doesn't exist (SQL: CREATE VIEW `L_NanoDV_XuatBanLe_Moi` AS SELECT        B.ID, A.ID AS IDPhieu, A.SoCT, B.NgayXuat, L.VatTuLoaiID, B.ThanhTien, A.KhoHangXuatID, B.SoLuong, CASE WHEN S.XeID IS NULL THEN 3580 ELSE S.XeID END AS XeID, 
                         CASE WHEN b.ngayxuat < '2021-01-22' THEN a.nguoimoinano ELSE a.kiemtracuoi END AS KiemTraCuoi
FROM            DVBanLeVatTu AS B INNER JOIN
                         VatTu AS L ON B.VatTuID = L.ID INNER JOIN
                         DVBanLe AS A ON B.DVBanLeID = A.ID INNER JOIN
                         XeSuaChua AS S ON A.XeSuaChuaID = S.ID
WHERE        (L.VatTuLoaiID = 201) AND (A.NguoiMoiNano IS NOT NULL) AND (B.ThanhTien > 0) AND (B.NgayXuat < '2021-01-22') OR
                         (L.VatTuLoaiID = 201) AND (B.ThanhTien > 0) AND (A.KiemTraCuoi IS NOT NULL) AND (B.NgayXuat >= '2021-01-22'))  
