[2024-07-18 16:06:59] local.ERROR: Error creating stored procedure SP_VT_XUATBANBUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANBUON]
      INT,
	  VARCHAR(...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANBUON]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanBuon AS  INNER JOIN
            DVBanBuonVatTu AS  ON A.ID = B.DVBanBuonID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:06:59] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC_TONGHOP]     
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC_TONGHOP]     
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeXuatKhac AS  INNER JOIN
			XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay)		
END;
//
DELIMITER ;)  
[2024-07-18 16:06:59] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeXuatKhac AS  INNER JOIN
			XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_BANGGIA2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_BANGGIA2]
      nvarchar(20),
	  in...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_BANGGIA2]
      nvarchar(20),
	  int,
	  nvarchar(50)
AS   nvarchar(30)

	
	SELECT		@TenModel = X.TenModel FROM XeNhapMua AS  INNER JOIN Xe AS  ON M.XeID = X.ID INNER JOIN V_XeThayVanh AS  ON M.ID = TV.XeNhapMuaID 
	WHERE		TV.XeNhapMuaID =  GROUP BY	X.TenModel	

	
	Declare  Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT  MAX(B.ID) AS , B.XeID
			FROM    XeBangGia AS  INNER JOIN
                    XeBangGiaChiTiet AS  ON A.ID = B.XeBangGiaID INNER JOIN
                    Xe AS  ON B.XeID = X.ID
			WHERE   (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive = 1) AND (X.TenModel = @TenModel) AND (X.TenType = @TenType)
			GROUP BY B.XeID, X.TenModel, X.TenType

	
	SELECT TOP (1) X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	FROM   XeBangGia AS  INNER JOIN
           XeBangGiaChiTiet AS  ON B.ID = C.XeBangGiaID INNER JOIN
            AS  ON C.ID = V.MaxID INNER JOIN
           Xe AS  ON C.XeID = X.ID	
	GROUP BY X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	ORDER BY C.GiaHaiQuan DESC
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_XUATKMDV: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMDV]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMDV]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS , B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            DVBanLe AS  INNER JOIN
            DVBanLeKhuyenMai AS  ON A.ID = B.DVBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure dt_setpropertybyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_setpropertybyid]
	 int,
	 varchar(64)...' at line 1 (SQL: DELIMITER //

create   procedure [dt_setpropertybyid]
	 int,
	 varchar(64),
	 varchar(255),
	 image
AS   nvarchar(255) 
	set @uvalue = convert(nvarchar(255), @value) 
	if exists (select * from dtproperties 
			where objectid= and property=@property)
	AS  dtproperties set value=@value, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid= and property= END;
	else
	AS  dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @value, @uvalue, @lvalue)
	END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure dt_getpropertiesbyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getpropertiesbyid_u]
	 int,
	 varchar...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getpropertiesbyid_u]
	 int,
	 varchar(64)
AS  ( is null) or (@property = '')
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure dt_getpropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getpropertiesbyid]
	 int,
	 varchar(6...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getpropertiesbyid]
	 int,
	 varchar(64)
AS  ( is null) or (@property = '')
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure dt_getobjwithprop_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getobjwithprop_u]
	 varchar(30),
	 nv...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getobjwithprop_u]
	 varchar(30),
	 nvarchar(255)
AS  ( is null) or (@property = '')
	AS ('Must specify a property name.',-1,-1)
		return (1)
	END;

	if ( is null)
		select objectid id from dtproperties
			where property= else
		select objectid id from dtproperties
			where property= and uvalue=@uvalue
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure dt_getobjwithprop: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getobjwithprop]
	 varchar(30),
	 varc...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getobjwithprop]
	 varchar(30),
	 varchar(255)
AS  ( is null) or (@property = '')
	AS ('Must specify a property name.',-1,-1)
		return (1)
	END;

	if ( is null)
		select objectid id from dtproperties
			where property= else
		select objectid id from dtproperties
			where property= and value=@value
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure dt_generateansiname: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
 
CREATE PROCEDURE `` () output) 
AS   varchar(20) 
	declare ...' at line 1 (SQL: DELIMITER //
 
CREATE PROCEDURE `` () output) 
AS   varchar(20) 
	declare  varchar(20) 
	declare  integer 
 
	set @prologue = 'MSDT-A-' 
	set @index = 1 
 
	while 1 = 1 
	AS  @indexstring = cast( AS (20)) 
		set @name = @prologue +  if not exists (select value from dtproperties where value = @name) 
			break 
		 
		set @index = @index + 1 
 
		if (@index = 10000) 
			goto TooMany 
	END; 
 
Leave: 
 
	return 
 
TooMany: 
 
	set @name = 'DIAGRAM' 
	goto Leave
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure dt_setpropertybyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_setpropertybyid_u]
	 int,
	 varchar(6...' at line 1 (SQL: DELIMITER //

create   procedure [dt_setpropertybyid_u]
	 int,
	 varchar(64),
	 nvarchar(255),
	 image
AS   varchar(255) 
	set @avalue = null 
	if ( is not null) 
	AS  (convert(nvarchar(255), convert(varchar(255), @uvalue)) = @uvalue) 
		AS  @avalue = convert(varchar(255), @uvalue) 
		END; 
		else 
		AS  'DtgSchemaNAME' =  AS  dt_generateansiname  output 
			END; 
		END; 
	END; 
	if exists (select * from dtproperties 
			where objectid= and property=@property)
	AS  dtproperties set value=@avalue, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid= and property= END;
	else
	AS  dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @avalue, @uvalue, @lvalue)
	END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_Old]
      INT,
	  VARC...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_Old]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS  INNER JOIN
            XePhuKienChiTiet AS  ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 1) AND (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure dt_dropuserobjectbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_dropuserobjectbyid]
	 int
AS  from dt...' at line 1 (SQL: DELIMITER //

create   procedure [dt_dropuserobjectbyid]
	 int
AS  from dtproperties where objectid=@id
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN]
      INT,
	  VARCHAR(...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS  INNER JOIN
            XePhuKienChiTiet AS  ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 0) AND (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure dt_droppropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_droppropertiesbyid]
	 int,
	 varchar(...' at line 1 (SQL: DELIMITER //

create   procedure [dt_droppropertiesbyid]
	 int,
	 varchar(64)
AS  ( is null) or (@property = '')
		delete from dtproperties where objectid= else
		delete from dtproperties 
			where objectid= and property=@property
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure dt_adduserobject: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_adduserobject]
AS 
		insert dtpropert...' at line 1 (SQL: DELIMITER //

create   procedure [dt_adduserobject]
AS 
		insert dtproperties (property) VALUES ('DtgSchemaOBJECT')
		update dtproperties set objectid=@ where id=@ and property='DtgSchemaOBJECT'
	commit
	return @@identity
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKHAC]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKHAC]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVXuatKhac AS  INNER JOIN
			DVXuatKhacVatTu AS  ON A.ID = B.DVXuatKhacID INNER JOIN
			VatTu AS  ON B.VatTuID = V.ID INNER JOIN
			VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_XUATDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATDOIDONVI]
      INT,
	  VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATDOIDONVI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, A.SoLuong, A.DonGia, A.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS  INNER JOIN
            VatTu AS  ON A.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_BANGGIA]
      nvarchar(20)
AS   Tab...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_BANGGIA]
      nvarchar(20)
AS   Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT Max(B.ID) AS , B.XeID
			FROM   XeBangGia AS  INNER JOIN
				   XeBangGiaChiTiet AS  ON A.ID = B.XeBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive =1)
			GROUP BY B.XeID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.XeID, C.SoKhung, C.SoMay, X.MaXe, X.TenXe, X.SortDoiXe, X.SortLoaiXe, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, c.GiaApThue
	FROM   XeBangGia AS  INNER JOIN
           XeBangGiaChiTiet AS  ON B.ID = C.XeBangGiaID INNER JOIN
            AS  ON C.ID = V.MaxID INNER JOIN
           Xe AS  ON C.XeID = X.ID	
	ORDER BY X.SortDoiXe
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON2]
	  VARCHAR(10),	 
 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON2]
	  VARCHAR(10),	 
      VARCHAR(10)	 
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare  Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	
	FROM (
		
		SELECT	1 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	2 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	3 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	5 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	6 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  8 AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  9 AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)		
		UNION ALL
		
		SELECT	10 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	11 AS , B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanLe AS  INNER JOIN
				DVBanLeVatTu AS  ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	12 AS , B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanSi AS  INNER JOIN
				DVBanSiVatTu AS  ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON]
	  VARCHAR(10),	 
  ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON]
	  VARCHAR(10),	 
      VARCHAR(10)	 
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare  Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanLe AS  INNER JOIN
				DVBanLeVatTu AS  ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS ,
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_TONDAU_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU_ALL]
      INT,
      VARCHA...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU_ALL]
      INT,
      VARCHAR(10)
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'	

	SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	'N01' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N02' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N03' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N04' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNoiBo AS  INNER JOIN
				DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT	'N05' AS , A.KhoHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID)
		UNION ALL
		
		SELECT	'N06' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT  'N07' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNoiBo AS  INNER JOIN
                XeNoiBoPhuKien AS  ON A.ID = B.XeNoiBoID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT  'N08' AS , A.KhoHangXuatID AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON A.ID = B.XeBanLeID INNER JOIN
				Va
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO_ALL_TEST]
      int,
      nv...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO_ALL_TEST]
      int,
      nvarchar(10)
AS   Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert  Exec SP_VT_TONDAU_ALL @KhoHangID,  SELECT A.KhoHangID AS , A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, V.VatTuLoaiID, L.VatTuNhomID, A.TDSLNhap, A.TDSLXuat, (A.TDSLNhap - A.TDSLXuat) AS 
	FROM  AS  INNER JOIN
			VatTu AS  ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) < 0
	order by  A.VatTuID

	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_XUATNOIBO]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_XUATNOIBO]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeNoiBo AS  INNER JOIN
			XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.IsXacNhan=1)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_VT_TONKHO_ALL]
      int,
      nvarcha...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_VT_TONKHO_ALL]
      int,
      nvarchar(10)
AS   Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert  Exec SP_VT_TONDAU_ALL @KhoHangID,  SELECT A.KhoHangID AS , A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS 
	FROM  AS  INNER JOIN
			VatTu AS  ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPNOIBO]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPNOIBO]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeNoiBo AS  INNER JOIN
			XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU]
      INT,
      VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU]
      INT,
      VARCHAR(10),	 
	  INT,
	  VARCHAR(1),
	  INT
AS   VARCHAR(10), 
		 INT,  INT,  INT,  INT,  INT,  INT, 
		 INT,  INT,  INT,  INT,  INT,  INT
	SET @NgayBatDauSuDung = '2019-12-19'
	SET @DVBanLeID = 0 	
	SET @DVBanSiID = 0
	SET @DVNoiBoID = 0
	SET @DoiDonViID = 0
	SET @DVXuatKhacID = 0
	SET @XeBanLeKMID = 0
	SET @DVBanLeKMID = 0
	SET @XePhuKienID = 0
	SET @XePhuKienNoiBoID = 0
	SET @DVBanBuonID = 0
	SET @XeBanSiKMID = 0
	SET @XeBanLeBHID = 0

	IF(@MaTacNghiep ='I')			SET @DVBanLeID =  ELSE IF(@MaTacNghiep='J')		SET @DVBanSiID =  ELSE IF(@MaTacNghiep='K')		SET @DVNoiBoID =  ELSE IF(@MaTacNghiep='L')		SET @DoiDonViID =  ELSE IF(@MaTacNghiep='M')		SET @DVXuatKhacID =  ELSE IF(@MaTacNghiep='N')		SET @XeBanLeKMID =  ELSE IF(@MaTacNghiep='O')		SET @DVBanLeKMID =  ELSE IF(@MaTacNghiep='P')		SET @XePhuKienID =  ELSE IF(@MaTacNghiep='Q')		SET @XePhuKienNoiBoID =  ELSE IF(@MaTacNghiep='R')		SET @DVBanBuonID =  ELSE IF(@MaTacNghiep='S')		SET @XeBanSiKMID =  ELSE IF(@MaTacNghiep='T')		SET @XeBanLeBHID =  SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	'N01' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNoiBo AS  INNER JOIN
				DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS , A.KhoHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATNOIBO]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATNOIBO]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS  INNER JOIN
            DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO]
      INT,
      nvarchar(10...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO]
      INT,
      nvarchar(10),
	  INT,
	  VARCHAR(1),
	  INT
AS   Table (KhoHangID INT, VatTuID INT, TDSLNhap INT, TDTienNhap FLOAT, TDSLXuat INT, TDTienXuat FLOAT)
	INSERT  Exec SP_VT_TONDAU @KhoHangID, @DenNgay, @VatTuID, @MaTacNghiep,  SELECT A.KhoHangID AS , A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS 
	FROM  AS  INNER JOIN
			VatTu AS  ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPNOIBO]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPNOIBO]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS  INNER JOIN
            DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.IsXacNhan = 1) AND (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_SELECT_GIAVON_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_SELECT_GIAVON_TEST]
	  VARCHAR(10),	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_SELECT_GIAVON_TEST]
	  VARCHAR(10),	 
      VARCHAR(10)	 
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare  Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , (1 - A.TyLeCK*0.01) * B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, 1 AS , C.GiaBanBH AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLeBaoHiem AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanLe AS  INNER JOIN
				DVBanLeVatTu AS  ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanSi AS  INNER JOIN
				DVBanSiVatTu AS  ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT < @TuNgay)
		UNION ALL
		
		SELECT  VatTuID, 0 AS , 0 AS , SoLuong AS , ThanhTien AS 
		FROM    DoiDonVi AS     
	
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_NHAPXUAT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPXUAT]
      INT,
	  INT,
	  VA...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPXUAT]
      INT,
	  INT,
	  VARCHAR(10),	 
      VARCHAR(10)	 	 
AS  T.SoCT, T.NgayCT, T.NgayNXK, T.KhoHangNhapID, T.KhoHangXuatID, T.KhachHangID, T.VatTuID, T.SLNhap, T.SLXuat 
	FROM (
		
		SELECT	'N01' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , A.KhachHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , C.KhachHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
                DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
                DVBanLe AS  ON A.DVBanLeID = C.ID   
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , C.KhachHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
                DVBanSi AS  ON A.DVBanSiID = C.ID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, A.KhoHangXuatID, NULL AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNoiBo AS  INNER JOIN
				DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangID AS , NULL AS , NULL AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N06' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , NULL AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  'N07' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , NULL AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNoiBo AS  INNER JOIN
                XeNoiBoPhuKien AS  ON A.ID = B.XeNoiBoID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)		
		UNION ALL
		
		SELECT  'N08' AS , B.SoCT, B.NgayCT, B.NgayCT AS , A.KhoHangXuatID AS , NULL AS , a.KhachHangID, C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_NHAPDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPDOIDONVI]
      INT,
	  VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPDOIDONVI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS  INNER JOIN
            DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XECHUYENKHO]
      INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XECHUYENKHO]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS , B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS  INNER JOIN
            XeNoiBoPhuKien AS  ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_GET_GIAVON]
	  VARCHAR(10),	 
     ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_GET_GIAVON]
	  VARCHAR(10),	 
      VARCHAR(10),
	  int
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare  Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanLe AS  INNER JOIN
				DVBanLeVatTu AS  ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.Nga
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_XECHUYENKHO]
      INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_XECHUYENKHO]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID AS , B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS  INNER JOIN
            XeNoiBoPhuKien AS  ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan = 1)
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_DELETE_DUPLICATE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_DELETE_DUPLICATE]
	  int,	 
      i...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_DELETE_DUPLICATE]
	  int,	 
      int	 
AS  DoiDonVi						set VATTUID =  WHERE VATTUID =  update DoiDonViChiTiet				set VATTUID =  WHERE VATTUID =  update DVBanLeVatTu					set VATTUID =  WHERE VATTUID =  update DVBanSiVatTu					set VATTUID =  WHERE VATTUID =  update DVNhapKhacVatTu				set VATTUID =  WHERE VATTUID =  update DVNhapMuaVatTu				set VATTUID =  WHERE VATTUID =  update DVNhapTraLaiBanLeChiTiet		set VATTUID =  WHERE VATTUID =  update DVNhapTraLaiBanSiChiTiet		set VATTUID =  WHERE VATTUID =  update DVNoiBoVatTu					set VATTUID =  WHERE VATTUID =  update DVXuatKhacVatTu				set VATTUID =  WHERE VATTUID =  update VTBangGiaChiTiet				set VATTUID =  WHERE VATTUID =  update XeBanLeKhuyenMai				set VATTUID =  WHERE VATTUID =  update XeBanLePhuKien				set VATTUID =  WHERE VATTUID =  update XeNhapTraLaiBanLeKhuyenMai	set VATTUID =  WHERE VATTUID =  update XeNhapTraLaiBanLePhuKien		set VATTUID =  WHERE VATTUID =  update XeNoiBoPhuKien				set VATTUID =  WHERE VATTUID =  update XePhuKienChiTiet				set VATTUID =  WHERE VATTUID =  Delete VatTu where (ID = @VatTuID_DEL)

END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XEBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XEBANLE]
      INT,
	  ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XEBANLE]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS , B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, b.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeBanLe AS  INNER JOIN
            XeBanLePhuKien AS  ON A.ID = B.XeBanLeID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE   (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHLE]
      INT,
	  VARCHAR(1...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHLE]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS  INNER JOIN
            XeBanLeKhuyenMai AS  ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure dt_verstamp007: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_verstamp007]
AS  7005
//
DELIMITER' at line 1 (SQL: DELIMITER //

create   procedure [dt_verstamp007]
AS  7005
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_XUATKMBH_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBH_Old]
      INT,
	  VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBH_Old]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS  INNER JOIN
            XeBanLeKhuyenMai AS  ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure dt_verstamp006: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_verstamp006]
AS  7000
//
DELIMITER' at line 1 (SQL: DELIMITER //

create   procedure [dt_verstamp006]
AS  7000
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_XUATBAOHIEM_BHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBAOHIEM_BHLE]
      INT,
	  VAR...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBAOHIEM_BHLE]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, B.NgayXuat AS , A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, 1 AS , B.GiaBanBH, B.GiaBanBH AS , V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS  INNER JOIN
            XeBanLeBaoHiem AS  ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_TRALAI]
      INT,
	  V...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_TRALAI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.ID, B.SoCT, C.NgayNhap AS , A.KhoHangXuatID AS , C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS  INNER JOIN
            XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS  ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS  ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_NHAPKHUYENMAI_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHUYENMAI_TRALAI]
      INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHUYENMAI_TRALAI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.ID, B.SoCT, B.NgayCT, A.KhoHangXuatID AS , C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS  INNER JOIN
            XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS  ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS  ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRASI]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRASI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS 
	FROM XeBanSi AS  INNER JOIN
			XeNhapTraLaiBanSi AS  ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS  ON B.ID = C.XeNhapTraLaiBanSiID
	WHERE (B.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.XeNhapMuaID IS NOT NULL)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_NHAPBAOHIEM_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPBAOHIEM_TRALAI]
      INT,
	  V...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPBAOHIEM_TRALAI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.ID, B.SoCT, C.NgayNhap AS , A.KhoHangXuatID AS , C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, 1 AS , C.GiaBanBH AS , C.GiaBanBH AS , V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS  INNER JOIN
            XeNhapTraLaiBanLeBaoHiem AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS  ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS  ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRALE]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRALE]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanLe AS  INNER JOIN
            DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_TEST_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TEST_1]   
AS  count(ID) BEGIN 'VT' from...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TEST_1]   
AS  count(ID) BEGIN 'VT' from VatTu
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TEST]
      INT     
AS  * from VatTu w...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TEST]
      INT     
AS  * from VatTu where ID =  END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_DV_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_DV_BANGGIA]
      nvarchar(10),
	  nvar...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_DV_BANGGIA]
      nvarchar(10),
	  nvarchar(2)
AS   Table (MaxID int, DichVuID int)
	Insert @V_DV_BangGia_MaxID(MaxID, DichVuID) 
			SELECT Max(B.ID) AS , B.DichVuID
			FROM   DVBangGia AS  INNER JOIN
				   DVBangGiaChiTiet AS  ON A.ID = B.DVBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.CuaHangID = @CuaHangID)
			GROUP BY B.DichVuID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.DichVuID, V.MaDichVu, V.HangMuc, C.DonGia
	FROM   DVBangGia AS  INNER JOIN
           DVBangGiaChiTiet AS  ON B.ID = C.DVBangGiaID INNER JOIN
            AS  ON C.ID = M.MaxID INNER JOIN
           DichVu AS  ON C.DichVuID = V.ID	
	ORDER BY V.MaDichVu
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHSI]
      INT,
	  VARCHAR(1...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHSI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanSi AS  INNER JOIN
            XeBanSiKhuyenMai AS  ON A.ID = B.XeBanSiID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE[SP_VT_BANGGIA]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE[SP_VT_BANGGIA]
                                 nvarchar(10),
	                             nvarchar(2)
                            AS   Table(MaxID int, VatTuID int)
                                Insert @V_VT_BangGia_MaxID(MaxID, VatTuID)
                                        SELECT Max(B.ID) AS , B.VatTuID
                                        FROM   VTBangGia AS  CROSS APPLY STRING_SPLIT(CuaHangID, ',') INNER JOIN
                                               VTBangGiaChiTiet AS  ON A.ID = B.VTBangGiaID
                                        WHERE(A.ApDungTu <= @DenNgay) AND(A.ApDungDen >= @DenNgay) AND (value = @CuaHangID)
                                        GROUP BY B.VatTuID

                                SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.VatTuLoaiID, L.VatTuNhomID, C.GiaNhap, C.GiaXuat
                                FROM   VTBangGia AS  INNER JOIN
                                       VTBangGiaChiTiet AS  ON B.ID = C.VTBangGiaID INNER JOIN
                                        AS  ON C.ID = M.MaxID INNER JOIN
                                       VatTu AS  ON C.VatTuID = V.ID INNER JOIN
                                       VatTuLoai AS  ON V.VatTuLoaiID = L.ID
                            END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_NHAPKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHAC]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHAC]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapKhac AS  INNER JOIN
            DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI_TONGHOP]     
	  VARCHAR(1...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI_TONGHOP]     
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeBanSi AS  INNER JOIN
			XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay)		
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeBanSi AS  INNER JOIN
			XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_TONDAU]
      INT,
      VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_TONDAU]
      INT,
      VARCHAR(10),
	  INT,
	  INT,
	  INT,
	  INT
AS  T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS , SUM(T.SLXuat) AS 
	FROM (
		
		SELECT 'A' AS , KhoHangNhapID AS , XeID, ID AS , 1 AS , 0 AS  
		FROM XeNhapMua 
		WHERE (NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT 'B' AS , A.KhoHangNhapID AS , B.XeID, B.XeNhapMuaID, 1 AS , 0 AS 
		FROM XeNoiBo AS  INNER JOIN
				XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
		UNION ALL
		
		SELECT 'C' AS , A.KhoHangXuatID AS , A.XeID, A.XeNhapMuaID, 1 AS , 0 AS 
		FROM XeBanLe  AS  INNER JOIN
				XeNhapTraLaiBanLe  AS  ON A.ID = B.XeBanLeID    
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'D' AS , A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS , 0 AS 
		FROM XeBanSi AS  INNER JOIN
				XeNhapTraLaiBanSi AS  ON A.ID = B.XeBanSiID INNER JOIN
				XeNhapTraLaiBanSiChiTiet AS  ON B.ID = C.XeNhapTraLaiBanSiID
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
		UNION ALL
		
		SELECT 'E' AS , KhoHangXuatID AS , XeID, XeNhapMuaID, 0 AS , 1 AS 
		FROM XeBanLe     
		WHERE (NgayBan <= @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'F' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
		FROM XeBanSi AS  INNER JOIN
				XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeBanSiID)
		UNION ALL
		
		SELECT 'G' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
		FROM XeNoiBo AS  INNER JOIN
				XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeNoiBoID) 
		UNION ALL
		
		SELECT 'H' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
		FROM XeXuatKhac AS  INNER JOIN
				XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeXuatKhacID)
	) AS 
	GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID
END;


//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_TONKHO]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_TONKHO]
                                  int,
                                  nvarchar(10),
	                              INT,
	                              INT,
	                              INT,
	                              INT
                            AS   Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)
	                            Insert  Exec SP_XE_TONDAU @KhoHangID, @DenNgay, @XeBanLeID, @XeBanSiID, @XeNoiBoID,  SELECT A.KhoHangID, B.KhoHangNhapID, A.XeID, X.MaXe, X.TenXe, A.XeNhapMuaID, B.KhachHangID AS , B.DonGia_CoVAT, B.NgayCT, B.SoKhung, B.SoMay, B.MaChiaKhoa, (A.TDSLNhap - A.TDSLXuat) AS , B.GhiChu, B.MaChiaKhoa
	                            FROM  AS  INNER JOIN
			                            XeNhapMua AS  ON A.XeNhapMuaID = B.ID INNER JOIN
			                            Xe AS  ON A.XeID = X.ID 
	                            WHERE (A.TDSLNhap - A.TDSLXuat) <>0
                            END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_NHAPXUATTON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_NHAPXUATTON]
      int,
	  nvarchar(10)...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_NHAPXUATTON]
      int,
	  nvarchar(10),
      nvarchar(10)
AS   Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)

	declare  int,  int,  int
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0

	Insert  Exec SP_XE_TONDAU @KhoHangID, @TuNgay, @XeBanLeID, @XeBanSiID,  SELECT NXT.* FROM (
		SELECT 'T' AS , KhoHangID, XeID, XeNhapMuaID, (TDSLNhap - TDSLXuat) AS 
		FROM  UNION ALL
		SELECT 'B' AS , A.KhoHangNhapID AS , B.XeID, B.XeNhapMuaID, 1 AS 
		FROM XeNoiBo AS  INNER JOIN
			 XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
		WHERE A.NgayCT <  AND KhoHangNhapID = @KhoHangID   
	) AS  
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_LICHSU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_LICHSU]
      INT
AS  'A' AS , ID, ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_LICHSU]
      INT
AS  'A' AS , ID, KhoHangNhapID, Null AS , XeID, ID AS , SoCT, NgayCT, NULL AS , CreatedBy, SoKhung, SoMay 
	FROM XeNhapMua 
	WHERE (ID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'B' AS , A.ID, A.KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, NULL AS , A.CreatedBy, M.SoKhung, M.SoMay 
	FROM XeNoiBo AS  INNER JOIN
			XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID INNER JOIN
			XeNhapMua AS  ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'C' AS , B.ID, A.KhoHangXuatID AS , null AS , A.XeID, A.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS , B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe  AS  INNER JOIN
			XeNhapTraLaiBanLe  AS  ON A.ID = B.XeBanLeID INNER JOIN
			XeNhapMua AS  ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'D' AS , B.ID, A.KhoHangXuatID AS , null AS , C.XeID, C.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS , B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS  INNER JOIN
			XeNhapTraLaiBanSi AS  ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS  ON B.ID = C.XeNhapTraLaiBanSiID INNER JOIN
			XeNhapMua AS  ON C.XeNhapMuaID = M.ID
	WHERE (C.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'E' AS , A.ID, Null AS , A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe AS  INNER JOIN
			XeNhapMua AS  ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'F' AS , A.ID, Null AS , A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS , A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS  INNER JOIN
			XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapMua AS  ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'G' AS , A.ID, Null AS , A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS , A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeXuatKhac AS  INNER JOIN
			XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID INNER JOIN
			XeNhapMua AS  ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	
	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE_TONGHOP]     
	  VARCHAR(1...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE_TONGHOP]     
	  VARCHAR(10),
      VARCHAR(10)
AS  KhoHangXuatID AS , XeID, XeNhapMuaID, 1 AS 
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN  AND @DenNgay) AND (XeNhapMuaID IS NOT NULL)
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  KhoHangXuatID AS , XeID, XeNhapMuaID, 1 AS 
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN  AND @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (XeNhapMuaID IS NOT NULL)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_TONKHO_BY_XEID: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_TONKHO_BY_XEID]     
      VARCHAR(1...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_TONKHO_BY_XEID]     
      VARCHAR(10),
	  INT,
	  INT,
	  INT,
	  VARCHAR(20)
AS   INT,	 INT,  INT,  INT
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0
	SET @XeXuatKhacID = 0

	if(@LoaiPhieu = 1)
		SET @XeBanLeID =  else if(@LoaiPhieu = 2)
		SET @XeBanSiID =  else if(@LoaiPhieu = 3)
		SET @XeNoiBoID =  else if(@LoaiPhieu = 4)
		SET @XeXuatKhacID =  Declare  Table (KhoHangID int, XeID int, XeNhapMuaID int, SLNhap int, SLXuat int)

	Insert  SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS , SUM(T.SLXuat) AS 
		FROM (
			
			SELECT 'A' AS , KhoHangNhapID AS , XeID, ID AS , 1 AS , 0 AS  
			FROM XeNhapMua 
			WHERE (NgayCT <= @DenNgay) AND (XeID = @XeID)
			UNION ALL
			
			SELECT 'B' AS , A.KhoHangNhapID AS , B.XeID, B.XeNhapMuaID, 1 AS , 0 AS 
			FROM XeNoiBo AS  INNER JOIN
					XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.IsXacNhan=1)
			UNION ALL
			
			SELECT 'C' AS , A.KhoHangXuatID AS , A.XeID, A.XeNhapMuaID, 1 AS , 0 AS 
			FROM XeBanLe  AS  INNER JOIN
					XeNhapTraLaiBanLe  AS  ON A.ID = B.XeBanLeID    
			WHERE (B.NgayCT <= @DenNgay) AND (A.XeID = @XeID) AND (A.XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'D' AS , A.KhoHangXuatID AS , C.XeID, C.XeNhapMuaID, 1 AS , 0 AS 
			FROM XeBanSi AS  INNER JOIN
					XeNhapTraLaiBanSi AS  ON A.ID = B.XeBanSiID INNER JOIN
					XeNhapTraLaiBanSiChiTiet AS  ON B.ID = C.XeNhapTraLaiBanSiID
			WHERE (B.NgayCT <= @DenNgay) AND (C.XeID = @XeID)
			UNION ALL
			
			SELECT 'E' AS , KhoHangXuatID AS , XeID, XeNhapMuaID, 0 AS , 1 AS 
			FROM XeBanLe     
			WHERE (NgayBan <= @DenNgay) AND (XeID = @XeID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'F' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
			FROM XeBanSi AS  INNER JOIN
					XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeBanSiID)
			UNION ALL
			
			SELECT 'G' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
			FROM XeNoiBo AS  INNER JOIN
					XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeNoiBoID) 
			UNION ALL
			
			SELECT 'F' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
			FROM XeXuatKhac AS  INNER JOIN
					XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeXuatKhacID)
		) AS 
		GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID

		if(LEN(@SoMay)>0)
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS ,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM  AS  INNER JOIN
					XeNhapMua AS  ON A.XeNhapMuaID = B.ID INNER JOIN
					Xe AS  ON A.XeID = X.ID INNER JOIN 
					KhoHang AS  ON A.KhoHangID = K.ID 
			WHERE SLNhap-SLXuat<>0 AND (B.SoMay Like N'%' + @SoMay)
		else
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS ,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM  AS  INNER JOIN
					XeNh
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRALE]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRALE]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, 1 AS 
	FROM XeBanLe  AS  INNER JOIN
			XeNhapTraLaiBanLe  AS  ON A.ID = B.XeBanLeID    
	WHERE (B.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA_GROUP]
      INT,
	  VARCHA...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA_GROUP]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, SUM(B.SoLuong) AS , SUM(B.ThanhTien) AS , V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS  INNER JOIN
            DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA]
      INT,
	  VARCHAR(10),...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS  INNER JOIN
            DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRASI]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRASI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanSi AS  INNER JOIN
            DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANSI]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANSI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanSi AS  INNER JOIN
            DVBanSiVatTu AS  ON A.ID = B.DVBanSiID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure uspGetChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc [uspGetChiTien1]
 int
AS         ChiTien.I...' at line 1 (SQL: DELIMITER //
CREATE         proc [uspGetChiTien1]
 int
AS         ChiTien.ID, KhachHang.TenKhachHang, ChiTienLyDo.TenLyDo, ChiTien.SoTien, TaiKhoan.TenTaiKhoan, ChiTien.GhiChu, ChiTien.CuaHangID, ChiTien.CreatedBy, 
                         ChiTien.CreatedAt, ChiTien.UpdatedBy, ChiTien.UpdatedAt
FROM            ChiTien INNER JOIN
                         KhachHang ON ChiTien.KhachHangID = KhachHang.ID INNER JOIN
                         ChiTienLyDo ON ChiTien.ChiTienLyDoID = ChiTienLyDo.ID INNER JOIN
                         TaiKhoan ON ChiTien.TaiKhoanID = TaiKhoan.ID
WHERE ChiTien.ID= @ID
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure uspChiTien2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
create         proc [uspChiTien2]
 int,
 int,
 int
AS  ChiTi...' at line 1 (SQL: DELIMITER //
create         proc [uspChiTien2]
 int,
 int,
 int
AS  ChiTien SET [Status2] = @Status, Approval2By = @ApprovalBy, Approval2At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_XE_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_NHAPMUA]
      INT,
	  VARCHAR(10),...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_NHAPMUA]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  KhoHangNhapID, XeID, ID AS , 1 AS  
	FROM XeNhapMua 
	WHERE (NgayCT BETWEEN  AND @DenNgay) AND (KhoHangNhapID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure uspChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc [uspChiTien1]
 int,
 int,
 int
AS  ChiTi...' at line 1 (SQL: DELIMITER //
CREATE         proc [uspChiTien1]
 int,
 int,
 int
AS  ChiTien SET [Status1] = @Status, Approval1By = @ApprovalBy, Approval1At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE_GROUP]
      INT,
	  VARC...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE_GROUP]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, SUM(B.SoLuong) AS , SUM(B.ThanhTien) AS , V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS  INNER JOIN
            DVBanLeVatTu AS  ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure upsChiTienPowerApps: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [upsChiTienPowerApps]
AS   VARCHAR(10),  VAR...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [upsChiTienPowerApps]
AS   VARCHAR(10),  VARCHAR(10)

	set @TuNgay = CONVERT(VARCHAR(10), DATEADD(DAY, -30, NOW()), 101)
	set @DenNgay = CONVERT(VARCHAR(10), NOW(), 101)

	SELECT * FROM ChiTien WHERE NgayCT between  and  END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON_KHOHANG: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //



CREATE PROCEDURE [SP_VT_GET_GIAVON_KHOHANG]
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //



CREATE PROCEDURE [SP_VT_GET_GIAVON_KHOHANG]
	  VARCHAR(10),	 
      VARCHAR(10),
	  int,
	  int
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	Declare  Table (KhoHangID int, VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
				XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		
		
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.SoPhieu, A.KhoHangXuatID, A.KhachHangID, B.NgayXuat, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS  INNER JOIN
            DVBanLeVatTu AS  ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure spCheckPhieuChi: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE `` ()
)
	AS 	* from ChiTien
				where	KhoHan...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE `` ()
)
	AS 	* from ChiTien
				where	KhoHangID =  END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_FIX_SLVT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_FIX_SLVT]
AS   Table (DVBanLeID int, SoL...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_FIX_SLVT]
AS   Table (DVBanLeID int, SoLuongVT float)

	Insert @Tb_SLVT(DVBanLeID, SoLuongVT) 
	select DVBanLeID, Sum(SoLuong) AS  from DVBanLeVatTu group by DVBanLeID
	
	UPDATE DVBanLe 
    SET DVBanLe.TongSoLuongVatTu = B.SoLuongVT            
	FROM DVBanLe INNER JOIN  AS  ON DVBanLe.ID = B.DVBanLeID 
	where B.SoLuongVT is not null
	
 
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_TC_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TC_TONDAU]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TC_TONDAU]
                                  INT,
                                  VARCHAR(10),
	                              VARCHAR(10)	 
                            AS  T.TaiKhoanID, T.TacNghiep, SUM(T.SoTien) AS 
	                            FROM (
		                            
		                            SELECT 1 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM XeBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 2 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM XeBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 3 AS , TaiKhoanID, SUM(GiaNhap) AS , 1 AS 
		                            FROM XeSonXe 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 4 AS , TaiKhoanID, SUM(SoTien) AS , 0 AS 
		                            FROM ThuTien 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 5 AS , TaiKhoanID, SUM(SoTien) AS , 1 AS 
		                            FROM ChiTien 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 6 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM DVBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 7 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM DVBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 8 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM DVBanBuonThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 9 AS , T.TaiKhoanID, SUM(G.ChiPhi) AS , 1 AS  
                                    FROM DVBanLe AS  INNER JOIN 
                                        KhoHang AS  ON A.KhoHangXuatID = K.ID INNER JOIN 
	
//
DELIMITER ;)  
[2024-07-18 16:07:00] local.ERROR: Error creating stored procedure SP_VT_NHAPTRABUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRABUON]
      INT,
	  VARCHAR(...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRABUON]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanBuon AS  INNER JOIN
            DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanbuonID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATBANBUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANBUON]
      INT,
	  VARCHAR(...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANBUON]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanBuon AS  INNER JOIN
            DVBanBuonVatTu AS  ON A.ID = B.DVBanBuonID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC_TONGHOP]     
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC_TONGHOP]     
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeXuatKhac AS  INNER JOIN
			XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay)		
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeXuatKhac AS  INNER JOIN
			XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_BANGGIA2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_BANGGIA2]
      nvarchar(20),
	  in...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_BANGGIA2]
      nvarchar(20),
	  int,
	  nvarchar(50)
AS   nvarchar(30)

	
	SELECT		@TenModel = X.TenModel FROM XeNhapMua AS  INNER JOIN Xe AS  ON M.XeID = X.ID INNER JOIN V_XeThayVanh AS  ON M.ID = TV.XeNhapMuaID 
	WHERE		TV.XeNhapMuaID =  GROUP BY	X.TenModel	

	
	Declare  Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT  MAX(B.ID) AS , B.XeID
			FROM    XeBangGia AS  INNER JOIN
                    XeBangGiaChiTiet AS  ON A.ID = B.XeBangGiaID INNER JOIN
                    Xe AS  ON B.XeID = X.ID
			WHERE   (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive = 1) AND (X.TenModel = @TenModel) AND (X.TenType = @TenType)
			GROUP BY B.XeID, X.TenModel, X.TenType

	
	SELECT TOP (1) X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	FROM   XeBangGia AS  INNER JOIN
           XeBangGiaChiTiet AS  ON B.ID = C.XeBangGiaID INNER JOIN
            AS  ON C.ID = V.MaxID INNER JOIN
           Xe AS  ON C.XeID = X.ID	
	GROUP BY X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	ORDER BY C.GiaHaiQuan DESC
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATKMDV: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMDV]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMDV]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS , B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            DVBanLe AS  INNER JOIN
            DVBanLeKhuyenMai AS  ON A.ID = B.DVBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure dt_setpropertybyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_setpropertybyid]
	 int,
	 varchar(64)...' at line 1 (SQL: DELIMITER //

create   procedure [dt_setpropertybyid]
	 int,
	 varchar(64),
	 varchar(255),
	 image
AS   nvarchar(255) 
	set @uvalue = convert(nvarchar(255), @value) 
	if exists (select * from dtproperties 
			where objectid= and property=@property)
	AS  dtproperties set value=@value, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid= and property= END;
	else
	AS  dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @value, @uvalue, @lvalue)
	END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure dt_getpropertiesbyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getpropertiesbyid_u]
	 int,
	 varchar...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getpropertiesbyid_u]
	 int,
	 varchar(64)
AS  ( is null) or (@property = '')
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure dt_getpropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getpropertiesbyid]
	 int,
	 varchar(6...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getpropertiesbyid]
	 int,
	 varchar(64)
AS  ( is null) or (@property = '')
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure dt_getobjwithprop_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getobjwithprop_u]
	 varchar(30),
	 nv...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getobjwithprop_u]
	 varchar(30),
	 nvarchar(255)
AS  ( is null) or (@property = '')
	AS ('Must specify a property name.',-1,-1)
		return (1)
	END;

	if ( is null)
		select objectid id from dtproperties
			where property= else
		select objectid id from dtproperties
			where property= and uvalue=@uvalue
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure dt_getobjwithprop: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getobjwithprop]
	 varchar(30),
	 varc...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getobjwithprop]
	 varchar(30),
	 varchar(255)
AS  ( is null) or (@property = '')
	AS ('Must specify a property name.',-1,-1)
		return (1)
	END;

	if ( is null)
		select objectid id from dtproperties
			where property= else
		select objectid id from dtproperties
			where property= and value=@value
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure dt_generateansiname: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
 
CREATE PROCEDURE `` () output) 
AS   varchar(20) 
	declare ...' at line 1 (SQL: DELIMITER //
 
CREATE PROCEDURE `` () output) 
AS   varchar(20) 
	declare  varchar(20) 
	declare  integer 
 
	set @prologue = 'MSDT-A-' 
	set @index = 1 
 
	while 1 = 1 
	AS  @indexstring = cast( AS (20)) 
		set @name = @prologue +  if not exists (select value from dtproperties where value = @name) 
			break 
		 
		set @index = @index + 1 
 
		if (@index = 10000) 
			goto TooMany 
	END; 
 
Leave: 
 
	return 
 
TooMany: 
 
	set @name = 'DIAGRAM' 
	goto Leave
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure dt_setpropertybyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_setpropertybyid_u]
	 int,
	 varchar(6...' at line 1 (SQL: DELIMITER //

create   procedure [dt_setpropertybyid_u]
	 int,
	 varchar(64),
	 nvarchar(255),
	 image
AS   varchar(255) 
	set @avalue = null 
	if ( is not null) 
	AS  (convert(nvarchar(255), convert(varchar(255), @uvalue)) = @uvalue) 
		AS  @avalue = convert(varchar(255), @uvalue) 
		END; 
		else 
		AS  'DtgSchemaNAME' =  AS  dt_generateansiname  output 
			END; 
		END; 
	END; 
	if exists (select * from dtproperties 
			where objectid= and property=@property)
	AS  dtproperties set value=@avalue, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid= and property= END;
	else
	AS  dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @avalue, @uvalue, @lvalue)
	END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_Old]
      INT,
	  VARC...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_Old]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS  INNER JOIN
            XePhuKienChiTiet AS  ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 1) AND (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure dt_dropuserobjectbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_dropuserobjectbyid]
	 int
AS  from dt...' at line 1 (SQL: DELIMITER //

create   procedure [dt_dropuserobjectbyid]
	 int
AS  from dtproperties where objectid=@id
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN]
      INT,
	  VARCHAR(...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS  INNER JOIN
            XePhuKienChiTiet AS  ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 0) AND (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure dt_droppropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_droppropertiesbyid]
	 int,
	 varchar(...' at line 1 (SQL: DELIMITER //

create   procedure [dt_droppropertiesbyid]
	 int,
	 varchar(64)
AS  ( is null) or (@property = '')
		delete from dtproperties where objectid= else
		delete from dtproperties 
			where objectid= and property=@property
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure dt_adduserobject: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_adduserobject]
AS 
		insert dtpropert...' at line 1 (SQL: DELIMITER //

create   procedure [dt_adduserobject]
AS 
		insert dtproperties (property) VALUES ('DtgSchemaOBJECT')
		update dtproperties set objectid=@ where id=@ and property='DtgSchemaOBJECT'
	commit
	return @@identity
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKHAC]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKHAC]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVXuatKhac AS  INNER JOIN
			DVXuatKhacVatTu AS  ON A.ID = B.DVXuatKhacID INNER JOIN
			VatTu AS  ON B.VatTuID = V.ID INNER JOIN
			VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATDOIDONVI]
      INT,
	  VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATDOIDONVI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, A.SoLuong, A.DonGia, A.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS  INNER JOIN
            VatTu AS  ON A.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_BANGGIA]
      nvarchar(20)
AS   Tab...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_BANGGIA]
      nvarchar(20)
AS   Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT Max(B.ID) AS , B.XeID
			FROM   XeBangGia AS  INNER JOIN
				   XeBangGiaChiTiet AS  ON A.ID = B.XeBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive =1)
			GROUP BY B.XeID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.XeID, C.SoKhung, C.SoMay, X.MaXe, X.TenXe, X.SortDoiXe, X.SortLoaiXe, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, c.GiaApThue
	FROM   XeBangGia AS  INNER JOIN
           XeBangGiaChiTiet AS  ON B.ID = C.XeBangGiaID INNER JOIN
            AS  ON C.ID = V.MaxID INNER JOIN
           Xe AS  ON C.XeID = X.ID	
	ORDER BY X.SortDoiXe
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON2]
	  VARCHAR(10),	 
 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON2]
	  VARCHAR(10),	 
      VARCHAR(10)	 
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare  Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	
	FROM (
		
		SELECT	1 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	2 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	3 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	5 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	6 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  8 AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  9 AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)		
		UNION ALL
		
		SELECT	10 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	11 AS , B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanLe AS  INNER JOIN
				DVBanLeVatTu AS  ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	12 AS , B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanSi AS  INNER JOIN
				DVBanSiVatTu AS  ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON]
	  VARCHAR(10),	 
  ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON]
	  VARCHAR(10),	 
      VARCHAR(10)	 
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare  Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanLe AS  INNER JOIN
				DVBanLeVatTu AS  ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS ,
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_TONDAU_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU_ALL]
      INT,
      VARCHA...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU_ALL]
      INT,
      VARCHAR(10)
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'	

	SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	'N01' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N02' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N03' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N04' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNoiBo AS  INNER JOIN
				DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT	'N05' AS , A.KhoHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID)
		UNION ALL
		
		SELECT	'N06' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT  'N07' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNoiBo AS  INNER JOIN
                XeNoiBoPhuKien AS  ON A.ID = B.XeNoiBoID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT  'N08' AS , A.KhoHangXuatID AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON A.ID = B.XeBanLeID INNER JOIN
				Va
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO_ALL_TEST]
      int,
      nv...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO_ALL_TEST]
      int,
      nvarchar(10)
AS   Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert  Exec SP_VT_TONDAU_ALL @KhoHangID,  SELECT A.KhoHangID AS , A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, V.VatTuLoaiID, L.VatTuNhomID, A.TDSLNhap, A.TDSLXuat, (A.TDSLNhap - A.TDSLXuat) AS 
	FROM  AS  INNER JOIN
			VatTu AS  ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) < 0
	order by  A.VatTuID

	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_XUATNOIBO]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_XUATNOIBO]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeNoiBo AS  INNER JOIN
			XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.IsXacNhan=1)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_VT_TONKHO_ALL]
      int,
      nvarcha...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_VT_TONKHO_ALL]
      int,
      nvarchar(10)
AS   Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert  Exec SP_VT_TONDAU_ALL @KhoHangID,  SELECT A.KhoHangID AS , A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS 
	FROM  AS  INNER JOIN
			VatTu AS  ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPNOIBO]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPNOIBO]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeNoiBo AS  INNER JOIN
			XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU]
      INT,
      VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU]
      INT,
      VARCHAR(10),	 
	  INT,
	  VARCHAR(1),
	  INT
AS   VARCHAR(10), 
		 INT,  INT,  INT,  INT,  INT,  INT, 
		 INT,  INT,  INT,  INT,  INT,  INT
	SET @NgayBatDauSuDung = '2019-12-19'
	SET @DVBanLeID = 0 	
	SET @DVBanSiID = 0
	SET @DVNoiBoID = 0
	SET @DoiDonViID = 0
	SET @DVXuatKhacID = 0
	SET @XeBanLeKMID = 0
	SET @DVBanLeKMID = 0
	SET @XePhuKienID = 0
	SET @XePhuKienNoiBoID = 0
	SET @DVBanBuonID = 0
	SET @XeBanSiKMID = 0
	SET @XeBanLeBHID = 0

	IF(@MaTacNghiep ='I')			SET @DVBanLeID =  ELSE IF(@MaTacNghiep='J')		SET @DVBanSiID =  ELSE IF(@MaTacNghiep='K')		SET @DVNoiBoID =  ELSE IF(@MaTacNghiep='L')		SET @DoiDonViID =  ELSE IF(@MaTacNghiep='M')		SET @DVXuatKhacID =  ELSE IF(@MaTacNghiep='N')		SET @XeBanLeKMID =  ELSE IF(@MaTacNghiep='O')		SET @DVBanLeKMID =  ELSE IF(@MaTacNghiep='P')		SET @XePhuKienID =  ELSE IF(@MaTacNghiep='Q')		SET @XePhuKienNoiBoID =  ELSE IF(@MaTacNghiep='R')		SET @DVBanBuonID =  ELSE IF(@MaTacNghiep='S')		SET @XeBanSiKMID =  ELSE IF(@MaTacNghiep='T')		SET @XeBanLeBHID =  SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	'N01' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNoiBo AS  INNER JOIN
				DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS , A.KhoHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATNOIBO]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATNOIBO]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS  INNER JOIN
            DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO]
      INT,
      nvarchar(10...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO]
      INT,
      nvarchar(10),
	  INT,
	  VARCHAR(1),
	  INT
AS   Table (KhoHangID INT, VatTuID INT, TDSLNhap INT, TDTienNhap FLOAT, TDSLXuat INT, TDTienXuat FLOAT)
	INSERT  Exec SP_VT_TONDAU @KhoHangID, @DenNgay, @VatTuID, @MaTacNghiep,  SELECT A.KhoHangID AS , A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS 
	FROM  AS  INNER JOIN
			VatTu AS  ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPNOIBO]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPNOIBO]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS  INNER JOIN
            DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.IsXacNhan = 1) AND (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_SELECT_GIAVON_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_SELECT_GIAVON_TEST]
	  VARCHAR(10),	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_SELECT_GIAVON_TEST]
	  VARCHAR(10),	 
      VARCHAR(10)	 
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare  Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , (1 - A.TyLeCK*0.01) * B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, 1 AS , C.GiaBanBH AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLeBaoHiem AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanLe AS  INNER JOIN
				DVBanLeVatTu AS  ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanSi AS  INNER JOIN
				DVBanSiVatTu AS  ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT < @TuNgay)
		UNION ALL
		
		SELECT  VatTuID, 0 AS , 0 AS , SoLuong AS , ThanhTien AS 
		FROM    DoiDonVi AS     
	
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_NHAPXUAT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPXUAT]
      INT,
	  INT,
	  VA...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPXUAT]
      INT,
	  INT,
	  VARCHAR(10),	 
      VARCHAR(10)	 	 
AS  T.SoCT, T.NgayCT, T.NgayNXK, T.KhoHangNhapID, T.KhoHangXuatID, T.KhachHangID, T.VatTuID, T.SLNhap, T.SLXuat 
	FROM (
		
		SELECT	'N01' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , A.KhachHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , C.KhachHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
                DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
                DVBanLe AS  ON A.DVBanLeID = C.ID   
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , C.KhachHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
                DVBanSi AS  ON A.DVBanSiID = C.ID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, A.KhoHangXuatID, NULL AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNoiBo AS  INNER JOIN
				DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangID AS , NULL AS , NULL AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N06' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , NULL AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  'N07' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , NULL AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNoiBo AS  INNER JOIN
                XeNoiBoPhuKien AS  ON A.ID = B.XeNoiBoID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)		
		UNION ALL
		
		SELECT  'N08' AS , B.SoCT, B.NgayCT, B.NgayCT AS , A.KhoHangXuatID AS , NULL AS , a.KhachHangID, C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_NHAPDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPDOIDONVI]
      INT,
	  VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPDOIDONVI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS  INNER JOIN
            DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XECHUYENKHO]
      INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XECHUYENKHO]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS , B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS  INNER JOIN
            XeNoiBoPhuKien AS  ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_GET_GIAVON]
	  VARCHAR(10),	 
     ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_GET_GIAVON]
	  VARCHAR(10),	 
      VARCHAR(10),
	  int
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare  Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanLe AS  INNER JOIN
				DVBanLeVatTu AS  ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.Nga
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_XECHUYENKHO]
      INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_XECHUYENKHO]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID AS , B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS  INNER JOIN
            XeNoiBoPhuKien AS  ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan = 1)
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_DELETE_DUPLICATE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_DELETE_DUPLICATE]
	  int,	 
      i...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_DELETE_DUPLICATE]
	  int,	 
      int	 
AS  DoiDonVi						set VATTUID =  WHERE VATTUID =  update DoiDonViChiTiet				set VATTUID =  WHERE VATTUID =  update DVBanLeVatTu					set VATTUID =  WHERE VATTUID =  update DVBanSiVatTu					set VATTUID =  WHERE VATTUID =  update DVNhapKhacVatTu				set VATTUID =  WHERE VATTUID =  update DVNhapMuaVatTu				set VATTUID =  WHERE VATTUID =  update DVNhapTraLaiBanLeChiTiet		set VATTUID =  WHERE VATTUID =  update DVNhapTraLaiBanSiChiTiet		set VATTUID =  WHERE VATTUID =  update DVNoiBoVatTu					set VATTUID =  WHERE VATTUID =  update DVXuatKhacVatTu				set VATTUID =  WHERE VATTUID =  update VTBangGiaChiTiet				set VATTUID =  WHERE VATTUID =  update XeBanLeKhuyenMai				set VATTUID =  WHERE VATTUID =  update XeBanLePhuKien				set VATTUID =  WHERE VATTUID =  update XeNhapTraLaiBanLeKhuyenMai	set VATTUID =  WHERE VATTUID =  update XeNhapTraLaiBanLePhuKien		set VATTUID =  WHERE VATTUID =  update XeNoiBoPhuKien				set VATTUID =  WHERE VATTUID =  update XePhuKienChiTiet				set VATTUID =  WHERE VATTUID =  Delete VatTu where (ID = @VatTuID_DEL)

END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XEBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XEBANLE]
      INT,
	  ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XEBANLE]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS , B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, b.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeBanLe AS  INNER JOIN
            XeBanLePhuKien AS  ON A.ID = B.XeBanLeID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE   (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHLE]
      INT,
	  VARCHAR(1...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHLE]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS  INNER JOIN
            XeBanLeKhuyenMai AS  ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure dt_verstamp007: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_verstamp007]
AS  7005
//
DELIMITER' at line 1 (SQL: DELIMITER //

create   procedure [dt_verstamp007]
AS  7005
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATKMBH_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBH_Old]
      INT,
	  VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBH_Old]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS  INNER JOIN
            XeBanLeKhuyenMai AS  ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure dt_verstamp006: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_verstamp006]
AS  7000
//
DELIMITER' at line 1 (SQL: DELIMITER //

create   procedure [dt_verstamp006]
AS  7000
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATBAOHIEM_BHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBAOHIEM_BHLE]
      INT,
	  VAR...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBAOHIEM_BHLE]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, B.NgayXuat AS , A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, 1 AS , B.GiaBanBH, B.GiaBanBH AS , V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS  INNER JOIN
            XeBanLeBaoHiem AS  ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_TRALAI]
      INT,
	  V...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_TRALAI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.ID, B.SoCT, C.NgayNhap AS , A.KhoHangXuatID AS , C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS  INNER JOIN
            XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS  ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS  ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_NHAPKHUYENMAI_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHUYENMAI_TRALAI]
      INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHUYENMAI_TRALAI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.ID, B.SoCT, B.NgayCT, A.KhoHangXuatID AS , C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS  INNER JOIN
            XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS  ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS  ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRASI]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRASI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS 
	FROM XeBanSi AS  INNER JOIN
			XeNhapTraLaiBanSi AS  ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS  ON B.ID = C.XeNhapTraLaiBanSiID
	WHERE (B.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.XeNhapMuaID IS NOT NULL)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_NHAPBAOHIEM_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPBAOHIEM_TRALAI]
      INT,
	  V...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPBAOHIEM_TRALAI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.ID, B.SoCT, C.NgayNhap AS , A.KhoHangXuatID AS , C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, 1 AS , C.GiaBanBH AS , C.GiaBanBH AS , V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS  INNER JOIN
            XeNhapTraLaiBanLeBaoHiem AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS  ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS  ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRALE]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRALE]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanLe AS  INNER JOIN
            DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_TEST_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TEST_1]   
AS  count(ID) BEGIN 'VT' from...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TEST_1]   
AS  count(ID) BEGIN 'VT' from VatTu
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TEST]
      INT     
AS  * from VatTu w...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TEST]
      INT     
AS  * from VatTu where ID =  END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_DV_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_DV_BANGGIA]
      nvarchar(10),
	  nvar...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_DV_BANGGIA]
      nvarchar(10),
	  nvarchar(2)
AS   Table (MaxID int, DichVuID int)
	Insert @V_DV_BangGia_MaxID(MaxID, DichVuID) 
			SELECT Max(B.ID) AS , B.DichVuID
			FROM   DVBangGia AS  INNER JOIN
				   DVBangGiaChiTiet AS  ON A.ID = B.DVBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.CuaHangID = @CuaHangID)
			GROUP BY B.DichVuID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.DichVuID, V.MaDichVu, V.HangMuc, C.DonGia
	FROM   DVBangGia AS  INNER JOIN
           DVBangGiaChiTiet AS  ON B.ID = C.DVBangGiaID INNER JOIN
            AS  ON C.ID = M.MaxID INNER JOIN
           DichVu AS  ON C.DichVuID = V.ID	
	ORDER BY V.MaDichVu
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHSI]
      INT,
	  VARCHAR(1...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHSI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanSi AS  INNER JOIN
            XeBanSiKhuyenMai AS  ON A.ID = B.XeBanSiID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE[SP_VT_BANGGIA]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE[SP_VT_BANGGIA]
                                 nvarchar(10),
	                             nvarchar(2)
                            AS   Table(MaxID int, VatTuID int)
                                Insert @V_VT_BangGia_MaxID(MaxID, VatTuID)
                                        SELECT Max(B.ID) AS , B.VatTuID
                                        FROM   VTBangGia AS  CROSS APPLY STRING_SPLIT(CuaHangID, ',') INNER JOIN
                                               VTBangGiaChiTiet AS  ON A.ID = B.VTBangGiaID
                                        WHERE(A.ApDungTu <= @DenNgay) AND(A.ApDungDen >= @DenNgay) AND (value = @CuaHangID)
                                        GROUP BY B.VatTuID

                                SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.VatTuLoaiID, L.VatTuNhomID, C.GiaNhap, C.GiaXuat
                                FROM   VTBangGia AS  INNER JOIN
                                       VTBangGiaChiTiet AS  ON B.ID = C.VTBangGiaID INNER JOIN
                                        AS  ON C.ID = M.MaxID INNER JOIN
                                       VatTu AS  ON C.VatTuID = V.ID INNER JOIN
                                       VatTuLoai AS  ON V.VatTuLoaiID = L.ID
                            END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_NHAPKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHAC]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHAC]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapKhac AS  INNER JOIN
            DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI_TONGHOP]     
	  VARCHAR(1...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI_TONGHOP]     
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeBanSi AS  INNER JOIN
			XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay)		
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeBanSi AS  INNER JOIN
			XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_TONDAU]
      INT,
      VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_TONDAU]
      INT,
      VARCHAR(10),
	  INT,
	  INT,
	  INT,
	  INT
AS  T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS , SUM(T.SLXuat) AS 
	FROM (
		
		SELECT 'A' AS , KhoHangNhapID AS , XeID, ID AS , 1 AS , 0 AS  
		FROM XeNhapMua 
		WHERE (NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT 'B' AS , A.KhoHangNhapID AS , B.XeID, B.XeNhapMuaID, 1 AS , 0 AS 
		FROM XeNoiBo AS  INNER JOIN
				XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
		UNION ALL
		
		SELECT 'C' AS , A.KhoHangXuatID AS , A.XeID, A.XeNhapMuaID, 1 AS , 0 AS 
		FROM XeBanLe  AS  INNER JOIN
				XeNhapTraLaiBanLe  AS  ON A.ID = B.XeBanLeID    
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'D' AS , A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS , 0 AS 
		FROM XeBanSi AS  INNER JOIN
				XeNhapTraLaiBanSi AS  ON A.ID = B.XeBanSiID INNER JOIN
				XeNhapTraLaiBanSiChiTiet AS  ON B.ID = C.XeNhapTraLaiBanSiID
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
		UNION ALL
		
		SELECT 'E' AS , KhoHangXuatID AS , XeID, XeNhapMuaID, 0 AS , 1 AS 
		FROM XeBanLe     
		WHERE (NgayBan <= @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'F' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
		FROM XeBanSi AS  INNER JOIN
				XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeBanSiID)
		UNION ALL
		
		SELECT 'G' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
		FROM XeNoiBo AS  INNER JOIN
				XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeNoiBoID) 
		UNION ALL
		
		SELECT 'H' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
		FROM XeXuatKhac AS  INNER JOIN
				XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeXuatKhacID)
	) AS 
	GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID
END;


//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_TONKHO]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_TONKHO]
                                  int,
                                  nvarchar(10),
	                              INT,
	                              INT,
	                              INT,
	                              INT
                            AS   Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)
	                            Insert  Exec SP_XE_TONDAU @KhoHangID, @DenNgay, @XeBanLeID, @XeBanSiID, @XeNoiBoID,  SELECT A.KhoHangID, B.KhoHangNhapID, A.XeID, X.MaXe, X.TenXe, A.XeNhapMuaID, B.KhachHangID AS , B.DonGia_CoVAT, B.NgayCT, B.SoKhung, B.SoMay, B.MaChiaKhoa, (A.TDSLNhap - A.TDSLXuat) AS , B.GhiChu, B.MaChiaKhoa
	                            FROM  AS  INNER JOIN
			                            XeNhapMua AS  ON A.XeNhapMuaID = B.ID INNER JOIN
			                            Xe AS  ON A.XeID = X.ID 
	                            WHERE (A.TDSLNhap - A.TDSLXuat) <>0
                            END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_NHAPXUATTON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_NHAPXUATTON]
      int,
	  nvarchar(10)...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_NHAPXUATTON]
      int,
	  nvarchar(10),
      nvarchar(10)
AS   Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)

	declare  int,  int,  int
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0

	Insert  Exec SP_XE_TONDAU @KhoHangID, @TuNgay, @XeBanLeID, @XeBanSiID,  SELECT NXT.* FROM (
		SELECT 'T' AS , KhoHangID, XeID, XeNhapMuaID, (TDSLNhap - TDSLXuat) AS 
		FROM  UNION ALL
		SELECT 'B' AS , A.KhoHangNhapID AS , B.XeID, B.XeNhapMuaID, 1 AS 
		FROM XeNoiBo AS  INNER JOIN
			 XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
		WHERE A.NgayCT <  AND KhoHangNhapID = @KhoHangID   
	) AS  
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_LICHSU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_LICHSU]
      INT
AS  'A' AS , ID, ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_LICHSU]
      INT
AS  'A' AS , ID, KhoHangNhapID, Null AS , XeID, ID AS , SoCT, NgayCT, NULL AS , CreatedBy, SoKhung, SoMay 
	FROM XeNhapMua 
	WHERE (ID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'B' AS , A.ID, A.KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, NULL AS , A.CreatedBy, M.SoKhung, M.SoMay 
	FROM XeNoiBo AS  INNER JOIN
			XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID INNER JOIN
			XeNhapMua AS  ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'C' AS , B.ID, A.KhoHangXuatID AS , null AS , A.XeID, A.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS , B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe  AS  INNER JOIN
			XeNhapTraLaiBanLe  AS  ON A.ID = B.XeBanLeID INNER JOIN
			XeNhapMua AS  ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'D' AS , B.ID, A.KhoHangXuatID AS , null AS , C.XeID, C.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS , B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS  INNER JOIN
			XeNhapTraLaiBanSi AS  ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS  ON B.ID = C.XeNhapTraLaiBanSiID INNER JOIN
			XeNhapMua AS  ON C.XeNhapMuaID = M.ID
	WHERE (C.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'E' AS , A.ID, Null AS , A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe AS  INNER JOIN
			XeNhapMua AS  ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'F' AS , A.ID, Null AS , A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS , A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS  INNER JOIN
			XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapMua AS  ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'G' AS , A.ID, Null AS , A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS , A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeXuatKhac AS  INNER JOIN
			XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID INNER JOIN
			XeNhapMua AS  ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	
	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE_TONGHOP]     
	  VARCHAR(1...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE_TONGHOP]     
	  VARCHAR(10),
      VARCHAR(10)
AS  KhoHangXuatID AS , XeID, XeNhapMuaID, 1 AS 
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN  AND @DenNgay) AND (XeNhapMuaID IS NOT NULL)
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  KhoHangXuatID AS , XeID, XeNhapMuaID, 1 AS 
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN  AND @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (XeNhapMuaID IS NOT NULL)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_TONKHO_BY_XEID: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_TONKHO_BY_XEID]     
      VARCHAR(1...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_TONKHO_BY_XEID]     
      VARCHAR(10),
	  INT,
	  INT,
	  INT,
	  VARCHAR(20)
AS   INT,	 INT,  INT,  INT
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0
	SET @XeXuatKhacID = 0

	if(@LoaiPhieu = 1)
		SET @XeBanLeID =  else if(@LoaiPhieu = 2)
		SET @XeBanSiID =  else if(@LoaiPhieu = 3)
		SET @XeNoiBoID =  else if(@LoaiPhieu = 4)
		SET @XeXuatKhacID =  Declare  Table (KhoHangID int, XeID int, XeNhapMuaID int, SLNhap int, SLXuat int)

	Insert  SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS , SUM(T.SLXuat) AS 
		FROM (
			
			SELECT 'A' AS , KhoHangNhapID AS , XeID, ID AS , 1 AS , 0 AS  
			FROM XeNhapMua 
			WHERE (NgayCT <= @DenNgay) AND (XeID = @XeID)
			UNION ALL
			
			SELECT 'B' AS , A.KhoHangNhapID AS , B.XeID, B.XeNhapMuaID, 1 AS , 0 AS 
			FROM XeNoiBo AS  INNER JOIN
					XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.IsXacNhan=1)
			UNION ALL
			
			SELECT 'C' AS , A.KhoHangXuatID AS , A.XeID, A.XeNhapMuaID, 1 AS , 0 AS 
			FROM XeBanLe  AS  INNER JOIN
					XeNhapTraLaiBanLe  AS  ON A.ID = B.XeBanLeID    
			WHERE (B.NgayCT <= @DenNgay) AND (A.XeID = @XeID) AND (A.XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'D' AS , A.KhoHangXuatID AS , C.XeID, C.XeNhapMuaID, 1 AS , 0 AS 
			FROM XeBanSi AS  INNER JOIN
					XeNhapTraLaiBanSi AS  ON A.ID = B.XeBanSiID INNER JOIN
					XeNhapTraLaiBanSiChiTiet AS  ON B.ID = C.XeNhapTraLaiBanSiID
			WHERE (B.NgayCT <= @DenNgay) AND (C.XeID = @XeID)
			UNION ALL
			
			SELECT 'E' AS , KhoHangXuatID AS , XeID, XeNhapMuaID, 0 AS , 1 AS 
			FROM XeBanLe     
			WHERE (NgayBan <= @DenNgay) AND (XeID = @XeID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'F' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
			FROM XeBanSi AS  INNER JOIN
					XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeBanSiID)
			UNION ALL
			
			SELECT 'G' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
			FROM XeNoiBo AS  INNER JOIN
					XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeNoiBoID) 
			UNION ALL
			
			SELECT 'F' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
			FROM XeXuatKhac AS  INNER JOIN
					XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeXuatKhacID)
		) AS 
		GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID

		if(LEN(@SoMay)>0)
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS ,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM  AS  INNER JOIN
					XeNhapMua AS  ON A.XeNhapMuaID = B.ID INNER JOIN
					Xe AS  ON A.XeID = X.ID INNER JOIN 
					KhoHang AS  ON A.KhoHangID = K.ID 
			WHERE SLNhap-SLXuat<>0 AND (B.SoMay Like N'%' + @SoMay)
		else
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS ,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM  AS  INNER JOIN
					XeNh
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRALE]
      INT,
	  VARCHAR(10)...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRALE]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, 1 AS 
	FROM XeBanLe  AS  INNER JOIN
			XeNhapTraLaiBanLe  AS  ON A.ID = B.XeBanLeID    
	WHERE (B.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA_GROUP]
      INT,
	  VARCHA...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA_GROUP]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, SUM(B.SoLuong) AS , SUM(B.ThanhTien) AS , V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS  INNER JOIN
            DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA]
      INT,
	  VARCHAR(10),...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS  INNER JOIN
            DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRASI]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRASI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanSi AS  INNER JOIN
            DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANSI]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANSI]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanSi AS  INNER JOIN
            DVBanSiVatTu AS  ON A.ID = B.DVBanSiID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure uspGetChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc [uspGetChiTien1]
 int
AS         ChiTien.I...' at line 1 (SQL: DELIMITER //
CREATE         proc [uspGetChiTien1]
 int
AS         ChiTien.ID, KhachHang.TenKhachHang, ChiTienLyDo.TenLyDo, ChiTien.SoTien, TaiKhoan.TenTaiKhoan, ChiTien.GhiChu, ChiTien.CuaHangID, ChiTien.CreatedBy, 
                         ChiTien.CreatedAt, ChiTien.UpdatedBy, ChiTien.UpdatedAt
FROM            ChiTien INNER JOIN
                         KhachHang ON ChiTien.KhachHangID = KhachHang.ID INNER JOIN
                         ChiTienLyDo ON ChiTien.ChiTienLyDoID = ChiTienLyDo.ID INNER JOIN
                         TaiKhoan ON ChiTien.TaiKhoanID = TaiKhoan.ID
WHERE ChiTien.ID= @ID
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure uspChiTien2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
create         proc [uspChiTien2]
 int,
 int,
 int
AS  ChiTi...' at line 1 (SQL: DELIMITER //
create         proc [uspChiTien2]
 int,
 int,
 int
AS  ChiTien SET [Status2] = @Status, Approval2By = @ApprovalBy, Approval2At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_XE_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_NHAPMUA]
      INT,
	  VARCHAR(10),...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_NHAPMUA]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  KhoHangNhapID, XeID, ID AS , 1 AS  
	FROM XeNhapMua 
	WHERE (NgayCT BETWEEN  AND @DenNgay) AND (KhoHangNhapID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure uspChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc [uspChiTien1]
 int,
 int,
 int
AS  ChiTi...' at line 1 (SQL: DELIMITER //
CREATE         proc [uspChiTien1]
 int,
 int,
 int
AS  ChiTien SET [Status1] = @Status, Approval1By = @ApprovalBy, Approval1At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE_GROUP]
      INT,
	  VARC...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE_GROUP]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, SUM(B.SoLuong) AS , SUM(B.ThanhTien) AS , V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS  INNER JOIN
            DVBanLeVatTu AS  ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure upsChiTienPowerApps: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [upsChiTienPowerApps]
AS   VARCHAR(10),  VAR...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [upsChiTienPowerApps]
AS   VARCHAR(10),  VARCHAR(10)

	set @TuNgay = CONVERT(VARCHAR(10), DATEADD(DAY, -30, NOW()), 101)
	set @DenNgay = CONVERT(VARCHAR(10), NOW(), 101)

	SELECT * FROM ChiTien WHERE NgayCT between  and  END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON_KHOHANG: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //



CREATE PROCEDURE `$1`
	  VARCHAR(10),	 
      VARCHAR(10)...' at line 1 (SQL: DELIMITER //



CREATE PROCEDURE `$1`
	  VARCHAR(10),	 
      VARCHAR(10),
	  int,
	  int
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	Declare  Table (KhoHangID int, VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
				XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		
		
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE]
      INT,
	  VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.SoPhieu, A.KhoHangXuatID, A.KhachHangID, B.NgayXuat, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS  INNER JOIN
            DVBanLeVatTu AS  ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure spCheckPhieuChi: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE `` ()
)
	AS 	* from ChiTien
				where	KhoHan...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE `` ()
)
	AS 	* from ChiTien
				where	KhoHangID =  END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_FIX_SLVT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_FIX_SLVT]
AS   Table (DVBanLeID int, SoL...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_FIX_SLVT]
AS   Table (DVBanLeID int, SoLuongVT float)

	Insert @Tb_SLVT(DVBanLeID, SoLuongVT) 
	select DVBanLeID, Sum(SoLuong) AS  from DVBanLeVatTu group by DVBanLeID
	
	UPDATE DVBanLe 
    SET DVBanLe.TongSoLuongVatTu = B.SoLuongVT            
	FROM DVBanLe INNER JOIN  AS  ON DVBanLe.ID = B.DVBanLeID 
	where B.SoLuongVT is not null
	
 
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_TC_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TC_TONDAU]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TC_TONDAU]
                                  INT,
                                  VARCHAR(10),
	                              VARCHAR(10)	 
                            AS  T.TaiKhoanID, T.TacNghiep, SUM(T.SoTien) AS 
	                            FROM (
		                            
		                            SELECT 1 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM XeBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 2 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM XeBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 3 AS , TaiKhoanID, SUM(GiaNhap) AS , 1 AS 
		                            FROM XeSonXe 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 4 AS , TaiKhoanID, SUM(SoTien) AS , 0 AS 
		                            FROM ThuTien 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 5 AS , TaiKhoanID, SUM(SoTien) AS , 1 AS 
		                            FROM ChiTien 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 6 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM DVBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 7 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM DVBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 8 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM DVBanBuonThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 9 AS , T.TaiKhoanID, SUM(G.ChiPhi) AS , 1 AS  
                                    FROM DVBanLe AS  INNER JOIN 
                                        KhoHang AS  ON A.KhoHangXuatID = K.ID INNER JOIN 
	
//
DELIMITER ;)  
[2024-07-18 16:11:27] local.ERROR: Error creating stored procedure SP_VT_NHAPTRABUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRABUON]
      INT,
	  VARCHAR(...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRABUON]
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanBuon AS  INNER JOIN
            DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanbuonID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATBANBUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANBUON]
     `KhoHangID` INT,
...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANBUON]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanBuon AS `A` INNER JOIN
            DVBanBuonVatTu AS `B` ON A.ID = B.DVBanBuonID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC_TONGHOP]     
	 `TuNgay` VA...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC_TONGHOP]     
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeXuatKhac AS `A` INNER JOIN
			XeXuatKhacChiTiet AS `B` ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay)		
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeXuatKhac AS `A` INNER JOIN
			XeXuatKhacChiTiet AS `B` ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_BANGGIA2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_BANGGIA2]
     `DenNgay` nvarchar(20...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_BANGGIA2]
     `DenNgay` nvarchar(20),
	 `XeNhapMuaID` int,
	 `TenType` nvarchar(50)
AS `Declare` `TenModel` nvarchar(30)

	
	SELECT		@TenModel = X.TenModel FROM XeNhapMua AS `M` INNER JOIN Xe AS `X` ON M.XeID = X.ID INNER JOIN V_XeThayVanh AS `TV` ON M.ID = TV.XeNhapMuaID 
	WHERE		TV.XeNhapMuaID = `XeNhapMuaID` GROUP BY	X.TenModel	

	
	Declare `V_Xe_BangGia_MaxID` Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT  MAX(B.ID) AS `MaxID`, B.XeID
			FROM    XeBangGia AS `A` INNER JOIN
                    XeBangGiaChiTiet AS `B` ON A.ID = B.XeBangGiaID INNER JOIN
                    Xe AS `X` ON B.XeID = X.ID
			WHERE   (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive = 1) AND (X.TenModel = @TenModel) AND (X.TenType = @TenType)
			GROUP BY B.XeID, X.TenModel, X.TenType

	
	SELECT TOP (1) X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	FROM   XeBangGia AS `B` INNER JOIN
           XeBangGiaChiTiet AS `C` ON B.ID = C.XeBangGiaID INNER JOIN
           `V_Xe_BangGia_MaxID` AS `V` ON C.ID = V.MaxID INNER JOIN
           Xe AS `X` ON C.XeID = X.ID	
	GROUP BY X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	ORDER BY C.GiaHaiQuan DESC
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATKMDV: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMDV]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMDV]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS `KhoHangXuatID`, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS `L` INNER JOIN
            VatTu AS `V` ON L.ID = V.VatTuLoaiID INNER JOIN
            DVBanLe AS `A` INNER JOIN
            DVBanLeKhuyenMai AS `B` ON A.ID = B.DVBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure dt_setpropertybyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_setpropertybyid]
	`id` int,
	`propert...' at line 1 (SQL: DELIMITER //

create   procedure [dt_setpropertybyid]
	`id` int,
	`property` varchar(64),
	`value` varchar(255),
	`lvalue` image
AS `declare` `uvalue` nvarchar(255) 
	set @uvalue = convert(nvarchar(255), @value) 
	if exists (select * from dtproperties 
			where objectid=`id` and property=@property)
	AS `update` dtproperties set value=@value, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=`id` and property=`property` END;
	else
	AS `insert` dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @value, @uvalue, @lvalue)
	END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure dt_getpropertiesbyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getpropertiesbyid_u]
	`id` int,
	`pro...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getpropertiesbyid_u]
	`id` int,
	`property` varchar(64)
AS `if` (`property` is null) or (@property = '')
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure dt_getpropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getpropertiesbyid]
	`id` int,
	`prope...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getpropertiesbyid]
	`id` int,
	`property` varchar(64)
AS `if` (`property` is null) or (@property = '')
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure dt_getobjwithprop_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getobjwithprop_u]
	`property` varchar(...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getobjwithprop_u]
	`property` varchar(30),
	`uvalue` nvarchar(255)
AS `if` (`property` is null) or (@property = '')
	AS `raiserror`('Must specify a property name.',-1,-1)
		return (1)
	END;

	if (`uvalue` is null)
		select objectid id from dtproperties
			where property=`property` else
		select objectid id from dtproperties
			where property=`property` and uvalue=@uvalue
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure dt_getobjwithprop: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getobjwithprop]
	`property` varchar(30...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getobjwithprop]
	`property` varchar(30),
	`value` varchar(255)
AS `if` (`property` is null) or (@property = '')
	AS `raiserror`('Must specify a property name.',-1,-1)
		return (1)
	END;

	if (`value` is null)
		select objectid id from dtproperties
			where property=`property` else
		select objectid id from dtproperties
			where property=`property` and value=@value
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure dt_generateansiname: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
 
CREATE PROCEDURE `dt_generateansiname` (`name` varchar(255) o...' at line 1 (SQL: DELIMITER //
 
CREATE PROCEDURE `dt_generateansiname` (`name` varchar(255) output) 
AS `declare` `prologue` varchar(20) 
	declare `indexstring` varchar(20) 
	declare `index` integer 
 
	set @prologue = 'MSDT-A-' 
	set @index = 1 
 
	while 1 = 1 
	AS `set` @indexstring = cast(`index` AS `varchar`(20)) 
		set @name = @prologue + `indexstring` if not exists (select value from dtproperties where value = @name) 
			break 
		 
		set @index = @index + 1 
 
		if (@index = 10000) 
			goto TooMany 
	END; 
 
Leave: 
 
	return 
 
TooMany: 
 
	set @name = 'DIAGRAM' 
	goto Leave
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure dt_setpropertybyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_setpropertybyid_u]
	`id` int,
	`prope...' at line 1 (SQL: DELIMITER //

create   procedure [dt_setpropertybyid_u]
	`id` int,
	`property` varchar(64),
	`uvalue` nvarchar(255),
	`lvalue` image
AS `declare` `avalue` varchar(255) 
	set @avalue = null 
	if (`uvalue` is not null) 
	AS `if` (convert(nvarchar(255), convert(varchar(255), @uvalue)) = @uvalue) 
		AS `set` @avalue = convert(varchar(255), @uvalue) 
		END; 
		else 
		AS `if` 'DtgSchemaNAME' = `property` AS `exec` dt_generateansiname `avalue` output 
			END; 
		END; 
	END; 
	if exists (select * from dtproperties 
			where objectid=`id` and property=@property)
	AS `update` dtproperties set value=@avalue, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=`id` and property=`property` END;
	else
	AS `insert` dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @avalue, @uvalue, @lvalue)
	END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_Old]
     `KhoHangID` IN...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_Old]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS `A` INNER JOIN
            XePhuKienChiTiet AS `B` ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 1) AND (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure dt_dropuserobjectbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_dropuserobjectbyid]
	`id` int
AS `del...' at line 1 (SQL: DELIMITER //

create   procedure [dt_dropuserobjectbyid]
	`id` int
AS `delete` from dtproperties where objectid=@id
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN]
     `KhoHangID` INT,
...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS `A` INNER JOIN
            XePhuKienChiTiet AS `B` ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 0) AND (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure dt_droppropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_droppropertiesbyid]
	`id` int,
	`prop...' at line 1 (SQL: DELIMITER //

create   procedure [dt_droppropertiesbyid]
	`id` int,
	`property` varchar(64)
AS `if` (`property` is null) or (@property = '')
		delete from dtproperties where objectid=`id` else
		delete from dtproperties 
			where objectid=`id` and property=@property
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure dt_adduserobject: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_adduserobject]
AS `transaction`
		ins...' at line 1 (SQL: DELIMITER //

create   procedure [dt_adduserobject]
AS `transaction`
		insert dtproperties (property) VALUES ('DtgSchemaOBJECT')
		update dtproperties set objectid=@`identity` where id=@`identity` and property='DtgSchemaOBJECT'
	commit
	return @@identity
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKHAC]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKHAC]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVXuatKhac AS `A` INNER JOIN
			DVXuatKhacVatTu AS `B` ON A.ID = B.DVXuatKhacID INNER JOIN
			VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
			VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATDOIDONVI]
     `KhoHangID` INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATDOIDONVI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, A.SoLuong, A.DonGia, A.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS `A` INNER JOIN
            VatTu AS `V` ON A.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_BANGGIA]
     `DenNgay` nvarchar(20)...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_BANGGIA]
     `DenNgay` nvarchar(20)
AS `Declare` `V_Xe_BangGia_MaxID` Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT Max(B.ID) AS `MaxID`, B.XeID
			FROM   XeBangGia AS `A` INNER JOIN
				   XeBangGiaChiTiet AS `B` ON A.ID = B.XeBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive =1)
			GROUP BY B.XeID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.XeID, C.SoKhung, C.SoMay, X.MaXe, X.TenXe, X.SortDoiXe, X.SortLoaiXe, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, c.GiaApThue
	FROM   XeBangGia AS `B` INNER JOIN
           XeBangGiaChiTiet AS `C` ON B.ID = C.XeBangGiaID INNER JOIN
           `V_Xe_BangGia_MaxID` AS `V` ON C.ID = V.MaxID INNER JOIN
           Xe AS `X` ON C.XeID = X.ID	
	ORDER BY X.SortDoiXe
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON2]
	 `TuNgay` VARCHAR(1...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON2]
	 `TuNgay` VARCHAR(10),	 
     `DenNgay` VARCHAR(10)	 
AS `Declare` `NgayBatDauSuDung` VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare `Tb_VTTonDau` Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert `Tb_VTTonDau` SELECT T.VatTuID, SUM(T.SLNhap) AS `SLNhap`, SUM(T.TienNhap) AS `TienNhap`, SUM(T.SLXuat) AS `SLXuat`, SUM(T.TienXuat) AS `TienXuat` 
	
	FROM (
		
		SELECT	1 AS `a`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	2 AS `a`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	3 AS `a`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	5 AS `a`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	6 AS `a`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapKhac AS `A` INNER JOIN
				DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  8 AS `a`, C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
                XeNhapTraLaiBanLePhuKien AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS `A` ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  9 AS `a`, C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS `C` ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)		
		UNION ALL
		
		SELECT	10 AS `a`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanBuon AS `A` INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	11 AS `a`, B.VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, B.SoLuong AS `SLXuat`, B.TienVon AS `TienXuat`
		FROM	DVBanLe AS `A` INNER JOIN
				DVBanLeVatTu AS `B` ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	12 AS `a`, B.VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, B.SoLuong AS `SLXuat`, B.TienVon AS `TienXuat`
		FROM	DVBanSi AS `A` INNER JOIN
				DVBanSiVatTu AS `B` ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON]
	 `TuNgay` VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON]
	 `TuNgay` VARCHAR(10),	 
     `DenNgay` VARCHAR(10)	 
AS `Declare` `NgayBatDauSuDung` VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare `Tb_VTTonDau` Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert `Tb_VTTonDau` SELECT T.VatTuID, SUM(T.SLNhap) AS `SLNhap`, SUM(T.TienNhap) AS `TienNhap`, SUM(T.SLXuat) AS `SLXuat`, SUM(T.TienXuat) AS `TienXuat` 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapKhac AS `A` INNER JOIN
				DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
                XeNhapTraLaiBanLePhuKien AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS `A` ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS `C` ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanBuon AS `A` INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, B.SoLuong AS `SLXuat`, B.TienVon AS `TienXuat`
		FROM	DVBanLe AS `A` INNER JOIN
				DVBanLeVatTu AS `B` ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, B.SoLuong AS `SLXuat`,
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_TONDAU_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU_ALL]
     `KhoHangID` INT,
 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU_ALL]
     `KhoHangID` INT,
     `DenNgay` VARCHAR(10)
AS `Declare` `NgayBatDauSuDung` VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'	

	SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS `TDSLNhap`, SUM(T.TienNhap) AS `TDTienNhap`, SUM(T.SLXuat) AS `TDSLXuat`, SUM(T.TienXuat) AS `TDTienXuat` 
	FROM (
		
		SELECT	'N01' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N02' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N03' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N04' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNoiBo AS `A` INNER JOIN
				DVNoiBoVatTu AS `B` ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT	'N05' AS `MaTN`, A.KhoHangID, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID)
		UNION ALL
		
		SELECT	'N06' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapKhac AS `A` INNER JOIN
				DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT  'N07' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNoiBo AS `A` INNER JOIN
                XeNoiBoPhuKien AS `B` ON A.ID = B.XeNoiBoID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT  'N08' AS `MaTN`, A.KhoHangXuatID AS `KhoHangID`, C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
                XeNhapTraLaiBanLePhuKien AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS `A` ON A.ID = B.XeBanLeID INNER JOIN
				Va
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO_ALL_TEST]
     `KhoHangID` int...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO_ALL_TEST]
     `KhoHangID` int,
     `DenNgay` nvarchar(10)
AS `Declare` `Tb_VTTonDau` Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert `Tb_VTTonDau` Exec SP_VT_TONDAU_ALL @KhoHangID, `DenNgay` SELECT A.KhoHangID AS `KhoHangID`, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, A.TDSLNhap, A.TDSLXuat, (A.TDSLNhap - A.TDSLXuat) AS `SoLuongTon`
	FROM `Tb_VTTonDau` AS `A` INNER JOIN
			VatTu AS `V` ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) < 0
	order by  A.VatTuID

	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_XUATNOIBO]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_XUATNOIBO]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeNoiBo AS `A` INNER JOIN
			XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.IsXacNhan=1)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_VT_TONKHO_ALL]
     `KhoHangID` int,
  ...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_VT_TONKHO_ALL]
     `KhoHangID` int,
     `DenNgay` nvarchar(10)
AS `Declare` `Tb_VTTonDau` Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert `Tb_VTTonDau` Exec SP_VT_TONDAU_ALL @KhoHangID, `DenNgay` SELECT A.KhoHangID AS `KhoHangID`, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS `SoLuongTon`
	FROM `Tb_VTTonDau` AS `A` INNER JOIN
			VatTu AS `V` ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPNOIBO]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPNOIBO]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeNoiBo AS `A` INNER JOIN
			XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU]
     `KhoHangID` INT,
     ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU]
     `KhoHangID` INT,
     `DenNgay` VARCHAR(10),	 
	 `VatTuID` INT,
	 `MaTacNghiep` VARCHAR(1),
	 `IDTacNghiep` INT
AS `DECLARE` `NgayBatDauSuDung` VARCHAR(10), 
		`DVBanLeID` INT, `DVBanSiID` INT, `DVNoiBoID` INT, `DoiDonViID` INT, `DVXuatKhacID` INT, `XeBanLeKMID` INT, 
		`DVBanLeKMID` INT, `XePhuKienID` INT, `XePhuKienNoiBoID` INT, `DVBanBuonID` INT, `XeBanSiKMID` INT, `XeBanLeBHID` INT
	SET @NgayBatDauSuDung = '2019-12-19'
	SET @DVBanLeID = 0 	
	SET @DVBanSiID = 0
	SET @DVNoiBoID = 0
	SET @DoiDonViID = 0
	SET @DVXuatKhacID = 0
	SET @XeBanLeKMID = 0
	SET @DVBanLeKMID = 0
	SET @XePhuKienID = 0
	SET @XePhuKienNoiBoID = 0
	SET @DVBanBuonID = 0
	SET @XeBanSiKMID = 0
	SET @XeBanLeBHID = 0

	IF(@MaTacNghiep ='I')			SET @DVBanLeID = `IDTacNghiep` ELSE IF(@MaTacNghiep='J')		SET @DVBanSiID = `IDTacNghiep` ELSE IF(@MaTacNghiep='K')		SET @DVNoiBoID = `IDTacNghiep` ELSE IF(@MaTacNghiep='L')		SET @DoiDonViID = `IDTacNghiep` ELSE IF(@MaTacNghiep='M')		SET @DVXuatKhacID = `IDTacNghiep` ELSE IF(@MaTacNghiep='N')		SET @XeBanLeKMID = `IDTacNghiep` ELSE IF(@MaTacNghiep='O')		SET @DVBanLeKMID = `IDTacNghiep` ELSE IF(@MaTacNghiep='P')		SET @XePhuKienID = `IDTacNghiep` ELSE IF(@MaTacNghiep='Q')		SET @XePhuKienNoiBoID = `IDTacNghiep` ELSE IF(@MaTacNghiep='R')		SET @DVBanBuonID = `IDTacNghiep` ELSE IF(@MaTacNghiep='S')		SET @XeBanSiKMID = `IDTacNghiep` ELSE IF(@MaTacNghiep='T')		SET @XeBanLeBHID = `IDTacNghiep` SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS `TDSLNhap`, SUM(T.TienNhap) AS `TDTienNhap`, SUM(T.SLXuat) AS `TDSLXuat`, SUM(T.TienXuat) AS `TDTienXuat` 
	FROM (
		
		SELECT	'N01' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNoiBo AS `A` INNER JOIN
				DVNoiBoVatTu AS `B` ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS `MaTN`, A.KhoHangID, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATNOIBO]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATNOIBO]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS `A` INNER JOIN
            DVNoiBoVatTu AS `B` ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO]
     `KhoHangID` INT,
     `...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO]
     `KhoHangID` INT,
     `DenNgay` nvarchar(10),
	 `VatTuID` INT,
	 `MaTacNghiep` VARCHAR(1),
	 `IDTacNghiep` INT
AS `DECLARE` `Tb_VTTonDau` Table (KhoHangID INT, VatTuID INT, TDSLNhap INT, TDTienNhap FLOAT, TDSLXuat INT, TDTienXuat FLOAT)
	INSERT `Tb_VTTonDau` Exec SP_VT_TONDAU @KhoHangID, @DenNgay, @VatTuID, @MaTacNghiep, `IDTacNghiep` SELECT A.KhoHangID AS `KhoHangID`, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS `SoLuongTon`
	FROM `Tb_VTTonDau` AS `A` INNER JOIN
			VatTu AS `V` ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPNOIBO]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPNOIBO]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS `A` INNER JOIN
            DVNoiBoVatTu AS `B` ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.IsXacNhan = 1) AND (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_SELECT_GIAVON_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_SELECT_GIAVON_TEST]
	 `TuNgay` VARCH...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_SELECT_GIAVON_TEST]
	 `TuNgay` VARCHAR(10),	 
     `DenNgay` VARCHAR(10)	 
AS `Declare` `NgayBatDauSuDung` VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare `Tb_VTTonDau` Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert `Tb_VTTonDau` SELECT T.VatTuID, SUM(T.SLNhap) AS `SLNhap`, SUM(T.TienNhap) AS `TienNhap`, SUM(T.SLXuat) AS `SLXuat`, SUM(T.TienXuat) AS `TienXuat` 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, (1 - A.TyLeCK*0.01) * B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapKhac AS `A` INNER JOIN
				DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
                XeNhapTraLaiBanLePhuKien AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS `A` ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanBuon AS `A` INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, 1 AS `SLNhap`, C.GiaBanBH AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
                XeNhapTraLaiBanLeBaoHiem AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS `A` ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, B.SoLuong AS `SLXuat`, B.TienVon AS `TienXuat`
		FROM	DVBanLe AS `A` INNER JOIN
				DVBanLeVatTu AS `B` ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, B.SoLuong AS `SLXuat`, B.TienVon AS `TienXuat`
		FROM	DVBanSi AS `A` INNER JOIN
				DVBanSiVatTu AS `B` ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT < @TuNgay)
		UNION ALL
		
		SELECT  VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, SoLuong AS `SLXuat`, ThanhTien AS `TienXuat`
		FROM    DoiDonVi AS `A`    
	
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_NHAPXUAT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPXUAT]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPXUAT]
     `KhoHangID` INT,
	 `VatTuID` INT,
	 `TuNgay` VARCHAR(10),	 
     `DenNgay` VARCHAR(10)	 	 
AS `SELECT` T.SoCT, T.NgayCT, T.NgayNXK, T.KhoHangNhapID, T.KhoHangXuatID, T.KhachHangID, T.VatTuID, T.SLNhap, T.SLXuat 
	FROM (
		
		SELECT	'N01' AS `MaTN`, A.SoCT, A.NgayCT, A.NgayCT AS `NgayNXK`, A.KhoHangNhapID, NULL AS `KhoHangXuatID`, A.KhachHangID, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS `MaTN`, A.SoCT, A.NgayCT, A.NgayCT AS `NgayNXK`, A.KhoHangNhapID, NULL AS `KhoHangXuatID`, C.KhachHangID, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
                DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
                DVBanLe AS `C` ON A.DVBanLeID = C.ID   
		WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS `MaTN`, A.SoCT, A.NgayCT, A.NgayCT AS `NgayNXK`, A.KhoHangNhapID, NULL AS `KhoHangXuatID`, C.KhachHangID, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
                DVBanSi AS `C` ON A.DVBanSiID = C.ID
		WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS `MaTN`, A.SoCT, A.NgayCT, A.NgayCT AS `NgayNXK`, A.KhoHangNhapID, A.KhoHangXuatID, NULL AS `KhachHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNoiBo AS `A` INNER JOIN
				DVNoiBoVatTu AS `B` ON A.ID = B.DVNoiBoID
		WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS `MaTN`, A.SoCT, A.NgayCT, A.NgayCT AS `NgayNXK`, A.KhoHangID AS `KhoHangNhapID`, NULL AS `KhoHangXuatID`, NULL AS `KhachHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N06' AS `MaTN`, A.SoCT, A.NgayCT, A.NgayCT AS `NgayNXK`, A.KhoHangNhapID, NULL AS `KhoHangXuatID`, NULL AS `KhachHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapKhac AS `A` INNER JOIN
				DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  'N07' AS `MaTN`, A.SoCT, A.NgayCT, A.NgayCT AS `NgayNXK`, A.KhoHangNhapID, NULL AS `KhoHangXuatID`, NULL AS `KhachHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNoiBo AS `A` INNER JOIN
                XeNoiBoPhuKien AS `B` ON A.ID = B.XeNoiBoID
		WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)		
		UNION ALL
		
		SELECT  'N08' AS `MaTN`, B.SoCT, B.NgayCT, B.NgayCT AS `NgayNXK`, A.KhoHangXuatID AS `KhoHangNhapID`, NULL AS `KhoHangXuatID`, a.KhachHangID, C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_NHAPDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPDOIDONVI]
     `KhoHangID` INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPDOIDONVI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS `A` INNER JOIN
            DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XECHUYENKHO]
     `KhoHa...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XECHUYENKHO]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS `KhoHangID`, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS `A` INNER JOIN
            XeNoiBoPhuKien AS `B` ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_GET_GIAVON]
	 `TuNgay` VARCHAR(10),	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_GET_GIAVON]
	 `TuNgay` VARCHAR(10),	 
     `DenNgay` VARCHAR(10),
	 `VatTuID` int
AS `Declare` `NgayBatDauSuDung` VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare `Tb_VTTonDau` Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert `Tb_VTTonDau` SELECT T.VatTuID, SUM(T.SLNhap) AS `SLNhap`, SUM(T.TienNhap) AS `TienNhap`, SUM(T.SLXuat) AS `SLXuat`, SUM(T.TienXuat) AS `TienXuat` 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapKhac AS `A` INNER JOIN
				DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
                XeNhapTraLaiBanLePhuKien AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS `A` ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS `C` ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanBuon AS `A` INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, B.SoLuong AS `SLXuat`, B.TienVon AS `TienXuat`
		FROM	DVBanLe AS `A` INNER JOIN
				DVBanLeVatTu AS `B` ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.Nga
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_XECHUYENKHO]
     `KhoHa...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_XECHUYENKHO]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS `A` INNER JOIN
            XeNoiBoPhuKien AS `B` ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan = 1)
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_DELETE_DUPLICATE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_DELETE_DUPLICATE]
	 `VatTuID_DEL` in...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_DELETE_DUPLICATE]
	 `VatTuID_DEL` int,	 
     `VatTuID` int	 
AS `update` DoiDonVi						set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DoiDonViChiTiet				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVBanLeVatTu					set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVBanSiVatTu					set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVNhapKhacVatTu				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVNhapMuaVatTu				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVNhapTraLaiBanLeChiTiet		set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVNhapTraLaiBanSiChiTiet		set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVNoiBoVatTu					set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVXuatKhacVatTu				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update VTBangGiaChiTiet				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update XeBanLeKhuyenMai				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update XeBanLePhuKien				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update XeNhapTraLaiBanLeKhuyenMai	set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update XeNhapTraLaiBanLePhuKien		set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update XeNoiBoPhuKien				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update XePhuKienChiTiet				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` Delete VatTu where (ID = @VatTuID_DEL)

END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XEBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XEBANLE]
     `KhoHangID...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XEBANLE]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS `KhoHangID`, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, b.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeBanLe AS `A` INNER JOIN
            XeBanLePhuKien AS `B` ON A.ID = B.XeBanLeID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE   (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHLE]
     `KhoHangID` INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHLE]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS `L` INNER JOIN
            VatTu AS `V` ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS `A` INNER JOIN
            XeBanLeKhuyenMai AS `B` ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure dt_verstamp007: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_verstamp007]
AS `select` 7005
//
DELIM...' at line 1 (SQL: DELIMITER //

create   procedure [dt_verstamp007]
AS `select` 7005
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATKMBH_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBH_Old]
     `KhoHangID` INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBH_Old]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS `L` INNER JOIN
            VatTu AS `V` ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS `A` INNER JOIN
            XeBanLeKhuyenMai AS `B` ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure dt_verstamp006: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_verstamp006]
AS `select` 7000
//
DELIM...' at line 1 (SQL: DELIMITER //

create   procedure [dt_verstamp006]
AS `select` 7000
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATBAOHIEM_BHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBAOHIEM_BHLE]
     `KhoHangID` I...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBAOHIEM_BHLE]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, B.NgayXuat AS `NgayCT`, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, 1 AS `SoLuong`, B.GiaBanBH, B.GiaBanBH AS `ThanhTien`, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS `L` INNER JOIN
            VatTu AS `V` ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS `A` INNER JOIN
            XeBanLeBaoHiem AS `B` ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_TRALAI]
     `KhoHangID`...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_TRALAI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  B.ID, B.SoCT, C.NgayNhap AS `NgayCT`, A.KhoHangXuatID AS `KhoHangID`, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
            XeNhapTraLaiBanLePhuKien AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS `A` ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS `V` ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_NHAPKHUYENMAI_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHUYENMAI_TRALAI]
     `KhoHangI...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHUYENMAI_TRALAI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  B.ID, B.SoCT, B.NgayCT, A.KhoHangXuatID AS `KhoHangID`, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
            XeNhapTraLaiBanLeKhuyenMai AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS `A` ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS `V` ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRASI]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRASI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeBanSi AS `A` INNER JOIN
			XeNhapTraLaiBanSi AS `B` ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS `C` ON B.ID = C.XeNhapTraLaiBanSiID
	WHERE (B.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.XeNhapMuaID IS NOT NULL)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_NHAPBAOHIEM_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPBAOHIEM_TRALAI]
     `KhoHangID`...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPBAOHIEM_TRALAI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  B.ID, B.SoCT, C.NgayNhap AS `NgayCT`, A.KhoHangXuatID AS `KhoHangID`, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, 1 AS `SoLuong`, C.GiaBanBH AS `DonGia`, C.GiaBanBH AS `ThanhTien`, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
            XeNhapTraLaiBanLeBaoHiem AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS `A` ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS `V` ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRALE]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRALE]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanLe AS `A` INNER JOIN
            DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_TEST_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TEST_1]   
AS `select` count(ID) BEGIN '...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TEST_1]   
AS `select` count(ID) BEGIN 'VT' from VatTu
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TEST]
     `VatTuID` INT     
AS `selec...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TEST]
     `VatTuID` INT     
AS `select` * from VatTu where ID = `VatTuID` END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_DV_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_DV_BANGGIA]
     `DenNgay` nvarchar(10),...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_DV_BANGGIA]
     `DenNgay` nvarchar(10),
	 `CuaHangID` nvarchar(2)
AS `Declare` `V_DV_BangGia_MaxID` Table (MaxID int, DichVuID int)
	Insert @V_DV_BangGia_MaxID(MaxID, DichVuID) 
			SELECT Max(B.ID) AS `MaxID`, B.DichVuID
			FROM   DVBangGia AS `A` INNER JOIN
				   DVBangGiaChiTiet AS `B` ON A.ID = B.DVBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.CuaHangID = @CuaHangID)
			GROUP BY B.DichVuID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.DichVuID, V.MaDichVu, V.HangMuc, C.DonGia
	FROM   DVBangGia AS `B` INNER JOIN
           DVBangGiaChiTiet AS `C` ON B.ID = C.DVBangGiaID INNER JOIN
           `V_DV_BangGia_MaxID` AS `M` ON C.ID = M.MaxID INNER JOIN
           DichVu AS `V` ON C.DichVuID = V.ID	
	ORDER BY V.MaDichVu
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHSI]
     `KhoHangID` INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHSI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS `L` INNER JOIN
            VatTu AS `V` ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanSi AS `A` INNER JOIN
            XeBanSiKhuyenMai AS `B` ON A.ID = B.XeBanSiID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE[SP_VT_BANGGIA]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE[SP_VT_BANGGIA]
                                `DenNgay` nvarchar(10),
	                            `CuaHangID` nvarchar(2)
                            AS `Declare` `V_VT_BangGia_MaxID` Table(MaxID int, VatTuID int)
                                Insert @V_VT_BangGia_MaxID(MaxID, VatTuID)
                                        SELECT Max(B.ID) AS `MaxID`, B.VatTuID
                                        FROM   VTBangGia AS `A` CROSS APPLY STRING_SPLIT(CuaHangID, ',') INNER JOIN
                                               VTBangGiaChiTiet AS `B` ON A.ID = B.VTBangGiaID
                                        WHERE(A.ApDungTu <= @DenNgay) AND(A.ApDungDen >= @DenNgay) AND (value = @CuaHangID)
                                        GROUP BY B.VatTuID

                                SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.VatTuLoaiID, L.VatTuNhomID, C.GiaNhap, C.GiaXuat
                                FROM   VTBangGia AS `B` INNER JOIN
                                       VTBangGiaChiTiet AS `C` ON B.ID = C.VTBangGiaID INNER JOIN
                                       `V_VT_BangGia_MaxID` AS `M` ON C.ID = M.MaxID INNER JOIN
                                       VatTu AS `V` ON C.VatTuID = V.ID INNER JOIN
                                       VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
                            END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_NHAPKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHAC]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHAC]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapKhac AS `A` INNER JOIN
            DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI_TONGHOP]     
	 `TuNgay` V...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI_TONGHOP]     
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeBanSi AS `A` INNER JOIN
			XeBanSiChiTiet AS `B` ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay)		
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeBanSi AS `A` INNER JOIN
			XeBanSiChiTiet AS `B` ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_TONDAU]
     `KhoHangID` INT,
     ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_TONDAU]
     `KhoHangID` INT,
     `DenNgay` VARCHAR(10),
	 `XeBanLeID` INT,
	 `XeBanSiID` INT,
	 `XeNoiBoID` INT,
	 `XeXuatKhacID` INT
AS `SELECT` T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS `TDSLNhap`, SUM(T.SLXuat) AS `TDSLXuat`
	FROM (
		
		SELECT 'A' AS `MaTN`, KhoHangNhapID AS `KhoHangID`, XeID, ID AS `XeNhapMuaID`, 1 AS `SLNhap`, 0 AS `SLXuat` 
		FROM XeNhapMua 
		WHERE (NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT 'B' AS `TN`, A.KhoHangNhapID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 1 AS `SLNhap`, 0 AS `SLXuat`
		FROM XeNoiBo AS `A` INNER JOIN
				XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
		UNION ALL
		
		SELECT 'C' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, A.XeID, A.XeNhapMuaID, 1 AS `SLNhap`, 0 AS `SLXuat`
		FROM XeBanLe  AS `A` INNER JOIN
				XeNhapTraLaiBanLe  AS `B` ON A.ID = B.XeBanLeID    
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'D' AS `TN`, A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS `SLNhap`, 0 AS `SLXuat`
		FROM XeBanSi AS `A` INNER JOIN
				XeNhapTraLaiBanSi AS `B` ON A.ID = B.XeBanSiID INNER JOIN
				XeNhapTraLaiBanSiChiTiet AS `C` ON B.ID = C.XeNhapTraLaiBanSiID
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
		UNION ALL
		
		SELECT 'E' AS `TN`, KhoHangXuatID AS `KhoHangID`, XeID, XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
		FROM XeBanLe     
		WHERE (NgayBan <= @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'F' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
		FROM XeBanSi AS `A` INNER JOIN
				XeBanSiChiTiet AS `B` ON A.ID = B.XeBanSiID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeBanSiID)
		UNION ALL
		
		SELECT 'G' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
		FROM XeNoiBo AS `A` INNER JOIN
				XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeNoiBoID) 
		UNION ALL
		
		SELECT 'H' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
		FROM XeXuatKhac AS `A` INNER JOIN
				XeXuatKhacChiTiet AS `B` ON A.ID = B.XeXuatKhacID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeXuatKhacID)
	) AS `T`
	GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID
END;


//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_TONKHO]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_TONKHO]
                                 `KhoHangID` int,
                                 `DenNgay` nvarchar(10),
	                             `XeBanLeID` INT,
	                             `XeBanSiID` INT,
	                             `XeNoiBoID` INT,
	                             `XeXuatKhacID` INT
                            AS `Declare` `Tb_XeTonDau` Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)
	                            Insert `Tb_XeTonDau` Exec SP_XE_TONDAU @KhoHangID, @DenNgay, @XeBanLeID, @XeBanSiID, @XeNoiBoID, `XeXuatKhacID` SELECT A.KhoHangID, B.KhoHangNhapID, A.XeID, X.MaXe, X.TenXe, A.XeNhapMuaID, B.KhachHangID AS `NhaCungCapID`, B.DonGia_CoVAT, B.NgayCT, B.SoKhung, B.SoMay, B.MaChiaKhoa, (A.TDSLNhap - A.TDSLXuat) AS `SoLuongTon`, B.GhiChu, B.MaChiaKhoa
	                            FROM `Tb_XeTonDau` AS `A` INNER JOIN
			                            XeNhapMua AS `B` ON A.XeNhapMuaID = B.ID INNER JOIN
			                            Xe AS `X` ON A.XeID = X.ID 
	                            WHERE (A.TDSLNhap - A.TDSLXuat) <>0
                            END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_NHAPXUATTON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_NHAPXUATTON]
     `KhoHangID` int,
	 `T...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_NHAPXUATTON]
     `KhoHangID` int,
	 `TuNgay` nvarchar(10),
     `DenNgay` nvarchar(10)
AS `Declare` `Tb_XeTonDau` Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)

	declare `XeBanLeID` int, `XeBanSiID` int, `XeNoiBoID` int
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0

	Insert `Tb_XeTonDau` Exec SP_XE_TONDAU @KhoHangID, @TuNgay, @XeBanLeID, @XeBanSiID, `XeNoiBoID` SELECT NXT.* FROM (
		SELECT 'T' AS `TN`, KhoHangID, XeID, XeNhapMuaID, (TDSLNhap - TDSLXuat) AS `TDSL`
		FROM `Tb_XeTonDau` UNION ALL
		SELECT 'B' AS `TN`, A.KhoHangNhapID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 1 AS `SoLuong`
		FROM XeNoiBo AS `A` INNER JOIN
			 XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID    
		WHERE A.NgayCT < `DenNgay` AND KhoHangNhapID = @KhoHangID   
	) AS `NXT` 
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_LICHSU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_LICHSU]
     `XeNhapMuaID` INT
AS `...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_LICHSU]
     `XeNhapMuaID` INT
AS `SELECT` 'A' AS `MaTN`, ID, KhoHangNhapID, Null AS `KhoHangXuatID`, XeID, ID AS `XeNhapMuaID`, SoCT, NgayCT, NULL AS `NgayBan`, CreatedBy, SoKhung, SoMay 
	FROM XeNhapMua 
	WHERE (ID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'B' AS `TN`, A.ID, A.KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, NULL AS `NgayBan`, A.CreatedBy, M.SoKhung, M.SoMay 
	FROM XeNoiBo AS `A` INNER JOIN
			XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID INNER JOIN
			XeNhapMua AS `M` ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'C' AS `TN`, B.ID, A.KhoHangXuatID AS `KhoHangNhapID`, null AS `KhoHangXuatID`, A.XeID, A.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS `NgayBan`, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe  AS `A` INNER JOIN
			XeNhapTraLaiBanLe  AS `B` ON A.ID = B.XeBanLeID INNER JOIN
			XeNhapMua AS `M` ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'D' AS `TN`, B.ID, A.KhoHangXuatID AS `KhoHangNhapID`, null AS `KhoHangXuatID`, C.XeID, C.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS `NgayBan`, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS `A` INNER JOIN
			XeNhapTraLaiBanSi AS `B` ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS `C` ON B.ID = C.XeNhapTraLaiBanSiID INNER JOIN
			XeNhapMua AS `M` ON C.XeNhapMuaID = M.ID
	WHERE (C.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'E' AS `TN`, A.ID, Null AS `KhoHangNhapID`, A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe AS `A` INNER JOIN
			XeNhapMua AS `M` ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'F' AS `TN`, A.ID, Null AS `KhoHangNhapID`, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS `NgayBan`, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS `A` INNER JOIN
			XeBanSiChiTiet AS `B` ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapMua AS `M` ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'G' AS `TN`, A.ID, Null AS `KhoHangNhapID`, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS `NgayBan`, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeXuatKhac AS `A` INNER JOIN
			XeXuatKhacChiTiet AS `B` ON A.ID = B.XeXuatKhacID INNER JOIN
			XeNhapMua AS `M` ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	
	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE_TONGHOP]     
	 `TuNgay` V...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE_TONGHOP]     
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` KhoHangXuatID AS `KhoHangID`, XeID, XeNhapMuaID, 1 AS `SoLuong`
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN `TuNgay` AND @DenNgay) AND (XeNhapMuaID IS NOT NULL)
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` KhoHangXuatID AS `KhoHangID`, XeID, XeNhapMuaID, 1 AS `SoLuong`
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN `TuNgay` AND @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (XeNhapMuaID IS NOT NULL)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_TONKHO_BY_XEID: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_TONKHO_BY_XEID]     
     `DenNgay` ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_TONKHO_BY_XEID]     
     `DenNgay` VARCHAR(10),
	 `XeID` INT,
	 `IDPhieu` INT,
	 `LoaiPhieu` INT,
	 `SoMay` VARCHAR(20)
AS `Declare` `XeBanLeID` INT,	`XeBanSiID` INT, `XeNoiBoID` INT, `XeXuatKhacID` INT
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0
	SET @XeXuatKhacID = 0

	if(@LoaiPhieu = 1)
		SET @XeBanLeID = `IDPhieu` else if(@LoaiPhieu = 2)
		SET @XeBanSiID = `IDPhieu` else if(@LoaiPhieu = 3)
		SET @XeNoiBoID = `IDPhieu` else if(@LoaiPhieu = 4)
		SET @XeXuatKhacID = `IDPhieu` Declare `Tb_XeTonKho` Table (KhoHangID int, XeID int, XeNhapMuaID int, SLNhap int, SLXuat int)

	Insert `Tb_XeTonKho` SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS `TDSLNhap`, SUM(T.SLXuat) AS `TDSLXuat`
		FROM (
			
			SELECT 'A' AS `MaTN`, KhoHangNhapID AS `KhoHangID`, XeID, ID AS `XeNhapMuaID`, 1 AS `SLNhap`, 0 AS `SLXuat` 
			FROM XeNhapMua 
			WHERE (NgayCT <= @DenNgay) AND (XeID = @XeID)
			UNION ALL
			
			SELECT 'B' AS `TN`, A.KhoHangNhapID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 1 AS `SLNhap`, 0 AS `SLXuat`
			FROM XeNoiBo AS `A` INNER JOIN
					XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.IsXacNhan=1)
			UNION ALL
			
			SELECT 'C' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, A.XeID, A.XeNhapMuaID, 1 AS `SLNhap`, 0 AS `SLXuat`
			FROM XeBanLe  AS `A` INNER JOIN
					XeNhapTraLaiBanLe  AS `B` ON A.ID = B.XeBanLeID    
			WHERE (B.NgayCT <= @DenNgay) AND (A.XeID = @XeID) AND (A.XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'D' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, C.XeID, C.XeNhapMuaID, 1 AS `SLNhap`, 0 AS `SLXuat`
			FROM XeBanSi AS `A` INNER JOIN
					XeNhapTraLaiBanSi AS `B` ON A.ID = B.XeBanSiID INNER JOIN
					XeNhapTraLaiBanSiChiTiet AS `C` ON B.ID = C.XeNhapTraLaiBanSiID
			WHERE (B.NgayCT <= @DenNgay) AND (C.XeID = @XeID)
			UNION ALL
			
			SELECT 'E' AS `TN`, KhoHangXuatID AS `KhoHangID`, XeID, XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
			FROM XeBanLe     
			WHERE (NgayBan <= @DenNgay) AND (XeID = @XeID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'F' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
			FROM XeBanSi AS `A` INNER JOIN
					XeBanSiChiTiet AS `B` ON A.ID = B.XeBanSiID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeBanSiID)
			UNION ALL
			
			SELECT 'G' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
			FROM XeNoiBo AS `A` INNER JOIN
					XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeNoiBoID) 
			UNION ALL
			
			SELECT 'F' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
			FROM XeXuatKhac AS `A` INNER JOIN
					XeXuatKhacChiTiet AS `B` ON A.ID = B.XeXuatKhacID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeXuatKhacID)
		) AS `T`
		GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID

		if(LEN(@SoMay)>0)
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS `SLTON`,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM `Tb_XeTonKho` AS `A` INNER JOIN
					XeNhapMua AS `B` ON A.XeNhapMuaID = B.ID INNER JOIN
					Xe AS `X` ON A.XeID = X.ID INNER JOIN 
					KhoHang AS `K` ON A.KhoHangID = K.ID 
			WHERE SLNhap-SLXuat<>0 AND (B.SoMay Like N'%' + @SoMay)
		else
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS `SLTON`,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM `Tb_XeTonKho` AS `A` INNER JOIN
					XeNh
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRALE]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRALE]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeBanLe  AS `A` INNER JOIN
			XeNhapTraLaiBanLe  AS `B` ON A.ID = B.XeBanLeID    
	WHERE (B.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA_GROUP]
     `KhoHangID` INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA_GROUP]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, SUM(B.SoLuong) AS `SoLuong`, SUM(B.ThanhTien) AS `ThanhTien`, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS `A` INNER JOIN
            DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA]
     `KhoHangID` INT,
	 `T...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS `A` INNER JOIN
            DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRASI]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRASI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanSi AS `A` INNER JOIN
            DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANSI]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANSI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanSi AS `A` INNER JOIN
            DVBanSiVatTu AS `B` ON A.ID = B.DVBanSiID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure uspGetChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc [uspGetChiTien1]
`ID` int
AS `SELECT`     ...' at line 1 (SQL: DELIMITER //
CREATE         proc [uspGetChiTien1]
`ID` int
AS `SELECT`        ChiTien.ID, KhachHang.TenKhachHang, ChiTienLyDo.TenLyDo, ChiTien.SoTien, TaiKhoan.TenTaiKhoan, ChiTien.GhiChu, ChiTien.CuaHangID, ChiTien.CreatedBy, 
                         ChiTien.CreatedAt, ChiTien.UpdatedBy, ChiTien.UpdatedAt
FROM            ChiTien INNER JOIN
                         KhachHang ON ChiTien.KhachHangID = KhachHang.ID INNER JOIN
                         ChiTienLyDo ON ChiTien.ChiTienLyDoID = ChiTienLyDo.ID INNER JOIN
                         TaiKhoan ON ChiTien.TaiKhoanID = TaiKhoan.ID
WHERE ChiTien.ID= @ID
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure uspChiTien2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
create         proc [uspChiTien2]
`ID` int,
`Status` int,
`Ap...' at line 1 (SQL: DELIMITER //
create         proc [uspChiTien2]
`ID` int,
`Status` int,
`ApprovalBy` int
AS `UPDATE` ChiTien SET [Status2] = @Status, Approval2By = @ApprovalBy, Approval2At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_XE_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_NHAPMUA]
     `KhoHangID` INT,
	 `T...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_NHAPMUA]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` KhoHangNhapID, XeID, ID AS `XeNhapMuaID`, 1 AS `SoLuong` 
	FROM XeNhapMua 
	WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (KhoHangNhapID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure uspChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc [uspChiTien1]
`ID` int,
`Status` int,
`Ap...' at line 1 (SQL: DELIMITER //
CREATE         proc [uspChiTien1]
`ID` int,
`Status` int,
`ApprovalBy` int
AS `UPDATE` ChiTien SET [Status1] = @Status, Approval1By = @ApprovalBy, Approval1At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE_GROUP]
     `KhoHangID` IN...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE_GROUP]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, SUM(B.SoLuong) AS `SoLuong`, SUM(B.ThanhTien) AS `ThanhTien`, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS `A` INNER JOIN
            DVBanLeVatTu AS `B` ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure upsChiTienPowerApps: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [upsChiTienPowerApps]
AS `Declare` `TuNgay` ...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [upsChiTienPowerApps]
AS `Declare` `TuNgay` VARCHAR(10), `DenNgay` VARCHAR(10)

	set @TuNgay = CONVERT(VARCHAR(10), DATEADD(DAY, -30, NOW()), 101)
	set @DenNgay = CONVERT(VARCHAR(10), NOW(), 101)

	SELECT * FROM ChiTien WHERE NgayCT between `TuNgay` and `DenNgay` END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON_KHOHANG: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //



CREATE PROCEDURE `SP_VT_GET_GIAVON_KHOHANG`
	 `TuNgay` VAR...' at line 1 (SQL: DELIMITER //



CREATE PROCEDURE `SP_VT_GET_GIAVON_KHOHANG`
	 `TuNgay` VARCHAR(10),	 
     `DenNgay` VARCHAR(10),
	 `KhoHangID` int,
	 `VatTuID` int
AS `Declare` `NgayBatDauSuDung` VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	Declare `Tb_VTTonDau` Table (KhoHangID int, VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert `Tb_VTTonDau` SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS `SLNhap`, SUM(T.TienNhap) AS `TienNhap`, SUM(T.SLXuat) AS `SLXuat`, SUM(T.TienXuat) AS `TienXuat` 
	FROM (
		
		SELECT	A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangID, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapKhac AS `A` INNER JOIN
				DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS `KhoHangID`, C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
                XeNhapTraLaiBanLePhuKien AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS `A` ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS `KhoHangID`, C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
				XeBanLe AS `A` ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanBuon AS `A` INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		
		
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.SoPhieu, A.KhoHangXuatID, A.KhachHangID, B.NgayXuat, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS `A` INNER JOIN
            DVBanLeVatTu AS `B` ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure spCheckPhieuChi: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE `spCheckPhieuChi` (
		`khohangID` varchar(10)...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE `spCheckPhieuChi` (
		`khohangID` varchar(10)
)
	AS `select`	* from ChiTien
				where	KhoHangID = `khohangID` END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_FIX_SLVT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_FIX_SLVT]
AS `Declare` `Tb_SLVT` Table (...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_FIX_SLVT]
AS `Declare` `Tb_SLVT` Table (DVBanLeID int, SoLuongVT float)

	Insert @Tb_SLVT(DVBanLeID, SoLuongVT) 
	select DVBanLeID, Sum(SoLuong) AS `SoLuongVT` from DVBanLeVatTu group by DVBanLeID
	
	UPDATE DVBanLe 
    SET DVBanLe.TongSoLuongVatTu = B.SoLuongVT            
	FROM DVBanLe INNER JOIN `Tb_SLVT` AS `B` ON DVBanLe.ID = B.DVBanLeID 
	where B.SoLuongVT is not null
	
 
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_TC_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TC_TONDAU]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TC_TONDAU]
                                 `TaiKhoanID` INT,
                                 `TuNgay` VARCHAR(10),
	                             `DenNgay` VARCHAR(10)	 
                            AS `SELECT` T.TaiKhoanID, T.TacNghiep, SUM(T.SoTien) AS `SoTien`
	                            FROM (
		                            
		                            SELECT 1 AS `MaTN`, TaiKhoanID, SUM(SoTien) AS `SoTien`, TacNghiep 
		                            FROM XeBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 2 AS `MaTN`, TaiKhoanID, SUM(SoTien) AS `SoTien`, TacNghiep 
		                            FROM XeBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 3 AS `MaTN`, TaiKhoanID, SUM(GiaNhap) AS `SoTien`, 1 AS `TacNghiep`
		                            FROM XeSonXe 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 4 AS `MaTN`, TaiKhoanID, SUM(SoTien) AS `SoTien`, 0 AS `TacNghiep`
		                            FROM ThuTien 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 5 AS `MaTN`, TaiKhoanID, SUM(SoTien) AS `SoTien`, 1 AS `TacNghiep`
		                            FROM ChiTien 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 6 AS `MaTN`, TaiKhoanID, SUM(SoTien) AS `SoTien`, TacNghiep 
		                            FROM DVBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 7 AS `MaTN`, TaiKhoanID, SUM(SoTien) AS `SoTien`, TacNghiep 
		                            FROM DVBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 8 AS `MaTN`, TaiKhoanID, SUM(SoTien) AS `SoTien`, TacNghiep 
		                            FROM DVBanBuonThanhToan 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 9 AS `MaTN`, T.TaiKhoanID, SUM(G.ChiPhi) AS `SoTien`, 1 AS `TacNghiep` 
                                    FROM DVBanLe AS `A` INNER JOIN 
                                        KhoHang AS `K` ON A.KhoHangXuatID = K.ID INNER JOIN 
	
//
DELIMITER ;)  
[2024-07-18 16:27:14] local.ERROR: Error creating stored procedure SP_VT_NHAPTRABUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRABUON]
     `KhoHangID` INT,
...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRABUON]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanBuon AS `A` INNER JOIN
            DVNhapTraLaiBanBuonChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanbuonID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_XUATBANBUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANBUON]
     `KhoHangID` INT,
...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANBUON]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanBuon AS `A` INNER JOIN
            DVBanBuonVatTu AS `B` ON A.ID = B.DVBanBuonID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC_TONGHOP]     
	 `TuNgay` VA...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC_TONGHOP]     
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeXuatKhac AS `A` INNER JOIN
			XeXuatKhacChiTiet AS `B` ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay)		
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeXuatKhac AS `A` INNER JOIN
			XeXuatKhacChiTiet AS `B` ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_BANGGIA2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_BANGGIA2]
     `DenNgay` nvarchar(20...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_BANGGIA2]
     `DenNgay` nvarchar(20),
	 `XeNhapMuaID` int,
	 `TenType` nvarchar(50)
AS `Declare` `TenModel` nvarchar(30)

	
	SELECT		@TenModel = X.TenModel FROM XeNhapMua AS `M` INNER JOIN Xe AS `X` ON M.XeID = X.ID INNER JOIN V_XeThayVanh AS `TV` ON M.ID = TV.XeNhapMuaID 
	WHERE		TV.XeNhapMuaID = `XeNhapMuaID` GROUP BY	X.TenModel	

	
	Declare `V_Xe_BangGia_MaxID` Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT  MAX(B.ID) AS `MaxID`, B.XeID
			FROM    XeBangGia AS `A` INNER JOIN
                    XeBangGiaChiTiet AS `B` ON A.ID = B.XeBangGiaID INNER JOIN
                    Xe AS `X` ON B.XeID = X.ID
			WHERE   (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive = 1) AND (X.TenModel = @TenModel) AND (X.TenType = @TenType)
			GROUP BY B.XeID, X.TenModel, X.TenType

	
	SELECT TOP (1) X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	FROM   XeBangGia AS `B` INNER JOIN
           XeBangGiaChiTiet AS `C` ON B.ID = C.XeBangGiaID INNER JOIN
           `V_Xe_BangGia_MaxID` AS `V` ON C.ID = V.MaxID INNER JOIN
           Xe AS `X` ON C.XeID = X.ID	
	GROUP BY X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	ORDER BY C.GiaHaiQuan DESC
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_XUATKMDV: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMDV]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMDV]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS `KhoHangXuatID`, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS `L` INNER JOIN
            VatTu AS `V` ON L.ID = V.VatTuLoaiID INNER JOIN
            DVBanLe AS `A` INNER JOIN
            DVBanLeKhuyenMai AS `B` ON A.ID = B.DVBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure dt_setpropertybyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_setpropertybyid]
	`id` int,
	`propert...' at line 1 (SQL: DELIMITER //

create   procedure [dt_setpropertybyid]
	`id` int,
	`property` varchar(64),
	`value` varchar(255),
	`lvalue` image
AS `declare` `uvalue` nvarchar(255) 
	set @uvalue = convert(nvarchar(255), @value) 
	if exists (select * from dtproperties 
			where objectid=`id` and property=@property)
	AS `update` dtproperties set value=@value, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=`id` and property=`property` END;
	else
	AS `insert` dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @value, @uvalue, @lvalue)
	END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure dt_getpropertiesbyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getpropertiesbyid_u]
	`id` int,
	`pro...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getpropertiesbyid_u]
	`id` int,
	`property` varchar(64)
AS `if` (`property` is null) or (@property = '')
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure dt_getpropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getpropertiesbyid]
	`id` int,
	`prope...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getpropertiesbyid]
	`id` int,
	`property` varchar(64)
AS `if` (`property` is null) or (@property = '')
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure dt_getobjwithprop_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getobjwithprop_u]
	`property` varchar(...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getobjwithprop_u]
	`property` varchar(30),
	`uvalue` nvarchar(255)
AS `if` (`property` is null) or (@property = '')
	AS `raiserror`('Must specify a property name.',-1,-1)
		return (1)
	END;

	if (`uvalue` is null)
		select objectid id from dtproperties
			where property=`property` else
		select objectid id from dtproperties
			where property=`property` and uvalue=@uvalue
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure dt_getobjwithprop: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getobjwithprop]
	`property` varchar(30...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getobjwithprop]
	`property` varchar(30),
	`value` varchar(255)
AS `if` (`property` is null) or (@property = '')
	AS `raiserror`('Must specify a property name.',-1,-1)
		return (1)
	END;

	if (`value` is null)
		select objectid id from dtproperties
			where property=`property` else
		select objectid id from dtproperties
			where property=`property` and value=@value
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure dt_generateansiname: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
 
CREATE PROCEDURE `dt_generateansiname` (`name` varchar(255) o...' at line 1 (SQL: DELIMITER //
 
CREATE PROCEDURE `dt_generateansiname` (`name` varchar(255) output) 
AS `declare` `prologue` varchar(20) 
	declare `indexstring` varchar(20) 
	declare `index` integer 
 
	set @prologue = 'MSDT-A-' 
	set @index = 1 
 
	while 1 = 1 
	AS `set` @indexstring = cast(`index` AS `varchar`(20)) 
		set @name = @prologue + `indexstring` if not exists (select value from dtproperties where value = @name) 
			break 
		 
		set @index = @index + 1 
 
		if (@index = 10000) 
			goto TooMany 
	END; 
 
Leave: 
 
	return 
 
TooMany: 
 
	set @name = 'DIAGRAM' 
	goto Leave
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure dt_setpropertybyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_setpropertybyid_u]
	`id` int,
	`prope...' at line 1 (SQL: DELIMITER //

create   procedure [dt_setpropertybyid_u]
	`id` int,
	`property` varchar(64),
	`uvalue` nvarchar(255),
	`lvalue` image
AS `declare` `avalue` varchar(255) 
	set @avalue = null 
	if (`uvalue` is not null) 
	AS `if` (convert(nvarchar(255), convert(varchar(255), @uvalue)) = @uvalue) 
		AS `set` @avalue = convert(varchar(255), @uvalue) 
		END; 
		else 
		AS `if` 'DtgSchemaNAME' = `property` AS `exec` dt_generateansiname `avalue` output 
			END; 
		END; 
	END; 
	if exists (select * from dtproperties 
			where objectid=`id` and property=@property)
	AS `update` dtproperties set value=@avalue, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=`id` and property=`property` END;
	else
	AS `insert` dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @avalue, @uvalue, @lvalue)
	END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_Old]
     `KhoHangID` IN...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_Old]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS `A` INNER JOIN
            XePhuKienChiTiet AS `B` ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 1) AND (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure dt_dropuserobjectbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_dropuserobjectbyid]
	`id` int
AS `del...' at line 1 (SQL: DELIMITER //

create   procedure [dt_dropuserobjectbyid]
	`id` int
AS `delete` from dtproperties where objectid=@id
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN]
     `KhoHangID` INT,
...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS `A` INNER JOIN
            XePhuKienChiTiet AS `B` ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 0) AND (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure dt_droppropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_droppropertiesbyid]
	`id` int,
	`prop...' at line 1 (SQL: DELIMITER //

create   procedure [dt_droppropertiesbyid]
	`id` int,
	`property` varchar(64)
AS `if` (`property` is null) or (@property = '')
		delete from dtproperties where objectid=`id` else
		delete from dtproperties 
			where objectid=`id` and property=@property
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure dt_adduserobject: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_adduserobject]
AS `transaction`
		ins...' at line 1 (SQL: DELIMITER //

create   procedure [dt_adduserobject]
AS `transaction`
		insert dtproperties (property) VALUES ('DtgSchemaOBJECT')
		update dtproperties set objectid=@`identity` where id=@`identity` and property='DtgSchemaOBJECT'
	commit
	return @@identity
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKHAC]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKHAC]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVXuatKhac AS `A` INNER JOIN
			DVXuatKhacVatTu AS `B` ON A.ID = B.DVXuatKhacID INNER JOIN
			VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
			VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_XUATDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATDOIDONVI]
     `KhoHangID` INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATDOIDONVI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, A.SoLuong, A.DonGia, A.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS `A` INNER JOIN
            VatTu AS `V` ON A.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_BANGGIA]
     `DenNgay` nvarchar(20)...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_BANGGIA]
     `DenNgay` nvarchar(20)
AS `Declare` `V_Xe_BangGia_MaxID` Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT Max(B.ID) AS `MaxID`, B.XeID
			FROM   XeBangGia AS `A` INNER JOIN
				   XeBangGiaChiTiet AS `B` ON A.ID = B.XeBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive =1)
			GROUP BY B.XeID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.XeID, C.SoKhung, C.SoMay, X.MaXe, X.TenXe, X.SortDoiXe, X.SortLoaiXe, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, c.GiaApThue
	FROM   XeBangGia AS `B` INNER JOIN
           XeBangGiaChiTiet AS `C` ON B.ID = C.XeBangGiaID INNER JOIN
           `V_Xe_BangGia_MaxID` AS `V` ON C.ID = V.MaxID INNER JOIN
           Xe AS `X` ON C.XeID = X.ID	
	ORDER BY X.SortDoiXe
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON2]
	 `TuNgay` VARCHAR(1...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON2]
	 `TuNgay` VARCHAR(10),	 
     `DenNgay` VARCHAR(10)	 
AS `Declare` `NgayBatDauSuDung` VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare `Tb_VTTonDau` Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert `Tb_VTTonDau` SELECT T.VatTuID, SUM(T.SLNhap) AS `SLNhap`, SUM(T.TienNhap) AS `TienNhap`, SUM(T.SLXuat) AS `SLXuat`, SUM(T.TienXuat) AS `TienXuat` 
	
	FROM (
		
		SELECT	1 AS `a`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	2 AS `a`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	3 AS `a`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	5 AS `a`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	6 AS `a`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapKhac AS `A` INNER JOIN
				DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  8 AS `a`, C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
                XeNhapTraLaiBanLePhuKien AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS `A` ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  9 AS `a`, C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS `C` ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)		
		UNION ALL
		
		SELECT	10 AS `a`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanBuon AS `A` INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	11 AS `a`, B.VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, B.SoLuong AS `SLXuat`, B.TienVon AS `TienXuat`
		FROM	DVBanLe AS `A` INNER JOIN
				DVBanLeVatTu AS `B` ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	12 AS `a`, B.VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, B.SoLuong AS `SLXuat`, B.TienVon AS `TienXuat`
		FROM	DVBanSi AS `A` INNER JOIN
				DVBanSiVatTu AS `B` ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON]
	 `TuNgay` VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON]
	 `TuNgay` VARCHAR(10),	 
     `DenNgay` VARCHAR(10)	 
AS `Declare` `NgayBatDauSuDung` VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare `Tb_VTTonDau` Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert `Tb_VTTonDau` SELECT T.VatTuID, SUM(T.SLNhap) AS `SLNhap`, SUM(T.TienNhap) AS `TienNhap`, SUM(T.SLXuat) AS `SLXuat`, SUM(T.TienXuat) AS `TienXuat` 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapKhac AS `A` INNER JOIN
				DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
                XeNhapTraLaiBanLePhuKien AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS `A` ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS `C` ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanBuon AS `A` INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, B.SoLuong AS `SLXuat`, B.TienVon AS `TienXuat`
		FROM	DVBanLe AS `A` INNER JOIN
				DVBanLeVatTu AS `B` ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, B.SoLuong AS `SLXuat`,
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_TONDAU_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU_ALL]
     `KhoHangID` INT,
 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU_ALL]
     `KhoHangID` INT,
     `DenNgay` VARCHAR(10)
AS `Declare` `NgayBatDauSuDung` VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'	

	SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS `TDSLNhap`, SUM(T.TienNhap) AS `TDTienNhap`, SUM(T.SLXuat) AS `TDSLXuat`, SUM(T.TienXuat) AS `TDTienXuat` 
	FROM (
		
		SELECT	'N01' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N02' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N03' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N04' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNoiBo AS `A` INNER JOIN
				DVNoiBoVatTu AS `B` ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT	'N05' AS `MaTN`, A.KhoHangID, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID)
		UNION ALL
		
		SELECT	'N06' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapKhac AS `A` INNER JOIN
				DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT  'N07' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNoiBo AS `A` INNER JOIN
                XeNoiBoPhuKien AS `B` ON A.ID = B.XeNoiBoID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT  'N08' AS `MaTN`, A.KhoHangXuatID AS `KhoHangID`, C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
                XeNhapTraLaiBanLePhuKien AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS `A` ON A.ID = B.XeBanLeID INNER JOIN
				Va
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO_ALL_TEST]
     `KhoHangID` int...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO_ALL_TEST]
     `KhoHangID` int,
     `DenNgay` nvarchar(10)
AS `Declare` `Tb_VTTonDau` Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert `Tb_VTTonDau` Exec SP_VT_TONDAU_ALL @KhoHangID, `DenNgay` SELECT A.KhoHangID AS `KhoHangID`, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, A.TDSLNhap, A.TDSLXuat, (A.TDSLNhap - A.TDSLXuat) AS `SoLuongTon`
	FROM `Tb_VTTonDau` AS `A` INNER JOIN
			VatTu AS `V` ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) < 0
	order by  A.VatTuID

	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_XUATNOIBO]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_XUATNOIBO]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeNoiBo AS `A` INNER JOIN
			XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.IsXacNhan=1)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_VT_TONKHO_ALL]
     `KhoHangID` int,
  ...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_VT_TONKHO_ALL]
     `KhoHangID` int,
     `DenNgay` nvarchar(10)
AS `Declare` `Tb_VTTonDau` Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert `Tb_VTTonDau` Exec SP_VT_TONDAU_ALL @KhoHangID, `DenNgay` SELECT A.KhoHangID AS `KhoHangID`, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS `SoLuongTon`
	FROM `Tb_VTTonDau` AS `A` INNER JOIN
			VatTu AS `V` ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPNOIBO]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPNOIBO]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeNoiBo AS `A` INNER JOIN
			XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU]
     `KhoHangID` INT,
     ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU]
     `KhoHangID` INT,
     `DenNgay` VARCHAR(10),	 
	 `VatTuID` INT,
	 `MaTacNghiep` VARCHAR(1),
	 `IDTacNghiep` INT
AS `DECLARE` `NgayBatDauSuDung` VARCHAR(10), 
		`DVBanLeID` INT, `DVBanSiID` INT, `DVNoiBoID` INT, `DoiDonViID` INT, `DVXuatKhacID` INT, `XeBanLeKMID` INT, 
		`DVBanLeKMID` INT, `XePhuKienID` INT, `XePhuKienNoiBoID` INT, `DVBanBuonID` INT, `XeBanSiKMID` INT, `XeBanLeBHID` INT
	SET @NgayBatDauSuDung = '2019-12-19'
	SET @DVBanLeID = 0 	
	SET @DVBanSiID = 0
	SET @DVNoiBoID = 0
	SET @DoiDonViID = 0
	SET @DVXuatKhacID = 0
	SET @XeBanLeKMID = 0
	SET @DVBanLeKMID = 0
	SET @XePhuKienID = 0
	SET @XePhuKienNoiBoID = 0
	SET @DVBanBuonID = 0
	SET @XeBanSiKMID = 0
	SET @XeBanLeBHID = 0

	IF(@MaTacNghiep ='I')			SET @DVBanLeID = `IDTacNghiep` ELSE IF(@MaTacNghiep='J')		SET @DVBanSiID = `IDTacNghiep` ELSE IF(@MaTacNghiep='K')		SET @DVNoiBoID = `IDTacNghiep` ELSE IF(@MaTacNghiep='L')		SET @DoiDonViID = `IDTacNghiep` ELSE IF(@MaTacNghiep='M')		SET @DVXuatKhacID = `IDTacNghiep` ELSE IF(@MaTacNghiep='N')		SET @XeBanLeKMID = `IDTacNghiep` ELSE IF(@MaTacNghiep='O')		SET @DVBanLeKMID = `IDTacNghiep` ELSE IF(@MaTacNghiep='P')		SET @XePhuKienID = `IDTacNghiep` ELSE IF(@MaTacNghiep='Q')		SET @XePhuKienNoiBoID = `IDTacNghiep` ELSE IF(@MaTacNghiep='R')		SET @DVBanBuonID = `IDTacNghiep` ELSE IF(@MaTacNghiep='S')		SET @XeBanSiKMID = `IDTacNghiep` ELSE IF(@MaTacNghiep='T')		SET @XeBanLeBHID = `IDTacNghiep` SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS `TDSLNhap`, SUM(T.TienNhap) AS `TDTienNhap`, SUM(T.SLXuat) AS `TDSLXuat`, SUM(T.TienXuat) AS `TDTienXuat` 
	FROM (
		
		SELECT	'N01' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS `MaTN`, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNoiBo AS `A` INNER JOIN
				DVNoiBoVatTu AS `B` ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS `MaTN`, A.KhoHangID, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS `V` ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATNOIBO]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATNOIBO]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS `A` INNER JOIN
            DVNoiBoVatTu AS `B` ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO]
     `KhoHangID` INT,
     `...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO]
     `KhoHangID` INT,
     `DenNgay` nvarchar(10),
	 `VatTuID` INT,
	 `MaTacNghiep` VARCHAR(1),
	 `IDTacNghiep` INT
AS `DECLARE` `Tb_VTTonDau` Table (KhoHangID INT, VatTuID INT, TDSLNhap INT, TDTienNhap FLOAT, TDSLXuat INT, TDTienXuat FLOAT)
	INSERT `Tb_VTTonDau` Exec SP_VT_TONDAU @KhoHangID, @DenNgay, @VatTuID, @MaTacNghiep, `IDTacNghiep` SELECT A.KhoHangID AS `KhoHangID`, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS `SoLuongTon`
	FROM `Tb_VTTonDau` AS `A` INNER JOIN
			VatTu AS `V` ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPNOIBO]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPNOIBO]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS `A` INNER JOIN
            DVNoiBoVatTu AS `B` ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.IsXacNhan = 1) AND (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_SELECT_GIAVON_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_SELECT_GIAVON_TEST]
	 `TuNgay` VARCH...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_SELECT_GIAVON_TEST]
	 `TuNgay` VARCHAR(10),	 
     `DenNgay` VARCHAR(10)	 
AS `Declare` `NgayBatDauSuDung` VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare `Tb_VTTonDau` Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert `Tb_VTTonDau` SELECT T.VatTuID, SUM(T.SLNhap) AS `SLNhap`, SUM(T.TienNhap) AS `TienNhap`, SUM(T.SLXuat) AS `SLXuat`, SUM(T.TienXuat) AS `TienXuat` 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, (1 - A.TyLeCK*0.01) * B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapKhac AS `A` INNER JOIN
				DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
                XeNhapTraLaiBanLePhuKien AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS `A` ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanBuon AS `A` INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, 1 AS `SLNhap`, C.GiaBanBH AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
                XeNhapTraLaiBanLeBaoHiem AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS `A` ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, B.SoLuong AS `SLXuat`, B.TienVon AS `TienXuat`
		FROM	DVBanLe AS `A` INNER JOIN
				DVBanLeVatTu AS `B` ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, B.SoLuong AS `SLXuat`, B.TienVon AS `TienXuat`
		FROM	DVBanSi AS `A` INNER JOIN
				DVBanSiVatTu AS `B` ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT < @TuNgay)
		UNION ALL
		
		SELECT  VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, SoLuong AS `SLXuat`, ThanhTien AS `TienXuat`
		FROM    DoiDonVi AS `A`    
	
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_NHAPXUAT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPXUAT]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPXUAT]
     `KhoHangID` INT,
	 `VatTuID` INT,
	 `TuNgay` VARCHAR(10),	 
     `DenNgay` VARCHAR(10)	 	 
AS `SELECT` T.SoCT, T.NgayCT, T.NgayNXK, T.KhoHangNhapID, T.KhoHangXuatID, T.KhachHangID, T.VatTuID, T.SLNhap, T.SLXuat 
	FROM (
		
		SELECT	'N01' AS `MaTN`, A.SoCT, A.NgayCT, A.NgayCT AS `NgayNXK`, A.KhoHangNhapID, NULL AS `KhoHangXuatID`, A.KhachHangID, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS `MaTN`, A.SoCT, A.NgayCT, A.NgayCT AS `NgayNXK`, A.KhoHangNhapID, NULL AS `KhoHangXuatID`, C.KhachHangID, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
                DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
                DVBanLe AS `C` ON A.DVBanLeID = C.ID   
		WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS `MaTN`, A.SoCT, A.NgayCT, A.NgayCT AS `NgayNXK`, A.KhoHangNhapID, NULL AS `KhoHangXuatID`, C.KhachHangID, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
                DVBanSi AS `C` ON A.DVBanSiID = C.ID
		WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS `MaTN`, A.SoCT, A.NgayCT, A.NgayCT AS `NgayNXK`, A.KhoHangNhapID, A.KhoHangXuatID, NULL AS `KhachHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNoiBo AS `A` INNER JOIN
				DVNoiBoVatTu AS `B` ON A.ID = B.DVNoiBoID
		WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS `MaTN`, A.SoCT, A.NgayCT, A.NgayCT AS `NgayNXK`, A.KhoHangID AS `KhoHangNhapID`, NULL AS `KhoHangXuatID`, NULL AS `KhachHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N06' AS `MaTN`, A.SoCT, A.NgayCT, A.NgayCT AS `NgayNXK`, A.KhoHangNhapID, NULL AS `KhoHangXuatID`, NULL AS `KhachHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapKhac AS `A` INNER JOIN
				DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  'N07' AS `MaTN`, A.SoCT, A.NgayCT, A.NgayCT AS `NgayNXK`, A.KhoHangNhapID, NULL AS `KhoHangXuatID`, NULL AS `KhachHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNoiBo AS `A` INNER JOIN
                XeNoiBoPhuKien AS `B` ON A.ID = B.XeNoiBoID
		WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)		
		UNION ALL
		
		SELECT  'N08' AS `MaTN`, B.SoCT, B.NgayCT, B.NgayCT AS `NgayNXK`, A.KhoHangXuatID AS `KhoHangNhapID`, NULL AS `KhoHangXuatID`, a.KhachHangID, C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_NHAPDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPDOIDONVI]
     `KhoHangID` INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPDOIDONVI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS `A` INNER JOIN
            DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XECHUYENKHO]
     `KhoHa...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XECHUYENKHO]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS `KhoHangID`, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS `A` INNER JOIN
            XeNoiBoPhuKien AS `B` ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_GET_GIAVON]
	 `TuNgay` VARCHAR(10),	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_GET_GIAVON]
	 `TuNgay` VARCHAR(10),	 
     `DenNgay` VARCHAR(10),
	 `VatTuID` int
AS `Declare` `NgayBatDauSuDung` VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare `Tb_VTTonDau` Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert `Tb_VTTonDau` SELECT T.VatTuID, SUM(T.SLNhap) AS `SLNhap`, SUM(T.TienNhap) AS `TienNhap`, SUM(T.SLXuat) AS `SLXuat`, SUM(T.TienXuat) AS `TienXuat` 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapKhac AS `A` INNER JOIN
				DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
                XeNhapTraLaiBanLePhuKien AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS `A` ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS `C` ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanBuon AS `A` INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS `SLNhap`, 0 AS `TienNhap`, B.SoLuong AS `SLXuat`, B.TienVon AS `TienXuat`
		FROM	DVBanLe AS `A` INNER JOIN
				DVBanLeVatTu AS `B` ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.Nga
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_XECHUYENKHO]
     `KhoHa...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_XECHUYENKHO]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS `A` INNER JOIN
            XeNoiBoPhuKien AS `B` ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan = 1)
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_DELETE_DUPLICATE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_DELETE_DUPLICATE]
	 `VatTuID_DEL` in...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_DELETE_DUPLICATE]
	 `VatTuID_DEL` int,	 
     `VatTuID` int	 
AS `update` DoiDonVi						set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DoiDonViChiTiet				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVBanLeVatTu					set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVBanSiVatTu					set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVNhapKhacVatTu				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVNhapMuaVatTu				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVNhapTraLaiBanLeChiTiet		set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVNhapTraLaiBanSiChiTiet		set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVNoiBoVatTu					set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update DVXuatKhacVatTu				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update VTBangGiaChiTiet				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update XeBanLeKhuyenMai				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update XeBanLePhuKien				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update XeNhapTraLaiBanLeKhuyenMai	set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update XeNhapTraLaiBanLePhuKien		set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update XeNoiBoPhuKien				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` update XePhuKienChiTiet				set VATTUID = `VatTuID` WHERE VATTUID = `VatTuID_DEL` Delete VatTu where (ID = @VatTuID_DEL)

END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XEBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XEBANLE]
     `KhoHangID...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XEBANLE]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS `KhoHangID`, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, b.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeBanLe AS `A` INNER JOIN
            XeBanLePhuKien AS `B` ON A.ID = B.XeBanLeID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE   (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHLE]
     `KhoHangID` INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHLE]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS `L` INNER JOIN
            VatTu AS `V` ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS `A` INNER JOIN
            XeBanLeKhuyenMai AS `B` ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure dt_verstamp007: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_verstamp007]
AS `select` 7005
//
DELIM...' at line 1 (SQL: DELIMITER //

create   procedure [dt_verstamp007]
AS `select` 7005
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_XUATKMBH_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBH_Old]
     `KhoHangID` INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBH_Old]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS `L` INNER JOIN
            VatTu AS `V` ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS `A` INNER JOIN
            XeBanLeKhuyenMai AS `B` ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure dt_verstamp006: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_verstamp006]
AS `select` 7000
//
DELIM...' at line 1 (SQL: DELIMITER //

create   procedure [dt_verstamp006]
AS `select` 7000
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_XUATBAOHIEM_BHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBAOHIEM_BHLE]
     `KhoHangID` I...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBAOHIEM_BHLE]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, B.NgayXuat AS `NgayCT`, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, 1 AS `SoLuong`, B.GiaBanBH, B.GiaBanBH AS `ThanhTien`, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS `L` INNER JOIN
            VatTu AS `V` ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS `A` INNER JOIN
            XeBanLeBaoHiem AS `B` ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_TRALAI]
     `KhoHangID`...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_TRALAI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  B.ID, B.SoCT, C.NgayNhap AS `NgayCT`, A.KhoHangXuatID AS `KhoHangID`, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
            XeNhapTraLaiBanLePhuKien AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS `A` ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS `V` ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_NHAPKHUYENMAI_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHUYENMAI_TRALAI]
     `KhoHangI...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHUYENMAI_TRALAI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  B.ID, B.SoCT, B.NgayCT, A.KhoHangXuatID AS `KhoHangID`, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
            XeNhapTraLaiBanLeKhuyenMai AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS `A` ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS `V` ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRASI]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRASI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeBanSi AS `A` INNER JOIN
			XeNhapTraLaiBanSi AS `B` ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS `C` ON B.ID = C.XeNhapTraLaiBanSiID
	WHERE (B.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.XeNhapMuaID IS NOT NULL)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_NHAPBAOHIEM_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPBAOHIEM_TRALAI]
     `KhoHangID`...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPBAOHIEM_TRALAI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  B.ID, B.SoCT, C.NgayNhap AS `NgayCT`, A.KhoHangXuatID AS `KhoHangID`, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, 1 AS `SoLuong`, C.GiaBanBH AS `DonGia`, C.GiaBanBH AS `ThanhTien`, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
            XeNhapTraLaiBanLeBaoHiem AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS `A` ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS `V` ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRALE]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRALE]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanLe AS `A` INNER JOIN
            DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_TEST_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TEST_1]   
AS `select` count(ID) BEGIN '...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TEST_1]   
AS `select` count(ID) BEGIN 'VT' from VatTu
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TEST]
     `VatTuID` INT     
AS `selec...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TEST]
     `VatTuID` INT     
AS `select` * from VatTu where ID = `VatTuID` END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_DV_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_DV_BANGGIA]
     `DenNgay` nvarchar(10),...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_DV_BANGGIA]
     `DenNgay` nvarchar(10),
	 `CuaHangID` nvarchar(2)
AS `Declare` `V_DV_BangGia_MaxID` Table (MaxID int, DichVuID int)
	Insert @V_DV_BangGia_MaxID(MaxID, DichVuID) 
			SELECT Max(B.ID) AS `MaxID`, B.DichVuID
			FROM   DVBangGia AS `A` INNER JOIN
				   DVBangGiaChiTiet AS `B` ON A.ID = B.DVBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.CuaHangID = @CuaHangID)
			GROUP BY B.DichVuID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.DichVuID, V.MaDichVu, V.HangMuc, C.DonGia
	FROM   DVBangGia AS `B` INNER JOIN
           DVBangGiaChiTiet AS `C` ON B.ID = C.DVBangGiaID INNER JOIN
           `V_DV_BangGia_MaxID` AS `M` ON C.ID = M.MaxID INNER JOIN
           DichVu AS `V` ON C.DichVuID = V.ID	
	ORDER BY V.MaDichVu
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHSI]
     `KhoHangID` INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHSI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS `L` INNER JOIN
            VatTu AS `V` ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanSi AS `A` INNER JOIN
            XeBanSiKhuyenMai AS `B` ON A.ID = B.XeBanSiID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE[SP_VT_BANGGIA]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE[SP_VT_BANGGIA]
                                `DenNgay` nvarchar(10),
	                            `CuaHangID` nvarchar(2)
                            AS `Declare` `V_VT_BangGia_MaxID` Table(MaxID int, VatTuID int)
                                Insert @V_VT_BangGia_MaxID(MaxID, VatTuID)
                                        SELECT Max(B.ID) AS `MaxID`, B.VatTuID
                                        FROM   VTBangGia AS `A` CROSS APPLY STRING_SPLIT(CuaHangID, ',') INNER JOIN
                                               VTBangGiaChiTiet AS `B` ON A.ID = B.VTBangGiaID
                                        WHERE(A.ApDungTu <= @DenNgay) AND(A.ApDungDen >= @DenNgay) AND (value = @CuaHangID)
                                        GROUP BY B.VatTuID

                                SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.VatTuLoaiID, L.VatTuNhomID, C.GiaNhap, C.GiaXuat
                                FROM   VTBangGia AS `B` INNER JOIN
                                       VTBangGiaChiTiet AS `C` ON B.ID = C.VTBangGiaID INNER JOIN
                                       `V_VT_BangGia_MaxID` AS `M` ON C.ID = M.MaxID INNER JOIN
                                       VatTu AS `V` ON C.VatTuID = V.ID INNER JOIN
                                       VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
                            END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_NHAPKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHAC]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHAC]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapKhac AS `A` INNER JOIN
            DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI_TONGHOP]     
	 `TuNgay` V...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI_TONGHOP]     
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeBanSi AS `A` INNER JOIN
			XeBanSiChiTiet AS `B` ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay)		
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeBanSi AS `A` INNER JOIN
			XeBanSiChiTiet AS `B` ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_TONDAU]
     `KhoHangID` INT,
     ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_TONDAU]
     `KhoHangID` INT,
     `DenNgay` VARCHAR(10),
	 `XeBanLeID` INT,
	 `XeBanSiID` INT,
	 `XeNoiBoID` INT,
	 `XeXuatKhacID` INT
AS `SELECT` T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS `TDSLNhap`, SUM(T.SLXuat) AS `TDSLXuat`
	FROM (
		
		SELECT 'A' AS `MaTN`, KhoHangNhapID AS `KhoHangID`, XeID, ID AS `XeNhapMuaID`, 1 AS `SLNhap`, 0 AS `SLXuat` 
		FROM XeNhapMua 
		WHERE (NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT 'B' AS `TN`, A.KhoHangNhapID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 1 AS `SLNhap`, 0 AS `SLXuat`
		FROM XeNoiBo AS `A` INNER JOIN
				XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
		UNION ALL
		
		SELECT 'C' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, A.XeID, A.XeNhapMuaID, 1 AS `SLNhap`, 0 AS `SLXuat`
		FROM XeBanLe  AS `A` INNER JOIN
				XeNhapTraLaiBanLe  AS `B` ON A.ID = B.XeBanLeID    
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'D' AS `TN`, A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS `SLNhap`, 0 AS `SLXuat`
		FROM XeBanSi AS `A` INNER JOIN
				XeNhapTraLaiBanSi AS `B` ON A.ID = B.XeBanSiID INNER JOIN
				XeNhapTraLaiBanSiChiTiet AS `C` ON B.ID = C.XeNhapTraLaiBanSiID
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
		UNION ALL
		
		SELECT 'E' AS `TN`, KhoHangXuatID AS `KhoHangID`, XeID, XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
		FROM XeBanLe     
		WHERE (NgayBan <= @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'F' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
		FROM XeBanSi AS `A` INNER JOIN
				XeBanSiChiTiet AS `B` ON A.ID = B.XeBanSiID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeBanSiID)
		UNION ALL
		
		SELECT 'G' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
		FROM XeNoiBo AS `A` INNER JOIN
				XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeNoiBoID) 
		UNION ALL
		
		SELECT 'H' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
		FROM XeXuatKhac AS `A` INNER JOIN
				XeXuatKhacChiTiet AS `B` ON A.ID = B.XeXuatKhacID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeXuatKhacID)
	) AS `T`
	GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID
END;


//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_TONKHO]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_TONKHO]
                                 `KhoHangID` int,
                                 `DenNgay` nvarchar(10),
	                             `XeBanLeID` INT,
	                             `XeBanSiID` INT,
	                             `XeNoiBoID` INT,
	                             `XeXuatKhacID` INT
                            AS `Declare` `Tb_XeTonDau` Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)
	                            Insert `Tb_XeTonDau` Exec SP_XE_TONDAU @KhoHangID, @DenNgay, @XeBanLeID, @XeBanSiID, @XeNoiBoID, `XeXuatKhacID` SELECT A.KhoHangID, B.KhoHangNhapID, A.XeID, X.MaXe, X.TenXe, A.XeNhapMuaID, B.KhachHangID AS `NhaCungCapID`, B.DonGia_CoVAT, B.NgayCT, B.SoKhung, B.SoMay, B.MaChiaKhoa, (A.TDSLNhap - A.TDSLXuat) AS `SoLuongTon`, B.GhiChu, B.MaChiaKhoa
	                            FROM `Tb_XeTonDau` AS `A` INNER JOIN
			                            XeNhapMua AS `B` ON A.XeNhapMuaID = B.ID INNER JOIN
			                            Xe AS `X` ON A.XeID = X.ID 
	                            WHERE (A.TDSLNhap - A.TDSLXuat) <>0
                            END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_NHAPXUATTON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_NHAPXUATTON]
     `KhoHangID` int,
	 `T...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_NHAPXUATTON]
     `KhoHangID` int,
	 `TuNgay` nvarchar(10),
     `DenNgay` nvarchar(10)
AS `Declare` `Tb_XeTonDau` Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)

	declare `XeBanLeID` int, `XeBanSiID` int, `XeNoiBoID` int
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0

	Insert `Tb_XeTonDau` Exec SP_XE_TONDAU @KhoHangID, @TuNgay, @XeBanLeID, @XeBanSiID, `XeNoiBoID` SELECT NXT.* FROM (
		SELECT 'T' AS `TN`, KhoHangID, XeID, XeNhapMuaID, (TDSLNhap - TDSLXuat) AS `TDSL`
		FROM `Tb_XeTonDau` UNION ALL
		SELECT 'B' AS `TN`, A.KhoHangNhapID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 1 AS `SoLuong`
		FROM XeNoiBo AS `A` INNER JOIN
			 XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID    
		WHERE A.NgayCT < `DenNgay` AND KhoHangNhapID = @KhoHangID   
	) AS `NXT` 
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_LICHSU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_LICHSU]
     `XeNhapMuaID` INT
AS `...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_LICHSU]
     `XeNhapMuaID` INT
AS `SELECT` 'A' AS `MaTN`, ID, KhoHangNhapID, Null AS `KhoHangXuatID`, XeID, ID AS `XeNhapMuaID`, SoCT, NgayCT, NULL AS `NgayBan`, CreatedBy, SoKhung, SoMay 
	FROM XeNhapMua 
	WHERE (ID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'B' AS `TN`, A.ID, A.KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, NULL AS `NgayBan`, A.CreatedBy, M.SoKhung, M.SoMay 
	FROM XeNoiBo AS `A` INNER JOIN
			XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID INNER JOIN
			XeNhapMua AS `M` ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'C' AS `TN`, B.ID, A.KhoHangXuatID AS `KhoHangNhapID`, null AS `KhoHangXuatID`, A.XeID, A.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS `NgayBan`, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe  AS `A` INNER JOIN
			XeNhapTraLaiBanLe  AS `B` ON A.ID = B.XeBanLeID INNER JOIN
			XeNhapMua AS `M` ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'D' AS `TN`, B.ID, A.KhoHangXuatID AS `KhoHangNhapID`, null AS `KhoHangXuatID`, C.XeID, C.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS `NgayBan`, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS `A` INNER JOIN
			XeNhapTraLaiBanSi AS `B` ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS `C` ON B.ID = C.XeNhapTraLaiBanSiID INNER JOIN
			XeNhapMua AS `M` ON C.XeNhapMuaID = M.ID
	WHERE (C.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'E' AS `TN`, A.ID, Null AS `KhoHangNhapID`, A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe AS `A` INNER JOIN
			XeNhapMua AS `M` ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'F' AS `TN`, A.ID, Null AS `KhoHangNhapID`, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS `NgayBan`, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS `A` INNER JOIN
			XeBanSiChiTiet AS `B` ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapMua AS `M` ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'G' AS `TN`, A.ID, Null AS `KhoHangNhapID`, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS `NgayBan`, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeXuatKhac AS `A` INNER JOIN
			XeXuatKhacChiTiet AS `B` ON A.ID = B.XeXuatKhacID INNER JOIN
			XeNhapMua AS `M` ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	
	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE_TONGHOP]     
	 `TuNgay` V...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE_TONGHOP]     
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` KhoHangXuatID AS `KhoHangID`, XeID, XeNhapMuaID, 1 AS `SoLuong`
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN `TuNgay` AND @DenNgay) AND (XeNhapMuaID IS NOT NULL)
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` KhoHangXuatID AS `KhoHangID`, XeID, XeNhapMuaID, 1 AS `SoLuong`
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN `TuNgay` AND @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (XeNhapMuaID IS NOT NULL)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_TONKHO_BY_XEID: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_TONKHO_BY_XEID]     
     `DenNgay` ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_TONKHO_BY_XEID]     
     `DenNgay` VARCHAR(10),
	 `XeID` INT,
	 `IDPhieu` INT,
	 `LoaiPhieu` INT,
	 `SoMay` VARCHAR(20)
AS `Declare` `XeBanLeID` INT,	`XeBanSiID` INT, `XeNoiBoID` INT, `XeXuatKhacID` INT
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0
	SET @XeXuatKhacID = 0

	if(@LoaiPhieu = 1)
		SET @XeBanLeID = `IDPhieu` else if(@LoaiPhieu = 2)
		SET @XeBanSiID = `IDPhieu` else if(@LoaiPhieu = 3)
		SET @XeNoiBoID = `IDPhieu` else if(@LoaiPhieu = 4)
		SET @XeXuatKhacID = `IDPhieu` Declare `Tb_XeTonKho` Table (KhoHangID int, XeID int, XeNhapMuaID int, SLNhap int, SLXuat int)

	Insert `Tb_XeTonKho` SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS `TDSLNhap`, SUM(T.SLXuat) AS `TDSLXuat`
		FROM (
			
			SELECT 'A' AS `MaTN`, KhoHangNhapID AS `KhoHangID`, XeID, ID AS `XeNhapMuaID`, 1 AS `SLNhap`, 0 AS `SLXuat` 
			FROM XeNhapMua 
			WHERE (NgayCT <= @DenNgay) AND (XeID = @XeID)
			UNION ALL
			
			SELECT 'B' AS `TN`, A.KhoHangNhapID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 1 AS `SLNhap`, 0 AS `SLXuat`
			FROM XeNoiBo AS `A` INNER JOIN
					XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.IsXacNhan=1)
			UNION ALL
			
			SELECT 'C' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, A.XeID, A.XeNhapMuaID, 1 AS `SLNhap`, 0 AS `SLXuat`
			FROM XeBanLe  AS `A` INNER JOIN
					XeNhapTraLaiBanLe  AS `B` ON A.ID = B.XeBanLeID    
			WHERE (B.NgayCT <= @DenNgay) AND (A.XeID = @XeID) AND (A.XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'D' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, C.XeID, C.XeNhapMuaID, 1 AS `SLNhap`, 0 AS `SLXuat`
			FROM XeBanSi AS `A` INNER JOIN
					XeNhapTraLaiBanSi AS `B` ON A.ID = B.XeBanSiID INNER JOIN
					XeNhapTraLaiBanSiChiTiet AS `C` ON B.ID = C.XeNhapTraLaiBanSiID
			WHERE (B.NgayCT <= @DenNgay) AND (C.XeID = @XeID)
			UNION ALL
			
			SELECT 'E' AS `TN`, KhoHangXuatID AS `KhoHangID`, XeID, XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
			FROM XeBanLe     
			WHERE (NgayBan <= @DenNgay) AND (XeID = @XeID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'F' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
			FROM XeBanSi AS `A` INNER JOIN
					XeBanSiChiTiet AS `B` ON A.ID = B.XeBanSiID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeBanSiID)
			UNION ALL
			
			SELECT 'G' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
			FROM XeNoiBo AS `A` INNER JOIN
					XeNoiBoChiTiet AS `B` ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeNoiBoID) 
			UNION ALL
			
			SELECT 'F' AS `TN`, A.KhoHangXuatID AS `KhoHangID`, B.XeID, B.XeNhapMuaID, 0 AS `SLNhap`, 1 AS `SLXuat`
			FROM XeXuatKhac AS `A` INNER JOIN
					XeXuatKhacChiTiet AS `B` ON A.ID = B.XeXuatKhacID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeXuatKhacID)
		) AS `T`
		GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID

		if(LEN(@SoMay)>0)
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS `SLTON`,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM `Tb_XeTonKho` AS `A` INNER JOIN
					XeNhapMua AS `B` ON A.XeNhapMuaID = B.ID INNER JOIN
					Xe AS `X` ON A.XeID = X.ID INNER JOIN 
					KhoHang AS `K` ON A.KhoHangID = K.ID 
			WHERE SLNhap-SLXuat<>0 AND (B.SoMay Like N'%' + @SoMay)
		else
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS `SLTON`,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM `Tb_XeTonKho` AS `A` INNER JOIN
					XeNh
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRALE]
     `KhoHangID` INT,
	 `...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRALE]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, 1 AS `SoLuong`
	FROM XeBanLe  AS `A` INNER JOIN
			XeNhapTraLaiBanLe  AS `B` ON A.ID = B.XeBanLeID    
	WHERE (B.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA_GROUP]
     `KhoHangID` INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA_GROUP]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, SUM(B.SoLuong) AS `SoLuong`, SUM(B.ThanhTien) AS `ThanhTien`, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS `A` INNER JOIN
            DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA]
     `KhoHangID` INT,
	 `T...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS `A` INNER JOIN
            DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRASI]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRASI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanSi AS `A` INNER JOIN
            DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANSI]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANSI]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanSi AS `A` INNER JOIN
            DVBanSiVatTu AS `B` ON A.ID = B.DVBanSiID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure uspGetChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc [uspGetChiTien1]
`ID` int
AS `SELECT`     ...' at line 1 (SQL: DELIMITER //
CREATE         proc [uspGetChiTien1]
`ID` int
AS `SELECT`        ChiTien.ID, KhachHang.TenKhachHang, ChiTienLyDo.TenLyDo, ChiTien.SoTien, TaiKhoan.TenTaiKhoan, ChiTien.GhiChu, ChiTien.CuaHangID, ChiTien.CreatedBy, 
                         ChiTien.CreatedAt, ChiTien.UpdatedBy, ChiTien.UpdatedAt
FROM            ChiTien INNER JOIN
                         KhachHang ON ChiTien.KhachHangID = KhachHang.ID INNER JOIN
                         ChiTienLyDo ON ChiTien.ChiTienLyDoID = ChiTienLyDo.ID INNER JOIN
                         TaiKhoan ON ChiTien.TaiKhoanID = TaiKhoan.ID
WHERE ChiTien.ID= @ID
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure uspChiTien2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
create         proc [uspChiTien2]
`ID` int,
`Status` int,
`Ap...' at line 1 (SQL: DELIMITER //
create         proc [uspChiTien2]
`ID` int,
`Status` int,
`ApprovalBy` int
AS `UPDATE` ChiTien SET [Status2] = @Status, Approval2By = @ApprovalBy, Approval2At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_XE_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_NHAPMUA]
     `KhoHangID` INT,
	 `T...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_NHAPMUA]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT` KhoHangNhapID, XeID, ID AS `XeNhapMuaID`, 1 AS `SoLuong` 
	FROM XeNhapMua 
	WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (KhoHangNhapID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure uspChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc [uspChiTien1]
`ID` int,
`Status` int,
`Ap...' at line 1 (SQL: DELIMITER //
CREATE         proc [uspChiTien1]
`ID` int,
`Status` int,
`ApprovalBy` int
AS `UPDATE` ChiTien SET [Status1] = @Status, Approval1By = @ApprovalBy, Approval1At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE_GROUP]
     `KhoHangID` IN...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE_GROUP]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, SUM(B.SoLuong) AS `SoLuong`, SUM(B.ThanhTien) AS `ThanhTien`, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS `A` INNER JOIN
            DVBanLeVatTu AS `B` ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
END;
//
DELIMITER ;)  
[2024-07-18 16:27:56] local.ERROR: Error creating stored procedure upsChiTienPowerApps: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [upsChiTienPowerApps]
AS `Declare` `TuNgay` ...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [upsChiTienPowerApps]
AS `Declare` `TuNgay` VARCHAR(10), `DenNgay` VARCHAR(10)

	set @TuNgay = CONVERT(VARCHAR(10), DATEADD(DAY, -30, NOW()), 101)
	set @DenNgay = CONVERT(VARCHAR(10), NOW(), 101)

	SELECT * FROM ChiTien WHERE NgayCT between `TuNgay` and `DenNgay` END;
//
DELIMITER ;)  
[2024-07-18 16:27:57] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON_KHOHANG: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //



CREATE PROCEDURE `SP_VT_GET_GIAVON_KHOHANG`
	 `TuNgay` VAR...' at line 1 (SQL: DELIMITER //



CREATE PROCEDURE `SP_VT_GET_GIAVON_KHOHANG`
	 `TuNgay` VARCHAR(10),	 
     `DenNgay` VARCHAR(10),
	 `KhoHangID` int,
	 `VatTuID` int
AS `Declare` `NgayBatDauSuDung` VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	Declare `Tb_VTTonDau` Table (KhoHangID int, VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert `Tb_VTTonDau` SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS `SLNhap`, SUM(T.TienNhap) AS `TienNhap`, SUM(T.SLXuat) AS `SLXuat`, SUM(T.TienXuat) AS `TienXuat` 
	FROM (
		
		SELECT	A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapMua AS `A` INNER JOIN
				DVNhapMuaVatTu AS `B` ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanLe AS `A` INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanSi AS `A` INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangID, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DoiDonVi AS `A` INNER JOIN
				DoiDonViChiTiet AS `B` ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapKhac AS `A` INNER JOIN
				DVNhapKhacVatTu AS `B` ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS `KhoHangID`, C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
                XeNhapTraLaiBanLePhuKien AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS `A` ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS `KhoHangID`, C.VatTuID, C.SoLuong AS `SLNhap`, C.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM    XeNhapTraLaiBanLe AS `B` INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS `C` ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
				XeBanLe AS `A` ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS `KhoHangID`, B.VatTuID, B.SoLuong AS `SLNhap`, B.ThanhTien AS `TienNhap`, 0 AS `SLXuat`, 0 AS `TienXuat`
		FROM	DVNhapTraLaiBanBuon AS `A` INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		
		
//
DELIMITER ;)  
[2024-07-18 16:27:57] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE]
     `KhoHangID` INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.SoPhieu, A.KhoHangXuatID, A.KhachHangID, B.NgayXuat, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS `A` INNER JOIN
            DVBanLeVatTu AS `B` ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:57] local.ERROR: Error creating stored procedure spCheckPhieuChi: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE `spCheckPhieuChi` (
		`khohangID` varchar(10)...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE `spCheckPhieuChi` (
		`khohangID` varchar(10)
)
	AS `select`	* from ChiTien
				where	KhoHangID = `khohangID` END;
//
DELIMITER ;)  
[2024-07-18 16:27:57] local.ERROR: Error creating stored procedure SP_FIX_SLVT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_FIX_SLVT]
AS `Declare` `Tb_SLVT` Table (...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_FIX_SLVT]
AS `Declare` `Tb_SLVT` Table (DVBanLeID int, SoLuongVT float)

	Insert @Tb_SLVT(DVBanLeID, SoLuongVT) 
	select DVBanLeID, Sum(SoLuong) AS `SoLuongVT` from DVBanLeVatTu group by DVBanLeID
	
	UPDATE DVBanLe 
    SET DVBanLe.TongSoLuongVatTu = B.SoLuongVT            
	FROM DVBanLe INNER JOIN `Tb_SLVT` AS `B` ON DVBanLe.ID = B.DVBanLeID 
	where B.SoLuongVT is not null
	
 
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:27:57] local.ERROR: Error creating stored procedure SP_TC_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TC_TONDAU]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TC_TONDAU]
                                 `TaiKhoanID` INT,
                                 `TuNgay` VARCHAR(10),
	                             `DenNgay` VARCHAR(10)	 
                            AS `SELECT` T.TaiKhoanID, T.TacNghiep, SUM(T.SoTien) AS `SoTien`
	                            FROM (
		                            
		                            SELECT 1 AS `MaTN`, TaiKhoanID, SUM(SoTien) AS `SoTien`, TacNghiep 
		                            FROM XeBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 2 AS `MaTN`, TaiKhoanID, SUM(SoTien) AS `SoTien`, TacNghiep 
		                            FROM XeBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 3 AS `MaTN`, TaiKhoanID, SUM(GiaNhap) AS `SoTien`, 1 AS `TacNghiep`
		                            FROM XeSonXe 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 4 AS `MaTN`, TaiKhoanID, SUM(SoTien) AS `SoTien`, 0 AS `TacNghiep`
		                            FROM ThuTien 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 5 AS `MaTN`, TaiKhoanID, SUM(SoTien) AS `SoTien`, 1 AS `TacNghiep`
		                            FROM ChiTien 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 6 AS `MaTN`, TaiKhoanID, SUM(SoTien) AS `SoTien`, TacNghiep 
		                            FROM DVBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 7 AS `MaTN`, TaiKhoanID, SUM(SoTien) AS `SoTien`, TacNghiep 
		                            FROM DVBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 8 AS `MaTN`, TaiKhoanID, SUM(SoTien) AS `SoTien`, TacNghiep 
		                            FROM DVBanBuonThanhToan 
		                            WHERE (NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 9 AS `MaTN`, T.TaiKhoanID, SUM(G.ChiPhi) AS `SoTien`, 1 AS `TacNghiep` 
                                    FROM DVBanLe AS `A` INNER JOIN 
                                        KhoHang AS `K` ON A.KhoHangXuatID = K.ID INNER JOIN 
	
//
DELIMITER ;)  
[2024-07-18 16:27:57] local.ERROR: Error creating stored procedure SP_VT_NHAPTRABUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRABUON]
     `KhoHangID` INT,
...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRABUON]
     `KhoHangID` INT,
	 `TuNgay` VARCHAR(10),
     `DenNgay` VARCHAR(10)
AS `SELECT`  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS `TenVatTu`, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanBuon AS `A` INNER JOIN
            DVNhapTraLaiBanBuonChiTiet AS `B` ON A.ID = B.DVNhapTraLaiBanbuonID INNER JOIN
            VatTu AS `V` ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS `L` ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN `TuNgay` AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_XUATBANBUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANBUON]
     IN KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANBUON]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanBuon BEGIN A INNER JOIN
            DVBanBuonVatTu BEGIN B ON A.ID = B.DVBanBuonID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC_TONGHOP]     
	 IN TuNgay V...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC_TONGHOP]     
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeXuatKhac BEGIN A INNER JOIN
			XeXuatKhacChiTiet BEGIN B ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay)		
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeXuatKhac BEGIN A INNER JOIN
			XeXuatKhacChiTiet BEGIN B ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_XE_BANGGIA2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_BANGGIA2]
     IN DenNgay nvarchar(2...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_BANGGIA2]
     IN DenNgay nvarchar(20),
	 IN XeNhapMuaID int,
	 IN TenType nvarchar(50)
BEGIN
    
	Declare IN TenModel nvarchar(30)

	
	SELECT		@TenModel = X.TenModel FROM XeNhapMua BEGIN M INNER JOIN Xe BEGIN X ON M.XeID = X.ID INNER JOIN V_XeThayVanh BEGIN TV ON M.ID = TV.XeNhapMuaID 
	WHERE		TV.XeNhapMuaID = IN XeNhapMuaID GROUP BY	X.TenModel	

	
	Declare IN V_Xe_BangGia_MaxID Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT  MAX(B.ID) BEGIN MaxID, B.XeID
			FROM    XeBangGia BEGIN A INNER JOIN
                    XeBangGiaChiTiet BEGIN B ON A.ID = B.XeBangGiaID INNER JOIN
                    Xe BEGIN X ON B.XeID = X.ID
			WHERE   (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive = 1) AND (X.TenModel = @TenModel) AND (X.TenType = @TenType)
			GROUP BY B.XeID, X.TenModel, X.TenType

	
	SELECT TOP (1) X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	FROM   XeBangGia BEGIN B INNER JOIN
           XeBangGiaChiTiet BEGIN C ON B.ID = C.XeBangGiaID INNER JOIN
           IN V_Xe_BangGia_MaxID BEGIN V ON C.ID = V.MaxID INNER JOIN
           Xe BEGIN X ON C.XeID = X.ID	
	GROUP BY X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	ORDER BY C.GiaHaiQuan DESC
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_XUATKMDV: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMDV]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMDV]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID BEGIN KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai BEGIN L INNER JOIN
            VatTu BEGIN V ON L.ID = V.VatTuLoaiID INNER JOIN
            DVBanLe BEGIN A INNER JOIN
            DVBanLeKhuyenMai BEGIN B ON A.ID = B.DVBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure dt_setpropertybyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_setpropertybyid]
	IN id int,
	IN prop...' at line 1 (SQL: DELIMITER //

create   procedure [dt_setpropertybyid]
	IN id int,
	IN property varchar(64),
	IN value varchar(255),
	IN lvalue image
BEGIN
	
	declare IN uvalue nvarchar(255) 
	set @uvalue = convert(nvarchar(255), @value) 
	if exists (select * from dtproperties 
			where objectid=IN id and property=@property)
	begin
		
		
		
		update dtproperties set value=@value, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=IN id and property=IN property END;
	else
	begin
		
		
		
		insert dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @value, @uvalue, @lvalue)
	END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure dt_getpropertiesbyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getpropertiesbyid_u]
	IN id int,
	IN ...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getpropertiesbyid_u]
	IN id int,
	IN property varchar(64)
BEGIN
	

	if (IN property is null) or (@property = '')
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure dt_getpropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getpropertiesbyid]
	IN id int,
	IN pr...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getpropertiesbyid]
	IN id int,
	IN property varchar(64)
BEGIN
	

	if (IN property is null) or (@property = '')
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure dt_getobjwithprop_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getobjwithprop_u]
	IN property varchar...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getobjwithprop_u]
	IN property varchar(30),
	IN uvalue nvarchar(255)
BEGIN
	

	if (IN property is null) or (@property = '')
	begin
		raiserror('Must specify a property name.',-1,-1)
		return (1)
	END;

	if (IN uvalue is null)
		select objectid id from dtproperties
			where property=IN property else
		select objectid id from dtproperties
			where property=IN property and uvalue=@uvalue
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure dt_getobjwithprop: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getobjwithprop]
	IN property varchar(3...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getobjwithprop]
	IN property varchar(30),
	IN value varchar(255)
BEGIN
	

	if (IN property is null) or (@property = '')
	begin
		raiserror('Must specify a property name.',-1,-1)
		return (1)
	END;

	if (IN value is null)
		select objectid id from dtproperties
			where property=IN property else
		select objectid id from dtproperties
			where property=IN property and value=@value
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure dt_generateansiname: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
 
CREATE PROCEDURE `dt_generateansiname` (IN name varchar(255) ...' at line 1 (SQL: DELIMITER //
 
CREATE PROCEDURE `dt_generateansiname` (IN name varchar(255) output) BEGIN declare IN prologue varchar(20) 
	declare IN indexstring varchar(20) 
	declare IN index integer 
 
	set @prologue = 'MSDT-A-' 
	set @index = 1 
 
	while 1 = 1 
	begin 
		set @indexstring = cast(IN index BEGIN varchar(20)) 
		set @name = @prologue + IN indexstring if not exists (select value from dtproperties where value = @name) 
			break 
		 
		set @index = @index + 1 
 
		if (@index = 10000) 
			goto TooMany 
	 END; 
 
Leave: 
 
	return 
 
TooMany: 
 
	set @name = 'DIAGRAM' 
	goto Leave
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure dt_setpropertybyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_setpropertybyid_u]
	IN id int,
	IN pr...' at line 1 (SQL: DELIMITER //

create   procedure [dt_setpropertybyid_u]
	IN id int,
	IN property varchar(64),
	IN uvalue nvarchar(255),
	IN lvalue image
BEGIN
	
	
	
	
	
	declare IN avalue varchar(255) 
	set @avalue = null 
	if (IN uvalue is not null) 
	begin 
		if (convert(nvarchar(255), convert(varchar(255), @uvalue)) = @uvalue) 
		begin 
			set @avalue = convert(varchar(255), @uvalue) 
		END; 
		else 
		begin 
			if 'DtgSchemaNAME' = IN property begin 
				exec dt_generateansiname IN avalue output 
			END; 
		END; 
	END; 
	if exists (select * from dtproperties 
			where objectid=IN id and property=@property)
	begin
		
		
		
		update dtproperties set value=@avalue, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=IN id and property=IN property END;
	else
	begin
		
		
		
		insert dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @avalue, @uvalue, @lvalue)
	END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_Old]
     IN KhoHangID I...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_Old]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien BEGIN A INNER JOIN
            XePhuKienChiTiet BEGIN B ON A.ID = B.XePhuKienID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 1) AND (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure dt_dropuserobjectbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_dropuserobjectbyid]
	IN id int
BEGIN...' at line 1 (SQL: DELIMITER //

create   procedure [dt_dropuserobjectbyid]
	IN id int
BEGIN
	
	delete from dtproperties where objectid=@id
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN]
     IN KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien BEGIN A INNER JOIN
            XePhuKienChiTiet BEGIN B ON A.ID = B.XePhuKienID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 0) AND (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure dt_droppropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_droppropertiesbyid]
	IN id int,
	IN p...' at line 1 (SQL: DELIMITER //

create   procedure [dt_droppropertiesbyid]
	IN id int,
	IN property varchar(64)
BEGIN
	

	if (IN property is null) or (@property = '')
		delete from dtproperties where objectid=IN id else
		delete from dtproperties 
			where objectid=IN id and property=@property
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure dt_adduserobject: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_adduserobject]
BEGIN transaction
		in...' at line 1 (SQL: DELIMITER //

create   procedure [dt_adduserobject]
BEGIN transaction
		insert dtproperties (property) VALUES ('DtgSchemaOBJECT')
		update dtproperties set objectid=@IN identity where id=@IN identity and property='DtgSchemaOBJECT'
	commit
	return @@identity
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKHAC]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKHAC]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVXuatKhac BEGIN A INNER JOIN
			DVXuatKhacVatTu BEGIN B ON A.ID = B.DVXuatKhacID INNER JOIN
			VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
			VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_XUATDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATDOIDONVI]
     IN KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATDOIDONVI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, A.SoLuong, A.DonGia, A.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi BEGIN A INNER JOIN
            VatTu BEGIN V ON A.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_XE_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_BANGGIA]
     IN DenNgay nvarchar(20)...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_BANGGIA]
     IN DenNgay nvarchar(20)
BEGIN
    
	Declare IN V_Xe_BangGia_MaxID Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT Max(B.ID) BEGIN MaxID, B.XeID
			FROM   XeBangGia BEGIN A INNER JOIN
				   XeBangGiaChiTiet BEGIN B ON A.ID = B.XeBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive =1)
			GROUP BY B.XeID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.XeID, C.SoKhung, C.SoMay, X.MaXe, X.TenXe, X.SortDoiXe, X.SortLoaiXe, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, c.GiaApThue
	FROM   XeBangGia BEGIN B INNER JOIN
           XeBangGiaChiTiet BEGIN C ON B.ID = C.XeBangGiaID INNER JOIN
           IN V_Xe_BangGia_MaxID BEGIN V ON C.ID = V.MaxID INNER JOIN
           Xe BEGIN X ON C.XeID = X.ID	
	ORDER BY X.SortDoiXe
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON2]
	 IN TuNgay VARCHAR(...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON2]
	 IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 
BEGIN

	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) BEGIN SLNhap, SUM(T.TienNhap) BEGIN TienNhap, SUM(T.SLXuat) BEGIN SLXuat, SUM(T.TienXuat) BEGIN TienXuat 
	
	FROM (
		
		SELECT	1 BEGIN a, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	2 BEGIN a, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
				DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	3 BEGIN a, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	5 BEGIN a, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	6 BEGIN a, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapKhac BEGIN A INNER JOIN
				DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  8 BEGIN a, C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
                XeNhapTraLaiBanLePhuKien BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe BEGIN A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  9 BEGIN a, C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)		
		UNION ALL
		
		SELECT	10 BEGIN a, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanBuon BEGIN A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	11 BEGIN a, B.VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, B.SoLuong BEGIN SLXuat, B.TienVon BEGIN TienXuat
		FROM	DVBanLe BEGIN A INNER JOIN
				DVBanLeVatTu BEGIN B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	12 BEGIN a, B.VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, B.SoLuong BEGIN SLXuat, B.TienVon BEGIN TienXuat
		FROM	DVBanSi BEGIN A INNER JOIN
				DVBanSiVatTu BEGIN B ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON]
	 IN TuNgay VARCHAR(1...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON]
	 IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 
BEGIN

	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) BEGIN SLNhap, SUM(T.TienNhap) BEGIN TienNhap, SUM(T.SLXuat) BEGIN SLXuat, SUM(T.TienXuat) BEGIN TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
				DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapKhac BEGIN A INNER JOIN
				DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
                XeNhapTraLaiBanLePhuKien BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe BEGIN A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanBuon BEGIN A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, B.SoLuong BEGIN SLXuat, B.TienVon BEGIN TienXuat
		FROM	DVBanLe BEGIN A INNER JOIN
				DVBanLeVatTu BEGIN B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, B.SoLuong BEGIN SLXuat,
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_TONDAU_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU_ALL]
     IN KhoHangID INT,
...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU_ALL]
     IN KhoHangID INT,
     IN DenNgay VARCHAR(10)
BEGIN

	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'	

	SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) BEGIN TDSLNhap, SUM(T.TienNhap) BEGIN TDTienNhap, SUM(T.SLXuat) BEGIN TDSLXuat, SUM(T.TienXuat) BEGIN TDTienXuat 
	FROM (
		
		SELECT	'N01' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N02' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
				DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N03' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N04' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNoiBo BEGIN A INNER JOIN
				DVNoiBoVatTu BEGIN B ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT	'N05' BEGIN MaTN, A.KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID)
		UNION ALL
		
		SELECT	'N06' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapKhac BEGIN A INNER JOIN
				DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT  'N07' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNoiBo BEGIN A INNER JOIN
                XeNoiBoPhuKien BEGIN B ON A.ID = B.XeNoiBoID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT  'N08' BEGIN MaTN, A.KhoHangXuatID BEGIN KhoHangID, C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
                XeNhapTraLaiBanLePhuKien BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe BEGIN A ON A.ID = B.XeBanLeID INNER JOIN
				Va
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO_ALL_TEST]
     IN KhoHangID in...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO_ALL_TEST]
     IN KhoHangID int,
     IN DenNgay nvarchar(10)
BEGIN
    
	Declare IN Tb_VTTonDau Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert IN Tb_VTTonDau Exec SP_VT_TONDAU_ALL @KhoHangID, IN DenNgay SELECT A.KhoHangID BEGIN KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, A.TDSLNhap, A.TDSLXuat, (A.TDSLNhap - A.TDSLXuat) BEGIN SoLuongTon
	FROM IN Tb_VTTonDau BEGIN A INNER JOIN
			VatTu BEGIN V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) < 0
	order by  A.VatTuID

	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_XE_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_XUATNOIBO]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_XUATNOIBO]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeNoiBo BEGIN A INNER JOIN
			XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.IsXacNhan=1)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_VT_TONKHO_ALL]
     IN KhoHangID int,
 ...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_VT_TONKHO_ALL]
     IN KhoHangID int,
     IN DenNgay nvarchar(10)
BEGIN
    
	Declare IN Tb_VTTonDau Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert IN Tb_VTTonDau Exec SP_VT_TONDAU_ALL @KhoHangID, IN DenNgay SELECT A.KhoHangID BEGIN KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) BEGIN SoLuongTon
	FROM IN Tb_VTTonDau BEGIN A INNER JOIN
			VatTu BEGIN V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_XE_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPNOIBO]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPNOIBO]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeNoiBo BEGIN A INNER JOIN
			XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU]
     IN KhoHangID INT,
    ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU]
     IN KhoHangID INT,
     IN DenNgay VARCHAR(10),	 
	 IN VatTuID INT,
	 IN MaTacNghiep VARCHAR(1),
	 IN IDTacNghiep INT
BEGIN
	
	DECLARE IN NgayBatDauSuDung VARCHAR(10), 
		IN DVBanLeID INT, IN DVBanSiID INT, IN DVNoiBoID INT, IN DoiDonViID INT, IN DVXuatKhacID INT, IN XeBanLeKMID INT, 
		IN DVBanLeKMID INT, IN XePhuKienID INT, IN XePhuKienNoiBoID INT, IN DVBanBuonID INT, IN XeBanSiKMID INT, IN XeBanLeBHID INT
	SET @NgayBatDauSuDung = '2019-12-19'
	SET @DVBanLeID = 0 	
	SET @DVBanSiID = 0
	SET @DVNoiBoID = 0
	SET @DoiDonViID = 0
	SET @DVXuatKhacID = 0
	SET @XeBanLeKMID = 0
	SET @DVBanLeKMID = 0
	SET @XePhuKienID = 0
	SET @XePhuKienNoiBoID = 0
	SET @DVBanBuonID = 0
	SET @XeBanSiKMID = 0
	SET @XeBanLeBHID = 0

	IF(@MaTacNghiep ='I')			SET @DVBanLeID = IN IDTacNghiep ELSE IF(@MaTacNghiep='J')		SET @DVBanSiID = IN IDTacNghiep ELSE IF(@MaTacNghiep='K')		SET @DVNoiBoID = IN IDTacNghiep ELSE IF(@MaTacNghiep='L')		SET @DoiDonViID = IN IDTacNghiep ELSE IF(@MaTacNghiep='M')		SET @DVXuatKhacID = IN IDTacNghiep ELSE IF(@MaTacNghiep='N')		SET @XeBanLeKMID = IN IDTacNghiep ELSE IF(@MaTacNghiep='O')		SET @DVBanLeKMID = IN IDTacNghiep ELSE IF(@MaTacNghiep='P')		SET @XePhuKienID = IN IDTacNghiep ELSE IF(@MaTacNghiep='Q')		SET @XePhuKienNoiBoID = IN IDTacNghiep ELSE IF(@MaTacNghiep='R')		SET @DVBanBuonID = IN IDTacNghiep ELSE IF(@MaTacNghiep='S')		SET @XeBanSiKMID = IN IDTacNghiep ELSE IF(@MaTacNghiep='T')		SET @XeBanLeBHID = IN IDTacNghiep SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) BEGIN TDSLNhap, SUM(T.TienNhap) BEGIN TDTienNhap, SUM(T.SLXuat) BEGIN TDSLXuat, SUM(T.TienXuat) BEGIN TDTienXuat 
	FROM (
		
		SELECT	'N01' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
				DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNoiBo BEGIN A INNER JOIN
				DVNoiBoVatTu BEGIN B ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' BEGIN MaTN, A.KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATNOIBO]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATNOIBO]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo BEGIN A INNER JOIN
            DVNoiBoVatTu BEGIN B ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO]
     IN KhoHangID INT,
     ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO]
     IN KhoHangID INT,
     IN DenNgay nvarchar(10),
	 IN VatTuID INT,
	 IN MaTacNghiep VARCHAR(1),
	 IN IDTacNghiep INT
BEGIN
	    
	DECLARE IN Tb_VTTonDau Table (KhoHangID INT, VatTuID INT, TDSLNhap INT, TDTienNhap FLOAT, TDSLXuat INT, TDTienXuat FLOAT)
	INSERT IN Tb_VTTonDau Exec SP_VT_TONDAU @KhoHangID, @DenNgay, @VatTuID, @MaTacNghiep, IN IDTacNghiep SELECT A.KhoHangID BEGIN KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) BEGIN SoLuongTon
	FROM IN Tb_VTTonDau BEGIN A INNER JOIN
			VatTu BEGIN V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPNOIBO]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPNOIBO]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo BEGIN A INNER JOIN
            DVNoiBoVatTu BEGIN B ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.IsXacNhan = 1) AND (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_SELECT_GIAVON_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_SELECT_GIAVON_TEST]
	 IN TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_SELECT_GIAVON_TEST]
	 IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 
BEGIN

	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) BEGIN SLNhap, SUM(T.TienNhap) BEGIN TienNhap, SUM(T.SLXuat) BEGIN SLXuat, SUM(T.TienXuat) BEGIN TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
				DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, (1 - A.TyLeCK*0.01) * B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapKhac BEGIN A INNER JOIN
				DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
                XeNhapTraLaiBanLePhuKien BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe BEGIN A ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanBuon BEGIN A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, 1 BEGIN SLNhap, C.GiaBanBH BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
                XeNhapTraLaiBanLeBaoHiem BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe BEGIN A ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, B.SoLuong BEGIN SLXuat, B.TienVon BEGIN TienXuat
		FROM	DVBanLe BEGIN A INNER JOIN
				DVBanLeVatTu BEGIN B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, B.SoLuong BEGIN SLXuat, B.TienVon BEGIN TienXuat
		FROM	DVBanSi BEGIN A INNER JOIN
				DVBanSiVatTu BEGIN B ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT < @TuNgay)
		UNION ALL
		
		SELECT  VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, SoLuong BEGIN SLXuat, ThanhTien BEGIN TienXuat
		FROM    DoiDonVi BEGIN A    
	
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_NHAPXUAT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPXUAT]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPXUAT]
     IN KhoHangID INT,
	 IN VatTuID INT,
	 IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 	 
BEGIN
	
	SELECT T.SoCT, T.NgayCT, T.NgayNXK, T.KhoHangNhapID, T.KhoHangXuatID, T.KhachHangID, T.VatTuID, T.SLNhap, T.SLXuat 
	FROM (
		
		SELECT	'N01' BEGIN MaTN, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayNXK, A.KhoHangNhapID, NULL BEGIN KhoHangXuatID, A.KhachHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' BEGIN MaTN, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayNXK, A.KhoHangNhapID, NULL BEGIN KhoHangXuatID, C.KhachHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
                DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
                DVBanLe BEGIN C ON A.DVBanLeID = C.ID   
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' BEGIN MaTN, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayNXK, A.KhoHangNhapID, NULL BEGIN KhoHangXuatID, C.KhachHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
                DVBanSi BEGIN C ON A.DVBanSiID = C.ID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' BEGIN MaTN, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayNXK, A.KhoHangNhapID, A.KhoHangXuatID, NULL BEGIN KhachHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNoiBo BEGIN A INNER JOIN
				DVNoiBoVatTu BEGIN B ON A.ID = B.DVNoiBoID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' BEGIN MaTN, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayNXK, A.KhoHangID BEGIN KhoHangNhapID, NULL BEGIN KhoHangXuatID, NULL BEGIN KhachHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N06' BEGIN MaTN, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayNXK, A.KhoHangNhapID, NULL BEGIN KhoHangXuatID, NULL BEGIN KhachHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapKhac BEGIN A INNER JOIN
				DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  'N07' BEGIN MaTN, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayNXK, A.KhoHangNhapID, NULL BEGIN KhoHangXuatID, NULL BEGIN KhachHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNoiBo BEGIN A INNER JOIN
                XeNoiBoPhuKien BEGIN B ON A.ID = B.XeNoiBoID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)		
		UNION ALL
		
		SELECT  'N08' BEGIN MaTN, B.SoCT, B.NgayCT, B.NgayCT BEGIN NgayNXK, A.KhoHangXuatID BEGIN KhoHangNhapID, NULL BEGIN KhoHangXuatID, a.KhachHangID, C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_NHAPDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPDOIDONVI]
     IN KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPDOIDONVI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi BEGIN A INNER JOIN
            DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XECHUYENKHO]
     IN Kho...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XECHUYENKHO]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID BEGIN KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo BEGIN A INNER JOIN
            XeNoiBoPhuKien BEGIN B ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_GET_GIAVON]
	 IN TuNgay VARCHAR(10),...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_GET_GIAVON]
	 IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10),
	 IN VatTuID int
BEGIN

	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) BEGIN SLNhap, SUM(T.TienNhap) BEGIN TienNhap, SUM(T.SLXuat) BEGIN SLXuat, SUM(T.TienXuat) BEGIN TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
				DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapKhac BEGIN A INNER JOIN
				DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
                XeNhapTraLaiBanLePhuKien BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe BEGIN A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanBuon BEGIN A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, B.SoLuong BEGIN SLXuat, B.TienVon BEGIN TienXuat
		FROM	DVBanLe BEGIN A INNER JOIN
				DVBanLeVatTu BEGIN B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.Nga
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_XECHUYENKHO]
     IN Kho...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_XECHUYENKHO]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo BEGIN A INNER JOIN
            XeNoiBoPhuKien BEGIN B ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan = 1)
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_DELETE_DUPLICATE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_DELETE_DUPLICATE]
	 IN VatTuID_DEL i...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_DELETE_DUPLICATE]
	 IN VatTuID_DEL int,	 
     IN VatTuID int	 
BEGIN

	update DoiDonVi						set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DoiDonViChiTiet				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVBanLeVatTu					set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVBanSiVatTu					set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapKhacVatTu				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapMuaVatTu				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapTraLaiBanLeChiTiet		set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapTraLaiBanSiChiTiet		set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNoiBoVatTu					set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVXuatKhacVatTu				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update VTBangGiaChiTiet				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeBanLeKhuyenMai				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeBanLePhuKien				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeNhapTraLaiBanLeKhuyenMai	set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeNhapTraLaiBanLePhuKien		set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeNoiBoPhuKien				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XePhuKienChiTiet				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL Delete VatTu where (ID = @VatTuID_DEL)

END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XEBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XEBANLE]
     IN KhoHang...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XEBANLE]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID BEGIN KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, b.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeBanLe BEGIN A INNER JOIN
            XeBanLePhuKien BEGIN B ON A.ID = B.XeBanLeID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE   (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHLE]
     IN KhoHangID INT,
...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHLE]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai BEGIN L INNER JOIN
            VatTu BEGIN V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe BEGIN A INNER JOIN
            XeBanLeKhuyenMai BEGIN B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure dt_verstamp007: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_verstamp007]
BEGIN
	select 7005
//
DE...' at line 1 (SQL: DELIMITER //

create   procedure [dt_verstamp007]
BEGIN
	select 7005
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_XUATKMBH_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBH_Old]
     IN KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBH_Old]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai BEGIN L INNER JOIN
            VatTu BEGIN V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe BEGIN A INNER JOIN
            XeBanLeKhuyenMai BEGIN B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure dt_verstamp006: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_verstamp006]
BEGIN
	select 7000
//
DE...' at line 1 (SQL: DELIMITER //

create   procedure [dt_verstamp006]
BEGIN
	select 7000
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_XUATBAOHIEM_BHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBAOHIEM_BHLE]
     IN KhoHangID ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBAOHIEM_BHLE]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, B.NgayXuat BEGIN NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, 1 BEGIN SoLuong, B.GiaBanBH, B.GiaBanBH BEGIN ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai BEGIN L INNER JOIN
            VatTu BEGIN V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe BEGIN A INNER JOIN
            XeBanLeBaoHiem BEGIN B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_TRALAI]
     IN KhoHangI...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_TRALAI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  B.ID, B.SoCT, C.NgayNhap BEGIN NgayCT, A.KhoHangXuatID BEGIN KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
            XeNhapTraLaiBanLePhuKien BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe BEGIN A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu BEGIN V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_NHAPKHUYENMAI_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHUYENMAI_TRALAI]
     IN KhoHan...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHUYENMAI_TRALAI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  B.ID, B.SoCT, B.NgayCT, A.KhoHangXuatID BEGIN KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
            XeNhapTraLaiBanLeKhuyenMai BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe BEGIN A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu BEGIN V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_XE_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRASI]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRASI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeBanSi BEGIN A INNER JOIN
			XeNhapTraLaiBanSi BEGIN B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet BEGIN C ON B.ID = C.XeNhapTraLaiBanSiID
	WHERE (B.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.XeNhapMuaID IS NOT NULL)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_NHAPBAOHIEM_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPBAOHIEM_TRALAI]
     IN KhoHangI...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPBAOHIEM_TRALAI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  B.ID, B.SoCT, C.NgayNhap BEGIN NgayCT, A.KhoHangXuatID BEGIN KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, 1 BEGIN SoLuong, C.GiaBanBH BEGIN DonGia, C.GiaBanBH BEGIN ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
            XeNhapTraLaiBanLeBaoHiem BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe BEGIN A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu BEGIN V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRALE]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRALE]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanLe BEGIN A INNER JOIN
            DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_TEST_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TEST_1]   
BEGIN

	select count(ID) BE...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TEST_1]   
BEGIN

	select count(ID) BEGIN 'VT' from VatTu
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TEST]
     IN VatTuID INT     
BEGIN
...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TEST]
     IN VatTuID INT     
BEGIN

	
	

	
	
	
	
	
	
	select * from VatTu where ID = IN VatTuID END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_DV_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_DV_BANGGIA]
     IN DenNgay nvarchar(10)...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_DV_BANGGIA]
     IN DenNgay nvarchar(10),
	 IN CuaHangID nvarchar(2)
BEGIN
    
	Declare IN V_DV_BangGia_MaxID Table (MaxID int, DichVuID int)
	Insert @V_DV_BangGia_MaxID(MaxID, DichVuID) 
			SELECT Max(B.ID) BEGIN MaxID, B.DichVuID
			FROM   DVBangGia BEGIN A INNER JOIN
				   DVBangGiaChiTiet BEGIN B ON A.ID = B.DVBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.CuaHangID = @CuaHangID)
			GROUP BY B.DichVuID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.DichVuID, V.MaDichVu, V.HangMuc, C.DonGia
	FROM   DVBangGia BEGIN B INNER JOIN
           DVBangGiaChiTiet BEGIN C ON B.ID = C.DVBangGiaID INNER JOIN
           IN V_DV_BangGia_MaxID BEGIN M ON C.ID = M.MaxID INNER JOIN
           DichVu BEGIN V ON C.DichVuID = V.ID	
	ORDER BY V.MaDichVu
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHSI]
     IN KhoHangID INT,
...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHSI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai BEGIN L INNER JOIN
            VatTu BEGIN V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanSi BEGIN A INNER JOIN
            XeBanSiKhuyenMai BEGIN B ON A.ID = B.XeBanSiID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE[SP_VT_BANGGIA]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE[SP_VT_BANGGIA]
                                IN DenNgay nvarchar(10),
	                            IN CuaHangID nvarchar(2)
                            BEGIN
                            
                                Declare IN V_VT_BangGia_MaxID Table(MaxID int, VatTuID int)
                                Insert @V_VT_BangGia_MaxID(MaxID, VatTuID)
                                        SELECT Max(B.ID) BEGIN MaxID, B.VatTuID
                                        FROM   VTBangGia BEGIN A CROSS APPLY STRING_SPLIT(CuaHangID, ',') INNER JOIN
                                               VTBangGiaChiTiet BEGIN B ON A.ID = B.VTBangGiaID
                                        WHERE(A.ApDungTu <= @DenNgay) AND(A.ApDungDen >= @DenNgay) AND (value = @CuaHangID)
                                        GROUP BY B.VatTuID

                                SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.VatTuLoaiID, L.VatTuNhomID, C.GiaNhap, C.GiaXuat
                                FROM   VTBangGia BEGIN B INNER JOIN
                                       VTBangGiaChiTiet BEGIN C ON B.ID = C.VTBangGiaID INNER JOIN
                                       IN V_VT_BangGia_MaxID BEGIN M ON C.ID = M.MaxID INNER JOIN
                                       VatTu BEGIN V ON C.VatTuID = V.ID INNER JOIN
                                       VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
                            END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_VT_NHAPKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHAC]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHAC]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapKhac BEGIN A INNER JOIN
            DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI_TONGHOP]     
	 IN TuNgay ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI_TONGHOP]     
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeBanSi BEGIN A INNER JOIN
			XeBanSiChiTiet BEGIN B ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay)		
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeBanSi BEGIN A INNER JOIN
			XeBanSiChiTiet BEGIN B ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_XE_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_TONDAU]
     IN KhoHangID INT,
    ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_TONDAU]
     IN KhoHangID INT,
     IN DenNgay VARCHAR(10),
	 IN XeBanLeID INT,
	 IN XeBanSiID INT,
	 IN XeNoiBoID INT,
	 IN XeXuatKhacID INT
BEGIN

	SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) BEGIN TDSLNhap, SUM(T.SLXuat) BEGIN TDSLXuat
	FROM (
		
		SELECT 'A' BEGIN MaTN, KhoHangNhapID BEGIN KhoHangID, XeID, ID BEGIN XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat 
		FROM XeNhapMua 
		WHERE (NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT 'B' BEGIN TN, A.KhoHangNhapID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat
		FROM XeNoiBo BEGIN A INNER JOIN
				XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
		UNION ALL
		
		SELECT 'C' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, A.XeID, A.XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat
		FROM XeBanLe  BEGIN A INNER JOIN
				XeNhapTraLaiBanLe  BEGIN B ON A.ID = B.XeBanLeID    
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'D' BEGIN TN, A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat
		FROM XeBanSi BEGIN A INNER JOIN
				XeNhapTraLaiBanSi BEGIN B ON A.ID = B.XeBanSiID INNER JOIN
				XeNhapTraLaiBanSiChiTiet BEGIN C ON B.ID = C.XeNhapTraLaiBanSiID
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
		UNION ALL
		
		SELECT 'E' BEGIN TN, KhoHangXuatID BEGIN KhoHangID, XeID, XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
		FROM XeBanLe     
		WHERE (NgayBan <= @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'F' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
		FROM XeBanSi BEGIN A INNER JOIN
				XeBanSiChiTiet BEGIN B ON A.ID = B.XeBanSiID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeBanSiID)
		UNION ALL
		
		SELECT 'G' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
		FROM XeNoiBo BEGIN A INNER JOIN
				XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeNoiBoID) 
		UNION ALL
		
		SELECT 'H' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
		FROM XeXuatKhac BEGIN A INNER JOIN
				XeXuatKhacChiTiet BEGIN B ON A.ID = B.XeXuatKhacID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeXuatKhacID)
	) BEGIN T
	GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID
END;


//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_XE_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_TONKHO]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_TONKHO]
                                 IN KhoHangID int,
                                 IN DenNgay nvarchar(10),
	                             IN XeBanLeID INT,
	                             IN XeBanSiID INT,
	                             IN XeNoiBoID INT,
	                             IN XeXuatKhacID INT
                            BEGIN
                             
	                            Declare IN Tb_XeTonDau Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)
	                            Insert IN Tb_XeTonDau Exec SP_XE_TONDAU @KhoHangID, @DenNgay, @XeBanLeID, @XeBanSiID, @XeNoiBoID, IN XeXuatKhacID SELECT A.KhoHangID, B.KhoHangNhapID, A.XeID, X.MaXe, X.TenXe, A.XeNhapMuaID, B.KhachHangID BEGIN NhaCungCapID, B.DonGia_CoVAT, B.NgayCT, B.SoKhung, B.SoMay, B.MaChiaKhoa, (A.TDSLNhap - A.TDSLXuat) BEGIN SoLuongTon, B.GhiChu, B.MaChiaKhoa
	                            FROM IN Tb_XeTonDau BEGIN A INNER JOIN
			                            XeNhapMua BEGIN B ON A.XeNhapMuaID = B.ID INNER JOIN
			                            Xe BEGIN X ON A.XeID = X.ID 
	                            WHERE (A.TDSLNhap - A.TDSLXuat) <>0
                            END;
//
DELIMITER ;)  
[2024-07-18 16:32:11] local.ERROR: Error creating stored procedure SP_NHAPXUATTON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_NHAPXUATTON]
     IN KhoHangID int,
	 I...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_NHAPXUATTON]
     IN KhoHangID int,
	 IN TuNgay nvarchar(10),
     IN DenNgay nvarchar(10)
BEGIN
    

	Declare IN Tb_XeTonDau Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)

	declare IN XeBanLeID int, IN XeBanSiID int, IN XeNoiBoID int
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0

	Insert IN Tb_XeTonDau Exec SP_XE_TONDAU @KhoHangID, @TuNgay, @XeBanLeID, @XeBanSiID, IN XeNoiBoID SELECT NXT.* FROM (
		SELECT 'T' BEGIN TN, KhoHangID, XeID, XeNhapMuaID, (TDSLNhap - TDSLXuat) BEGIN TDSL
		FROM IN Tb_XeTonDau UNION ALL
		SELECT 'B' BEGIN TN, A.KhoHangNhapID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 1 BEGIN SoLuong
		FROM XeNoiBo BEGIN A INNER JOIN
			 XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID    
		WHERE A.NgayCT < IN DenNgay AND KhoHangNhapID = @KhoHangID   
	) BEGIN NXT 
END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_XE_LICHSU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_LICHSU]
     IN XeNhapMuaID INT
BEG...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_LICHSU]
     IN XeNhapMuaID INT
BEGIN

	
	SELECT 'A' BEGIN MaTN, ID, KhoHangNhapID, Null BEGIN KhoHangXuatID, XeID, ID BEGIN XeNhapMuaID, SoCT, NgayCT, NULL BEGIN NgayBan, CreatedBy, SoKhung, SoMay 
	FROM XeNhapMua 
	WHERE (ID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'B' BEGIN TN, A.ID, A.KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, NULL BEGIN NgayBan, A.CreatedBy, M.SoKhung, M.SoMay 
	FROM XeNoiBo BEGIN A INNER JOIN
			XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID INNER JOIN
			XeNhapMua BEGIN M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'C' BEGIN TN, B.ID, A.KhoHangXuatID BEGIN KhoHangNhapID, null BEGIN KhoHangXuatID, A.XeID, A.XeNhapMuaID, B.SoCT, B.NgayCT, NULL BEGIN NgayBan, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe  BEGIN A INNER JOIN
			XeNhapTraLaiBanLe  BEGIN B ON A.ID = B.XeBanLeID INNER JOIN
			XeNhapMua BEGIN M ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'D' BEGIN TN, B.ID, A.KhoHangXuatID BEGIN KhoHangNhapID, null BEGIN KhoHangXuatID, C.XeID, C.XeNhapMuaID, B.SoCT, B.NgayCT, NULL BEGIN NgayBan, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi BEGIN A INNER JOIN
			XeNhapTraLaiBanSi BEGIN B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet BEGIN C ON B.ID = C.XeNhapTraLaiBanSiID INNER JOIN
			XeNhapMua BEGIN M ON C.XeNhapMuaID = M.ID
	WHERE (C.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'E' BEGIN TN, A.ID, Null BEGIN KhoHangNhapID, A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe BEGIN A INNER JOIN
			XeNhapMua BEGIN M ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'F' BEGIN TN, A.ID, Null BEGIN KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi BEGIN A INNER JOIN
			XeBanSiChiTiet BEGIN B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapMua BEGIN M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'G' BEGIN TN, A.ID, Null BEGIN KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeXuatKhac BEGIN A INNER JOIN
			XeXuatKhacChiTiet BEGIN B ON A.ID = B.XeXuatKhacID INNER JOIN
			XeNhapMua BEGIN M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	
	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE_TONGHOP]     
	 IN TuNgay ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE_TONGHOP]     
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT KhoHangXuatID BEGIN KhoHangID, XeID, XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN IN TuNgay AND @DenNgay) AND (XeNhapMuaID IS NOT NULL)
END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT KhoHangXuatID BEGIN KhoHangID, XeID, XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN IN TuNgay AND @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (XeNhapMuaID IS NOT NULL)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_XE_TONKHO_BY_XEID: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_TONKHO_BY_XEID]     
     IN DenNgay...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_TONKHO_BY_XEID]     
     IN DenNgay VARCHAR(10),
	 IN XeID INT,
	 IN IDPhieu INT,
	 IN LoaiPhieu INT,
	 IN SoMay VARCHAR(20)
BEGIN

	Declare IN XeBanLeID INT,	IN XeBanSiID INT, IN XeNoiBoID INT, IN XeXuatKhacID INT
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0
	SET @XeXuatKhacID = 0

	if(@LoaiPhieu = 1)
		SET @XeBanLeID = IN IDPhieu else if(@LoaiPhieu = 2)
		SET @XeBanSiID = IN IDPhieu else if(@LoaiPhieu = 3)
		SET @XeNoiBoID = IN IDPhieu else if(@LoaiPhieu = 4)
		SET @XeXuatKhacID = IN IDPhieu Declare IN Tb_XeTonKho Table (KhoHangID int, XeID int, XeNhapMuaID int, SLNhap int, SLXuat int)

	Insert IN Tb_XeTonKho SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) BEGIN TDSLNhap, SUM(T.SLXuat) BEGIN TDSLXuat
		FROM (
			
			SELECT 'A' BEGIN MaTN, KhoHangNhapID BEGIN KhoHangID, XeID, ID BEGIN XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat 
			FROM XeNhapMua 
			WHERE (NgayCT <= @DenNgay) AND (XeID = @XeID)
			UNION ALL
			
			SELECT 'B' BEGIN TN, A.KhoHangNhapID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat
			FROM XeNoiBo BEGIN A INNER JOIN
					XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.IsXacNhan=1)
			UNION ALL
			
			SELECT 'C' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, A.XeID, A.XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat
			FROM XeBanLe  BEGIN A INNER JOIN
					XeNhapTraLaiBanLe  BEGIN B ON A.ID = B.XeBanLeID    
			WHERE (B.NgayCT <= @DenNgay) AND (A.XeID = @XeID) AND (A.XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'D' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, C.XeID, C.XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat
			FROM XeBanSi BEGIN A INNER JOIN
					XeNhapTraLaiBanSi BEGIN B ON A.ID = B.XeBanSiID INNER JOIN
					XeNhapTraLaiBanSiChiTiet BEGIN C ON B.ID = C.XeNhapTraLaiBanSiID
			WHERE (B.NgayCT <= @DenNgay) AND (C.XeID = @XeID)
			UNION ALL
			
			SELECT 'E' BEGIN TN, KhoHangXuatID BEGIN KhoHangID, XeID, XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
			FROM XeBanLe     
			WHERE (NgayBan <= @DenNgay) AND (XeID = @XeID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'F' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
			FROM XeBanSi BEGIN A INNER JOIN
					XeBanSiChiTiet BEGIN B ON A.ID = B.XeBanSiID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeBanSiID)
			UNION ALL
			
			SELECT 'G' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
			FROM XeNoiBo BEGIN A INNER JOIN
					XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeNoiBoID) 
			UNION ALL
			
			SELECT 'F' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
			FROM XeXuatKhac BEGIN A INNER JOIN
					XeXuatKhacChiTiet BEGIN B ON A.ID = B.XeXuatKhacID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeXuatKhacID)
		) BEGIN T
		GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID

		if(LEN(@SoMay)>0)
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) BEGIN SLTON,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM IN Tb_XeTonKho BEGIN A INNER JOIN
					XeNhapMua BEGIN B ON A.XeNhapMuaID = B.ID INNER JOIN
					Xe BEGIN X ON A.XeID = X.ID INNER JOIN 
					KhoHang BEGIN K ON A.KhoHangID = K.ID 
			WHERE SLNhap-SLXuat<>0 AND (B.SoMay Like N'%' + @SoMay)
		else
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) BEGIN SLTON,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM IN Tb_XeTonKho BEGIN A INNER JOIN
					XeNh
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_XE_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRALE]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRALE]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeBanLe  BEGIN A INNER JOIN
			XeNhapTraLaiBanLe  BEGIN B ON A.ID = B.XeBanLeID    
	WHERE (B.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA_GROUP]
     IN KhoHangID INT...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA_GROUP]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, SUM(B.SoLuong) BEGIN SoLuong, SUM(B.ThanhTien) BEGIN ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua BEGIN A INNER JOIN
            DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA]
     IN KhoHangID INT,
	 I...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua BEGIN A INNER JOIN
            DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_VT_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRASI]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRASI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanSi BEGIN A INNER JOIN
            DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_VT_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANSI]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANSI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanSi BEGIN A INNER JOIN
            DVBanSiVatTu BEGIN B ON A.ID = B.DVBanSiID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure uspGetChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc [uspGetChiTien1]
IN ID int
BEGIN
SELECT  ...' at line 1 (SQL: DELIMITER //
CREATE         proc [uspGetChiTien1]
IN ID int
BEGIN
SELECT        ChiTien.ID, KhachHang.TenKhachHang, ChiTienLyDo.TenLyDo, ChiTien.SoTien, TaiKhoan.TenTaiKhoan, ChiTien.GhiChu, ChiTien.CuaHangID, ChiTien.CreatedBy, 
                         ChiTien.CreatedAt, ChiTien.UpdatedBy, ChiTien.UpdatedAt
FROM            ChiTien INNER JOIN
                         KhachHang ON ChiTien.KhachHangID = KhachHang.ID INNER JOIN
                         ChiTienLyDo ON ChiTien.ChiTienLyDoID = ChiTienLyDo.ID INNER JOIN
                         TaiKhoan ON ChiTien.TaiKhoanID = TaiKhoan.ID
WHERE ChiTien.ID= @ID
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure uspChiTien2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
create         proc [uspChiTien2]
IN ID int,
IN Status int,
I...' at line 1 (SQL: DELIMITER //
create         proc [uspChiTien2]
IN ID int,
IN Status int,
IN ApprovalBy int
BEGIN
UPDATE ChiTien SET [Status2] = @Status, Approval2By = @ApprovalBy, Approval2At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_XE_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_NHAPMUA]
     IN KhoHangID INT,
	 I...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_NHAPMUA]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT KhoHangNhapID, XeID, ID BEGIN XeNhapMuaID, 1 BEGIN SoLuong 
	FROM XeNhapMua 
	WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (KhoHangNhapID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure uspChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc [uspChiTien1]
IN ID int,
IN Status int,
I...' at line 1 (SQL: DELIMITER //
CREATE         proc [uspChiTien1]
IN ID int,
IN Status int,
IN ApprovalBy int
BEGIN
UPDATE ChiTien SET [Status1] = @Status, Approval1By = @ApprovalBy, Approval1At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE_GROUP]
     IN KhoHangID I...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE_GROUP]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, SUM(B.SoLuong) BEGIN SoLuong, SUM(B.ThanhTien) BEGIN ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe BEGIN A INNER JOIN
            DVBanLeVatTu BEGIN B ON A.ID = B.DVBanLeID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure upsChiTienPowerApps: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [upsChiTienPowerApps]
BEGIN
    
	Declare ...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [upsChiTienPowerApps]
BEGIN
    
	Declare IN TuNgay VARCHAR(10), IN DenNgay VARCHAR(10)

	set @TuNgay = CONVERT(VARCHAR(10), DATEADD(DAY, -30, NOW()), 101)
	set @DenNgay = CONVERT(VARCHAR(10), NOW(), 101)

	SELECT * FROM ChiTien WHERE NgayCT between IN TuNgay and IN DenNgay END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON_KHOHANG: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //



CREATE PROCEDURE `SP_VT_GET_GIAVON_KHOHANG`
	 IN TuNgay VA...' at line 1 (SQL: DELIMITER //



CREATE PROCEDURE `SP_VT_GET_GIAVON_KHOHANG`
	 IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10),
	 IN KhoHangID int,
	 IN VatTuID int
BEGIN

	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	Declare IN Tb_VTTonDau Table (KhoHangID int, VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) BEGIN SLNhap, SUM(T.TienNhap) BEGIN TienNhap, SUM(T.SLXuat) BEGIN SLXuat, SUM(T.TienXuat) BEGIN TienXuat 
	FROM (
		
		SELECT	A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
				DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapKhac BEGIN A INNER JOIN
				DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID BEGIN KhoHangID, C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
                XeNhapTraLaiBanLePhuKien BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe BEGIN A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID BEGIN KhoHangID, C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
				XeBanLe BEGIN A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanBuon BEGIN A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		
		
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.SoPhieu, A.KhoHangXuatID, A.KhachHangID, B.NgayXuat, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe BEGIN A INNER JOIN
            DVBanLeVatTu BEGIN B ON A.ID = B.DVBanLeID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure spCheckPhieuChi: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE `spCheckPhieuChi` (
		IN khohangID varchar(10)...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE `spCheckPhieuChi` (
		IN khohangID varchar(10)
) BEGIN select	* from ChiTien
				where	KhoHangID = IN khohangID  END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_FIX_SLVT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_FIX_SLVT]
BEGIN
    
	Declare IN Tb_SL...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_FIX_SLVT]
BEGIN
    
	Declare IN Tb_SLVT Table (DVBanLeID int, SoLuongVT float)

	Insert @Tb_SLVT(DVBanLeID, SoLuongVT) 
	select DVBanLeID, Sum(SoLuong) BEGIN SoLuongVT from DVBanLeVatTu group by DVBanLeID
	
	UPDATE DVBanLe 
    SET DVBanLe.TongSoLuongVatTu = B.SoLuongVT            
	FROM DVBanLe INNER JOIN IN Tb_SLVT BEGIN B ON DVBanLe.ID = B.DVBanLeID 
	where B.SoLuongVT is not null
	
 
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_TC_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TC_TONDAU]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TC_TONDAU]
                                 IN TaiKhoanID INT,
                                 IN TuNgay VARCHAR(10),
	                             IN DenNgay VARCHAR(10)	 
                            BEGIN
                            
	                            SELECT T.TaiKhoanID, T.TacNghiep, SUM(T.SoTien) BEGIN SoTien
	                            FROM (
		                            
		                            SELECT 1 BEGIN MaTN, TaiKhoanID, SUM(SoTien) BEGIN SoTien, TacNghiep 
		                            FROM XeBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 2 BEGIN MaTN, TaiKhoanID, SUM(SoTien) BEGIN SoTien, TacNghiep 
		                            FROM XeBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 3 BEGIN MaTN, TaiKhoanID, SUM(GiaNhap) BEGIN SoTien, 1 BEGIN TacNghiep
		                            FROM XeSonXe 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 4 BEGIN MaTN, TaiKhoanID, SUM(SoTien) BEGIN SoTien, 0 BEGIN TacNghiep
		                            FROM ThuTien 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 5 BEGIN MaTN, TaiKhoanID, SUM(SoTien) BEGIN SoTien, 1 BEGIN TacNghiep
		                            FROM ChiTien 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 6 BEGIN MaTN, TaiKhoanID, SUM(SoTien) BEGIN SoTien, TacNghiep 
		                            FROM DVBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 7 BEGIN MaTN, TaiKhoanID, SUM(SoTien) BEGIN SoTien, TacNghiep 
		                            FROM DVBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 8 BEGIN MaTN, TaiKhoanID, SUM(SoTien) BEGIN SoTien, TacNghiep 
		                            FROM DVBanBuonThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 9 BEGIN MaTN, T.TaiKhoanID, SUM(G.ChiPhi) BEGIN SoTien, 1 BEGIN TacNghiep 
                                    FROM DVBanLe BEGIN A INNER JOIN 
                                        KhoHang BEGIN K ON A.KhoHangXuatID = K.ID INNER JOIN 
	
//
DELIMITER ;)  
[2024-07-18 16:32:12] local.ERROR: Error creating stored procedure SP_VT_NHAPTRABUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRABUON]
     IN KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRABUON]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanBuon BEGIN A INNER JOIN
            DVNhapTraLaiBanBuonChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanbuonID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_XUATBANBUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanBuon AS  INNER JOIN
            DVBanBuonVatTu AS  ON A.ID = B.DVBanBuonID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``     
	  VARCHAR(10),
      VARCHAR(10)
A...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``     
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeXuatKhac AS  INNER JOIN
			XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay)		
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeXuatKhac AS  INNER JOIN
			XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_XE_BANGGIA2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      nvarchar(20),
	  int,
	  nvarchar(...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      nvarchar(20),
	  int,
	  nvarchar(50)
AS   nvarchar(30)

	
	SELECT		@TenModel = X.TenModel FROM XeNhapMua AS  INNER JOIN Xe AS  ON M.XeID = X.ID INNER JOIN V_XeThayVanh AS  ON M.ID = TV.XeNhapMuaID 
	WHERE		TV.XeNhapMuaID =  GROUP BY	X.TenModel	

	
	Declare  Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT  MAX(B.ID) AS , B.XeID
			FROM    XeBangGia AS  INNER JOIN
                    XeBangGiaChiTiet AS  ON A.ID = B.XeBangGiaID INNER JOIN
                    Xe AS  ON B.XeID = X.ID
			WHERE   (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive = 1) AND (X.TenModel = @TenModel) AND (X.TenType = @TenType)
			GROUP BY B.XeID, X.TenModel, X.TenType

	
	SELECT TOP (1) X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	FROM   XeBangGia AS  INNER JOIN
           XeBangGiaChiTiet AS  ON B.ID = C.XeBangGiaID INNER JOIN
            AS  ON C.ID = V.MaxID INNER JOIN
           Xe AS  ON C.XeID = X.ID	
	GROUP BY X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	ORDER BY C.GiaHaiQuan DESC
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_XUATKMDV: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS , B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            DVBanLe AS  INNER JOIN
            DVBanLeKhuyenMai AS  ON A.ID = B.DVBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure dt_setpropertybyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
	 int,
	 varchar(64),
	 varchar(255),
...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
	 int,
	 varchar(64),
	 varchar(255),
	 image
AS   nvarchar(255) 
	set @uvalue = convert(nvarchar(255), @value) 
	if exists (select * from dtproperties 
			where objectid= and property=@property)
	AS  dtproperties set value=@value, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid= and property= END;
	else
	AS  dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @value, @uvalue, @lvalue)
	END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure dt_getpropertiesbyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
	 int,
	 varchar(64)
AS  ( is null) or ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
	 int,
	 varchar(64)
AS  ( is null) or (@property = '')
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure dt_getpropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
	 int,
	 varchar(64)
AS  ( is null) or ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
	 int,
	 varchar(64)
AS  ( is null) or (@property = '')
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure dt_getobjwithprop_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
	 varchar(30),
	 nvarchar(255)
AS  ( is...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
	 varchar(30),
	 nvarchar(255)
AS  ( is null) or (@property = '')
	AS ('Must specify a property name.',-1,-1)
		return (1)
	END;

	if ( is null)
		select objectid id from dtproperties
			where property= else
		select objectid id from dtproperties
			where property= and uvalue=@uvalue
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure dt_getobjwithprop: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
	 varchar(30),
	 varchar(255)
AS  ( is ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
	 varchar(30),
	 varchar(255)
AS  ( is null) or (@property = '')
	AS ('Must specify a property name.',-1,-1)
		return (1)
	END;

	if ( is null)
		select objectid id from dtproperties
			where property= else
		select objectid id from dtproperties
			where property= and value=@value
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure dt_generateansiname: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
 
CREATE PROCEDURE ``( varchar(255) output) 
AS   varchar(20) ...' at line 1 (SQL: DELIMITER //
 
CREATE PROCEDURE ``( varchar(255) output) 
AS   varchar(20) 
	declare  varchar(20) 
	declare  integer 
 
	set @prologue = 'MSDT-A-' 
	set @index = 1 
 
	while 1 = 1 
	AS  @indexstring = cast( AS (20)) 
		set @name = @prologue +  if not exists (select value from dtproperties where value = @name) 
			break 
		 
		set @index = @index + 1 
 
		if (@index = 10000) 
			goto TooMany 
	END; 
 
Leave: 
 
	return 
 
TooMany: 
 
	set @name = 'DIAGRAM' 
	goto Leave
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure dt_setpropertybyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
	 int,
	 varchar(64),
	 nvarchar(255),...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
	 int,
	 varchar(64),
	 nvarchar(255),
	 image
AS   varchar(255) 
	set @avalue = null 
	if ( is not null) 
	AS  (convert(nvarchar(255), convert(varchar(255), @uvalue)) = @uvalue) 
		AS  @avalue = convert(varchar(255), @uvalue) 
		END; 
		else 
		AS  'DtgSchemaNAME' =  AS  dt_generateansiname  output 
			END; 
		END; 
	END; 
	if exists (select * from dtproperties 
			where objectid= and property=@property)
	AS  dtproperties set value=@avalue, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid= and property= END;
	else
	AS  dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @avalue, @uvalue, @lvalue)
	END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS  INNER JOIN
            XePhuKienChiTiet AS  ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 1) AND (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure dt_dropuserobjectbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
	 int
AS  from dtproperties where object...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
	 int
AS  from dtproperties where objectid=@id
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS  INNER JOIN
            XePhuKienChiTiet AS  ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 0) AND (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure dt_droppropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
	 int,
	 varchar(64)
AS  ( is null) or ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
	 int,
	 varchar(64)
AS  ( is null) or (@property = '')
		delete from dtproperties where objectid= else
		delete from dtproperties 
			where objectid= and property=@property
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure dt_adduserobject: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
AS 
		insert dtproperties (property) VAL...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
AS 
		insert dtproperties (property) VALUES ('DtgSchemaOBJECT')
		update dtproperties set objectid=@ where id=@ and property='DtgSchemaOBJECT'
	commit
	return @@identity
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVXuatKhac AS  INNER JOIN
			DVXuatKhacVatTu AS  ON A.ID = B.DVXuatKhacID INNER JOIN
			VatTu AS  ON B.VatTuID = V.ID INNER JOIN
			VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_XUATDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, A.SoLuong, A.DonGia, A.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS  INNER JOIN
            VatTu AS  ON A.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_XE_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
      nvarchar(20)
AS   Table (MaxID int, ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
      nvarchar(20)
AS   Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT Max(B.ID) AS , B.XeID
			FROM   XeBangGia AS  INNER JOIN
				   XeBangGiaChiTiet AS  ON A.ID = B.XeBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive =1)
			GROUP BY B.XeID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.XeID, C.SoKhung, C.SoMay, X.MaXe, X.TenXe, X.SortDoiXe, X.SortLoaiXe, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, c.GiaApThue
	FROM   XeBangGia AS  INNER JOIN
           XeBangGiaChiTiet AS  ON B.ID = C.XeBangGiaID INNER JOIN
            AS  ON C.ID = V.MaxID INNER JOIN
           Xe AS  ON C.XeID = X.ID	
	ORDER BY X.SortDoiXe
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
	  VARCHAR(10),	 
      VARCHAR(10)	 
AS...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
	  VARCHAR(10),	 
      VARCHAR(10)	 
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare  Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	
	FROM (
		
		SELECT	1 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	2 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	3 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	5 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	6 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  8 AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  9 AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)		
		UNION ALL
		
		SELECT	10 AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	11 AS , B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanLe AS  INNER JOIN
				DVBanLeVatTu AS  ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	12 AS , B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanSi AS  INNER JOIN
				DVBanSiVatTu AS  ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
	  VARCHAR(10),	 
      VARCHAR(10)	 
AS...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
	  VARCHAR(10),	 
      VARCHAR(10)	 
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare  Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanLe AS  INNER JOIN
				DVBanLeVatTu AS  ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS ,
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_TONDAU_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
      VARCHAR(10)
AS   VARCHA...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
      VARCHAR(10)
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'	

	SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	'N01' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N02' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N03' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N04' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNoiBo AS  INNER JOIN
				DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT	'N05' AS , A.KhoHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID)
		UNION ALL
		
		SELECT	'N06' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT  'N07' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNoiBo AS  INNER JOIN
                XeNoiBoPhuKien AS  ON A.ID = B.XeNoiBoID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT  'N08' AS , A.KhoHangXuatID AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON A.ID = B.XeBanLeID INNER JOIN
				Va
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
      int,
      nvarchar(10)
AS   Table ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
      int,
      nvarchar(10)
AS   Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert  Exec SP_VT_TONDAU_ALL @KhoHangID,  SELECT A.KhoHangID AS , A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, V.VatTuLoaiID, L.VatTuNhomID, A.TDSLNhap, A.TDSLXuat, (A.TDSLNhap - A.TDSLXuat) AS 
	FROM  AS  INNER JOIN
			VatTu AS  ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) < 0
	order by  A.VatTuID

	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_XE_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeNoiBo AS  INNER JOIN
			XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.IsXacNhan=1)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
      int,
      nvarchar(10)
AS   Table ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
      int,
      nvarchar(10)
AS   Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert  Exec SP_VT_TONDAU_ALL @KhoHangID,  SELECT A.KhoHangID AS , A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS 
	FROM  AS  INNER JOIN
			VatTu AS  ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_XE_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeNoiBo AS  INNER JOIN
			XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
      VARCHAR(10),	 
	  INT,...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
      VARCHAR(10),	 
	  INT,
	  VARCHAR(1),
	  INT
AS   VARCHAR(10), 
		 INT,  INT,  INT,  INT,  INT,  INT, 
		 INT,  INT,  INT,  INT,  INT,  INT
	SET @NgayBatDauSuDung = '2019-12-19'
	SET @DVBanLeID = 0 	
	SET @DVBanSiID = 0
	SET @DVNoiBoID = 0
	SET @DoiDonViID = 0
	SET @DVXuatKhacID = 0
	SET @XeBanLeKMID = 0
	SET @DVBanLeKMID = 0
	SET @XePhuKienID = 0
	SET @XePhuKienNoiBoID = 0
	SET @DVBanBuonID = 0
	SET @XeBanSiKMID = 0
	SET @XeBanLeBHID = 0

	IF(@MaTacNghiep ='I')			SET @DVBanLeID =  ELSE IF(@MaTacNghiep='J')		SET @DVBanSiID =  ELSE IF(@MaTacNghiep='K')		SET @DVNoiBoID =  ELSE IF(@MaTacNghiep='L')		SET @DoiDonViID =  ELSE IF(@MaTacNghiep='M')		SET @DVXuatKhacID =  ELSE IF(@MaTacNghiep='N')		SET @XeBanLeKMID =  ELSE IF(@MaTacNghiep='O')		SET @DVBanLeKMID =  ELSE IF(@MaTacNghiep='P')		SET @XePhuKienID =  ELSE IF(@MaTacNghiep='Q')		SET @XePhuKienNoiBoID =  ELSE IF(@MaTacNghiep='R')		SET @DVBanBuonID =  ELSE IF(@MaTacNghiep='S')		SET @XeBanSiKMID =  ELSE IF(@MaTacNghiep='T')		SET @XeBanLeBHID =  SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	'N01' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS , A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNoiBo AS  INNER JOIN
				DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS , A.KhoHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS  ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS  INNER JOIN
            DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
      INT,
      nvarchar(10),
	  INT,
	...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
      INT,
      nvarchar(10),
	  INT,
	  VARCHAR(1),
	  INT
AS   Table (KhoHangID INT, VatTuID INT, TDSLNhap INT, TDTienNhap FLOAT, TDSLXuat INT, TDTienXuat FLOAT)
	INSERT  Exec SP_VT_TONDAU @KhoHangID, @DenNgay, @VatTuID, @MaTacNghiep,  SELECT A.KhoHangID AS , A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS 
	FROM  AS  INNER JOIN
			VatTu AS  ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS  INNER JOIN
            DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.IsXacNhan = 1) AND (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_SELECT_GIAVON_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
	  VARCHAR(10),	 
      VARCHAR(10)	 
AS...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
	  VARCHAR(10),	 
      VARCHAR(10)	 
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare  Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , (1 - A.TyLeCK*0.01) * B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, 1 AS , C.GiaBanBH AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLeBaoHiem AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanLe AS  INNER JOIN
				DVBanLeVatTu AS  ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanSi AS  INNER JOIN
				DVBanSiVatTu AS  ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT < @TuNgay)
		UNION ALL
		
		SELECT  VatTuID, 0 AS , 0 AS , SoLuong AS , ThanhTien AS 
		FROM    DoiDonVi AS     
	
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_NHAPXUAT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  INT,
	  VARCHAR(10),	 
  ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  INT,
	  VARCHAR(10),	 
      VARCHAR(10)	 	 
AS  T.SoCT, T.NgayCT, T.NgayNXK, T.KhoHangNhapID, T.KhoHangXuatID, T.KhachHangID, T.VatTuID, T.SLNhap, T.SLXuat 
	FROM (
		
		SELECT	'N01' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , A.KhachHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , C.KhachHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
                DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
                DVBanLe AS  ON A.DVBanLeID = C.ID   
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , C.KhachHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
                DVBanSi AS  ON A.DVBanSiID = C.ID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, A.KhoHangXuatID, NULL AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNoiBo AS  INNER JOIN
				DVNoiBoVatTu AS  ON A.ID = B.DVNoiBoID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangID AS , NULL AS , NULL AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N06' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , NULL AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  'N07' AS , A.SoCT, A.NgayCT, A.NgayCT AS , A.KhoHangNhapID, NULL AS , NULL AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNoiBo AS  INNER JOIN
                XeNoiBoPhuKien AS  ON A.ID = B.XeNoiBoID
		WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)		
		UNION ALL
		
		SELECT  'N08' AS , B.SoCT, B.NgayCT, B.NgayCT AS , A.KhoHangXuatID AS , NULL AS , a.KhachHangID, C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_NHAPDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS  INNER JOIN
            DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS , B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS  INNER JOIN
            XeNoiBoPhuKien AS  ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
	  VARCHAR(10),	 
      VARCHAR(10),
	  ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
	  VARCHAR(10),	 
      VARCHAR(10),
	  int
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare  Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS , 0 AS , B.SoLuong AS , B.TienVon AS 
		FROM	DVBanLe AS  INNER JOIN
				DVBanLeVatTu AS  ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.Nga
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID AS , B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS  INNER JOIN
            XeNoiBoPhuKien AS  ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan = 1)
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_DELETE_DUPLICATE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
	  int,	 
      int	 
AS  DoiDonVi						...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
	  int,	 
      int	 
AS  DoiDonVi						set VATTUID =  WHERE VATTUID =  update DoiDonViChiTiet				set VATTUID =  WHERE VATTUID =  update DVBanLeVatTu					set VATTUID =  WHERE VATTUID =  update DVBanSiVatTu					set VATTUID =  WHERE VATTUID =  update DVNhapKhacVatTu				set VATTUID =  WHERE VATTUID =  update DVNhapMuaVatTu				set VATTUID =  WHERE VATTUID =  update DVNhapTraLaiBanLeChiTiet		set VATTUID =  WHERE VATTUID =  update DVNhapTraLaiBanSiChiTiet		set VATTUID =  WHERE VATTUID =  update DVNoiBoVatTu					set VATTUID =  WHERE VATTUID =  update DVXuatKhacVatTu				set VATTUID =  WHERE VATTUID =  update VTBangGiaChiTiet				set VATTUID =  WHERE VATTUID =  update XeBanLeKhuyenMai				set VATTUID =  WHERE VATTUID =  update XeBanLePhuKien				set VATTUID =  WHERE VATTUID =  update XeNhapTraLaiBanLeKhuyenMai	set VATTUID =  WHERE VATTUID =  update XeNhapTraLaiBanLePhuKien		set VATTUID =  WHERE VATTUID =  update XeNoiBoPhuKien				set VATTUID =  WHERE VATTUID =  update XePhuKienChiTiet				set VATTUID =  WHERE VATTUID =  Delete VatTu where (ID = @VatTuID_DEL)

END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XEBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS , B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, b.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeBanLe AS  INNER JOIN
            XeBanLePhuKien AS  ON A.ID = B.XeBanLeID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE   (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS  INNER JOIN
            XeBanLeKhuyenMai AS  ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure dt_verstamp007: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
AS  7005
//
DELIMITER' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
AS  7005
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_XUATKMBH_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS  INNER JOIN
            XeBanLeKhuyenMai AS  ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure dt_verstamp006: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
AS  7000
//
DELIMITER' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
AS  7000
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_XUATBAOHIEM_BHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, B.NgayXuat AS , A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, 1 AS , B.GiaBanBH, B.GiaBanBH AS , V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS  INNER JOIN
            XeBanLeBaoHiem AS  ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.ID, B.SoCT, C.NgayNhap AS , A.KhoHangXuatID AS , C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS  INNER JOIN
            XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS  ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS  ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_NHAPKHUYENMAI_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.ID, B.SoCT, B.NgayCT, A.KhoHangXuatID AS , C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS  INNER JOIN
            XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS  ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS  ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_XE_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS 
	FROM XeBanSi AS  INNER JOIN
			XeNhapTraLaiBanSi AS  ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS  ON B.ID = C.XeNhapTraLaiBanSiID
	WHERE (B.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.XeNhapMuaID IS NOT NULL)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_NHAPBAOHIEM_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.ID, B.SoCT, C.NgayNhap AS , A.KhoHangXuatID AS , C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, 1 AS , C.GiaBanBH AS , C.GiaBanBH AS , V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS  INNER JOIN
            XeNhapTraLaiBanLeBaoHiem AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS  ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS  ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanLe AS  INNER JOIN
            DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_TEST_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``   
AS  count(ID) BEGIN 'VT' from VatTu
END...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``   
AS  count(ID) BEGIN 'VT' from VatTu
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
      INT     
AS  * from VatTu where ID =...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
      INT     
AS  * from VatTu where ID =  END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_DV_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
      nvarchar(10),
	  nvarchar(2)
AS   T...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
      nvarchar(10),
	  nvarchar(2)
AS   Table (MaxID int, DichVuID int)
	Insert @V_DV_BangGia_MaxID(MaxID, DichVuID) 
			SELECT Max(B.ID) AS , B.DichVuID
			FROM   DVBangGia AS  INNER JOIN
				   DVBangGiaChiTiet AS  ON A.ID = B.DVBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.CuaHangID = @CuaHangID)
			GROUP BY B.DichVuID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.DichVuID, V.MaDichVu, V.HangMuc, C.DonGia
	FROM   DVBangGia AS  INNER JOIN
           DVBangGiaChiTiet AS  ON B.ID = C.DVBangGiaID INNER JOIN
            AS  ON C.ID = M.MaxID INNER JOIN
           DichVu AS  ON C.DichVuID = V.ID	
	ORDER BY V.MaDichVu
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS  INNER JOIN
            VatTu AS  ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanSi AS  INNER JOIN
            XeBanSiKhuyenMai AS  ON A.ID = B.XeBanSiID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE[SP_VT_BANGGIA]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE[SP_VT_BANGGIA]
                                 nvarchar(10),
	                             nvarchar(2)
                            AS   Table(MaxID int, VatTuID int)
                                Insert @V_VT_BangGia_MaxID(MaxID, VatTuID)
                                        SELECT Max(B.ID) AS , B.VatTuID
                                        FROM   VTBangGia AS  CROSS APPLY STRING_SPLIT(CuaHangID, ',') INNER JOIN
                                               VTBangGiaChiTiet AS  ON A.ID = B.VTBangGiaID
                                        WHERE(A.ApDungTu <= @DenNgay) AND(A.ApDungDen >= @DenNgay) AND (value = @CuaHangID)
                                        GROUP BY B.VatTuID

                                SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.VatTuLoaiID, L.VatTuNhomID, C.GiaNhap, C.GiaXuat
                                FROM   VTBangGia AS  INNER JOIN
                                       VTBangGiaChiTiet AS  ON B.ID = C.VTBangGiaID INNER JOIN
                                        AS  ON C.ID = M.MaxID INNER JOIN
                                       VatTu AS  ON C.VatTuID = V.ID INNER JOIN
                                       VatTuLoai AS  ON V.VatTuLoaiID = L.ID
                            END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_VT_NHAPKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapKhac AS  INNER JOIN
            DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``     
	  VARCHAR(10),
      VARCHAR(10)
A...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``     
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeBanSi AS  INNER JOIN
			XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay)		
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 1 AS 
	FROM XeBanSi AS  INNER JOIN
			XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_XE_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
      VARCHAR(10),
	  INT,
	...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
      VARCHAR(10),
	  INT,
	  INT,
	  INT,
	  INT
AS  T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS , SUM(T.SLXuat) AS 
	FROM (
		
		SELECT 'A' AS , KhoHangNhapID AS , XeID, ID AS , 1 AS , 0 AS  
		FROM XeNhapMua 
		WHERE (NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT 'B' AS , A.KhoHangNhapID AS , B.XeID, B.XeNhapMuaID, 1 AS , 0 AS 
		FROM XeNoiBo AS  INNER JOIN
				XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
		UNION ALL
		
		SELECT 'C' AS , A.KhoHangXuatID AS , A.XeID, A.XeNhapMuaID, 1 AS , 0 AS 
		FROM XeBanLe  AS  INNER JOIN
				XeNhapTraLaiBanLe  AS  ON A.ID = B.XeBanLeID    
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'D' AS , A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS , 0 AS 
		FROM XeBanSi AS  INNER JOIN
				XeNhapTraLaiBanSi AS  ON A.ID = B.XeBanSiID INNER JOIN
				XeNhapTraLaiBanSiChiTiet AS  ON B.ID = C.XeNhapTraLaiBanSiID
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
		UNION ALL
		
		SELECT 'E' AS , KhoHangXuatID AS , XeID, XeNhapMuaID, 0 AS , 1 AS 
		FROM XeBanLe     
		WHERE (NgayBan <= @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'F' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
		FROM XeBanSi AS  INNER JOIN
				XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeBanSiID)
		UNION ALL
		
		SELECT 'G' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
		FROM XeNoiBo AS  INNER JOIN
				XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeNoiBoID) 
		UNION ALL
		
		SELECT 'H' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
		FROM XeXuatKhac AS  INNER JOIN
				XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeXuatKhacID)
	) AS 
	GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID
END;


//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_XE_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
                                  int,
   ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
                                  int,
                                  nvarchar(10),
	                              INT,
	                              INT,
	                              INT,
	                              INT
                            AS   Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)
	                            Insert  Exec SP_XE_TONDAU @KhoHangID, @DenNgay, @XeBanLeID, @XeBanSiID, @XeNoiBoID,  SELECT A.KhoHangID, B.KhoHangNhapID, A.XeID, X.MaXe, X.TenXe, A.XeNhapMuaID, B.KhachHangID AS , B.DonGia_CoVAT, B.NgayCT, B.SoKhung, B.SoMay, B.MaChiaKhoa, (A.TDSLNhap - A.TDSLXuat) AS , B.GhiChu, B.MaChiaKhoa
	                            FROM  AS  INNER JOIN
			                            XeNhapMua AS  ON A.XeNhapMuaID = B.ID INNER JOIN
			                            Xe AS  ON A.XeID = X.ID 
	                            WHERE (A.TDSLNhap - A.TDSLXuat) <>0
                            END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_NHAPXUATTON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
      int,
	  nvarchar(10),
      nvarcha...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
      int,
	  nvarchar(10),
      nvarchar(10)
AS   Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)

	declare  int,  int,  int
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0

	Insert  Exec SP_XE_TONDAU @KhoHangID, @TuNgay, @XeBanLeID, @XeBanSiID,  SELECT NXT.* FROM (
		SELECT 'T' AS , KhoHangID, XeID, XeNhapMuaID, (TDSLNhap - TDSLXuat) AS 
		FROM  UNION ALL
		SELECT 'B' AS , A.KhoHangNhapID AS , B.XeID, B.XeNhapMuaID, 1 AS 
		FROM XeNoiBo AS  INNER JOIN
			 XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
		WHERE A.NgayCT <  AND KhoHangNhapID = @KhoHangID   
	) AS  
END;
//
DELIMITER ;)  
[2024-07-18 16:34:53] local.ERROR: Error creating stored procedure SP_XE_LICHSU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT
AS  'A' AS , ID, KhoHangNhapID,...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT
AS  'A' AS , ID, KhoHangNhapID, Null AS , XeID, ID AS , SoCT, NgayCT, NULL AS , CreatedBy, SoKhung, SoMay 
	FROM XeNhapMua 
	WHERE (ID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'B' AS , A.ID, A.KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, NULL AS , A.CreatedBy, M.SoKhung, M.SoMay 
	FROM XeNoiBo AS  INNER JOIN
			XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID INNER JOIN
			XeNhapMua AS  ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'C' AS , B.ID, A.KhoHangXuatID AS , null AS , A.XeID, A.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS , B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe  AS  INNER JOIN
			XeNhapTraLaiBanLe  AS  ON A.ID = B.XeBanLeID INNER JOIN
			XeNhapMua AS  ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'D' AS , B.ID, A.KhoHangXuatID AS , null AS , C.XeID, C.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS , B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS  INNER JOIN
			XeNhapTraLaiBanSi AS  ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS  ON B.ID = C.XeNhapTraLaiBanSiID INNER JOIN
			XeNhapMua AS  ON C.XeNhapMuaID = M.ID
	WHERE (C.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'E' AS , A.ID, Null AS , A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe AS  INNER JOIN
			XeNhapMua AS  ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'F' AS , A.ID, Null AS , A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS , A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS  INNER JOIN
			XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapMua AS  ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'G' AS , A.ID, Null AS , A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS , A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeXuatKhac AS  INNER JOIN
			XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID INNER JOIN
			XeNhapMua AS  ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	
	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``     
	  VARCHAR(10),
      VARCHAR(10)
A...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``     
	  VARCHAR(10),
      VARCHAR(10)
AS  KhoHangXuatID AS , XeID, XeNhapMuaID, 1 AS 
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN  AND @DenNgay) AND (XeNhapMuaID IS NOT NULL)
END;
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  KhoHangXuatID AS , XeID, XeNhapMuaID, 1 AS 
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN  AND @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (XeNhapMuaID IS NOT NULL)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_XE_TONKHO_BY_XEID: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``     
      VARCHAR(10),
	  INT,
	  INT,...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``     
      VARCHAR(10),
	  INT,
	  INT,
	  INT,
	  VARCHAR(20)
AS   INT,	 INT,  INT,  INT
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0
	SET @XeXuatKhacID = 0

	if(@LoaiPhieu = 1)
		SET @XeBanLeID =  else if(@LoaiPhieu = 2)
		SET @XeBanSiID =  else if(@LoaiPhieu = 3)
		SET @XeNoiBoID =  else if(@LoaiPhieu = 4)
		SET @XeXuatKhacID =  Declare  Table (KhoHangID int, XeID int, XeNhapMuaID int, SLNhap int, SLXuat int)

	Insert  SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS , SUM(T.SLXuat) AS 
		FROM (
			
			SELECT 'A' AS , KhoHangNhapID AS , XeID, ID AS , 1 AS , 0 AS  
			FROM XeNhapMua 
			WHERE (NgayCT <= @DenNgay) AND (XeID = @XeID)
			UNION ALL
			
			SELECT 'B' AS , A.KhoHangNhapID AS , B.XeID, B.XeNhapMuaID, 1 AS , 0 AS 
			FROM XeNoiBo AS  INNER JOIN
					XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.IsXacNhan=1)
			UNION ALL
			
			SELECT 'C' AS , A.KhoHangXuatID AS , A.XeID, A.XeNhapMuaID, 1 AS , 0 AS 
			FROM XeBanLe  AS  INNER JOIN
					XeNhapTraLaiBanLe  AS  ON A.ID = B.XeBanLeID    
			WHERE (B.NgayCT <= @DenNgay) AND (A.XeID = @XeID) AND (A.XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'D' AS , A.KhoHangXuatID AS , C.XeID, C.XeNhapMuaID, 1 AS , 0 AS 
			FROM XeBanSi AS  INNER JOIN
					XeNhapTraLaiBanSi AS  ON A.ID = B.XeBanSiID INNER JOIN
					XeNhapTraLaiBanSiChiTiet AS  ON B.ID = C.XeNhapTraLaiBanSiID
			WHERE (B.NgayCT <= @DenNgay) AND (C.XeID = @XeID)
			UNION ALL
			
			SELECT 'E' AS , KhoHangXuatID AS , XeID, XeNhapMuaID, 0 AS , 1 AS 
			FROM XeBanLe     
			WHERE (NgayBan <= @DenNgay) AND (XeID = @XeID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'F' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
			FROM XeBanSi AS  INNER JOIN
					XeBanSiChiTiet AS  ON A.ID = B.XeBanSiID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeBanSiID)
			UNION ALL
			
			SELECT 'G' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
			FROM XeNoiBo AS  INNER JOIN
					XeNoiBoChiTiet AS  ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeNoiBoID) 
			UNION ALL
			
			SELECT 'F' AS , A.KhoHangXuatID AS , B.XeID, B.XeNhapMuaID, 0 AS , 1 AS 
			FROM XeXuatKhac AS  INNER JOIN
					XeXuatKhacChiTiet AS  ON A.ID = B.XeXuatKhacID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeXuatKhacID)
		) AS 
		GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID

		if(LEN(@SoMay)>0)
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS ,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM  AS  INNER JOIN
					XeNhapMua AS  ON A.XeNhapMuaID = B.ID INNER JOIN
					Xe AS  ON A.XeID = X.ID INNER JOIN 
					KhoHang AS  ON A.KhoHangID = K.ID 
			WHERE SLNhap-SLXuat<>0 AND (B.SoMay Like N'%' + @SoMay)
		else
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS ,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM  AS  INNER JOIN
					XeNh
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_XE_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, 1 AS 
	FROM XeBanLe  AS  INNER JOIN
			XeNhapTraLaiBanLe  AS  ON A.ID = B.XeBanLeID    
	WHERE (B.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
END;
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, SUM(B.SoLuong) AS , SUM(B.ThanhTien) AS , V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS  INNER JOIN
            DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
END;
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS  INNER JOIN
            DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
END;
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_VT_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanSi AS  INNER JOIN
            DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_VT_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanSi AS  INNER JOIN
            DVBanSiVatTu AS  ON A.ID = B.DVBanSiID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure uspGetChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc [uspGetChiTien1]
 int
AS         ChiTien.I...' at line 1 (SQL: DELIMITER //
CREATE         proc [uspGetChiTien1]
 int
AS         ChiTien.ID, KhachHang.TenKhachHang, ChiTienLyDo.TenLyDo, ChiTien.SoTien, TaiKhoan.TenTaiKhoan, ChiTien.GhiChu, ChiTien.CuaHangID, ChiTien.CreatedBy, 
                         ChiTien.CreatedAt, ChiTien.UpdatedBy, ChiTien.UpdatedAt
FROM            ChiTien INNER JOIN
                         KhachHang ON ChiTien.KhachHangID = KhachHang.ID INNER JOIN
                         ChiTienLyDo ON ChiTien.ChiTienLyDoID = ChiTienLyDo.ID INNER JOIN
                         TaiKhoan ON ChiTien.TaiKhoanID = TaiKhoan.ID
WHERE ChiTien.ID= @ID
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure uspChiTien2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
create         proc [uspChiTien2]
 int,
 int,
 int
AS  ChiTi...' at line 1 (SQL: DELIMITER //
create         proc [uspChiTien2]
 int,
 int,
 int
AS  ChiTien SET [Status2] = @Status, Approval2By = @ApprovalBy, Approval2At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_XE_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS  KhoHangNhapID, XeID, ID AS , 1 AS  
	FROM XeNhapMua 
	WHERE (NgayCT BETWEEN  AND @DenNgay) AND (KhoHangNhapID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure uspChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc [uspChiTien1]
 int,
 int,
 int
AS  ChiTi...' at line 1 (SQL: DELIMITER //
CREATE         proc [uspChiTien1]
 int,
 int,
 int
AS  ChiTien SET [Status1] = @Status, Approval1By = @ApprovalBy, Approval1At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, SUM(B.SoLuong) AS , SUM(B.ThanhTien) AS , V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS  INNER JOIN
            DVBanLeVatTu AS  ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
END;
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure upsChiTienPowerApps: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
AS   VARCHAR(10),  VARCHAR(10)

	set @TuN...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
AS   VARCHAR(10),  VARCHAR(10)

	set @TuNgay = CONVERT(VARCHAR(10), DATEADD(DAY, -30, NOW()), 101)
	set @DenNgay = CONVERT(VARCHAR(10), NOW(), 101)

	SELECT * FROM ChiTien WHERE NgayCT between  and  END;
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON_KHOHANG: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //



CREATE PROCEDURE ``
	  VARCHAR(10),	 
      VARCHAR(10),...' at line 1 (SQL: DELIMITER //



CREATE PROCEDURE ``
	  VARCHAR(10),	 
      VARCHAR(10),
	  int,
	  int
AS   VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	Declare  Table (KhoHangID int, VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert  SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS , SUM(T.TienNhap) AS , SUM(T.SLXuat) AS , SUM(T.TienXuat) AS  
	FROM (
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapMua AS  INNER JOIN
				DVNhapMuaVatTu AS  ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanLe AS  INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS  ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanSi AS  INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS  ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangID, B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DoiDonVi AS  INNER JOIN
				DoiDonViChiTiet AS  ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapKhac AS  INNER JOIN
				DVNhapKhacVatTu AS  ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
                XeNhapTraLaiBanLePhuKien AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS , C.VatTuID, C.SoLuong AS , C.ThanhTien AS , 0 AS , 0 AS 
		FROM    XeNhapTraLaiBanLe AS  INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS  ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
				XeBanLe AS  ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS , B.VatTuID, B.SoLuong AS , B.ThanhTien AS , 0 AS , 0 AS 
		FROM	DVNhapTraLaiBanBuon AS  INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		
		
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.SoPhieu, A.KhoHangXuatID, A.KhachHangID, B.NgayXuat, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS  INNER JOIN
            DVBanLeVatTu AS  ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN  AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure spCheckPhieuChi: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
(
		 varchar(10)
)
	AS 	* from ChiTien
...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
(
		 varchar(10)
)
	AS 	* from ChiTien
				where	KhoHangID =  END;
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_FIX_SLVT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
AS   Table (DVBanLeID int, SoLuongVT float)...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
AS   Table (DVBanLeID int, SoLuongVT float)

	Insert @Tb_SLVT(DVBanLeID, SoLuongVT) 
	select DVBanLeID, Sum(SoLuong) AS  from DVBanLeVatTu group by DVBanLeID
	
	UPDATE DVBanLe 
    SET DVBanLe.TongSoLuongVatTu = B.SoLuongVT            
	FROM DVBanLe INNER JOIN  AS  ON DVBanLe.ID = B.DVBanLeID 
	where B.SoLuongVT is not null
	
 
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_TC_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE ``
                                  INT,
   ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE ``
                                  INT,
                                  VARCHAR(10),
	                              VARCHAR(10)	 
                            AS  T.TaiKhoanID, T.TacNghiep, SUM(T.SoTien) AS 
	                            FROM (
		                            
		                            SELECT 1 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM XeBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 2 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM XeBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 3 AS , TaiKhoanID, SUM(GiaNhap) AS , 1 AS 
		                            FROM XeSonXe 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 4 AS , TaiKhoanID, SUM(SoTien) AS , 0 AS 
		                            FROM ThuTien 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 5 AS , TaiKhoanID, SUM(SoTien) AS , 1 AS 
		                            FROM ChiTien 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 6 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM DVBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 7 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM DVBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 8 AS , TaiKhoanID, SUM(SoTien) AS , TacNghiep 
		                            FROM DVBanBuonThanhToan 
		                            WHERE (NgayCT BETWEEN  AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 9 AS , T.TaiKhoanID, SUM(G.ChiPhi) AS , 1 AS  
                                    FROM DVBanLe AS  INNER JOIN 
                                        KhoHang AS  ON A.KhoHangXuatID = K.ID INNER JOIN 
	
//
DELIMITER ;)  
[2024-07-18 16:34:54] local.ERROR: Error creating stored procedure SP_VT_NHAPTRABUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE ``
      INT,
	  VARCHAR(10),
      VARCHAR(10)
AS   A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS , V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanBuon AS  INNER JOIN
            DVNhapTraLaiBanBuonChiTiet AS  ON A.ID = B.DVNhapTraLaiBanbuonID INNER JOIN
            VatTu AS  ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS  ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN  AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATBANBUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANBUON]
     IN KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANBUON]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanBuon BEGIN A INNER JOIN
            DVBanBuonVatTu BEGIN B ON A.ID = B.DVBanBuonID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC_TONGHOP]     
	 IN TuNgay V...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC_TONGHOP]     
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeXuatKhac BEGIN A INNER JOIN
			XeXuatKhacChiTiet BEGIN B ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay)		
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATKHAC]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeXuatKhac BEGIN A INNER JOIN
			XeXuatKhacChiTiet BEGIN B ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_BANGGIA2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_BANGGIA2]
     IN DenNgay nvarchar(2...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_BANGGIA2]
     IN DenNgay nvarchar(20),
	 IN XeNhapMuaID int,
	 IN TenType nvarchar(50)
BEGIN
    
	Declare IN TenModel nvarchar(30)

	
	SELECT		@TenModel = X.TenModel FROM XeNhapMua BEGIN M INNER JOIN Xe BEGIN X ON M.XeID = X.ID INNER JOIN V_XeThayVanh BEGIN TV ON M.ID = TV.XeNhapMuaID 
	WHERE		TV.XeNhapMuaID = IN XeNhapMuaID GROUP BY	X.TenModel	

	
	Declare IN V_Xe_BangGia_MaxID Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT  MAX(B.ID) BEGIN MaxID, B.XeID
			FROM    XeBangGia BEGIN A INNER JOIN
                    XeBangGiaChiTiet BEGIN B ON A.ID = B.XeBangGiaID INNER JOIN
                    Xe BEGIN X ON B.XeID = X.ID
			WHERE   (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive = 1) AND (X.TenModel = @TenModel) AND (X.TenType = @TenType)
			GROUP BY B.XeID, X.TenModel, X.TenType

	
	SELECT TOP (1) X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	FROM   XeBangGia BEGIN B INNER JOIN
           XeBangGiaChiTiet BEGIN C ON B.ID = C.XeBangGiaID INNER JOIN
           IN V_Xe_BangGia_MaxID BEGIN V ON C.ID = V.MaxID INNER JOIN
           Xe BEGIN X ON C.XeID = X.ID	
	GROUP BY X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	ORDER BY C.GiaHaiQuan DESC
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATKMDV: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMDV]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMDV]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID BEGIN KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai BEGIN L INNER JOIN
            VatTu BEGIN V ON L.ID = V.VatTuLoaiID INNER JOIN
            DVBanLe BEGIN A INNER JOIN
            DVBanLeKhuyenMai BEGIN B ON A.ID = B.DVBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure dt_setpropertybyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_setpropertybyid]
	IN id int,
	IN prop...' at line 1 (SQL: DELIMITER //

create   procedure [dt_setpropertybyid]
	IN id int,
	IN property varchar(64),
	IN value varchar(255),
	IN lvalue image
BEGIN
	
	declare IN uvalue nvarchar(255) 
	set @uvalue = convert(nvarchar(255), @value) 
	if exists (select * from dtproperties 
			where objectid=IN id and property=@property)
	begin
		
		
		
		update dtproperties set value=@value, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=IN id and property=IN property END;
	else
	begin
		
		
		
		insert dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @value, @uvalue, @lvalue)
	END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure dt_getpropertiesbyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getpropertiesbyid_u]
	IN id int,
	IN ...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getpropertiesbyid_u]
	IN id int,
	IN property varchar(64)
BEGIN
	

	if (IN property is null) or (@property = '')
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure dt_getpropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getpropertiesbyid]
	IN id int,
	IN pr...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getpropertiesbyid]
	IN id int,
	IN property varchar(64)
BEGIN
	

	if (IN property is null) or (@property = '')
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure dt_getobjwithprop_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getobjwithprop_u]
	IN property varchar...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getobjwithprop_u]
	IN property varchar(30),
	IN uvalue nvarchar(255)
BEGIN
	

	if (IN property is null) or (@property = '')
	begin
		raiserror('Must specify a property name.',-1,-1)
		return (1)
	END;

	if (IN uvalue is null)
		select objectid id from dtproperties
			where property=IN property else
		select objectid id from dtproperties
			where property=IN property and uvalue=@uvalue
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure dt_getobjwithprop: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_getobjwithprop]
	IN property varchar(3...' at line 1 (SQL: DELIMITER //

create   procedure [dt_getobjwithprop]
	IN property varchar(30),
	IN value varchar(255)
BEGIN
	

	if (IN property is null) or (@property = '')
	begin
		raiserror('Must specify a property name.',-1,-1)
		return (1)
	END;

	if (IN value is null)
		select objectid id from dtproperties
			where property=IN property else
		select objectid id from dtproperties
			where property=IN property and value=@value
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure dt_generateansiname: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
 
CREATE PROCEDURE `dt_generateansiname` (IN name varchar(255) ...' at line 1 (SQL: DELIMITER //
 
CREATE PROCEDURE `dt_generateansiname` (IN name varchar(255) output) BEGIN declare IN prologue varchar(20) 
	declare IN indexstring varchar(20) 
	declare IN index integer 
 
	set @prologue = 'MSDT-A-' 
	set @index = 1 
 
	while 1 = 1 
	begin 
		set @indexstring = cast(IN index BEGIN varchar(20)) 
		set @name = @prologue + IN indexstring if not exists (select value from dtproperties where value = @name) 
			break 
		 
		set @index = @index + 1 
 
		if (@index = 10000) 
			goto TooMany 
	 END; 
 
Leave: 
 
	return 
 
TooMany: 
 
	set @name = 'DIAGRAM' 
	goto Leave
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure dt_setpropertybyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_setpropertybyid_u]
	IN id int,
	IN pr...' at line 1 (SQL: DELIMITER //

create   procedure [dt_setpropertybyid_u]
	IN id int,
	IN property varchar(64),
	IN uvalue nvarchar(255),
	IN lvalue image
BEGIN
	
	
	
	
	
	declare IN avalue varchar(255) 
	set @avalue = null 
	if (IN uvalue is not null) 
	begin 
		if (convert(nvarchar(255), convert(varchar(255), @uvalue)) = @uvalue) 
		begin 
			set @avalue = convert(varchar(255), @uvalue) 
		END; 
		else 
		begin 
			if 'DtgSchemaNAME' = IN property begin 
				exec dt_generateansiname IN avalue output 
			END; 
		END; 
	END; 
	if exists (select * from dtproperties 
			where objectid=IN id and property=@property)
	begin
		
		
		
		update dtproperties set value=@avalue, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=IN id and property=IN property END;
	else
	begin
		
		
		
		insert dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @avalue, @uvalue, @lvalue)
	END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_Old]
     IN KhoHangID I...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_Old]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien BEGIN A INNER JOIN
            XePhuKienChiTiet BEGIN B ON A.ID = B.XePhuKienID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 1) AND (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure dt_dropuserobjectbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_dropuserobjectbyid]
	IN id int
BEGIN...' at line 1 (SQL: DELIMITER //

create   procedure [dt_dropuserobjectbyid]
	IN id int
BEGIN
	
	delete from dtproperties where objectid=@id
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN]
     IN KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien BEGIN A INNER JOIN
            XePhuKienChiTiet BEGIN B ON A.ID = B.XePhuKienID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 0) AND (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure dt_droppropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_droppropertiesbyid]
	IN id int,
	IN p...' at line 1 (SQL: DELIMITER //

create   procedure [dt_droppropertiesbyid]
	IN id int,
	IN property varchar(64)
BEGIN
	

	if (IN property is null) or (@property = '')
		delete from dtproperties where objectid=IN id else
		delete from dtproperties 
			where objectid=IN id and property=@property
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure dt_adduserobject: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_adduserobject]
BEGIN transaction
		in...' at line 1 (SQL: DELIMITER //

create   procedure [dt_adduserobject]
BEGIN transaction
		insert dtproperties (property) VALUES ('DtgSchemaOBJECT')
		update dtproperties set objectid=@IN identity where id=@IN identity and property='DtgSchemaOBJECT'
	commit
	return @@identity
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKHAC]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKHAC]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVXuatKhac BEGIN A INNER JOIN
			DVXuatKhacVatTu BEGIN B ON A.ID = B.DVXuatKhacID INNER JOIN
			VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
			VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATDOIDONVI]
     IN KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATDOIDONVI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, A.SoLuong, A.DonGia, A.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi BEGIN A INNER JOIN
            VatTu BEGIN V ON A.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_BANGGIA]
     IN DenNgay nvarchar(20)...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_BANGGIA]
     IN DenNgay nvarchar(20)
BEGIN
    
	Declare IN V_Xe_BangGia_MaxID Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT Max(B.ID) BEGIN MaxID, B.XeID
			FROM   XeBangGia BEGIN A INNER JOIN
				   XeBangGiaChiTiet BEGIN B ON A.ID = B.XeBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive =1)
			GROUP BY B.XeID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.XeID, C.SoKhung, C.SoMay, X.MaXe, X.TenXe, X.SortDoiXe, X.SortLoaiXe, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, c.GiaApThue
	FROM   XeBangGia BEGIN B INNER JOIN
           XeBangGiaChiTiet BEGIN C ON B.ID = C.XeBangGiaID INNER JOIN
           IN V_Xe_BangGia_MaxID BEGIN V ON C.ID = V.MaxID INNER JOIN
           Xe BEGIN X ON C.XeID = X.ID	
	ORDER BY X.SortDoiXe
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON2]
	 IN TuNgay VARCHAR(...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON2]
	 IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 
BEGIN

	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) BEGIN SLNhap, SUM(T.TienNhap) BEGIN TienNhap, SUM(T.SLXuat) BEGIN SLXuat, SUM(T.TienXuat) BEGIN TienXuat 
	
	FROM (
		
		SELECT	1 BEGIN a, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	2 BEGIN a, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
				DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	3 BEGIN a, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	5 BEGIN a, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	6 BEGIN a, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapKhac BEGIN A INNER JOIN
				DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  8 BEGIN a, C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
                XeNhapTraLaiBanLePhuKien BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe BEGIN A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  9 BEGIN a, C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)		
		UNION ALL
		
		SELECT	10 BEGIN a, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanBuon BEGIN A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	11 BEGIN a, B.VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, B.SoLuong BEGIN SLXuat, B.TienVon BEGIN TienXuat
		FROM	DVBanLe BEGIN A INNER JOIN
				DVBanLeVatTu BEGIN B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	12 BEGIN a, B.VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, B.SoLuong BEGIN SLXuat, B.TienVon BEGIN TienXuat
		FROM	DVBanSi BEGIN A INNER JOIN
				DVBanSiVatTu BEGIN B ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON]
	 IN TuNgay VARCHAR(1...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_UPDATE_GIAVON]
	 IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 
BEGIN

	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) BEGIN SLNhap, SUM(T.TienNhap) BEGIN TienNhap, SUM(T.SLXuat) BEGIN SLXuat, SUM(T.TienXuat) BEGIN TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
				DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapKhac BEGIN A INNER JOIN
				DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
                XeNhapTraLaiBanLePhuKien BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe BEGIN A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanBuon BEGIN A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, B.SoLuong BEGIN SLXuat, B.TienVon BEGIN TienXuat
		FROM	DVBanLe BEGIN A INNER JOIN
				DVBanLeVatTu BEGIN B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, B.SoLuong BEGIN SLXuat,
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_TONDAU_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU_ALL]
     IN KhoHangID INT,
...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU_ALL]
     IN KhoHangID INT,
     IN DenNgay VARCHAR(10)
BEGIN

	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'	

	SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) BEGIN TDSLNhap, SUM(T.TienNhap) BEGIN TDTienNhap, SUM(T.SLXuat) BEGIN TDSLXuat, SUM(T.TienXuat) BEGIN TDTienXuat 
	FROM (
		
		SELECT	'N01' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N02' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
				DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N03' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N04' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNoiBo BEGIN A INNER JOIN
				DVNoiBoVatTu BEGIN B ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT	'N05' BEGIN MaTN, A.KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID)
		UNION ALL
		
		SELECT	'N06' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapKhac BEGIN A INNER JOIN
				DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT  'N07' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNoiBo BEGIN A INNER JOIN
                XeNoiBoPhuKien BEGIN B ON A.ID = B.XeNoiBoID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT  'N08' BEGIN MaTN, A.KhoHangXuatID BEGIN KhoHangID, C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
                XeNhapTraLaiBanLePhuKien BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe BEGIN A ON A.ID = B.XeBanLeID INNER JOIN
				Va
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO_ALL_TEST]
     IN KhoHangID in...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO_ALL_TEST]
     IN KhoHangID int,
     IN DenNgay nvarchar(10)
BEGIN
    
	Declare IN Tb_VTTonDau Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert IN Tb_VTTonDau Exec SP_VT_TONDAU_ALL @KhoHangID, IN DenNgay SELECT A.KhoHangID BEGIN KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, A.TDSLNhap, A.TDSLXuat, (A.TDSLNhap - A.TDSLXuat) BEGIN SoLuongTon
	FROM IN Tb_VTTonDau BEGIN A INNER JOIN
			VatTu BEGIN V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) < 0
	order by  A.VatTuID

	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_XUATNOIBO]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_XUATNOIBO]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeNoiBo BEGIN A INNER JOIN
			XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.IsXacNhan=1)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_VT_TONKHO_ALL]
     IN KhoHangID int,
 ...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_VT_TONKHO_ALL]
     IN KhoHangID int,
     IN DenNgay nvarchar(10)
BEGIN
    
	Declare IN Tb_VTTonDau Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert IN Tb_VTTonDau Exec SP_VT_TONDAU_ALL @KhoHangID, IN DenNgay SELECT A.KhoHangID BEGIN KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) BEGIN SoLuongTon
	FROM IN Tb_VTTonDau BEGIN A INNER JOIN
			VatTu BEGIN V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPNOIBO]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPNOIBO]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeNoiBo BEGIN A INNER JOIN
			XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU]
     IN KhoHangID INT,
    ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_TONDAU]
     IN KhoHangID INT,
     IN DenNgay VARCHAR(10),	 
	 IN VatTuID INT,
	 IN MaTacNghiep VARCHAR(1),
	 IN IDTacNghiep INT
BEGIN
	
	DECLARE IN NgayBatDauSuDung VARCHAR(10), 
		IN DVBanLeID INT, IN DVBanSiID INT, IN DVNoiBoID INT, IN DoiDonViID INT, IN DVXuatKhacID INT, IN XeBanLeKMID INT, 
		IN DVBanLeKMID INT, IN XePhuKienID INT, IN XePhuKienNoiBoID INT, IN DVBanBuonID INT, IN XeBanSiKMID INT, IN XeBanLeBHID INT
	SET @NgayBatDauSuDung = '2019-12-19'
	SET @DVBanLeID = 0 	
	SET @DVBanSiID = 0
	SET @DVNoiBoID = 0
	SET @DoiDonViID = 0
	SET @DVXuatKhacID = 0
	SET @XeBanLeKMID = 0
	SET @DVBanLeKMID = 0
	SET @XePhuKienID = 0
	SET @XePhuKienNoiBoID = 0
	SET @DVBanBuonID = 0
	SET @XeBanSiKMID = 0
	SET @XeBanLeBHID = 0

	IF(@MaTacNghiep ='I')			SET @DVBanLeID = IN IDTacNghiep ELSE IF(@MaTacNghiep='J')		SET @DVBanSiID = IN IDTacNghiep ELSE IF(@MaTacNghiep='K')		SET @DVNoiBoID = IN IDTacNghiep ELSE IF(@MaTacNghiep='L')		SET @DoiDonViID = IN IDTacNghiep ELSE IF(@MaTacNghiep='M')		SET @DVXuatKhacID = IN IDTacNghiep ELSE IF(@MaTacNghiep='N')		SET @XeBanLeKMID = IN IDTacNghiep ELSE IF(@MaTacNghiep='O')		SET @DVBanLeKMID = IN IDTacNghiep ELSE IF(@MaTacNghiep='P')		SET @XePhuKienID = IN IDTacNghiep ELSE IF(@MaTacNghiep='Q')		SET @XePhuKienNoiBoID = IN IDTacNghiep ELSE IF(@MaTacNghiep='R')		SET @DVBanBuonID = IN IDTacNghiep ELSE IF(@MaTacNghiep='S')		SET @XeBanSiKMID = IN IDTacNghiep ELSE IF(@MaTacNghiep='T')		SET @XeBanLeBHID = IN IDTacNghiep SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) BEGIN TDSLNhap, SUM(T.TienNhap) BEGIN TDTienNhap, SUM(T.SLXuat) BEGIN TDSLXuat, SUM(T.TienXuat) BEGIN TDTienXuat 
	FROM (
		
		SELECT	'N01' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
				DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' BEGIN MaTN, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNoiBo BEGIN A INNER JOIN
				DVNoiBoVatTu BEGIN B ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' BEGIN MaTN, A.KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID INNER JOIN
				VatTu BEGIN V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATNOIBO]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATNOIBO]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo BEGIN A INNER JOIN
            DVNoiBoVatTu BEGIN B ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO]
     IN KhoHangID INT,
     ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_VT_TONKHO]
     IN KhoHangID INT,
     IN DenNgay nvarchar(10),
	 IN VatTuID INT,
	 IN MaTacNghiep VARCHAR(1),
	 IN IDTacNghiep INT
BEGIN
	    
	DECLARE IN Tb_VTTonDau Table (KhoHangID INT, VatTuID INT, TDSLNhap INT, TDTienNhap FLOAT, TDSLXuat INT, TDTienXuat FLOAT)
	INSERT IN Tb_VTTonDau Exec SP_VT_TONDAU @KhoHangID, @DenNgay, @VatTuID, @MaTacNghiep, IN IDTacNghiep SELECT A.KhoHangID BEGIN KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) BEGIN SoLuongTon
	FROM IN Tb_VTTonDau BEGIN A INNER JOIN
			VatTu BEGIN V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPNOIBO]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPNOIBO]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo BEGIN A INNER JOIN
            DVNoiBoVatTu BEGIN B ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.IsXacNhan = 1) AND (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_SELECT_GIAVON_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_SELECT_GIAVON_TEST]
	 IN TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_SELECT_GIAVON_TEST]
	 IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 
BEGIN

	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) BEGIN SLNhap, SUM(T.TienNhap) BEGIN TienNhap, SUM(T.SLXuat) BEGIN SLXuat, SUM(T.TienXuat) BEGIN TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
				DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, (1 - A.TyLeCK*0.01) * B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapKhac BEGIN A INNER JOIN
				DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
                XeNhapTraLaiBanLePhuKien BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe BEGIN A ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanBuon BEGIN A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, 1 BEGIN SLNhap, C.GiaBanBH BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
                XeNhapTraLaiBanLeBaoHiem BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe BEGIN A ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, B.SoLuong BEGIN SLXuat, B.TienVon BEGIN TienXuat
		FROM	DVBanLe BEGIN A INNER JOIN
				DVBanLeVatTu BEGIN B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, B.SoLuong BEGIN SLXuat, B.TienVon BEGIN TienXuat
		FROM	DVBanSi BEGIN A INNER JOIN
				DVBanSiVatTu BEGIN B ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT < @TuNgay)
		UNION ALL
		
		SELECT  VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, SoLuong BEGIN SLXuat, ThanhTien BEGIN TienXuat
		FROM    DoiDonVi BEGIN A    
	
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_NHAPXUAT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPXUAT]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPXUAT]
     IN KhoHangID INT,
	 IN VatTuID INT,
	 IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 	 
BEGIN
	
	SELECT T.SoCT, T.NgayCT, T.NgayNXK, T.KhoHangNhapID, T.KhoHangXuatID, T.KhachHangID, T.VatTuID, T.SLNhap, T.SLXuat 
	FROM (
		
		SELECT	'N01' BEGIN MaTN, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayNXK, A.KhoHangNhapID, NULL BEGIN KhoHangXuatID, A.KhachHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' BEGIN MaTN, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayNXK, A.KhoHangNhapID, NULL BEGIN KhoHangXuatID, C.KhachHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
                DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
                DVBanLe BEGIN C ON A.DVBanLeID = C.ID   
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' BEGIN MaTN, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayNXK, A.KhoHangNhapID, NULL BEGIN KhoHangXuatID, C.KhachHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
                DVBanSi BEGIN C ON A.DVBanSiID = C.ID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' BEGIN MaTN, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayNXK, A.KhoHangNhapID, A.KhoHangXuatID, NULL BEGIN KhachHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNoiBo BEGIN A INNER JOIN
				DVNoiBoVatTu BEGIN B ON A.ID = B.DVNoiBoID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' BEGIN MaTN, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayNXK, A.KhoHangID BEGIN KhoHangNhapID, NULL BEGIN KhoHangXuatID, NULL BEGIN KhachHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N06' BEGIN MaTN, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayNXK, A.KhoHangNhapID, NULL BEGIN KhoHangXuatID, NULL BEGIN KhachHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapKhac BEGIN A INNER JOIN
				DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  'N07' BEGIN MaTN, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayNXK, A.KhoHangNhapID, NULL BEGIN KhoHangXuatID, NULL BEGIN KhachHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNoiBo BEGIN A INNER JOIN
                XeNoiBoPhuKien BEGIN B ON A.ID = B.XeNoiBoID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)		
		UNION ALL
		
		SELECT  'N08' BEGIN MaTN, B.SoCT, B.NgayCT, B.NgayCT BEGIN NgayNXK, A.KhoHangXuatID BEGIN KhoHangNhapID, NULL BEGIN KhoHangXuatID, a.KhachHangID, C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_NHAPDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPDOIDONVI]
     IN KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPDOIDONVI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi BEGIN A INNER JOIN
            DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XECHUYENKHO]
     IN Kho...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XECHUYENKHO]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID BEGIN KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo BEGIN A INNER JOIN
            XeNoiBoPhuKien BEGIN B ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_GET_GIAVON]
	 IN TuNgay VARCHAR(10),...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_GET_GIAVON]
	 IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10),
	 IN VatTuID int
BEGIN

	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) BEGIN SLNhap, SUM(T.TienNhap) BEGIN TienNhap, SUM(T.SLXuat) BEGIN SLXuat, SUM(T.TienXuat) BEGIN TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
				DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapKhac BEGIN A INNER JOIN
				DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
                XeNhapTraLaiBanLePhuKien BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe BEGIN A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanBuon BEGIN A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 BEGIN SLNhap, 0 BEGIN TienNhap, B.SoLuong BEGIN SLXuat, B.TienVon BEGIN TienXuat
		FROM	DVBanLe BEGIN A INNER JOIN
				DVBanLeVatTu BEGIN B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.Nga
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_XECHUYENKHO]
     IN Kho...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_XECHUYENKHO]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo BEGIN A INNER JOIN
            XeNoiBoPhuKien BEGIN B ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan = 1)
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_DELETE_DUPLICATE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_DELETE_DUPLICATE]
	 IN VatTuID_DEL i...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_DELETE_DUPLICATE]
	 IN VatTuID_DEL int,	 
     IN VatTuID int	 
BEGIN

	update DoiDonVi						set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DoiDonViChiTiet				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVBanLeVatTu					set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVBanSiVatTu					set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapKhacVatTu				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapMuaVatTu				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapTraLaiBanLeChiTiet		set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapTraLaiBanSiChiTiet		set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNoiBoVatTu					set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVXuatKhacVatTu				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update VTBangGiaChiTiet				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeBanLeKhuyenMai				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeBanLePhuKien				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeNhapTraLaiBanLeKhuyenMai	set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeNhapTraLaiBanLePhuKien		set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeNoiBoPhuKien				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XePhuKienChiTiet				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL Delete VatTu where (ID = @VatTuID_DEL)

END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XEBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XEBANLE]
     IN KhoHang...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATPHUKIEN_XEBANLE]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID BEGIN KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, b.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeBanLe BEGIN A INNER JOIN
            XeBanLePhuKien BEGIN B ON A.ID = B.XeBanLeID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE   (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHLE]
     IN KhoHangID INT,
...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHLE]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai BEGIN L INNER JOIN
            VatTu BEGIN V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe BEGIN A INNER JOIN
            XeBanLeKhuyenMai BEGIN B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure dt_verstamp007: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_verstamp007]
BEGIN
	select 7005
//
DE...' at line 1 (SQL: DELIMITER //

create   procedure [dt_verstamp007]
BEGIN
	select 7005
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATKMBH_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBH_Old]
     IN KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBH_Old]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai BEGIN L INNER JOIN
            VatTu BEGIN V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe BEGIN A INNER JOIN
            XeBanLeKhuyenMai BEGIN B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure dt_verstamp006: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

create   procedure [dt_verstamp006]
BEGIN
	select 7000
//
DE...' at line 1 (SQL: DELIMITER //

create   procedure [dt_verstamp006]
BEGIN
	select 7000
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATBAOHIEM_BHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBAOHIEM_BHLE]
     IN KhoHangID ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBAOHIEM_BHLE]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, B.NgayXuat BEGIN NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, 1 BEGIN SoLuong, B.GiaBanBH, B.GiaBanBH BEGIN ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai BEGIN L INNER JOIN
            VatTu BEGIN V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe BEGIN A INNER JOIN
            XeBanLeBaoHiem BEGIN B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_TRALAI]
     IN KhoHangI...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPPHUKIEN_TRALAI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  B.ID, B.SoCT, C.NgayNhap BEGIN NgayCT, A.KhoHangXuatID BEGIN KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
            XeNhapTraLaiBanLePhuKien BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe BEGIN A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu BEGIN V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_NHAPKHUYENMAI_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHUYENMAI_TRALAI]
     IN KhoHan...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHUYENMAI_TRALAI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  B.ID, B.SoCT, B.NgayCT, A.KhoHangXuatID BEGIN KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
            XeNhapTraLaiBanLeKhuyenMai BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe BEGIN A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu BEGIN V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRASI]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRASI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeBanSi BEGIN A INNER JOIN
			XeNhapTraLaiBanSi BEGIN B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet BEGIN C ON B.ID = C.XeNhapTraLaiBanSiID
	WHERE (B.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.XeNhapMuaID IS NOT NULL)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_NHAPBAOHIEM_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPBAOHIEM_TRALAI]
     IN KhoHangI...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPBAOHIEM_TRALAI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  B.ID, B.SoCT, C.NgayNhap BEGIN NgayCT, A.KhoHangXuatID BEGIN KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, 1 BEGIN SoLuong, C.GiaBanBH BEGIN DonGia, C.GiaBanBH BEGIN ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
            XeNhapTraLaiBanLeBaoHiem BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe BEGIN A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu BEGIN V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRALE]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRALE]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanLe BEGIN A INNER JOIN
            DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_TEST_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TEST_1]   
BEGIN

	select count(ID) BE...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TEST_1]   
BEGIN

	select count(ID) BEGIN 'VT' from VatTu
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TEST]
     IN VatTuID INT     
BEGIN
...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TEST]
     IN VatTuID INT     
BEGIN

	
	

	
	
	
	
	
	
	select * from VatTu where ID = IN VatTuID END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_DV_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_DV_BANGGIA]
     IN DenNgay nvarchar(10)...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_DV_BANGGIA]
     IN DenNgay nvarchar(10),
	 IN CuaHangID nvarchar(2)
BEGIN
    
	Declare IN V_DV_BangGia_MaxID Table (MaxID int, DichVuID int)
	Insert @V_DV_BangGia_MaxID(MaxID, DichVuID) 
			SELECT Max(B.ID) BEGIN MaxID, B.DichVuID
			FROM   DVBangGia BEGIN A INNER JOIN
				   DVBangGiaChiTiet BEGIN B ON A.ID = B.DVBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.CuaHangID = @CuaHangID)
			GROUP BY B.DichVuID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.DichVuID, V.MaDichVu, V.HangMuc, C.DonGia
	FROM   DVBangGia BEGIN B INNER JOIN
           DVBangGiaChiTiet BEGIN C ON B.ID = C.DVBangGiaID INNER JOIN
           IN V_DV_BangGia_MaxID BEGIN M ON C.ID = M.MaxID INNER JOIN
           DichVu BEGIN V ON C.DichVuID = V.ID	
	ORDER BY V.MaDichVu
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHSI]
     IN KhoHangID INT,
...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATKMBHSI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai BEGIN L INNER JOIN
            VatTu BEGIN V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanSi BEGIN A INNER JOIN
            XeBanSiKhuyenMai BEGIN B ON A.ID = B.XeBanSiID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE[SP_VT_BANGGIA]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE[SP_VT_BANGGIA]
                                IN DenNgay nvarchar(10),
	                            IN CuaHangID nvarchar(2)
                            BEGIN
                            
                                Declare IN V_VT_BangGia_MaxID Table(MaxID int, VatTuID int)
                                Insert @V_VT_BangGia_MaxID(MaxID, VatTuID)
                                        SELECT Max(B.ID) BEGIN MaxID, B.VatTuID
                                        FROM   VTBangGia BEGIN A CROSS APPLY STRING_SPLIT(CuaHangID, ',') INNER JOIN
                                               VTBangGiaChiTiet BEGIN B ON A.ID = B.VTBangGiaID
                                        WHERE(A.ApDungTu <= @DenNgay) AND(A.ApDungDen >= @DenNgay) AND (value = @CuaHangID)
                                        GROUP BY B.VatTuID

                                SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.VatTuLoaiID, L.VatTuNhomID, C.GiaNhap, C.GiaXuat
                                FROM   VTBangGia BEGIN B INNER JOIN
                                       VTBangGiaChiTiet BEGIN C ON B.ID = C.VTBangGiaID INNER JOIN
                                       IN V_VT_BangGia_MaxID BEGIN M ON C.ID = M.MaxID INNER JOIN
                                       VatTu BEGIN V ON C.VatTuID = V.ID INNER JOIN
                                       VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
                            END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_NHAPKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHAC]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPKHAC]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapKhac BEGIN A INNER JOIN
            DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI_TONGHOP]     
	 IN TuNgay ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI_TONGHOP]     
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeBanSi BEGIN A INNER JOIN
			XeBanSiChiTiet BEGIN B ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay)		
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANSI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeBanSi BEGIN A INNER JOIN
			XeBanSiChiTiet BEGIN B ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_TONDAU]
     IN KhoHangID INT,
    ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_TONDAU]
     IN KhoHangID INT,
     IN DenNgay VARCHAR(10),
	 IN XeBanLeID INT,
	 IN XeBanSiID INT,
	 IN XeNoiBoID INT,
	 IN XeXuatKhacID INT
BEGIN

	SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) BEGIN TDSLNhap, SUM(T.SLXuat) BEGIN TDSLXuat
	FROM (
		
		SELECT 'A' BEGIN MaTN, KhoHangNhapID BEGIN KhoHangID, XeID, ID BEGIN XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat 
		FROM XeNhapMua 
		WHERE (NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT 'B' BEGIN TN, A.KhoHangNhapID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat
		FROM XeNoiBo BEGIN A INNER JOIN
				XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
		UNION ALL
		
		SELECT 'C' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, A.XeID, A.XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat
		FROM XeBanLe  BEGIN A INNER JOIN
				XeNhapTraLaiBanLe  BEGIN B ON A.ID = B.XeBanLeID    
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'D' BEGIN TN, A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat
		FROM XeBanSi BEGIN A INNER JOIN
				XeNhapTraLaiBanSi BEGIN B ON A.ID = B.XeBanSiID INNER JOIN
				XeNhapTraLaiBanSiChiTiet BEGIN C ON B.ID = C.XeNhapTraLaiBanSiID
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
		UNION ALL
		
		SELECT 'E' BEGIN TN, KhoHangXuatID BEGIN KhoHangID, XeID, XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
		FROM XeBanLe     
		WHERE (NgayBan <= @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'F' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
		FROM XeBanSi BEGIN A INNER JOIN
				XeBanSiChiTiet BEGIN B ON A.ID = B.XeBanSiID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeBanSiID)
		UNION ALL
		
		SELECT 'G' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
		FROM XeNoiBo BEGIN A INNER JOIN
				XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeNoiBoID) 
		UNION ALL
		
		SELECT 'H' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
		FROM XeXuatKhac BEGIN A INNER JOIN
				XeXuatKhacChiTiet BEGIN B ON A.ID = B.XeXuatKhacID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeXuatKhacID)
	) BEGIN T
	GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID
END;


//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_TONKHO]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_TONKHO]
                                 IN KhoHangID int,
                                 IN DenNgay nvarchar(10),
	                             IN XeBanLeID INT,
	                             IN XeBanSiID INT,
	                             IN XeNoiBoID INT,
	                             IN XeXuatKhacID INT
                            BEGIN
                             
	                            Declare IN Tb_XeTonDau Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)
	                            Insert IN Tb_XeTonDau Exec SP_XE_TONDAU @KhoHangID, @DenNgay, @XeBanLeID, @XeBanSiID, @XeNoiBoID, IN XeXuatKhacID SELECT A.KhoHangID, B.KhoHangNhapID, A.XeID, X.MaXe, X.TenXe, A.XeNhapMuaID, B.KhachHangID BEGIN NhaCungCapID, B.DonGia_CoVAT, B.NgayCT, B.SoKhung, B.SoMay, B.MaChiaKhoa, (A.TDSLNhap - A.TDSLXuat) BEGIN SoLuongTon, B.GhiChu, B.MaChiaKhoa
	                            FROM IN Tb_XeTonDau BEGIN A INNER JOIN
			                            XeNhapMua BEGIN B ON A.XeNhapMuaID = B.ID INNER JOIN
			                            Xe BEGIN X ON A.XeID = X.ID 
	                            WHERE (A.TDSLNhap - A.TDSLXuat) <>0
                            END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_NHAPXUATTON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_NHAPXUATTON]
     IN KhoHangID int,
	 I...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_NHAPXUATTON]
     IN KhoHangID int,
	 IN TuNgay nvarchar(10),
     IN DenNgay nvarchar(10)
BEGIN
    

	Declare IN Tb_XeTonDau Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)

	declare IN XeBanLeID int, IN XeBanSiID int, IN XeNoiBoID int
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0

	Insert IN Tb_XeTonDau Exec SP_XE_TONDAU @KhoHangID, @TuNgay, @XeBanLeID, @XeBanSiID, IN XeNoiBoID SELECT NXT.* FROM (
		SELECT 'T' BEGIN TN, KhoHangID, XeID, XeNhapMuaID, (TDSLNhap - TDSLXuat) BEGIN TDSL
		FROM IN Tb_XeTonDau UNION ALL
		SELECT 'B' BEGIN TN, A.KhoHangNhapID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 1 BEGIN SoLuong
		FROM XeNoiBo BEGIN A INNER JOIN
			 XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID    
		WHERE A.NgayCT < IN DenNgay AND KhoHangNhapID = @KhoHangID   
	) BEGIN NXT 
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_LICHSU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_LICHSU]
     IN XeNhapMuaID INT
BEG...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_LICHSU]
     IN XeNhapMuaID INT
BEGIN

	
	SELECT 'A' BEGIN MaTN, ID, KhoHangNhapID, Null BEGIN KhoHangXuatID, XeID, ID BEGIN XeNhapMuaID, SoCT, NgayCT, NULL BEGIN NgayBan, CreatedBy, SoKhung, SoMay 
	FROM XeNhapMua 
	WHERE (ID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'B' BEGIN TN, A.ID, A.KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, NULL BEGIN NgayBan, A.CreatedBy, M.SoKhung, M.SoMay 
	FROM XeNoiBo BEGIN A INNER JOIN
			XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID INNER JOIN
			XeNhapMua BEGIN M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'C' BEGIN TN, B.ID, A.KhoHangXuatID BEGIN KhoHangNhapID, null BEGIN KhoHangXuatID, A.XeID, A.XeNhapMuaID, B.SoCT, B.NgayCT, NULL BEGIN NgayBan, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe  BEGIN A INNER JOIN
			XeNhapTraLaiBanLe  BEGIN B ON A.ID = B.XeBanLeID INNER JOIN
			XeNhapMua BEGIN M ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'D' BEGIN TN, B.ID, A.KhoHangXuatID BEGIN KhoHangNhapID, null BEGIN KhoHangXuatID, C.XeID, C.XeNhapMuaID, B.SoCT, B.NgayCT, NULL BEGIN NgayBan, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi BEGIN A INNER JOIN
			XeNhapTraLaiBanSi BEGIN B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet BEGIN C ON B.ID = C.XeNhapTraLaiBanSiID INNER JOIN
			XeNhapMua BEGIN M ON C.XeNhapMuaID = M.ID
	WHERE (C.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'E' BEGIN TN, A.ID, Null BEGIN KhoHangNhapID, A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe BEGIN A INNER JOIN
			XeNhapMua BEGIN M ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'F' BEGIN TN, A.ID, Null BEGIN KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi BEGIN A INNER JOIN
			XeBanSiChiTiet BEGIN B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapMua BEGIN M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'G' BEGIN TN, A.ID, Null BEGIN KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT BEGIN NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeXuatKhac BEGIN A INNER JOIN
			XeXuatKhacChiTiet BEGIN B ON A.ID = B.XeXuatKhacID INNER JOIN
			XeNhapMua BEGIN M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	
	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE_TONGHOP]     
	 IN TuNgay ...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE_TONGHOP]     
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT KhoHangXuatID BEGIN KhoHangID, XeID, XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN IN TuNgay AND @DenNgay) AND (XeNhapMuaID IS NOT NULL)
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_XUATBANLE]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT KhoHangXuatID BEGIN KhoHangID, XeID, XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN IN TuNgay AND @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (XeNhapMuaID IS NOT NULL)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_TONKHO_BY_XEID: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_TONKHO_BY_XEID]     
     IN DenNgay...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_TONKHO_BY_XEID]     
     IN DenNgay VARCHAR(10),
	 IN XeID INT,
	 IN IDPhieu INT,
	 IN LoaiPhieu INT,
	 IN SoMay VARCHAR(20)
BEGIN

	Declare IN XeBanLeID INT,	IN XeBanSiID INT, IN XeNoiBoID INT, IN XeXuatKhacID INT
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0
	SET @XeXuatKhacID = 0

	if(@LoaiPhieu = 1)
		SET @XeBanLeID = IN IDPhieu else if(@LoaiPhieu = 2)
		SET @XeBanSiID = IN IDPhieu else if(@LoaiPhieu = 3)
		SET @XeNoiBoID = IN IDPhieu else if(@LoaiPhieu = 4)
		SET @XeXuatKhacID = IN IDPhieu Declare IN Tb_XeTonKho Table (KhoHangID int, XeID int, XeNhapMuaID int, SLNhap int, SLXuat int)

	Insert IN Tb_XeTonKho SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) BEGIN TDSLNhap, SUM(T.SLXuat) BEGIN TDSLXuat
		FROM (
			
			SELECT 'A' BEGIN MaTN, KhoHangNhapID BEGIN KhoHangID, XeID, ID BEGIN XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat 
			FROM XeNhapMua 
			WHERE (NgayCT <= @DenNgay) AND (XeID = @XeID)
			UNION ALL
			
			SELECT 'B' BEGIN TN, A.KhoHangNhapID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat
			FROM XeNoiBo BEGIN A INNER JOIN
					XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.IsXacNhan=1)
			UNION ALL
			
			SELECT 'C' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, A.XeID, A.XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat
			FROM XeBanLe  BEGIN A INNER JOIN
					XeNhapTraLaiBanLe  BEGIN B ON A.ID = B.XeBanLeID    
			WHERE (B.NgayCT <= @DenNgay) AND (A.XeID = @XeID) AND (A.XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'D' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, C.XeID, C.XeNhapMuaID, 1 BEGIN SLNhap, 0 BEGIN SLXuat
			FROM XeBanSi BEGIN A INNER JOIN
					XeNhapTraLaiBanSi BEGIN B ON A.ID = B.XeBanSiID INNER JOIN
					XeNhapTraLaiBanSiChiTiet BEGIN C ON B.ID = C.XeNhapTraLaiBanSiID
			WHERE (B.NgayCT <= @DenNgay) AND (C.XeID = @XeID)
			UNION ALL
			
			SELECT 'E' BEGIN TN, KhoHangXuatID BEGIN KhoHangID, XeID, XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
			FROM XeBanLe     
			WHERE (NgayBan <= @DenNgay) AND (XeID = @XeID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'F' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
			FROM XeBanSi BEGIN A INNER JOIN
					XeBanSiChiTiet BEGIN B ON A.ID = B.XeBanSiID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeBanSiID)
			UNION ALL
			
			SELECT 'G' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
			FROM XeNoiBo BEGIN A INNER JOIN
					XeNoiBoChiTiet BEGIN B ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeNoiBoID) 
			UNION ALL
			
			SELECT 'F' BEGIN TN, A.KhoHangXuatID BEGIN KhoHangID, B.XeID, B.XeNhapMuaID, 0 BEGIN SLNhap, 1 BEGIN SLXuat
			FROM XeXuatKhac BEGIN A INNER JOIN
					XeXuatKhacChiTiet BEGIN B ON A.ID = B.XeXuatKhacID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeXuatKhacID)
		) BEGIN T
		GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID

		if(LEN(@SoMay)>0)
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) BEGIN SLTON,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM IN Tb_XeTonKho BEGIN A INNER JOIN
					XeNhapMua BEGIN B ON A.XeNhapMuaID = B.ID INNER JOIN
					Xe BEGIN X ON A.XeID = X.ID INNER JOIN 
					KhoHang BEGIN K ON A.KhoHangID = K.ID 
			WHERE SLNhap-SLXuat<>0 AND (B.SoMay Like N'%' + @SoMay)
		else
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) BEGIN SLTON,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM IN Tb_XeTonKho BEGIN A INNER JOIN
					XeNh
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRALE]
     IN KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_XE_NHAPTRALE]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, 1 BEGIN SoLuong
	FROM XeBanLe  BEGIN A INNER JOIN
			XeNhapTraLaiBanLe  BEGIN B ON A.ID = B.XeBanLeID    
	WHERE (B.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA_GROUP]
     IN KhoHangID INT...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA_GROUP]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, SUM(B.SoLuong) BEGIN SoLuong, SUM(B.ThanhTien) BEGIN ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua BEGIN A INNER JOIN
            DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA]
     IN KhoHangID INT,
	 I...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPMUA]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua BEGIN A INNER JOIN
            DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRASI]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRASI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanSi BEGIN A INNER JOIN
            DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANSI]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANSI]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanSi BEGIN A INNER JOIN
            DVBanSiVatTu BEGIN B ON A.ID = B.DVBanSiID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure uspGetChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc [uspGetChiTien1]
IN ID int
BEGIN
SELECT  ...' at line 1 (SQL: DELIMITER //
CREATE         proc [uspGetChiTien1]
IN ID int
BEGIN
SELECT        ChiTien.ID, KhachHang.TenKhachHang, ChiTienLyDo.TenLyDo, ChiTien.SoTien, TaiKhoan.TenTaiKhoan, ChiTien.GhiChu, ChiTien.CuaHangID, ChiTien.CreatedBy, 
                         ChiTien.CreatedAt, ChiTien.UpdatedBy, ChiTien.UpdatedAt
FROM            ChiTien INNER JOIN
                         KhachHang ON ChiTien.KhachHangID = KhachHang.ID INNER JOIN
                         ChiTienLyDo ON ChiTien.ChiTienLyDoID = ChiTienLyDo.ID INNER JOIN
                         TaiKhoan ON ChiTien.TaiKhoanID = TaiKhoan.ID
WHERE ChiTien.ID= @ID
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure uspChiTien2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
create         proc [uspChiTien2]
IN ID int,
IN Status int,
I...' at line 1 (SQL: DELIMITER //
create         proc [uspChiTien2]
IN ID int,
IN Status int,
IN ApprovalBy int
BEGIN
UPDATE ChiTien SET [Status2] = @Status, Approval2By = @ApprovalBy, Approval2At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_XE_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_XE_NHAPMUA]
     IN KhoHangID INT,
	 I...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_XE_NHAPMUA]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT KhoHangNhapID, XeID, ID BEGIN XeNhapMuaID, 1 BEGIN SoLuong 
	FROM XeNhapMua 
	WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (KhoHangNhapID = @KhoHangID)		
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure uspChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc [uspChiTien1]
IN ID int,
IN Status int,
I...' at line 1 (SQL: DELIMITER //
CREATE         proc [uspChiTien1]
IN ID int,
IN Status int,
IN ApprovalBy int
BEGIN
UPDATE ChiTien SET [Status1] = @Status, Approval1By = @ApprovalBy, Approval1At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE_GROUP]
     IN KhoHangID I...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE_GROUP]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, SUM(B.SoLuong) BEGIN SoLuong, SUM(B.ThanhTien) BEGIN ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe BEGIN A INNER JOIN
            DVBanLeVatTu BEGIN B ON A.ID = B.DVBanLeID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure upsChiTienPowerApps: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [upsChiTienPowerApps]
BEGIN
    
	Declare ...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [upsChiTienPowerApps]
BEGIN
    
	Declare IN TuNgay VARCHAR(10), IN DenNgay VARCHAR(10)

	set @TuNgay = CONVERT(VARCHAR(10), DATEADD(DAY, -30, NOW()), 101)
	set @DenNgay = CONVERT(VARCHAR(10), NOW(), 101)

	SELECT * FROM ChiTien WHERE NgayCT between IN TuNgay and IN DenNgay END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON_KHOHANG: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //



CREATE PROCEDURE `SP_VT_GET_GIAVON_KHOHANG`
	 IN TuNgay VA...' at line 1 (SQL: DELIMITER //



CREATE PROCEDURE `SP_VT_GET_GIAVON_KHOHANG`
	 IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10),
	 IN KhoHangID int,
	 IN VatTuID int
BEGIN

	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	Declare IN Tb_VTTonDau Table (KhoHangID int, VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) BEGIN SLNhap, SUM(T.TienNhap) BEGIN TienNhap, SUM(T.SLXuat) BEGIN SLXuat, SUM(T.TienXuat) BEGIN TienXuat 
	FROM (
		
		SELECT	A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapMua BEGIN A INNER JOIN
				DVNhapMuaVatTu BEGIN B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanLe BEGIN A INNER JOIN
				DVNhapTraLaiBanLeChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanSi BEGIN A INNER JOIN
				DVNhapTraLaiBanSiChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DoiDonVi BEGIN A INNER JOIN
				DoiDonViChiTiet BEGIN B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapKhac BEGIN A INNER JOIN
				DVNhapKhacVatTu BEGIN B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID BEGIN KhoHangID, C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
                XeNhapTraLaiBanLePhuKien BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe BEGIN A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID BEGIN KhoHangID, C.VatTuID, C.SoLuong BEGIN SLNhap, C.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM    XeNhapTraLaiBanLe BEGIN B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai BEGIN C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
				XeBanLe BEGIN A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID BEGIN KhoHangID, B.VatTuID, B.SoLuong BEGIN SLNhap, B.ThanhTien BEGIN TienNhap, 0 BEGIN SLXuat, 0 BEGIN TienXuat
		FROM	DVNhapTraLaiBanBuon BEGIN A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		
		
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE]
     IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_XUATBANLE]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.SoPhieu, A.KhoHangXuatID, A.KhachHangID, B.NgayXuat, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe BEGIN A INNER JOIN
            DVBanLeVatTu BEGIN B ON A.ID = B.DVBanLeID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure spCheckPhieuChi: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE `spCheckPhieuChi` (
		IN khohangID varchar(10)...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE `spCheckPhieuChi` (
		IN khohangID varchar(10)
) BEGIN select	* from ChiTien
				where	KhoHangID = IN khohangID  END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_FIX_SLVT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
Create   PROCEDURE [SP_FIX_SLVT]
BEGIN
    
	Declare IN Tb_SL...' at line 1 (SQL: DELIMITER //
Create   PROCEDURE [SP_FIX_SLVT]
BEGIN
    
	Declare IN Tb_SLVT Table (DVBanLeID int, SoLuongVT float)

	Insert @Tb_SLVT(DVBanLeID, SoLuongVT) 
	select DVBanLeID, Sum(SoLuong) BEGIN SoLuongVT from DVBanLeVatTu group by DVBanLeID
	
	UPDATE DVBanLe 
    SET DVBanLe.TongSoLuongVatTu = B.SoLuongVT            
	FROM DVBanLe INNER JOIN IN Tb_SLVT BEGIN B ON DVBanLe.ID = B.DVBanLeID 
	where B.SoLuongVT is not null
	
 
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_TC_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURE [SP_TC_TONDAU]
                             ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURE [SP_TC_TONDAU]
                                 IN TaiKhoanID INT,
                                 IN TuNgay VARCHAR(10),
	                             IN DenNgay VARCHAR(10)	 
                            BEGIN
                            
	                            SELECT T.TaiKhoanID, T.TacNghiep, SUM(T.SoTien) BEGIN SoTien
	                            FROM (
		                            
		                            SELECT 1 BEGIN MaTN, TaiKhoanID, SUM(SoTien) BEGIN SoTien, TacNghiep 
		                            FROM XeBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 2 BEGIN MaTN, TaiKhoanID, SUM(SoTien) BEGIN SoTien, TacNghiep 
		                            FROM XeBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 3 BEGIN MaTN, TaiKhoanID, SUM(GiaNhap) BEGIN SoTien, 1 BEGIN TacNghiep
		                            FROM XeSonXe 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 4 BEGIN MaTN, TaiKhoanID, SUM(SoTien) BEGIN SoTien, 0 BEGIN TacNghiep
		                            FROM ThuTien 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 5 BEGIN MaTN, TaiKhoanID, SUM(SoTien) BEGIN SoTien, 1 BEGIN TacNghiep
		                            FROM ChiTien 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 6 BEGIN MaTN, TaiKhoanID, SUM(SoTien) BEGIN SoTien, TacNghiep 
		                            FROM DVBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 7 BEGIN MaTN, TaiKhoanID, SUM(SoTien) BEGIN SoTien, TacNghiep 
		                            FROM DVBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 8 BEGIN MaTN, TaiKhoanID, SUM(SoTien) BEGIN SoTien, TacNghiep 
		                            FROM DVBanBuonThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 9 BEGIN MaTN, T.TaiKhoanID, SUM(G.ChiPhi) BEGIN SoTien, 1 BEGIN TacNghiep 
                                    FROM DVBanLe BEGIN A INNER JOIN 
                                        KhoHang BEGIN K ON A.KhoHangXuatID = K.ID INNER JOIN 
	
//
DELIMITER ;)  
[2024-07-18 16:35:31] local.ERROR: Error creating stored procedure SP_VT_NHAPTRABUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRABUON]
     IN KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE   PROCEDURE [SP_VT_NHAPTRABUON]
     IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10)
BEGIN

	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet BEGIN TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanBuon BEGIN A INNER JOIN
            DVNhapTraLaiBanBuonChiTiet BEGIN B ON A.ID = B.DVNhapTraLaiBanbuonID INNER JOIN
            VatTu BEGIN V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai BEGIN L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATBANBUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANBUON (IN KhoHangID INT,
	 IN TuN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANBUON (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanBuon AS A INNER JOIN
            DVBanBuonVatTu AS B ON A.ID = B.DVBanBuonID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC_TONGHOP (IN TuNgay VARCHAR(10),...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC_TONGHOP (IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeXuatKhac AS A INNER JOIN
			XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeXuatKhac AS A INNER JOIN
			XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_BANGGIA2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_BANGGIA2 (IN DenNgay nvarchar(20),
	 IN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_BANGGIA2 (IN DenNgay nvarchar(20),
	 IN XeNhapMuaID int,
	 IN TenType nvarchar(50) BEGIN BEGIN
SET nocount  ON    
	Declare IN TenModel nvarchar(30)

	
	SELECT		@TenModel = X.TenModel FROM XeNhapMua AS M INNER JOIN Xe AS X ON M.XeID = X.ID INNER JOIN V_XeThayVanh AS TV ON M.ID = TV.XeNhapMuaID 
	WHERE		TV.XeNhapMuaID = IN XeNhapMuaID GROUP BY	X.TenModel	

	
	Declare IN V_Xe_BangGia_MaxID Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT  MAX(B.ID) AS MaxID, B.XeID
			FROM    XeBangGia AS A INNER JOIN
                    XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID INNER JOIN
                    Xe AS X ON B.XeID = X.ID
			WHERE   (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive = 1) AND (X.TenModel = @TenModel) AND (X.TenType = @TenType)
			GROUP BY B.XeID, X.TenModel, X.TenType

	
	SELECT TOP (1) X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	FROM   XeBangGia AS B INNER JOIN
           XeBangGiaChiTiet AS C ON B.ID = C.XeBangGiaID INNER JOIN
           IN V_Xe_BangGia_MaxID AS V ON C.ID = V.MaxID INNER JOIN
           Xe AS X ON C.XeID = X.ID	
	GROUP BY X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	ORDER BY C.GiaHaiQuan DESC
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATKMDV: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMDV (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMDV (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            DVBanLe AS A INNER JOIN
            DVBanLeKhuyenMai AS B ON A.ID = B.DVBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure dt_setpropertybyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_setpropertybyid (IN id int,
	IN property ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_setpropertybyid (IN id int,
	IN property varchar(64),
	IN value varchar(255),
	IN lvalue image
BEGIN
	set nocount on
	declare IN uvalue nvarchar(255) 
	set @uvalue = convert(nvarchar(255), @value) 
	if exists (select * from dtproperties 
			where objectid=IN id and property=@property) BEGIN update dtproperties set value=@value, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=IN id and property=IN property END;
	else
	begin
		
		
		
		insert dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @value, @uvalue, @lvalue)
	 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure dt_getpropertiesbyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid_u (IN id int,
	IN prope...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid_u (IN id int,
	IN property varchar(64)
BEGIN
	set nocount on

	if (IN property is null) or (@property = '')
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure dt_getpropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid (IN id int,
	IN propert...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid (IN id int,
	IN property varchar(64)
BEGIN
	set nocount on

	if (IN property is null) or (@property = '')
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure dt_getobjwithprop_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getobjwithprop_u (IN property varchar(30),...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getobjwithprop_u (IN property varchar(30),
	IN uvalue nvarchar(255) BEGIN set nocount on

	if (IN property is null) or (@property = '')
	begin
		raiserror('Must specify a property name.',-1,-1)
		return (1)
	 END;

	if (IN uvalue is null)
		select objectid id from dtproperties
			where property=IN property else
		select objectid id from dtproperties
			where property=IN property and uvalue=@uvalue
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure dt_getobjwithprop: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getobjwithprop (IN property varchar(30),
...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getobjwithprop (IN property varchar(30),
	IN value varchar(255) BEGIN set nocount on

	if (IN property is null) or (@property = '')
	begin
		raiserror('Must specify a property name.',-1,-1)
		return (1)
	 END;

	if (IN value is null)
		select objectid id from dtproperties
			where property=IN property else
		select objectid id from dtproperties
			where property=IN property and value=@value
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure dt_generateansiname: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
 
CREATE PROCEDURE dt_generateansiname ((IN name varchar(255) o...' at line 1 (SQL: DELIMITER //
 
CREATE PROCEDURE dt_generateansiname ((IN name varchar(255) output) BEGIN declare IN prologue varchar(20) 
	declare IN indexstring varchar(20) 
	declare IN index integer 
 
	set @prologue = 'MSDT-A-' 
	set @index = 1 
 
	while 1 = 1 
	begin 
		set @indexstring = cast(IN index as varchar(20)) 
		set @name = @prologue + IN indexstring if not exists (select value from dtproperties where value = @name) 
			break 
		 
		set @index = @index + 1 
 
		if (@index = 10000) 
			goto TooMany 
	 END; 
 
Leave: 
 
	return 
 
TooMany: 
 
	set @name = 'DIAGRAM' 
	goto Leave
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure dt_setpropertybyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_setpropertybyid_u (IN id int,
	IN propert...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_setpropertybyid_u (IN id int,
	IN property varchar(64),
	IN uvalue nvarchar(255),
	IN lvalue image
BEGIN
	set nocount on
	
	
	
	
	declare IN avalue varchar(255) 
	set @avalue = null 
	if (IN uvalue is not null) BEGIN if (convert(nvarchar(255), convert(varchar(255), @uvalue)) = @uvalue) 
		begin 
			set @avalue = convert(varchar(255), @uvalue) 
		END; 
		else 
		begin 
			if 'DtgSchemaNAME' = IN property begin 
				exec dt_generateansiname IN avalue output 
			END; 
		END; 
	END; 
	if exists (select * from dtproperties 
			where objectid=IN id and property=@property)
	begin
		
		
		
		update dtproperties set value=@avalue, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=IN id and property=IN property END;
	else
	begin
		
		
		
		insert dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @avalue, @uvalue, @lvalue)
	 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_Old (IN KhoHangID INT,
	 IN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_Old (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS A INNER JOIN
            XePhuKienChiTiet AS B ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 1) AND (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure dt_dropuserobjectbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_dropuserobjectbyid (IN id int
BEGIN
	set...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_dropuserobjectbyid (IN id int
BEGIN
	set nocount on
	delete from dtproperties where objectid=@id
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN (IN KhoHangID INT,
	 IN TuN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS A INNER JOIN
            XePhuKienChiTiet AS B ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 0) AND (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure dt_droppropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_droppropertiesbyid (IN id int,
	IN proper...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_droppropertiesbyid (IN id int,
	IN property varchar(64)
BEGIN
	set nocount on

	if (IN property is null) or (@property = '')
		delete from dtproperties where objectid=IN id else
		delete from dtproperties 
			where objectid=IN id and property=@property
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure dt_adduserobject: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_adduserobject (BEGIN
	set nocount on
	
...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_adduserobject (BEGIN
	set nocount on
	
	begin transaction
		insert dtproperties (property) VALUES ('DtgSchemaOBJECT')
		update dtproperties set objectid=@IN identity where id=@IN identity and property='DtgSchemaOBJECT'
	commit
	return @@identity
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKHAC (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKHAC (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVXuatKhac AS A INNER JOIN
			DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
			VatTu AS V ON B.VatTuID = V.ID INNER JOIN
			VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATDOIDONVI (IN KhoHangID INT,
	 IN Tu...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATDOIDONVI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, A.SoLuong, A.DonGia, A.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS A INNER JOIN
            VatTu AS V ON A.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_BANGGIA (IN DenNgay nvarchar(20) BEGIN BE...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_BANGGIA (IN DenNgay nvarchar(20) BEGIN BEGIN
SET nocount  ON    
	Declare IN V_Xe_BangGia_MaxID Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT Max(B.ID) AS MaxID, B.XeID
			FROM   XeBangGia AS A INNER JOIN
				   XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive =1)
			GROUP BY B.XeID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.XeID, C.SoKhung, C.SoMay, X.MaXe, X.TenXe, X.SortDoiXe, X.SortLoaiXe, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, c.GiaApThue
	FROM   XeBangGia AS B INNER JOIN
           XeBangGiaChiTiet AS C ON B.ID = C.XeBangGiaID INNER JOIN
           IN V_Xe_BangGia_MaxID AS V ON C.ID = V.MaxID INNER JOIN
           Xe AS X ON C.XeID = X.ID	
	ORDER BY X.SortDoiXe
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON2 (IN TuNgay VARCHAR(10),	 ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON2 (IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 
BEGIN
BEGIN
SET NOCOUNT ON
	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	
	FROM (
		
		SELECT	1 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	2 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	3 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	5 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	6 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  8 as a, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  9 as a, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)		
		UNION ALL
		
		SELECT	10 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	11 as a, B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	12 as a, B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanSi AS A INNER JOIN
				DVBanSiVatTu AS B ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON (IN TuNgay VARCHAR(10),	 ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON (IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 
BEGIN
BEGIN
SET NOCOUNT ON
	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat,
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_TONDAU_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU_ALL (IN KhoHangID INT,
     IN D...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU_ALL (IN KhoHangID INT,
     IN DenNgay VARCHAR(10)
BEGIN
BEGIN
SET NOCOUNT ON
	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'	

	SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.TienNhap) AS TDTienNhap, SUM(T.SLXuat) AS TDSLXuat, SUM(T.TienXuat) AS TDTienXuat 
	FROM (
		
		SELECT	'N01' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N02' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N03' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N04' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNoiBo AS A INNER JOIN
				DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT	'N05' AS MaTN, A.KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID)
		UNION ALL
		
		SELECT	'N06' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT  'N07' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNoiBo AS A INNER JOIN
                XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT  'N08' AS MaTN, A.KhoHangXuatID AS KhoHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON A.ID = B.XeBanLeID INNER JOIN
				Va
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL_TEST (IN KhoHangID int,
     ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL_TEST (IN KhoHangID int,
     IN DenNgay nvarchar(10) BEGIN BEGIN
SET nocount  ON    
	Declare IN Tb_VTTonDau Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert IN Tb_VTTonDau Exec SP_VT_TONDAU_ALL @KhoHangID, IN DenNgay SELECT A.KhoHangID AS KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, A.TDSLNhap, A.TDSLXuat, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon
	FROM IN Tb_VTTonDau AS A INNER JOIN
			VatTu AS V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) < 0
	order by  A.VatTuID

	
	
	
	
	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_XUATNOIBO (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_XUATNOIBO (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeNoiBo AS A INNER JOIN
			XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.IsXacNhan=1)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL (IN KhoHangID int,
     IN De...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL (IN KhoHangID int,
     IN DenNgay nvarchar(10) BEGIN BEGIN
SET nocount  ON    
	Declare IN Tb_VTTonDau Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert IN Tb_VTTonDau Exec SP_VT_TONDAU_ALL @KhoHangID, IN DenNgay SELECT A.KhoHangID AS KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon
	FROM IN Tb_VTTonDau AS A INNER JOIN
			VatTu AS V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_NHAPNOIBO (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_NHAPNOIBO (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeNoiBo AS A INNER JOIN
			XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU (IN KhoHangID INT,
     IN DenNg...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU (IN KhoHangID INT,
     IN DenNgay VARCHAR(10),	 
	 IN VatTuID INT,
	 IN MaTacNghiep VARCHAR(1),
	 IN IDTacNghiep INT
BEGIN
BEGIN
	SET NOCOUNT ON
	DECLARE IN NgayBatDauSuDung VARCHAR(10), 
		IN DVBanLeID INT, IN DVBanSiID INT, IN DVNoiBoID INT, IN DoiDonViID INT, IN DVXuatKhacID INT, IN XeBanLeKMID INT, 
		IN DVBanLeKMID INT, IN XePhuKienID INT, IN XePhuKienNoiBoID INT, IN DVBanBuonID INT, IN XeBanSiKMID INT, IN XeBanLeBHID INT
	SET @NgayBatDauSuDung = '2019-12-19'
	SET @DVBanLeID = 0 	
	SET @DVBanSiID = 0
	SET @DVNoiBoID = 0
	SET @DoiDonViID = 0
	SET @DVXuatKhacID = 0
	SET @XeBanLeKMID = 0
	SET @DVBanLeKMID = 0
	SET @XePhuKienID = 0
	SET @XePhuKienNoiBoID = 0
	SET @DVBanBuonID = 0
	SET @XeBanSiKMID = 0
	SET @XeBanLeBHID = 0

	IF(@MaTacNghiep ='I')			SET @DVBanLeID = IN IDTacNghiep ELSE IF(@MaTacNghiep='J')		SET @DVBanSiID = IN IDTacNghiep ELSE IF(@MaTacNghiep='K')		SET @DVNoiBoID = IN IDTacNghiep ELSE IF(@MaTacNghiep='L')		SET @DoiDonViID = IN IDTacNghiep ELSE IF(@MaTacNghiep='M')		SET @DVXuatKhacID = IN IDTacNghiep ELSE IF(@MaTacNghiep='N')		SET @XeBanLeKMID = IN IDTacNghiep ELSE IF(@MaTacNghiep='O')		SET @DVBanLeKMID = IN IDTacNghiep ELSE IF(@MaTacNghiep='P')		SET @XePhuKienID = IN IDTacNghiep ELSE IF(@MaTacNghiep='Q')		SET @XePhuKienNoiBoID = IN IDTacNghiep ELSE IF(@MaTacNghiep='R')		SET @DVBanBuonID = IN IDTacNghiep ELSE IF(@MaTacNghiep='S')		SET @XeBanSiKMID = IN IDTacNghiep ELSE IF(@MaTacNghiep='T')		SET @XeBanLeBHID = IN IDTacNghiep SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.TienNhap) AS TDTienNhap, SUM(T.SLXuat) AS TDSLXuat, SUM(T.TienXuat) AS TDTienXuat 
	FROM (
		
		SELECT	'N01' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNoiBo AS A INNER JOIN
				DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS MaTN, A.KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATNOIBO (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATNOIBO (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS A INNER JOIN
            DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	
	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO (IN KhoHangID INT,
     IN DenNga...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO (IN KhoHangID INT,
     IN DenNgay nvarchar(10),
	 IN VatTuID INT,
	 IN MaTacNghiep VARCHAR(1),
	 IN IDTacNghiep INT
BEGIN
BEGIN
	SET NOCOUNT  ON    
	DECLARE IN Tb_VTTonDau Table (KhoHangID INT, VatTuID INT, TDSLNhap INT, TDTienNhap FLOAT, TDSLXuat INT, TDTienXuat FLOAT)
	INSERT IN Tb_VTTonDau Exec SP_VT_TONDAU @KhoHangID, @DenNgay, @VatTuID, @MaTacNghiep, IN IDTacNghiep SELECT A.KhoHangID AS KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon
	FROM IN Tb_VTTonDau AS A INNER JOIN
			VatTu AS V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPNOIBO (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPNOIBO (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS A INNER JOIN
            DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.IsXacNhan = 1) AND (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_SELECT_GIAVON_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_SELECT_GIAVON_TEST (IN TuNgay VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_SELECT_GIAVON_TEST (IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 
BEGIN
BEGIN
SET NOCOUNT ON
	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, (1 - A.TyLeCK*0.01) * B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, 1 AS SLNhap, C.GiaBanBH AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLeBaoHiem AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanSi AS A INNER JOIN
				DVBanSiVatTu AS B ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT < @TuNgay)
		UNION ALL
		
		SELECT  VatTuID, 0 AS SLNhap, 0 AS TienNhap, SoLuong AS SLXuat, ThanhTien AS TienXuat
		FROM    DoiDonVi AS A    
	
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_NHAPXUAT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPXUAT (IN KhoHangID INT,
	 IN VatTuI...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPXUAT (IN KhoHangID INT,
	 IN VatTuID INT,
	 IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 	 
BEGIN
BEGIN
	SET NOCOUNT ON
	SELECT T.SoCT, T.NgayCT, T.NgayNXK, T.KhoHangNhapID, T.KhoHangXuatID, T.KhachHangID, T.VatTuID, T.SLNhap, T.SLXuat 
	FROM (
		
		SELECT	'N01' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, A.KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, C.KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
                DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
                DVBanLe AS C ON A.DVBanLeID = C.ID   
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, C.KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
                DVBanSi AS C ON A.DVBanSiID = C.ID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, A.KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNoiBo AS A INNER JOIN
				DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangID AS KhoHangNhapID, NULL AS KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N06' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  'N07' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNoiBo AS A INNER JOIN
                XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)		
		UNION ALL
		
		SELECT  'N08' AS MaTN, B.SoCT, B.NgayCT, B.NgayCT AS NgayNXK, A.KhoHangXuatID AS KhoHangNhapID, NULL AS KhoHangXuatID, a.KhachHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_NHAPDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPDOIDONVI (IN KhoHangID INT,
	 IN Tu...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPDOIDONVI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS A INNER JOIN
            DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XECHUYENKHO (IN KhoHangID IN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XECHUYENKHO (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS A INNER JOIN
            XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
	
	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_GET_GIAVON (IN TuNgay VARCHAR(10),	 
  ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_GET_GIAVON (IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10),
	 IN VatTuID int
BEGIN
BEGIN
SET NOCOUNT ON
	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.Nga
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_XECHUYENKHO (IN KhoHangID IN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_XECHUYENKHO (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID AS KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS A INNER JOIN
            XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan = 1)
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_DELETE_DUPLICATE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_DELETE_DUPLICATE (IN VatTuID_DEL int,	 ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_DELETE_DUPLICATE (IN VatTuID_DEL int,	 
     IN VatTuID int	 
BEGIN
BEGIN
SET NOCOUNT ON
	update DoiDonVi						set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DoiDonViChiTiet				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVBanLeVatTu					set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVBanSiVatTu					set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapKhacVatTu				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapMuaVatTu				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapTraLaiBanLeChiTiet		set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapTraLaiBanSiChiTiet		set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNoiBoVatTu					set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVXuatKhacVatTu				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update VTBangGiaChiTiet				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeBanLeKhuyenMai				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeBanLePhuKien				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeNhapTraLaiBanLeKhuyenMai	set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeNhapTraLaiBanLePhuKien		set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeNoiBoPhuKien				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XePhuKienChiTiet				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL Delete VatTu where (ID = @VatTuID_DEL)

END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XEBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XEBANLE (IN KhoHangID INT,
...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XEBANLE (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, b.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeBanLe AS A INNER JOIN
            XeBanLePhuKien AS B ON A.ID = B.XeBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE   (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHLE (IN KhoHangID INT,
	 IN TuNg...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHLE (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS A INNER JOIN
            XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure dt_verstamp007: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_verstamp007 (BEGIN
	select 7005
//
DELIMITER' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_verstamp007 (BEGIN
	select 7005
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATKMBH_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBH_Old (IN KhoHangID INT,
	 IN Tu...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBH_Old (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS A INNER JOIN
            XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure dt_verstamp006: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_verstamp006 (BEGIN
	select 7000
//
DELIMITER' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_verstamp006 (BEGIN
	select 7000
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATBAOHIEM_BHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBAOHIEM_BHLE (IN KhoHangID INT,
	 I...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBAOHIEM_BHLE (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, B.NgayXuat AS NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, 1 AS SoLuong, B.GiaBanBH, B.GiaBanBH AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS A INNER JOIN
            XeBanLeBaoHiem AS B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_TRALAI (IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_TRALAI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  B.ID, B.SoCT, C.NgayNhap AS NgayCT, A.KhoHangXuatID AS KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS B INNER JOIN
            XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_NHAPKHUYENMAI_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHUYENMAI_TRALAI (IN KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHUYENMAI_TRALAI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  B.ID, B.SoCT, B.NgayCT, A.KhoHangXuatID AS KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS B INNER JOIN
            XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRASI (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRASI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanSi AS A INNER JOIN
			XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID
	WHERE (B.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.XeNhapMuaID IS NOT NULL)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_NHAPBAOHIEM_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPBAOHIEM_TRALAI (IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPBAOHIEM_TRALAI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  B.ID, B.SoCT, C.NgayNhap AS NgayCT, A.KhoHangXuatID AS KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, 1 AS SoLuong, C.GiaBanBH AS DonGia, C.GiaBanBH AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS B INNER JOIN
            XeNhapTraLaiBanLeBaoHiem AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRALE (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRALE (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanLe AS A INNER JOIN
            DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_TEST_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_TEST_1 (BEGIN
BEGIN
SET NOCOUNT ON
	selec...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_TEST_1 (BEGIN
BEGIN
SET NOCOUNT ON
	select count(ID) as 'VT' from VatTu
END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_TEST (IN VatTuID INT     
BEGIN
BEGIN
SET...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_TEST (IN VatTuID INT     
BEGIN
BEGIN
SET NOCOUNT ON
	
	

	
	
	
	
	
	
	select * from VatTu where ID = IN VatTuID END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_DV_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_DV_BANGGIA (IN DenNgay nvarchar(10),
	 IN C...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_DV_BANGGIA (IN DenNgay nvarchar(10),
	 IN CuaHangID nvarchar(2) BEGIN BEGIN
SET nocount  ON    
	Declare IN V_DV_BangGia_MaxID Table (MaxID int, DichVuID int)
	Insert @V_DV_BangGia_MaxID(MaxID, DichVuID) 
			SELECT Max(B.ID) AS MaxID, B.DichVuID
			FROM   DVBangGia AS A INNER JOIN
				   DVBangGiaChiTiet AS B ON A.ID = B.DVBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.CuaHangID = @CuaHangID)
			GROUP BY B.DichVuID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.DichVuID, V.MaDichVu, V.HangMuc, C.DonGia
	FROM   DVBangGia AS B INNER JOIN
           DVBangGiaChiTiet AS C ON B.ID = C.DVBangGiaID INNER JOIN
           IN V_DV_BangGia_MaxID AS M ON C.ID = M.MaxID INNER JOIN
           DichVu AS V ON C.DichVuID = V.ID	
	ORDER BY V.MaDichVu
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHSI (IN KhoHangID INT,
	 IN TuNg...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHSI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanSi AS A INNER JOIN
            XeBanSiKhuyenMai AS B ON A.ID = B.XeBanSiID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURESP_VT_BANGGIA
                               ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURESP_VT_BANGGIA
                                IN DenNgay nvarchar(10),
	                            IN CuaHangID nvarchar(2)
                            BEGIN
                            BEGIN
                            SET nocount  ON
                                Declare IN V_VT_BangGia_MaxID Table(MaxID int, VatTuID int)
                                Insert @V_VT_BangGia_MaxID(MaxID, VatTuID)
                                        SELECT Max(B.ID) AS MaxID, B.VatTuID
                                        FROM   VTBangGia AS A CROSS APPLY STRING_SPLIT(CuaHangID, ',') INNER JOIN
                                               VTBangGiaChiTiet AS B ON A.ID = B.VTBangGiaID
                                        WHERE(A.ApDungTu <= @DenNgay) AND(A.ApDungDen >= @DenNgay) AND (value = @CuaHangID)
                                        GROUP BY B.VatTuID

                                SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.VatTuLoaiID, L.VatTuNhomID, C.GiaNhap, C.GiaXuat
                                FROM   VTBangGia AS B INNER JOIN
                                       VTBangGiaChiTiet AS C ON B.ID = C.VTBangGiaID INNER JOIN
                                       IN V_VT_BangGia_MaxID AS M ON C.ID = M.MaxID INNER JOIN
                                       VatTu AS V ON C.VatTuID = V.ID INNER JOIN
                                       VatTuLoai AS L ON V.VatTuLoaiID = L.ID
                            END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_NHAPKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHAC (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHAC (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapKhac AS A INNER JOIN
            DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI_TONGHOP (IN TuNgay VARCHAR(10)...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI_TONGHOP (IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanSi AS A INNER JOIN
			XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanSi AS A INNER JOIN
			XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_TONDAU (IN KhoHangID INT,
     IN DenNg...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_TONDAU (IN KhoHangID INT,
     IN DenNgay VARCHAR(10),
	 IN XeBanLeID INT,
	 IN XeBanSiID INT,
	 IN XeNoiBoID INT,
	 IN XeXuatKhacID INT
BEGIN
BEGIN
SET NOCOUNT ON
	SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.SLXuat) AS TDSLXuat
	FROM (
		
		SELECT 'A' AS MaTN, KhoHangNhapID AS KhoHangID, XeID, ID AS XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat 
		FROM XeNhapMua 
		WHERE (NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT 'B' AS TN, A.KhoHangNhapID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
		FROM XeNoiBo AS A INNER JOIN
				XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
		UNION ALL
		
		SELECT 'C' AS TN, A.KhoHangXuatID AS KhoHangID, A.XeID, A.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
		FROM XeBanLe  AS A INNER JOIN
				XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID    
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'D' AS TN, A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
		FROM XeBanSi AS A INNER JOIN
				XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
				XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
		UNION ALL
		
		SELECT 'E' AS TN, KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeBanLe     
		WHERE (NgayBan <= @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'F' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeBanSi AS A INNER JOIN
				XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeBanSiID)
		UNION ALL
		
		SELECT 'G' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeNoiBo AS A INNER JOIN
				XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeNoiBoID) 
		UNION ALL
		
		SELECT 'H' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeXuatKhac AS A INNER JOIN
				XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeXuatKhacID)
	) AS T
	GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID
END;


//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_TONKHO (IN KhoHangID int,
              ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_TONKHO (IN KhoHangID int,
                                 IN DenNgay nvarchar(10),
	                             IN XeBanLeID INT,
	                             IN XeBanSiID INT,
	                             IN XeNoiBoID INT,
	                             IN XeXuatKhacID INT
                            BEGIN
                            BEGIN
                            SET nocount  ON 
	                            Declare IN Tb_XeTonDau Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)
	                            Insert IN Tb_XeTonDau Exec SP_XE_TONDAU @KhoHangID, @DenNgay, @XeBanLeID, @XeBanSiID, @XeNoiBoID, IN XeXuatKhacID SELECT A.KhoHangID, B.KhoHangNhapID, A.XeID, X.MaXe, X.TenXe, A.XeNhapMuaID, B.KhachHangID AS NhaCungCapID, B.DonGia_CoVAT, B.NgayCT, B.SoKhung, B.SoMay, B.MaChiaKhoa, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon, B.GhiChu, B.MaChiaKhoa
	                            FROM IN Tb_XeTonDau AS A INNER JOIN
			                            XeNhapMua AS B ON A.XeNhapMuaID = B.ID INNER JOIN
			                            Xe AS X ON A.XeID = X.ID 
	                            WHERE (A.TDSLNhap - A.TDSLXuat) <>0
                            END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_NHAPXUATTON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_NHAPXUATTON (IN KhoHangID int,
	 IN TuNgay ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_NHAPXUATTON (IN KhoHangID int,
	 IN TuNgay nvarchar(10),
     IN DenNgay nvarchar(10) BEGIN BEGIN
SET nocount  ON    

	Declare IN Tb_XeTonDau Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)

	declare IN XeBanLeID int, IN XeBanSiID int, IN XeNoiBoID int
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0

	Insert IN Tb_XeTonDau Exec SP_XE_TONDAU @KhoHangID, @TuNgay, @XeBanLeID, @XeBanSiID, IN XeNoiBoID SELECT NXT.* FROM (
		SELECT 'T' AS TN, KhoHangID, XeID, XeNhapMuaID, (TDSLNhap - TDSLXuat) AS TDSL
		FROM IN Tb_XeTonDau UNION ALL
		SELECT 'B' AS TN, A.KhoHangNhapID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
		FROM XeNoiBo AS A INNER JOIN
			 XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
		WHERE A.NgayCT < IN DenNgay AND KhoHangNhapID = @KhoHangID   
	) AS NXT 
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_LICHSU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_LICHSU (IN XeNhapMuaID INT
BEGIN
BEGIN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_LICHSU (IN XeNhapMuaID INT
BEGIN
BEGIN
SET NOCOUNT ON
	
	SELECT 'A' AS MaTN, ID, KhoHangNhapID, Null AS KhoHangXuatID, XeID, ID AS XeNhapMuaID, SoCT, NgayCT, NULL AS NgayBan, CreatedBy, SoKhung, SoMay 
	FROM XeNhapMua 
	WHERE (ID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'B' AS TN, A.ID, A.KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, NULL AS NgayBan, A.CreatedBy, M.SoKhung, M.SoMay 
	FROM XeNoiBo AS A INNER JOIN
			XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID INNER JOIN
			XeNhapMua AS M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'C' AS TN, B.ID, A.KhoHangXuatID AS KhoHangNhapID, null AS KhoHangXuatID, A.XeID, A.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS NgayBan, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe  AS A INNER JOIN
			XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID INNER JOIN
			XeNhapMua AS M ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'D' AS TN, B.ID, A.KhoHangXuatID AS KhoHangNhapID, null AS KhoHangXuatID, C.XeID, C.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS NgayBan, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS A INNER JOIN
			XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID INNER JOIN
			XeNhapMua AS M ON C.XeNhapMuaID = M.ID
	WHERE (C.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'E' AS TN, A.ID, Null AS KhoHangNhapID, A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe AS A INNER JOIN
			XeNhapMua AS M ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'F' AS TN, A.ID, Null AS KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS A INNER JOIN
			XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapMua AS M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'G' AS TN, A.ID, Null AS KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeXuatKhac AS A INNER JOIN
			XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID INNER JOIN
			XeNhapMua AS M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	
	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE_TONGHOP (IN TuNgay VARCHAR(10)...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE_TONGHOP (IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 1 AS SoLuong
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN IN TuNgay AND @DenNgay) AND (XeNhapMuaID IS NOT NULL)
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 1 AS SoLuong
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN IN TuNgay AND @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (XeNhapMuaID IS NOT NULL)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_TONKHO_BY_XEID: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_TONKHO_BY_XEID (IN DenNgay VARCHAR(10),...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_TONKHO_BY_XEID (IN DenNgay VARCHAR(10),
	 IN XeID INT,
	 IN IDPhieu INT,
	 IN LoaiPhieu INT,
	 IN SoMay VARCHAR(20)
BEGIN
BEGIN
SET NOCOUNT ON
	Declare IN XeBanLeID INT,	IN XeBanSiID INT, IN XeNoiBoID INT, IN XeXuatKhacID INT
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0
	SET @XeXuatKhacID = 0

	if(@LoaiPhieu = 1)
		SET @XeBanLeID = IN IDPhieu else if(@LoaiPhieu = 2)
		SET @XeBanSiID = IN IDPhieu else if(@LoaiPhieu = 3)
		SET @XeNoiBoID = IN IDPhieu else if(@LoaiPhieu = 4)
		SET @XeXuatKhacID = IN IDPhieu Declare IN Tb_XeTonKho Table (KhoHangID int, XeID int, XeNhapMuaID int, SLNhap int, SLXuat int)

	Insert IN Tb_XeTonKho SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.SLXuat) AS TDSLXuat
		FROM (
			
			SELECT 'A' AS MaTN, KhoHangNhapID AS KhoHangID, XeID, ID AS XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat 
			FROM XeNhapMua 
			WHERE (NgayCT <= @DenNgay) AND (XeID = @XeID)
			UNION ALL
			
			SELECT 'B' AS TN, A.KhoHangNhapID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
			FROM XeNoiBo AS A INNER JOIN
					XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.IsXacNhan=1)
			UNION ALL
			
			SELECT 'C' AS TN, A.KhoHangXuatID AS KhoHangID, A.XeID, A.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
			FROM XeBanLe  AS A INNER JOIN
					XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID    
			WHERE (B.NgayCT <= @DenNgay) AND (A.XeID = @XeID) AND (A.XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'D' AS TN, A.KhoHangXuatID AS KhoHangID, C.XeID, C.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
			FROM XeBanSi AS A INNER JOIN
					XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
					XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID
			WHERE (B.NgayCT <= @DenNgay) AND (C.XeID = @XeID)
			UNION ALL
			
			SELECT 'E' AS TN, KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeBanLe     
			WHERE (NgayBan <= @DenNgay) AND (XeID = @XeID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'F' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeBanSi AS A INNER JOIN
					XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeBanSiID)
			UNION ALL
			
			SELECT 'G' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeNoiBo AS A INNER JOIN
					XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeNoiBoID) 
			UNION ALL
			
			SELECT 'F' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeXuatKhac AS A INNER JOIN
					XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeXuatKhacID)
		) AS T
		GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID

		if(LEN(@SoMay)>0)
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS SLTON,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM IN Tb_XeTonKho AS A INNER JOIN
					XeNhapMua AS B ON A.XeNhapMuaID = B.ID INNER JOIN
					Xe AS X ON A.XeID = X.ID INNER JOIN 
					KhoHang AS K ON A.KhoHangID = K.ID 
			WHERE SLNhap-SLXuat<>0 AND (B.SoMay Like N'%' + @SoMay)
		else
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS SLTON,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM IN Tb_XeTonKho AS A INNER JOIN
					XeNh
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRALE (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRALE (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanLe  AS A INNER JOIN
			XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID    
	WHERE (B.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA_GROUP (IN KhoHangID INT,
	 IN T...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA_GROUP (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, SUM(B.SoLuong) AS SoLuong, SUM(B.ThanhTien) AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS A INNER JOIN
            DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA (IN KhoHangID INT,
	 IN TuNgay ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS A INNER JOIN
            DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRASI (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRASI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanSi AS A INNER JOIN
            DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANSI (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANSI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanSi AS A INNER JOIN
            DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure uspGetChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc uspGetChiTien1
IN ID int
BEGIN
SELECT    ...' at line 1 (SQL: DELIMITER //
CREATE         proc uspGetChiTien1
IN ID int
BEGIN
SELECT        ChiTien.ID, KhachHang.TenKhachHang, ChiTienLyDo.TenLyDo, ChiTien.SoTien, TaiKhoan.TenTaiKhoan, ChiTien.GhiChu, ChiTien.CuaHangID, ChiTien.CreatedBy, 
                         ChiTien.CreatedAt, ChiTien.UpdatedBy, ChiTien.UpdatedAt
FROM            ChiTien INNER JOIN
                         KhachHang ON ChiTien.KhachHangID = KhachHang.ID INNER JOIN
                         ChiTienLyDo ON ChiTien.ChiTienLyDoID = ChiTienLyDo.ID INNER JOIN
                         TaiKhoan ON ChiTien.TaiKhoanID = TaiKhoan.ID
WHERE ChiTien.ID= @ID
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure uspChiTien2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
create         proc uspChiTien2
IN ID int,
IN Status int,
IN ...' at line 1 (SQL: DELIMITER //
create         proc uspChiTien2
IN ID int,
IN Status int,
IN ApprovalBy int
BEGIN
UPDATE ChiTien SET Status2 = @Status, Approval2By = @ApprovalBy, Approval2At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_XE_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_NHAPMUA (IN KhoHangID INT,
	 IN TuNgay ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_NHAPMUA (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT KhoHangNhapID, XeID, ID AS XeNhapMuaID, 1 AS SoLuong 
	FROM XeNhapMua 
	WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (KhoHangNhapID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure uspChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc uspChiTien1
IN ID int,
IN Status int,
IN ...' at line 1 (SQL: DELIMITER //
CREATE         proc uspChiTien1
IN ID int,
IN Status int,
IN ApprovalBy int
BEGIN
UPDATE ChiTien SET Status1 = @Status, Approval1By = @ApprovalBy, Approval1At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE_GROUP (IN KhoHangID INT,
	 IN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE_GROUP (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, SUM(B.SoLuong) AS SoLuong, SUM(B.ThanhTien) AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS A INNER JOIN
            DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure upsChiTienPowerApps: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE upsChiTienPowerApps (BEGIN
BEGIN
SET nocount ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE upsChiTienPowerApps (BEGIN
BEGIN
SET nocount  ON    
	Declare IN TuNgay VARCHAR(10), IN DenNgay VARCHAR(10)

	set @TuNgay = CONVERT(VARCHAR(10), DATEADD(DAY, -30, NOW()), 101)
	set @DenNgay = CONVERT(VARCHAR(10), NOW(), 101)

	SELECT * FROM ChiTien WHERE NgayCT between IN TuNgay and IN DenNgay END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON_KHOHANG: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //



CREATE PROCEDURE SP_VT_GET_GIAVON_KHOHANG (IN TuNgay VARCHA...' at line 1 (SQL: DELIMITER //



CREATE PROCEDURE SP_VT_GET_GIAVON_KHOHANG (IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10),
	 IN KhoHangID int,
	 IN VatTuID int
BEGIN
BEGIN
SET NOCOUNT ON
	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	Declare IN Tb_VTTonDau Table (KhoHangID int, VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS KhoHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS KhoHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
				XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		
		
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.SoPhieu, A.KhoHangXuatID, A.KhachHangID, B.NgayXuat, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS A INNER JOIN
            DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure spCheckPhieuChi: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE spCheckPhieuChi ((
		IN khohangID varchar(10)...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE spCheckPhieuChi ((
		IN khohangID varchar(10)
) BEGIN Begin
				select	* from ChiTien
				where	KhoHangID = IN khohangID  END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_FIX_SLVT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_FIX_SLVT (BEGIN
BEGIN
SET nocount  ON    ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_FIX_SLVT (BEGIN
BEGIN
SET nocount  ON    
	Declare IN Tb_SLVT Table (DVBanLeID int, SoLuongVT float)

	Insert @Tb_SLVT(DVBanLeID, SoLuongVT) 
	select DVBanLeID, Sum(SoLuong) AS SoLuongVT from DVBanLeVatTu group by DVBanLeID
	
	UPDATE DVBanLe 
    SET DVBanLe.TongSoLuongVatTu = B.SoLuongVT            
	FROM DVBanLe INNER JOIN IN Tb_SLVT AS B ON DVBanLe.ID = B.DVBanLeID 
	where B.SoLuongVT is not null
	
 
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_TC_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_TC_TONDAU (IN TaiKhoanID INT,
             ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_TC_TONDAU (IN TaiKhoanID INT,
                                 IN TuNgay VARCHAR(10),
	                             IN DenNgay VARCHAR(10)	 
                            BEGIN
                            BEGIN
                            SET NOCOUNT ON
	                            SELECT T.TaiKhoanID, T.TacNghiep, SUM(T.SoTien) AS SoTien
	                            FROM (
		                            
		                            SELECT 1 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM XeBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 2 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM XeBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 3 AS MaTN, TaiKhoanID, SUM(GiaNhap) AS SoTien, 1 AS TacNghiep
		                            FROM XeSonXe 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 4 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, 0 AS TacNghiep
		                            FROM ThuTien 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 5 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, 1 AS TacNghiep
		                            FROM ChiTien 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 6 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM DVBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 7 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM DVBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 8 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM DVBanBuonThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 9 AS MaTN, T.TaiKhoanID, SUM(G.ChiPhi) AS SoTien, 1 AS TacNghiep 
                                    FROM DVBanLe AS A INNER JOIN 
                                        KhoHang AS K ON A.KhoHangXuatID = K.ID INNER JOIN 
	
//
DELIMITER ;)  
[2024-07-18 16:40:16] local.ERROR: Error creating stored procedure SP_VT_NHAPTRABUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRABUON (IN KhoHangID INT,
	 IN TuN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRABUON (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanBuon AS A INNER JOIN
            DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanbuonID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATBANBUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANBUON (IN KhoHangID INT,
	 IN TuN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANBUON (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanBuon AS A INNER JOIN
            DVBanBuonVatTu AS B ON A.ID = B.DVBanBuonID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC_TONGHOP (IN TuNgay VARCHAR(10),...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC_TONGHOP (IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeXuatKhac AS A INNER JOIN
			XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeXuatKhac AS A INNER JOIN
			XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_BANGGIA2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_BANGGIA2 (IN DenNgay nvarchar(20),
	 IN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_BANGGIA2 (IN DenNgay nvarchar(20),
	 IN XeNhapMuaID int,
	 IN TenType nvarchar(50) BEGIN BEGIN
SET nocount  ON    
	Declare IN TenModel nvarchar(30)

	
	SELECT		@TenModel = X.TenModel FROM XeNhapMua AS M INNER JOIN Xe AS X ON M.XeID = X.ID INNER JOIN V_XeThayVanh AS TV ON M.ID = TV.XeNhapMuaID 
	WHERE		TV.XeNhapMuaID = IN XeNhapMuaID GROUP BY	X.TenModel	

	
	Declare IN V_Xe_BangGia_MaxID Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT  MAX(B.ID) AS MaxID, B.XeID
			FROM    XeBangGia AS A INNER JOIN
                    XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID INNER JOIN
                    Xe AS X ON B.XeID = X.ID
			WHERE   (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive = 1) AND (X.TenModel = @TenModel) AND (X.TenType = @TenType)
			GROUP BY B.XeID, X.TenModel, X.TenType

	
	SELECT TOP (1) X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	FROM   XeBangGia AS B INNER JOIN
           XeBangGiaChiTiet AS C ON B.ID = C.XeBangGiaID INNER JOIN
           IN V_Xe_BangGia_MaxID AS V ON C.ID = V.MaxID INNER JOIN
           Xe AS X ON C.XeID = X.ID	
	GROUP BY X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	ORDER BY C.GiaHaiQuan DESC
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATKMDV: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMDV (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMDV (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            DVBanLe AS A INNER JOIN
            DVBanLeKhuyenMai AS B ON A.ID = B.DVBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure dt_setpropertybyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_setpropertybyid (IN id int,
	IN property ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_setpropertybyid (IN id int,
	IN property varchar(64),
	IN value varchar(255),
	IN lvalue image
BEGIN
	set nocount on
	declare IN uvalue nvarchar(255) 
	set @uvalue = convert(nvarchar(255), @value) 
	if exists (select * from dtproperties 
			where objectid=IN id and property=@property) BEGIN update dtproperties set value=@value, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=IN id and property=IN property END;
	else
	begin
		
		
		
		insert dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @value, @uvalue, @lvalue)
	 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure dt_getpropertiesbyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid_u (IN id int,
	IN prope...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid_u (IN id int,
	IN property varchar(64)
BEGIN
	set nocount on

	if (IN property is null) or (@property = '')
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure dt_getpropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid (IN id int,
	IN propert...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid (IN id int,
	IN property varchar(64)
BEGIN
	set nocount on

	if (IN property is null) or (@property = '')
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure dt_getobjwithprop_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getobjwithprop_u (IN property varchar(30),...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getobjwithprop_u (IN property varchar(30),
	IN uvalue nvarchar(255) BEGIN set nocount on

	if (IN property is null) or (@property = '')
	begin
		raiserror('Must specify a property name.',-1,-1)
		return (1)
	 END;

	if (IN uvalue is null)
		select objectid id from dtproperties
			where property=IN property else
		select objectid id from dtproperties
			where property=IN property and uvalue=@uvalue
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure dt_getobjwithprop: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getobjwithprop (IN property varchar(30),
...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getobjwithprop (IN property varchar(30),
	IN value varchar(255) BEGIN set nocount on

	if (IN property is null) or (@property = '')
	begin
		raiserror('Must specify a property name.',-1,-1)
		return (1)
	 END;

	if (IN value is null)
		select objectid id from dtproperties
			where property=IN property else
		select objectid id from dtproperties
			where property=IN property and value=@value
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure dt_generateansiname: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
 
CREATE PROCEDURE dt_generateansiname ((IN name varchar(255) o...' at line 1 (SQL: DELIMITER //
 
CREATE PROCEDURE dt_generateansiname ((IN name varchar(255) output) BEGIN declare IN prologue varchar(20) 
	declare IN indexstring varchar(20) 
	declare IN index integer 
 
	set @prologue = 'MSDT-A-' 
	set @index = 1 
 
	while 1 = 1 
	begin 
		set @indexstring = cast(IN index as varchar(20)) 
		set @name = @prologue + IN indexstring if not exists (select value from dtproperties where value = @name) 
			break 
		 
		set @index = @index + 1 
 
		if (@index = 10000) 
			goto TooMany 
	 END; 
 
Leave: 
 
	return 
 
TooMany: 
 
	set @name = 'DIAGRAM' 
	goto Leave
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure dt_setpropertybyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_setpropertybyid_u (IN id int,
	IN propert...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_setpropertybyid_u (IN id int,
	IN property varchar(64),
	IN uvalue nvarchar(255),
	IN lvalue image
BEGIN
	set nocount on
	
	
	
	
	declare IN avalue varchar(255) 
	set @avalue = null 
	if (IN uvalue is not null) BEGIN if (convert(nvarchar(255), convert(varchar(255), @uvalue)) = @uvalue) 
		begin 
			set @avalue = convert(varchar(255), @uvalue) 
		END; 
		else 
		begin 
			if 'DtgSchemaNAME' = IN property begin 
				exec dt_generateansiname IN avalue output 
			END; 
		END; 
	END; 
	if exists (select * from dtproperties 
			where objectid=IN id and property=@property)
	begin
		
		
		
		update dtproperties set value=@avalue, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=IN id and property=IN property END;
	else
	begin
		
		
		
		insert dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @avalue, @uvalue, @lvalue)
	 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_Old (IN KhoHangID INT,
	 IN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_Old (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS A INNER JOIN
            XePhuKienChiTiet AS B ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 1) AND (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure dt_dropuserobjectbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_dropuserobjectbyid (IN id int
BEGIN
	set...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_dropuserobjectbyid (IN id int
BEGIN
	set nocount on
	delete from dtproperties where objectid=@id
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN (IN KhoHangID INT,
	 IN TuN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS A INNER JOIN
            XePhuKienChiTiet AS B ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 0) AND (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure dt_droppropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_droppropertiesbyid (IN id int,
	IN proper...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_droppropertiesbyid (IN id int,
	IN property varchar(64)
BEGIN
	set nocount on

	if (IN property is null) or (@property = '')
		delete from dtproperties where objectid=IN id else
		delete from dtproperties 
			where objectid=IN id and property=@property
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure dt_adduserobject: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_adduserobject (BEGIN
	set nocount on
	
...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_adduserobject (BEGIN
	set nocount on
	
	begin transaction
		insert dtproperties (property) VALUES ('DtgSchemaOBJECT')
		update dtproperties set objectid=@IN identity where id=@IN identity and property='DtgSchemaOBJECT'
	commit
	return @@identity
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKHAC (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKHAC (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVXuatKhac AS A INNER JOIN
			DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
			VatTu AS V ON B.VatTuID = V.ID INNER JOIN
			VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATDOIDONVI (IN KhoHangID INT,
	 IN Tu...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATDOIDONVI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, A.SoLuong, A.DonGia, A.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS A INNER JOIN
            VatTu AS V ON A.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_BANGGIA (IN DenNgay nvarchar(20) BEGIN BE...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_BANGGIA (IN DenNgay nvarchar(20) BEGIN BEGIN
SET nocount  ON    
	Declare IN V_Xe_BangGia_MaxID Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT Max(B.ID) AS MaxID, B.XeID
			FROM   XeBangGia AS A INNER JOIN
				   XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive =1)
			GROUP BY B.XeID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.XeID, C.SoKhung, C.SoMay, X.MaXe, X.TenXe, X.SortDoiXe, X.SortLoaiXe, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, c.GiaApThue
	FROM   XeBangGia AS B INNER JOIN
           XeBangGiaChiTiet AS C ON B.ID = C.XeBangGiaID INNER JOIN
           IN V_Xe_BangGia_MaxID AS V ON C.ID = V.MaxID INNER JOIN
           Xe AS X ON C.XeID = X.ID	
	ORDER BY X.SortDoiXe
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON2 (IN TuNgay VARCHAR(10),	 ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON2 (IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 
BEGIN
BEGIN
SET NOCOUNT ON
	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	
	FROM (
		
		SELECT	1 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	2 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	3 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	5 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	6 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  8 as a, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  9 as a, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)		
		UNION ALL
		
		SELECT	10 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	11 as a, B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	12 as a, B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanSi AS A INNER JOIN
				DVBanSiVatTu AS B ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON (IN TuNgay VARCHAR(10),	 ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON (IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 
BEGIN
BEGIN
SET NOCOUNT ON
	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat,
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_TONDAU_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU_ALL (IN KhoHangID INT,
     IN D...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU_ALL (IN KhoHangID INT,
     IN DenNgay VARCHAR(10)
BEGIN
BEGIN
SET NOCOUNT ON
	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'	

	SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.TienNhap) AS TDTienNhap, SUM(T.SLXuat) AS TDSLXuat, SUM(T.TienXuat) AS TDTienXuat 
	FROM (
		
		SELECT	'N01' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N02' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N03' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N04' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNoiBo AS A INNER JOIN
				DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT	'N05' AS MaTN, A.KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID)
		UNION ALL
		
		SELECT	'N06' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT  'N07' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNoiBo AS A INNER JOIN
                XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT  'N08' AS MaTN, A.KhoHangXuatID AS KhoHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON A.ID = B.XeBanLeID INNER JOIN
				Va
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL_TEST (IN KhoHangID int,
     ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL_TEST (IN KhoHangID int,
     IN DenNgay nvarchar(10) BEGIN BEGIN
SET nocount  ON    
	Declare IN Tb_VTTonDau Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert IN Tb_VTTonDau Exec SP_VT_TONDAU_ALL @KhoHangID, IN DenNgay SELECT A.KhoHangID AS KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, A.TDSLNhap, A.TDSLXuat, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon
	FROM IN Tb_VTTonDau AS A INNER JOIN
			VatTu AS V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) < 0
	order by  A.VatTuID

	
	
	
	
	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_XUATNOIBO (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_XUATNOIBO (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeNoiBo AS A INNER JOIN
			XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.IsXacNhan=1)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL (IN KhoHangID int,
     IN De...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL (IN KhoHangID int,
     IN DenNgay nvarchar(10) BEGIN BEGIN
SET nocount  ON    
	Declare IN Tb_VTTonDau Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert IN Tb_VTTonDau Exec SP_VT_TONDAU_ALL @KhoHangID, IN DenNgay SELECT A.KhoHangID AS KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon
	FROM IN Tb_VTTonDau AS A INNER JOIN
			VatTu AS V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_NHAPNOIBO (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_NHAPNOIBO (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeNoiBo AS A INNER JOIN
			XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU (IN KhoHangID INT,
     IN DenNg...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU (IN KhoHangID INT,
     IN DenNgay VARCHAR(10),	 
	 IN VatTuID INT,
	 IN MaTacNghiep VARCHAR(1),
	 IN IDTacNghiep INT
BEGIN
BEGIN
	SET NOCOUNT ON
	DECLARE IN NgayBatDauSuDung VARCHAR(10), 
		IN DVBanLeID INT, IN DVBanSiID INT, IN DVNoiBoID INT, IN DoiDonViID INT, IN DVXuatKhacID INT, IN XeBanLeKMID INT, 
		IN DVBanLeKMID INT, IN XePhuKienID INT, IN XePhuKienNoiBoID INT, IN DVBanBuonID INT, IN XeBanSiKMID INT, IN XeBanLeBHID INT
	SET @NgayBatDauSuDung = '2019-12-19'
	SET @DVBanLeID = 0 	
	SET @DVBanSiID = 0
	SET @DVNoiBoID = 0
	SET @DoiDonViID = 0
	SET @DVXuatKhacID = 0
	SET @XeBanLeKMID = 0
	SET @DVBanLeKMID = 0
	SET @XePhuKienID = 0
	SET @XePhuKienNoiBoID = 0
	SET @DVBanBuonID = 0
	SET @XeBanSiKMID = 0
	SET @XeBanLeBHID = 0

	IF(@MaTacNghiep ='I')			SET @DVBanLeID = IN IDTacNghiep ELSE IF(@MaTacNghiep='J')		SET @DVBanSiID = IN IDTacNghiep ELSE IF(@MaTacNghiep='K')		SET @DVNoiBoID = IN IDTacNghiep ELSE IF(@MaTacNghiep='L')		SET @DoiDonViID = IN IDTacNghiep ELSE IF(@MaTacNghiep='M')		SET @DVXuatKhacID = IN IDTacNghiep ELSE IF(@MaTacNghiep='N')		SET @XeBanLeKMID = IN IDTacNghiep ELSE IF(@MaTacNghiep='O')		SET @DVBanLeKMID = IN IDTacNghiep ELSE IF(@MaTacNghiep='P')		SET @XePhuKienID = IN IDTacNghiep ELSE IF(@MaTacNghiep='Q')		SET @XePhuKienNoiBoID = IN IDTacNghiep ELSE IF(@MaTacNghiep='R')		SET @DVBanBuonID = IN IDTacNghiep ELSE IF(@MaTacNghiep='S')		SET @XeBanSiKMID = IN IDTacNghiep ELSE IF(@MaTacNghiep='T')		SET @XeBanLeBHID = IN IDTacNghiep SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.TienNhap) AS TDTienNhap, SUM(T.SLXuat) AS TDSLXuat, SUM(T.TienXuat) AS TDTienXuat 
	FROM (
		
		SELECT	'N01' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNoiBo AS A INNER JOIN
				DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS MaTN, A.KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATNOIBO (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATNOIBO (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS A INNER JOIN
            DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	
	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO (IN KhoHangID INT,
     IN DenNga...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO (IN KhoHangID INT,
     IN DenNgay nvarchar(10),
	 IN VatTuID INT,
	 IN MaTacNghiep VARCHAR(1),
	 IN IDTacNghiep INT
BEGIN
BEGIN
	SET NOCOUNT  ON    
	DECLARE IN Tb_VTTonDau Table (KhoHangID INT, VatTuID INT, TDSLNhap INT, TDTienNhap FLOAT, TDSLXuat INT, TDTienXuat FLOAT)
	INSERT IN Tb_VTTonDau Exec SP_VT_TONDAU @KhoHangID, @DenNgay, @VatTuID, @MaTacNghiep, IN IDTacNghiep SELECT A.KhoHangID AS KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon
	FROM IN Tb_VTTonDau AS A INNER JOIN
			VatTu AS V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPNOIBO (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPNOIBO (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS A INNER JOIN
            DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.IsXacNhan = 1) AND (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_SELECT_GIAVON_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_SELECT_GIAVON_TEST (IN TuNgay VARCHAR(10...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_SELECT_GIAVON_TEST (IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 
BEGIN
BEGIN
SET NOCOUNT ON
	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, (1 - A.TyLeCK*0.01) * B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, 1 AS SLNhap, C.GiaBanBH AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLeBaoHiem AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanSi AS A INNER JOIN
				DVBanSiVatTu AS B ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT < @TuNgay)
		UNION ALL
		
		SELECT  VatTuID, 0 AS SLNhap, 0 AS TienNhap, SoLuong AS SLXuat, ThanhTien AS TienXuat
		FROM    DoiDonVi AS A    
	
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_NHAPXUAT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPXUAT (IN KhoHangID INT,
	 IN VatTuI...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPXUAT (IN KhoHangID INT,
	 IN VatTuID INT,
	 IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10)	 	 
BEGIN
BEGIN
	SET NOCOUNT ON
	SELECT T.SoCT, T.NgayCT, T.NgayNXK, T.KhoHangNhapID, T.KhoHangXuatID, T.KhachHangID, T.VatTuID, T.SLNhap, T.SLXuat 
	FROM (
		
		SELECT	'N01' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, A.KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, C.KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
                DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
                DVBanLe AS C ON A.DVBanLeID = C.ID   
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, C.KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
                DVBanSi AS C ON A.DVBanSiID = C.ID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, A.KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNoiBo AS A INNER JOIN
				DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangID AS KhoHangNhapID, NULL AS KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N06' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  'N07' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNoiBo AS A INNER JOIN
                XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID
		WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)		
		UNION ALL
		
		SELECT  'N08' AS MaTN, B.SoCT, B.NgayCT, B.NgayCT AS NgayNXK, A.KhoHangXuatID AS KhoHangNhapID, NULL AS KhoHangXuatID, a.KhachHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_NHAPDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPDOIDONVI (IN KhoHangID INT,
	 IN Tu...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPDOIDONVI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS A INNER JOIN
            DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XECHUYENKHO (IN KhoHangID IN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XECHUYENKHO (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS A INNER JOIN
            XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
	
	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_GET_GIAVON (IN TuNgay VARCHAR(10),	 
  ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_GET_GIAVON (IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10),
	 IN VatTuID int
BEGIN
BEGIN
SET NOCOUNT ON
	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare IN Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.Nga
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_XECHUYENKHO (IN KhoHangID IN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_XECHUYENKHO (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID AS KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS A INNER JOIN
            XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan = 1)
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_DELETE_DUPLICATE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_DELETE_DUPLICATE (IN VatTuID_DEL int,	 ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_DELETE_DUPLICATE (IN VatTuID_DEL int,	 
     IN VatTuID int	 
BEGIN
BEGIN
SET NOCOUNT ON
	update DoiDonVi						set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DoiDonViChiTiet				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVBanLeVatTu					set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVBanSiVatTu					set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapKhacVatTu				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapMuaVatTu				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapTraLaiBanLeChiTiet		set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNhapTraLaiBanSiChiTiet		set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVNoiBoVatTu					set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update DVXuatKhacVatTu				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update VTBangGiaChiTiet				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeBanLeKhuyenMai				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeBanLePhuKien				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeNhapTraLaiBanLeKhuyenMai	set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeNhapTraLaiBanLePhuKien		set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XeNoiBoPhuKien				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL update XePhuKienChiTiet				set VATTUID = IN VatTuID WHERE VATTUID = IN VatTuID_DEL Delete VatTu where (ID = @VatTuID_DEL)

END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XEBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XEBANLE (IN KhoHangID INT,
...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XEBANLE (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, b.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeBanLe AS A INNER JOIN
            XeBanLePhuKien AS B ON A.ID = B.XeBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE   (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHLE (IN KhoHangID INT,
	 IN TuNg...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHLE (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS A INNER JOIN
            XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure dt_verstamp007: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_verstamp007 (BEGIN
	select 7005
//
DELIMITER' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_verstamp007 (BEGIN
	select 7005
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATKMBH_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBH_Old (IN KhoHangID INT,
	 IN Tu...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBH_Old (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS A INNER JOIN
            XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure dt_verstamp006: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_verstamp006 (BEGIN
	select 7000
//
DELIMITER' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_verstamp006 (BEGIN
	select 7000
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATBAOHIEM_BHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBAOHIEM_BHLE (IN KhoHangID INT,
	 I...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBAOHIEM_BHLE (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, B.NgayXuat AS NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, 1 AS SoLuong, B.GiaBanBH, B.GiaBanBH AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS A INNER JOIN
            XeBanLeBaoHiem AS B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_TRALAI (IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_TRALAI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  B.ID, B.SoCT, C.NgayNhap AS NgayCT, A.KhoHangXuatID AS KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS B INNER JOIN
            XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_NHAPKHUYENMAI_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHUYENMAI_TRALAI (IN KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHUYENMAI_TRALAI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  B.ID, B.SoCT, B.NgayCT, A.KhoHangXuatID AS KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS B INNER JOIN
            XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRASI (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRASI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanSi AS A INNER JOIN
			XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID
	WHERE (B.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.XeNhapMuaID IS NOT NULL)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_NHAPBAOHIEM_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPBAOHIEM_TRALAI (IN KhoHangID INT,
	...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPBAOHIEM_TRALAI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  B.ID, B.SoCT, C.NgayNhap AS NgayCT, A.KhoHangXuatID AS KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, 1 AS SoLuong, C.GiaBanBH AS DonGia, C.GiaBanBH AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS B INNER JOIN
            XeNhapTraLaiBanLeBaoHiem AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRALE (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRALE (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanLe AS A INNER JOIN
            DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_TEST_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_TEST_1 (BEGIN
BEGIN
SET NOCOUNT ON
	selec...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_TEST_1 (BEGIN
BEGIN
SET NOCOUNT ON
	select count(ID) as 'VT' from VatTu
END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_TEST (IN VatTuID INT     
BEGIN
BEGIN
SET...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_TEST (IN VatTuID INT     
BEGIN
BEGIN
SET NOCOUNT ON
	
	

	
	
	
	
	
	
	select * from VatTu where ID = IN VatTuID END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_DV_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_DV_BANGGIA (IN DenNgay nvarchar(10),
	 IN C...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_DV_BANGGIA (IN DenNgay nvarchar(10),
	 IN CuaHangID nvarchar(2) BEGIN BEGIN
SET nocount  ON    
	Declare IN V_DV_BangGia_MaxID Table (MaxID int, DichVuID int)
	Insert @V_DV_BangGia_MaxID(MaxID, DichVuID) 
			SELECT Max(B.ID) AS MaxID, B.DichVuID
			FROM   DVBangGia AS A INNER JOIN
				   DVBangGiaChiTiet AS B ON A.ID = B.DVBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.CuaHangID = @CuaHangID)
			GROUP BY B.DichVuID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.DichVuID, V.MaDichVu, V.HangMuc, C.DonGia
	FROM   DVBangGia AS B INNER JOIN
           DVBangGiaChiTiet AS C ON B.ID = C.DVBangGiaID INNER JOIN
           IN V_DV_BangGia_MaxID AS M ON C.ID = M.MaxID INNER JOIN
           DichVu AS V ON C.DichVuID = V.ID	
	ORDER BY V.MaDichVu
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHSI (IN KhoHangID INT,
	 IN TuNg...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHSI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanSi AS A INNER JOIN
            XeBanSiKhuyenMai AS B ON A.ID = B.XeBanSiID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURESP_VT_BANGGIA
                               ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURESP_VT_BANGGIA
                                IN DenNgay nvarchar(10),
	                            IN CuaHangID nvarchar(2)
                            BEGIN
                            BEGIN
                            SET nocount  ON
                                Declare IN V_VT_BangGia_MaxID Table(MaxID int, VatTuID int)
                                Insert @V_VT_BangGia_MaxID(MaxID, VatTuID)
                                        SELECT Max(B.ID) AS MaxID, B.VatTuID
                                        FROM   VTBangGia AS A CROSS APPLY STRING_SPLIT(CuaHangID, ',') INNER JOIN
                                               VTBangGiaChiTiet AS B ON A.ID = B.VTBangGiaID
                                        WHERE(A.ApDungTu <= @DenNgay) AND(A.ApDungDen >= @DenNgay) AND (value = @CuaHangID)
                                        GROUP BY B.VatTuID

                                SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.VatTuLoaiID, L.VatTuNhomID, C.GiaNhap, C.GiaXuat
                                FROM   VTBangGia AS B INNER JOIN
                                       VTBangGiaChiTiet AS C ON B.ID = C.VTBangGiaID INNER JOIN
                                       IN V_VT_BangGia_MaxID AS M ON C.ID = M.MaxID INNER JOIN
                                       VatTu AS V ON C.VatTuID = V.ID INNER JOIN
                                       VatTuLoai AS L ON V.VatTuLoaiID = L.ID
                            END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_NHAPKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHAC (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHAC (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapKhac AS A INNER JOIN
            DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI_TONGHOP (IN TuNgay VARCHAR(10)...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI_TONGHOP (IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanSi AS A INNER JOIN
			XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanSi AS A INNER JOIN
			XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_TONDAU (IN KhoHangID INT,
     IN DenNg...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_TONDAU (IN KhoHangID INT,
     IN DenNgay VARCHAR(10),
	 IN XeBanLeID INT,
	 IN XeBanSiID INT,
	 IN XeNoiBoID INT,
	 IN XeXuatKhacID INT
BEGIN
BEGIN
SET NOCOUNT ON
	SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.SLXuat) AS TDSLXuat
	FROM (
		
		SELECT 'A' AS MaTN, KhoHangNhapID AS KhoHangID, XeID, ID AS XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat 
		FROM XeNhapMua 
		WHERE (NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT 'B' AS TN, A.KhoHangNhapID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
		FROM XeNoiBo AS A INNER JOIN
				XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
		UNION ALL
		
		SELECT 'C' AS TN, A.KhoHangXuatID AS KhoHangID, A.XeID, A.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
		FROM XeBanLe  AS A INNER JOIN
				XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID    
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'D' AS TN, A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
		FROM XeBanSi AS A INNER JOIN
				XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
				XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
		UNION ALL
		
		SELECT 'E' AS TN, KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeBanLe     
		WHERE (NgayBan <= @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'F' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeBanSi AS A INNER JOIN
				XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeBanSiID)
		UNION ALL
		
		SELECT 'G' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeNoiBo AS A INNER JOIN
				XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeNoiBoID) 
		UNION ALL
		
		SELECT 'H' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeXuatKhac AS A INNER JOIN
				XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeXuatKhacID)
	) AS T
	GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID
END;


//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_TONKHO (IN KhoHangID int,
              ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_TONKHO (IN KhoHangID int,
                                 IN DenNgay nvarchar(10),
	                             IN XeBanLeID INT,
	                             IN XeBanSiID INT,
	                             IN XeNoiBoID INT,
	                             IN XeXuatKhacID INT
                            BEGIN
                            BEGIN
                            SET nocount  ON 
	                            Declare IN Tb_XeTonDau Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)
	                            Insert IN Tb_XeTonDau Exec SP_XE_TONDAU @KhoHangID, @DenNgay, @XeBanLeID, @XeBanSiID, @XeNoiBoID, IN XeXuatKhacID SELECT A.KhoHangID, B.KhoHangNhapID, A.XeID, X.MaXe, X.TenXe, A.XeNhapMuaID, B.KhachHangID AS NhaCungCapID, B.DonGia_CoVAT, B.NgayCT, B.SoKhung, B.SoMay, B.MaChiaKhoa, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon, B.GhiChu, B.MaChiaKhoa
	                            FROM IN Tb_XeTonDau AS A INNER JOIN
			                            XeNhapMua AS B ON A.XeNhapMuaID = B.ID INNER JOIN
			                            Xe AS X ON A.XeID = X.ID 
	                            WHERE (A.TDSLNhap - A.TDSLXuat) <>0
                            END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_NHAPXUATTON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_NHAPXUATTON (IN KhoHangID int,
	 IN TuNgay ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_NHAPXUATTON (IN KhoHangID int,
	 IN TuNgay nvarchar(10),
     IN DenNgay nvarchar(10) BEGIN BEGIN
SET nocount  ON    

	Declare IN Tb_XeTonDau Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)

	declare IN XeBanLeID int, IN XeBanSiID int, IN XeNoiBoID int
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0

	Insert IN Tb_XeTonDau Exec SP_XE_TONDAU @KhoHangID, @TuNgay, @XeBanLeID, @XeBanSiID, IN XeNoiBoID SELECT NXT.* FROM (
		SELECT 'T' AS TN, KhoHangID, XeID, XeNhapMuaID, (TDSLNhap - TDSLXuat) AS TDSL
		FROM IN Tb_XeTonDau UNION ALL
		SELECT 'B' AS TN, A.KhoHangNhapID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
		FROM XeNoiBo AS A INNER JOIN
			 XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
		WHERE A.NgayCT < IN DenNgay AND KhoHangNhapID = @KhoHangID   
	) AS NXT 
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_LICHSU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_LICHSU (IN XeNhapMuaID INT
BEGIN
BEGIN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_LICHSU (IN XeNhapMuaID INT
BEGIN
BEGIN
SET NOCOUNT ON
	
	SELECT 'A' AS MaTN, ID, KhoHangNhapID, Null AS KhoHangXuatID, XeID, ID AS XeNhapMuaID, SoCT, NgayCT, NULL AS NgayBan, CreatedBy, SoKhung, SoMay 
	FROM XeNhapMua 
	WHERE (ID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'B' AS TN, A.ID, A.KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, NULL AS NgayBan, A.CreatedBy, M.SoKhung, M.SoMay 
	FROM XeNoiBo AS A INNER JOIN
			XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID INNER JOIN
			XeNhapMua AS M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'C' AS TN, B.ID, A.KhoHangXuatID AS KhoHangNhapID, null AS KhoHangXuatID, A.XeID, A.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS NgayBan, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe  AS A INNER JOIN
			XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID INNER JOIN
			XeNhapMua AS M ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'D' AS TN, B.ID, A.KhoHangXuatID AS KhoHangNhapID, null AS KhoHangXuatID, C.XeID, C.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS NgayBan, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS A INNER JOIN
			XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID INNER JOIN
			XeNhapMua AS M ON C.XeNhapMuaID = M.ID
	WHERE (C.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'E' AS TN, A.ID, Null AS KhoHangNhapID, A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe AS A INNER JOIN
			XeNhapMua AS M ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'F' AS TN, A.ID, Null AS KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS A INNER JOIN
			XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapMua AS M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'G' AS TN, A.ID, Null AS KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeXuatKhac AS A INNER JOIN
			XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID INNER JOIN
			XeNhapMua AS M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	
	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE_TONGHOP (IN TuNgay VARCHAR(10)...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE_TONGHOP (IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 1 AS SoLuong
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN IN TuNgay AND @DenNgay) AND (XeNhapMuaID IS NOT NULL)
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 1 AS SoLuong
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN IN TuNgay AND @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (XeNhapMuaID IS NOT NULL)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_TONKHO_BY_XEID: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_TONKHO_BY_XEID (IN DenNgay VARCHAR(10),...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_TONKHO_BY_XEID (IN DenNgay VARCHAR(10),
	 IN XeID INT,
	 IN IDPhieu INT,
	 IN LoaiPhieu INT,
	 IN SoMay VARCHAR(20)
BEGIN
BEGIN
SET NOCOUNT ON
	Declare IN XeBanLeID INT,	IN XeBanSiID INT, IN XeNoiBoID INT, IN XeXuatKhacID INT
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0
	SET @XeXuatKhacID = 0

	if(@LoaiPhieu = 1)
		SET @XeBanLeID = IN IDPhieu else if(@LoaiPhieu = 2)
		SET @XeBanSiID = IN IDPhieu else if(@LoaiPhieu = 3)
		SET @XeNoiBoID = IN IDPhieu else if(@LoaiPhieu = 4)
		SET @XeXuatKhacID = IN IDPhieu Declare IN Tb_XeTonKho Table (KhoHangID int, XeID int, XeNhapMuaID int, SLNhap int, SLXuat int)

	Insert IN Tb_XeTonKho SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.SLXuat) AS TDSLXuat
		FROM (
			
			SELECT 'A' AS MaTN, KhoHangNhapID AS KhoHangID, XeID, ID AS XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat 
			FROM XeNhapMua 
			WHERE (NgayCT <= @DenNgay) AND (XeID = @XeID)
			UNION ALL
			
			SELECT 'B' AS TN, A.KhoHangNhapID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
			FROM XeNoiBo AS A INNER JOIN
					XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.IsXacNhan=1)
			UNION ALL
			
			SELECT 'C' AS TN, A.KhoHangXuatID AS KhoHangID, A.XeID, A.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
			FROM XeBanLe  AS A INNER JOIN
					XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID    
			WHERE (B.NgayCT <= @DenNgay) AND (A.XeID = @XeID) AND (A.XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'D' AS TN, A.KhoHangXuatID AS KhoHangID, C.XeID, C.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
			FROM XeBanSi AS A INNER JOIN
					XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
					XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID
			WHERE (B.NgayCT <= @DenNgay) AND (C.XeID = @XeID)
			UNION ALL
			
			SELECT 'E' AS TN, KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeBanLe     
			WHERE (NgayBan <= @DenNgay) AND (XeID = @XeID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'F' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeBanSi AS A INNER JOIN
					XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeBanSiID)
			UNION ALL
			
			SELECT 'G' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeNoiBo AS A INNER JOIN
					XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeNoiBoID) 
			UNION ALL
			
			SELECT 'F' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeXuatKhac AS A INNER JOIN
					XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeXuatKhacID)
		) AS T
		GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID

		if(LEN(@SoMay)>0)
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS SLTON,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM IN Tb_XeTonKho AS A INNER JOIN
					XeNhapMua AS B ON A.XeNhapMuaID = B.ID INNER JOIN
					Xe AS X ON A.XeID = X.ID INNER JOIN 
					KhoHang AS K ON A.KhoHangID = K.ID 
			WHERE SLNhap-SLXuat<>0 AND (B.SoMay Like N'%' + @SoMay)
		else
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS SLTON,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM IN Tb_XeTonKho AS A INNER JOIN
					XeNh
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRALE (IN KhoHangID INT,
	 IN TuNgay...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRALE (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanLe  AS A INNER JOIN
			XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID    
	WHERE (B.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA_GROUP (IN KhoHangID INT,
	 IN T...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA_GROUP (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, SUM(B.SoLuong) AS SoLuong, SUM(B.ThanhTien) AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS A INNER JOIN
            DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA (IN KhoHangID INT,
	 IN TuNgay ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS A INNER JOIN
            DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRASI (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRASI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanSi AS A INNER JOIN
            DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANSI (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANSI (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanSi AS A INNER JOIN
            DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure uspGetChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc uspGetChiTien1
IN ID int
BEGIN
SELECT    ...' at line 1 (SQL: DELIMITER //
CREATE         proc uspGetChiTien1
IN ID int
BEGIN
SELECT        ChiTien.ID, KhachHang.TenKhachHang, ChiTienLyDo.TenLyDo, ChiTien.SoTien, TaiKhoan.TenTaiKhoan, ChiTien.GhiChu, ChiTien.CuaHangID, ChiTien.CreatedBy, 
                         ChiTien.CreatedAt, ChiTien.UpdatedBy, ChiTien.UpdatedAt
FROM            ChiTien INNER JOIN
                         KhachHang ON ChiTien.KhachHangID = KhachHang.ID INNER JOIN
                         ChiTienLyDo ON ChiTien.ChiTienLyDoID = ChiTienLyDo.ID INNER JOIN
                         TaiKhoan ON ChiTien.TaiKhoanID = TaiKhoan.ID
WHERE ChiTien.ID= @ID
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure uspChiTien2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
create         proc uspChiTien2
IN ID int,
IN Status int,
IN ...' at line 1 (SQL: DELIMITER //
create         proc uspChiTien2
IN ID int,
IN Status int,
IN ApprovalBy int
BEGIN
UPDATE ChiTien SET Status2 = @Status, Approval2By = @ApprovalBy, Approval2At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_XE_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_NHAPMUA (IN KhoHangID INT,
	 IN TuNgay ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_NHAPMUA (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT KhoHangNhapID, XeID, ID AS XeNhapMuaID, 1 AS SoLuong 
	FROM XeNhapMua 
	WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (KhoHangNhapID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure uspChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc uspChiTien1
IN ID int,
IN Status int,
IN ...' at line 1 (SQL: DELIMITER //
CREATE         proc uspChiTien1
IN ID int,
IN Status int,
IN ApprovalBy int
BEGIN
UPDATE ChiTien SET Status1 = @Status, Approval1By = @ApprovalBy, Approval1At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE_GROUP (IN KhoHangID INT,
	 IN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE_GROUP (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, SUM(B.SoLuong) AS SoLuong, SUM(B.ThanhTien) AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS A INNER JOIN
            DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure upsChiTienPowerApps: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE upsChiTienPowerApps (BEGIN
BEGIN
SET nocount ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE upsChiTienPowerApps (BEGIN
BEGIN
SET nocount  ON    
	Declare IN TuNgay VARCHAR(10), IN DenNgay VARCHAR(10)

	set @TuNgay = CONVERT(VARCHAR(10), DATEADD(DAY, -30, NOW()), 101)
	set @DenNgay = CONVERT(VARCHAR(10), NOW(), 101)

	SELECT * FROM ChiTien WHERE NgayCT between IN TuNgay and IN DenNgay END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON_KHOHANG: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //



CREATE PROCEDURE SP_VT_GET_GIAVON_KHOHANG (IN TuNgay VARCHA...' at line 1 (SQL: DELIMITER //



CREATE PROCEDURE SP_VT_GET_GIAVON_KHOHANG (IN TuNgay VARCHAR(10),	 
     IN DenNgay VARCHAR(10),
	 IN KhoHangID int,
	 IN VatTuID int
BEGIN
BEGIN
SET NOCOUNT ON
	Declare IN NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	Declare IN Tb_VTTonDau Table (KhoHangID int, VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert IN Tb_VTTonDau SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS KhoHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS KhoHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
				XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		
		
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE (IN KhoHangID INT,
	 IN TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.SoPhieu, A.KhoHangXuatID, A.KhachHangID, B.NgayXuat, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS A INNER JOIN
            DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure spCheckPhieuChi: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE spCheckPhieuChi ((
		IN khohangID varchar(10)...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE spCheckPhieuChi ((
		IN khohangID varchar(10)
) BEGIN Begin
				select	* from ChiTien
				where	KhoHangID = IN khohangID  END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_FIX_SLVT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_FIX_SLVT (BEGIN
BEGIN
SET nocount  ON    ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_FIX_SLVT (BEGIN
BEGIN
SET nocount  ON    
	Declare IN Tb_SLVT Table (DVBanLeID int, SoLuongVT float)

	Insert @Tb_SLVT(DVBanLeID, SoLuongVT) 
	select DVBanLeID, Sum(SoLuong) AS SoLuongVT from DVBanLeVatTu group by DVBanLeID
	
	UPDATE DVBanLe 
    SET DVBanLe.TongSoLuongVatTu = B.SoLuongVT            
	FROM DVBanLe INNER JOIN IN Tb_SLVT AS B ON DVBanLe.ID = B.DVBanLeID 
	where B.SoLuongVT is not null
	
 
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_TC_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_TC_TONDAU (IN TaiKhoanID INT,
             ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_TC_TONDAU (IN TaiKhoanID INT,
                                 IN TuNgay VARCHAR(10),
	                             IN DenNgay VARCHAR(10)	 
                            BEGIN
                            BEGIN
                            SET NOCOUNT ON
	                            SELECT T.TaiKhoanID, T.TacNghiep, SUM(T.SoTien) AS SoTien
	                            FROM (
		                            
		                            SELECT 1 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM XeBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 2 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM XeBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 3 AS MaTN, TaiKhoanID, SUM(GiaNhap) AS SoTien, 1 AS TacNghiep
		                            FROM XeSonXe 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 4 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, 0 AS TacNghiep
		                            FROM ThuTien 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 5 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, 1 AS TacNghiep
		                            FROM ChiTien 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 6 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM DVBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 7 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM DVBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 8 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM DVBanBuonThanhToan 
		                            WHERE (NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 9 AS MaTN, T.TaiKhoanID, SUM(G.ChiPhi) AS SoTien, 1 AS TacNghiep 
                                    FROM DVBanLe AS A INNER JOIN 
                                        KhoHang AS K ON A.KhoHangXuatID = K.ID INNER JOIN 
	
//
DELIMITER ;)  
[2024-07-18 16:48:34] local.ERROR: Error creating stored procedure SP_VT_NHAPTRABUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRABUON (IN KhoHangID INT,
	 IN TuN...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRABUON (IN KhoHangID INT,
	 IN TuNgay VARCHAR(10),
     IN DenNgay VARCHAR(10) BEGIN BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanBuon AS A INNER JOIN
            DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanbuonID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN IN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATBANBUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANBUON (KhoHangID INT,
	 TuNgay VA...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANBUON (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanBuon AS A INNER JOIN
            DVBanBuonVatTu AS B ON A.ID = B.DVBanBuonID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC_TONGHOP (TuNgay VARCHAR(10),
 ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC_TONGHOP (TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeXuatKhac AS A INNER JOIN
			XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeXuatKhac AS A INNER JOIN
			XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_BANGGIA2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_BANGGIA2 (DenNgay nvarchar(20),
	 XeNha...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_BANGGIA2 (DenNgay nvarchar(20),
	 XeNhapMuaID int,
	 TenType nvarchar(50) BEGIN
SET nocount  ON    
	Declare TenModel nvarchar(30)

	
	SELECT		@TenModel = X.TenModel FROM XeNhapMua AS M INNER JOIN Xe AS X ON M.XeID = X.ID INNER JOIN V_XeThayVanh AS TV ON M.ID = TV.XeNhapMuaID 
	WHERE		TV.XeNhapMuaID = XeNhapMuaID GROUP BY	X.TenModel	

	
	Declare V_Xe_BangGia_MaxID Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT  MAX(B.ID) AS MaxID, B.XeID
			FROM    XeBangGia AS A INNER JOIN
                    XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID INNER JOIN
                    Xe AS X ON B.XeID = X.ID
			WHERE   (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive = 1) AND (X.TenModel = @TenModel) AND (X.TenType = @TenType)
			GROUP BY B.XeID, X.TenModel, X.TenType

	
	SELECT TOP (1) X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	FROM   XeBangGia AS B INNER JOIN
           XeBangGiaChiTiet AS C ON B.ID = C.XeBangGiaID INNER JOIN
           V_Xe_BangGia_MaxID AS V ON C.ID = V.MaxID INNER JOIN
           Xe AS X ON C.XeID = X.ID	
	GROUP BY X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	ORDER BY C.GiaHaiQuan DESC
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATKMDV: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMDV (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMDV (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            DVBanLe AS A INNER JOIN
            DVBanLeKhuyenMai AS B ON A.ID = B.DVBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure dt_setpropertybyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_setpropertybyid (id int,
	property varcha...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_setpropertybyid (id int,
	property varchar(64),
	value varchar(255),
	lvalue image
BEGIN
	set nocount on
	declare uvalue nvarchar(255) 
	set @uvalue = convert(nvarchar(255), @value) 
	if exists (select * from dtproperties 
			where objectid=id and property=@property) BEGIN update dtproperties set value=@value, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=id and property=property END;
	else
	begin
		
		
		
		insert dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @value, @uvalue, @lvalue)
	 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure dt_getpropertiesbyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid_u (id int,
	property va...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid_u (id int,
	property varchar(64)
BEGIN
	set nocount on

	if (property is null) or (@property = '')
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure dt_getpropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid (id int,
	property varc...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid (id int,
	property varchar(64)
BEGIN
	set nocount on

	if (property is null) or (@property = '')
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure dt_getobjwithprop_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getobjwithprop_u (property varchar(30),
	...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getobjwithprop_u (property varchar(30),
	uvalue nvarchar(255) BEGIN set nocount on

	if (property is null) or (@property = '')
	begin
		raiserror('Must specify a property name.',-1,-1)
		return (1)
	 END;

	if (uvalue is null)
		select objectid id from dtproperties
			where property=property else
		select objectid id from dtproperties
			where property=property and uvalue=@uvalue
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure dt_getobjwithprop: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getobjwithprop (property varchar(30),
	va...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getobjwithprop (property varchar(30),
	value varchar(255) BEGIN set nocount on

	if (property is null) or (@property = '')
	begin
		raiserror('Must specify a property name.',-1,-1)
		return (1)
	 END;

	if (value is null)
		select objectid id from dtproperties
			where property=property else
		select objectid id from dtproperties
			where property=property and value=@value
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure dt_generateansiname: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
 
CREATE PROCEDURE dt_generateansiname ((name varchar(255) outp...' at line 1 (SQL: DELIMITER //
 
CREATE PROCEDURE dt_generateansiname ((name varchar(255) output) BEGIN declare prologue varchar(20) 
	declare indexstring varchar(20) 
	declare index integer 
 
	set @prologue = 'MSDT-A-' 
	set @index = 1 
 
	while 1 = 1 
	begin 
		set @indexstring = cast(index as varchar(20)) 
		set @name = @prologue + indexstring if not exists (select value from dtproperties where value = @name) 
			break 
		 
		set @index = @index + 1 
 
		if (@index = 10000) 
			goto TooMany 
	 END; 
 
Leave: 
 
	return 
 
TooMany: 
 
	set @name = 'DIAGRAM' 
	goto Leave
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure dt_setpropertybyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_setpropertybyid_u (id int,
	property varc...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_setpropertybyid_u (id int,
	property varchar(64),
	uvalue nvarchar(255),
	lvalue image
BEGIN
	set nocount on
	
	
	
	
	declare avalue varchar(255) 
	set @avalue = null 
	if (uvalue is not null) BEGIN if (convert(nvarchar(255), convert(varchar(255), @uvalue)) = @uvalue) 
		begin 
			set @avalue = convert(varchar(255), @uvalue) 
		END; 
		else 
		begin 
			if 'DtgSchemaNAME' = property begin 
				exec dt_generateansiname avalue output 
			END; 
		END; 
	END; 
	if exists (select * from dtproperties 
			where objectid=id and property=@property)
	begin
		
		
		
		update dtproperties set value=@avalue, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=id and property=property END;
	else
	begin
		
		
		
		insert dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @avalue, @uvalue, @lvalue)
	 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_Old (KhoHangID INT,
	 TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_Old (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS A INNER JOIN
            XePhuKienChiTiet AS B ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 1) AND (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure dt_dropuserobjectbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_dropuserobjectbyid (id int
BEGIN
	set no...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_dropuserobjectbyid (id int
BEGIN
	set nocount on
	delete from dtproperties where objectid=@id
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN (KhoHangID INT,
	 TuNgay VA...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS A INNER JOIN
            XePhuKienChiTiet AS B ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 0) AND (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure dt_droppropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_droppropertiesbyid (id int,
	property var...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_droppropertiesbyid (id int,
	property varchar(64)
BEGIN
	set nocount on

	if (property is null) or (@property = '')
		delete from dtproperties where objectid=id else
		delete from dtproperties 
			where objectid=id and property=@property
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure dt_adduserobject: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_adduserobject (BEGIN
	set nocount on
	
...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_adduserobject (BEGIN
	set nocount on
	
	begin transaction
		insert dtproperties (property) VALUES ('DtgSchemaOBJECT')
		update dtproperties set objectid=@identity where id=@identity and property='DtgSchemaOBJECT'
	commit
	return @@identity
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKHAC (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKHAC (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVXuatKhac AS A INNER JOIN
			DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
			VatTu AS V ON B.VatTuID = V.ID INNER JOIN
			VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATDOIDONVI (KhoHangID INT,
	 TuNgay V...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATDOIDONVI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, A.SoLuong, A.DonGia, A.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS A INNER JOIN
            VatTu AS V ON A.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_BANGGIA (DenNgay nvarchar(20) BEGIN
SET ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_BANGGIA (DenNgay nvarchar(20) BEGIN
SET nocount  ON    
	Declare V_Xe_BangGia_MaxID Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT Max(B.ID) AS MaxID, B.XeID
			FROM   XeBangGia AS A INNER JOIN
				   XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive =1)
			GROUP BY B.XeID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.XeID, C.SoKhung, C.SoMay, X.MaXe, X.TenXe, X.SortDoiXe, X.SortLoaiXe, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, c.GiaApThue
	FROM   XeBangGia AS B INNER JOIN
           XeBangGiaChiTiet AS C ON B.ID = C.XeBangGiaID INNER JOIN
           V_Xe_BangGia_MaxID AS V ON C.ID = V.MaxID INNER JOIN
           Xe AS X ON C.XeID = X.ID	
	ORDER BY X.SortDoiXe
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON2 (TuNgay VARCHAR(10),	 
 ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON2 (TuNgay VARCHAR(10),	 
     DenNgay VARCHAR(10)	 
BEGIN
SET NOCOUNT ON
	Declare NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	
	FROM (
		
		SELECT	1 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	2 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	3 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	5 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	6 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  8 as a, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  9 as a, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)		
		UNION ALL
		
		SELECT	10 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	11 as a, B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	12 as a, B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanSi AS A INNER JOIN
				DVBanSiVatTu AS B ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON (TuNgay VARCHAR(10),	 
  ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON (TuNgay VARCHAR(10),	 
     DenNgay VARCHAR(10)	 
BEGIN
SET NOCOUNT ON
	Declare NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat,
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_TONDAU_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU_ALL (KhoHangID INT,
     DenNgay...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU_ALL (KhoHangID INT,
     DenNgay VARCHAR(10)
BEGIN
SET NOCOUNT ON
	Declare NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'	

	SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.TienNhap) AS TDTienNhap, SUM(T.SLXuat) AS TDSLXuat, SUM(T.TienXuat) AS TDTienXuat 
	FROM (
		
		SELECT	'N01' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N02' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N03' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N04' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNoiBo AS A INNER JOIN
				DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT	'N05' AS MaTN, A.KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID)
		UNION ALL
		
		SELECT	'N06' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT  'N07' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNoiBo AS A INNER JOIN
                XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT  'N08' AS MaTN, A.KhoHangXuatID AS KhoHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON A.ID = B.XeBanLeID INNER JOIN
				Va
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL_TEST (KhoHangID int,
     Den...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL_TEST (KhoHangID int,
     DenNgay nvarchar(10) BEGIN
SET nocount  ON    
	Declare Tb_VTTonDau Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert Tb_VTTonDau Exec SP_VT_TONDAU_ALL @KhoHangID, DenNgay SELECT A.KhoHangID AS KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, A.TDSLNhap, A.TDSLXuat, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon
	FROM Tb_VTTonDau AS A INNER JOIN
			VatTu AS V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) < 0
	order by  A.VatTuID

	
	
	
	
	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_XUATNOIBO (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_XUATNOIBO (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeNoiBo AS A INNER JOIN
			XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.IsXacNhan=1)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL (KhoHangID int,
     DenNgay ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL (KhoHangID int,
     DenNgay nvarchar(10) BEGIN
SET nocount  ON    
	Declare Tb_VTTonDau Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert Tb_VTTonDau Exec SP_VT_TONDAU_ALL @KhoHangID, DenNgay SELECT A.KhoHangID AS KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon
	FROM Tb_VTTonDau AS A INNER JOIN
			VatTu AS V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_NHAPNOIBO (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_NHAPNOIBO (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeNoiBo AS A INNER JOIN
			XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU (KhoHangID INT,
     DenNgay VAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU (KhoHangID INT,
     DenNgay VARCHAR(10),	 
	 VatTuID INT,
	 MaTacNghiep VARCHAR(1),
	 IDTacNghiep INT
BEGIN
	SET NOCOUNT ON
	DECLARE NgayBatDauSuDung VARCHAR(10), 
		DVBanLeID INT, DVBanSiID INT, DVNoiBoID INT, DoiDonViID INT, DVXuatKhacID INT, XeBanLeKMID INT, 
		DVBanLeKMID INT, XePhuKienID INT, XePhuKienNoiBoID INT, DVBanBuonID INT, XeBanSiKMID INT, XeBanLeBHID INT
	SET @NgayBatDauSuDung = '2019-12-19'
	SET @DVBanLeID = 0 	
	SET @DVBanSiID = 0
	SET @DVNoiBoID = 0
	SET @DoiDonViID = 0
	SET @DVXuatKhacID = 0
	SET @XeBanLeKMID = 0
	SET @DVBanLeKMID = 0
	SET @XePhuKienID = 0
	SET @XePhuKienNoiBoID = 0
	SET @DVBanBuonID = 0
	SET @XeBanSiKMID = 0
	SET @XeBanLeBHID = 0

	IF(@MaTacNghiep ='I')			SET @DVBanLeID = IDTacNghiep ELSE IF(@MaTacNghiep='J')		SET @DVBanSiID = IDTacNghiep ELSE IF(@MaTacNghiep='K')		SET @DVNoiBoID = IDTacNghiep ELSE IF(@MaTacNghiep='L')		SET @DoiDonViID = IDTacNghiep ELSE IF(@MaTacNghiep='M')		SET @DVXuatKhacID = IDTacNghiep ELSE IF(@MaTacNghiep='N')		SET @XeBanLeKMID = IDTacNghiep ELSE IF(@MaTacNghiep='O')		SET @DVBanLeKMID = IDTacNghiep ELSE IF(@MaTacNghiep='P')		SET @XePhuKienID = IDTacNghiep ELSE IF(@MaTacNghiep='Q')		SET @XePhuKienNoiBoID = IDTacNghiep ELSE IF(@MaTacNghiep='R')		SET @DVBanBuonID = IDTacNghiep ELSE IF(@MaTacNghiep='S')		SET @XeBanSiKMID = IDTacNghiep ELSE IF(@MaTacNghiep='T')		SET @XeBanLeBHID = IDTacNghiep SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.TienNhap) AS TDTienNhap, SUM(T.SLXuat) AS TDSLXuat, SUM(T.TienXuat) AS TDTienXuat 
	FROM (
		
		SELECT	'N01' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNoiBo AS A INNER JOIN
				DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS MaTN, A.KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATNOIBO (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATNOIBO (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS A INNER JOIN
            DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	
	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO (KhoHangID INT,
     DenNgay nvar...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO (KhoHangID INT,
     DenNgay nvarchar(10),
	 VatTuID INT,
	 MaTacNghiep VARCHAR(1),
	 IDTacNghiep INT
BEGIN
	SET NOCOUNT  ON    
	DECLARE Tb_VTTonDau Table (KhoHangID INT, VatTuID INT, TDSLNhap INT, TDTienNhap FLOAT, TDSLXuat INT, TDTienXuat FLOAT)
	INSERT Tb_VTTonDau Exec SP_VT_TONDAU @KhoHangID, @DenNgay, @VatTuID, @MaTacNghiep, IDTacNghiep SELECT A.KhoHangID AS KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon
	FROM Tb_VTTonDau AS A INNER JOIN
			VatTu AS V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPNOIBO (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPNOIBO (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS A INNER JOIN
            DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.IsXacNhan = 1) AND (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_SELECT_GIAVON_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_SELECT_GIAVON_TEST (TuNgay VARCHAR(10),	...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_SELECT_GIAVON_TEST (TuNgay VARCHAR(10),	 
     DenNgay VARCHAR(10)	 
BEGIN
SET NOCOUNT ON
	Declare NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, (1 - A.TyLeCK*0.01) * B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, 1 AS SLNhap, C.GiaBanBH AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLeBaoHiem AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanSi AS A INNER JOIN
				DVBanSiVatTu AS B ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT < @TuNgay)
		UNION ALL
		
		SELECT  VatTuID, 0 AS SLNhap, 0 AS TienNhap, SoLuong AS SLXuat, ThanhTien AS TienXuat
		FROM    DoiDonVi AS A    
	
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_NHAPXUAT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPXUAT (KhoHangID INT,
	 VatTuID INT,...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPXUAT (KhoHangID INT,
	 VatTuID INT,
	 TuNgay VARCHAR(10),	 
     DenNgay VARCHAR(10)	 	 
BEGIN
	SET NOCOUNT ON
	SELECT T.SoCT, T.NgayCT, T.NgayNXK, T.KhoHangNhapID, T.KhoHangXuatID, T.KhachHangID, T.VatTuID, T.SLNhap, T.SLXuat 
	FROM (
		
		SELECT	'N01' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, A.KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, C.KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
                DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
                DVBanLe AS C ON A.DVBanLeID = C.ID   
		WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, C.KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
                DVBanSi AS C ON A.DVBanSiID = C.ID
		WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, A.KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNoiBo AS A INNER JOIN
				DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID
		WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangID AS KhoHangNhapID, NULL AS KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N06' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  'N07' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNoiBo AS A INNER JOIN
                XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID
		WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)		
		UNION ALL
		
		SELECT  'N08' AS MaTN, B.SoCT, B.NgayCT, B.NgayCT AS NgayNXK, A.KhoHangXuatID AS KhoHangNhapID, NULL AS KhoHangXuatID, a.KhachHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_NHAPDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPDOIDONVI (KhoHangID INT,
	 TuNgay V...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPDOIDONVI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS A INNER JOIN
            DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XECHUYENKHO (KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XECHUYENKHO (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS A INNER JOIN
            XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
	
	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_GET_GIAVON (TuNgay VARCHAR(10),	 
     ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_GET_GIAVON (TuNgay VARCHAR(10),	 
     DenNgay VARCHAR(10),
	 VatTuID int
BEGIN
SET NOCOUNT ON
	Declare NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.Nga
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_XECHUYENKHO (KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_XECHUYENKHO (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID AS KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS A INNER JOIN
            XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan = 1)
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_DELETE_DUPLICATE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_DELETE_DUPLICATE (VatTuID_DEL int,	 
  ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_DELETE_DUPLICATE (VatTuID_DEL int,	 
     VatTuID int	 
BEGIN
SET NOCOUNT ON
	update DoiDonVi						set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DoiDonViChiTiet				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVBanLeVatTu					set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVBanSiVatTu					set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVNhapKhacVatTu				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVNhapMuaVatTu				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVNhapTraLaiBanLeChiTiet		set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVNhapTraLaiBanSiChiTiet		set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVNoiBoVatTu					set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVXuatKhacVatTu				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update VTBangGiaChiTiet				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update XeBanLeKhuyenMai				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update XeBanLePhuKien				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update XeNhapTraLaiBanLeKhuyenMai	set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update XeNhapTraLaiBanLePhuKien		set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update XeNoiBoPhuKien				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update XePhuKienChiTiet				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL Delete VatTu where (ID = @VatTuID_DEL)

END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XEBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XEBANLE (KhoHangID INT,
	 T...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XEBANLE (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, b.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeBanLe AS A INNER JOIN
            XeBanLePhuKien AS B ON A.ID = B.XeBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE   (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHLE (KhoHangID INT,
	 TuNgay VAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHLE (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS A INNER JOIN
            XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure dt_verstamp007: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_verstamp007 (BEGIN
	select 7005
//
DELIMITER' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_verstamp007 (BEGIN
	select 7005
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATKMBH_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBH_Old (KhoHangID INT,
	 TuNgay V...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBH_Old (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS A INNER JOIN
            XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure dt_verstamp006: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_verstamp006 (BEGIN
	select 7000
//
DELIMITER' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_verstamp006 (BEGIN
	select 7000
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATBAOHIEM_BHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBAOHIEM_BHLE (KhoHangID INT,
	 TuNg...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBAOHIEM_BHLE (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, B.NgayXuat AS NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, 1 AS SoLuong, B.GiaBanBH, B.GiaBanBH AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS A INNER JOIN
            XeBanLeBaoHiem AS B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_TRALAI (KhoHangID INT,
	 Tu...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_TRALAI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  B.ID, B.SoCT, C.NgayNhap AS NgayCT, A.KhoHangXuatID AS KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS B INNER JOIN
            XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_NHAPKHUYENMAI_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHUYENMAI_TRALAI (KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHUYENMAI_TRALAI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  B.ID, B.SoCT, B.NgayCT, A.KhoHangXuatID AS KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS B INNER JOIN
            XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRASI (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRASI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanSi AS A INNER JOIN
			XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID
	WHERE (B.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.XeNhapMuaID IS NOT NULL)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_NHAPBAOHIEM_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPBAOHIEM_TRALAI (KhoHangID INT,
	 Tu...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPBAOHIEM_TRALAI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  B.ID, B.SoCT, C.NgayNhap AS NgayCT, A.KhoHangXuatID AS KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, 1 AS SoLuong, C.GiaBanBH AS DonGia, C.GiaBanBH AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS B INNER JOIN
            XeNhapTraLaiBanLeBaoHiem AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRALE (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRALE (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanLe AS A INNER JOIN
            DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_TEST_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_TEST_1 (BEGIN
SET NOCOUNT ON
	select count...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_TEST_1 (BEGIN
SET NOCOUNT ON
	select count(ID) as 'VT' from VatTu
END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_TEST (VatTuID INT     
BEGIN
SET NOCOUNT O...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_TEST (VatTuID INT     
BEGIN
SET NOCOUNT ON
	
	

	
	
	
	
	
	
	select * from VatTu where ID = VatTuID END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_DV_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_DV_BANGGIA (DenNgay nvarchar(10),
	 CuaHang...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_DV_BANGGIA (DenNgay nvarchar(10),
	 CuaHangID nvarchar(2) BEGIN
SET nocount  ON    
	Declare V_DV_BangGia_MaxID Table (MaxID int, DichVuID int)
	Insert @V_DV_BangGia_MaxID(MaxID, DichVuID) 
			SELECT Max(B.ID) AS MaxID, B.DichVuID
			FROM   DVBangGia AS A INNER JOIN
				   DVBangGiaChiTiet AS B ON A.ID = B.DVBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.CuaHangID = @CuaHangID)
			GROUP BY B.DichVuID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.DichVuID, V.MaDichVu, V.HangMuc, C.DonGia
	FROM   DVBangGia AS B INNER JOIN
           DVBangGiaChiTiet AS C ON B.ID = C.DVBangGiaID INNER JOIN
           V_DV_BangGia_MaxID AS M ON C.ID = M.MaxID INNER JOIN
           DichVu AS V ON C.DichVuID = V.ID	
	ORDER BY V.MaDichVu
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHSI (KhoHangID INT,
	 TuNgay VAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHSI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanSi AS A INNER JOIN
            XeBanSiKhuyenMai AS B ON A.ID = B.XeBanSiID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURESP_VT_BANGGIA
                               ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURESP_VT_BANGGIA
                                DenNgay nvarchar(10),
	                            CuaHangID nvarchar(2)
                            BEGIN
                            SET nocount  ON
                                Declare V_VT_BangGia_MaxID Table(MaxID int, VatTuID int)
                                Insert @V_VT_BangGia_MaxID(MaxID, VatTuID)
                                        SELECT Max(B.ID) AS MaxID, B.VatTuID
                                        FROM   VTBangGia AS A CROSS APPLY STRING_SPLIT(CuaHangID, ',') INNER JOIN
                                               VTBangGiaChiTiet AS B ON A.ID = B.VTBangGiaID
                                        WHERE(A.ApDungTu <= @DenNgay) AND(A.ApDungDen >= @DenNgay) AND (value = @CuaHangID)
                                        GROUP BY B.VatTuID

                                SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.VatTuLoaiID, L.VatTuNhomID, C.GiaNhap, C.GiaXuat
                                FROM   VTBangGia AS B INNER JOIN
                                       VTBangGiaChiTiet AS C ON B.ID = C.VTBangGiaID INNER JOIN
                                       V_VT_BangGia_MaxID AS M ON C.ID = M.MaxID INNER JOIN
                                       VatTu AS V ON C.VatTuID = V.ID INNER JOIN
                                       VatTuLoai AS L ON V.VatTuLoaiID = L.ID
                            END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_NHAPKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHAC (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHAC (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapKhac AS A INNER JOIN
            DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI_TONGHOP (TuNgay VARCHAR(10),
...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI_TONGHOP (TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanSi AS A INNER JOIN
			XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanSi AS A INNER JOIN
			XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_TONDAU (KhoHangID INT,
     DenNgay VAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_TONDAU (KhoHangID INT,
     DenNgay VARCHAR(10),
	 XeBanLeID INT,
	 XeBanSiID INT,
	 XeNoiBoID INT,
	 XeXuatKhacID INT
BEGIN
SET NOCOUNT ON
	SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.SLXuat) AS TDSLXuat
	FROM (
		
		SELECT 'A' AS MaTN, KhoHangNhapID AS KhoHangID, XeID, ID AS XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat 
		FROM XeNhapMua 
		WHERE (NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT 'B' AS TN, A.KhoHangNhapID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
		FROM XeNoiBo AS A INNER JOIN
				XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
		UNION ALL
		
		SELECT 'C' AS TN, A.KhoHangXuatID AS KhoHangID, A.XeID, A.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
		FROM XeBanLe  AS A INNER JOIN
				XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID    
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'D' AS TN, A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
		FROM XeBanSi AS A INNER JOIN
				XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
				XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
		UNION ALL
		
		SELECT 'E' AS TN, KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeBanLe     
		WHERE (NgayBan <= @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'F' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeBanSi AS A INNER JOIN
				XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeBanSiID)
		UNION ALL
		
		SELECT 'G' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeNoiBo AS A INNER JOIN
				XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeNoiBoID) 
		UNION ALL
		
		SELECT 'H' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeXuatKhac AS A INNER JOIN
				XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeXuatKhacID)
	) AS T
	GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID
END;


//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_TONKHO (KhoHangID int,
                 ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_TONKHO (KhoHangID int,
                                 DenNgay nvarchar(10),
	                             XeBanLeID INT,
	                             XeBanSiID INT,
	                             XeNoiBoID INT,
	                             XeXuatKhacID INT
                            BEGIN
                            SET nocount  ON 
	                            Declare Tb_XeTonDau Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)
	                            Insert Tb_XeTonDau Exec SP_XE_TONDAU @KhoHangID, @DenNgay, @XeBanLeID, @XeBanSiID, @XeNoiBoID, XeXuatKhacID SELECT A.KhoHangID, B.KhoHangNhapID, A.XeID, X.MaXe, X.TenXe, A.XeNhapMuaID, B.KhachHangID AS NhaCungCapID, B.DonGia_CoVAT, B.NgayCT, B.SoKhung, B.SoMay, B.MaChiaKhoa, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon, B.GhiChu, B.MaChiaKhoa
	                            FROM Tb_XeTonDau AS A INNER JOIN
			                            XeNhapMua AS B ON A.XeNhapMuaID = B.ID INNER JOIN
			                            Xe AS X ON A.XeID = X.ID 
	                            WHERE (A.TDSLNhap - A.TDSLXuat) <>0
                            END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_NHAPXUATTON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_NHAPXUATTON (KhoHangID int,
	 TuNgay nvarch...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_NHAPXUATTON (KhoHangID int,
	 TuNgay nvarchar(10),
     DenNgay nvarchar(10) BEGIN
SET nocount  ON    

	Declare Tb_XeTonDau Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)

	declare XeBanLeID int, XeBanSiID int, XeNoiBoID int
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0

	Insert Tb_XeTonDau Exec SP_XE_TONDAU @KhoHangID, @TuNgay, @XeBanLeID, @XeBanSiID, XeNoiBoID SELECT NXT.* FROM (
		SELECT 'T' AS TN, KhoHangID, XeID, XeNhapMuaID, (TDSLNhap - TDSLXuat) AS TDSL
		FROM Tb_XeTonDau UNION ALL
		SELECT 'B' AS TN, A.KhoHangNhapID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
		FROM XeNoiBo AS A INNER JOIN
			 XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
		WHERE A.NgayCT < DenNgay AND KhoHangNhapID = @KhoHangID   
	) AS NXT 
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_LICHSU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_LICHSU (XeNhapMuaID INT
BEGIN
SET NOCO...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_LICHSU (XeNhapMuaID INT
BEGIN
SET NOCOUNT ON
	
	SELECT 'A' AS MaTN, ID, KhoHangNhapID, Null AS KhoHangXuatID, XeID, ID AS XeNhapMuaID, SoCT, NgayCT, NULL AS NgayBan, CreatedBy, SoKhung, SoMay 
	FROM XeNhapMua 
	WHERE (ID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'B' AS TN, A.ID, A.KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, NULL AS NgayBan, A.CreatedBy, M.SoKhung, M.SoMay 
	FROM XeNoiBo AS A INNER JOIN
			XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID INNER JOIN
			XeNhapMua AS M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'C' AS TN, B.ID, A.KhoHangXuatID AS KhoHangNhapID, null AS KhoHangXuatID, A.XeID, A.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS NgayBan, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe  AS A INNER JOIN
			XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID INNER JOIN
			XeNhapMua AS M ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'D' AS TN, B.ID, A.KhoHangXuatID AS KhoHangNhapID, null AS KhoHangXuatID, C.XeID, C.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS NgayBan, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS A INNER JOIN
			XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID INNER JOIN
			XeNhapMua AS M ON C.XeNhapMuaID = M.ID
	WHERE (C.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'E' AS TN, A.ID, Null AS KhoHangNhapID, A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe AS A INNER JOIN
			XeNhapMua AS M ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'F' AS TN, A.ID, Null AS KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS A INNER JOIN
			XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapMua AS M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'G' AS TN, A.ID, Null AS KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeXuatKhac AS A INNER JOIN
			XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID INNER JOIN
			XeNhapMua AS M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	
	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE_TONGHOP (TuNgay VARCHAR(10),
...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE_TONGHOP (TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 1 AS SoLuong
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN TuNgay AND @DenNgay) AND (XeNhapMuaID IS NOT NULL)
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 1 AS SoLuong
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN TuNgay AND @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (XeNhapMuaID IS NOT NULL)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_TONKHO_BY_XEID: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_TONKHO_BY_XEID (DenNgay VARCHAR(10),
	 ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_TONKHO_BY_XEID (DenNgay VARCHAR(10),
	 XeID INT,
	 IDPhieu INT,
	 LoaiPhieu INT,
	 SoMay VARCHAR(20)
BEGIN
SET NOCOUNT ON
	Declare XeBanLeID INT,	XeBanSiID INT, XeNoiBoID INT, XeXuatKhacID INT
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0
	SET @XeXuatKhacID = 0

	if(@LoaiPhieu = 1)
		SET @XeBanLeID = IDPhieu else if(@LoaiPhieu = 2)
		SET @XeBanSiID = IDPhieu else if(@LoaiPhieu = 3)
		SET @XeNoiBoID = IDPhieu else if(@LoaiPhieu = 4)
		SET @XeXuatKhacID = IDPhieu Declare Tb_XeTonKho Table (KhoHangID int, XeID int, XeNhapMuaID int, SLNhap int, SLXuat int)

	Insert Tb_XeTonKho SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.SLXuat) AS TDSLXuat
		FROM (
			
			SELECT 'A' AS MaTN, KhoHangNhapID AS KhoHangID, XeID, ID AS XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat 
			FROM XeNhapMua 
			WHERE (NgayCT <= @DenNgay) AND (XeID = @XeID)
			UNION ALL
			
			SELECT 'B' AS TN, A.KhoHangNhapID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
			FROM XeNoiBo AS A INNER JOIN
					XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.IsXacNhan=1)
			UNION ALL
			
			SELECT 'C' AS TN, A.KhoHangXuatID AS KhoHangID, A.XeID, A.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
			FROM XeBanLe  AS A INNER JOIN
					XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID    
			WHERE (B.NgayCT <= @DenNgay) AND (A.XeID = @XeID) AND (A.XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'D' AS TN, A.KhoHangXuatID AS KhoHangID, C.XeID, C.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
			FROM XeBanSi AS A INNER JOIN
					XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
					XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID
			WHERE (B.NgayCT <= @DenNgay) AND (C.XeID = @XeID)
			UNION ALL
			
			SELECT 'E' AS TN, KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeBanLe     
			WHERE (NgayBan <= @DenNgay) AND (XeID = @XeID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'F' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeBanSi AS A INNER JOIN
					XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeBanSiID)
			UNION ALL
			
			SELECT 'G' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeNoiBo AS A INNER JOIN
					XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeNoiBoID) 
			UNION ALL
			
			SELECT 'F' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeXuatKhac AS A INNER JOIN
					XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeXuatKhacID)
		) AS T
		GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID

		if(LEN(@SoMay)>0)
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS SLTON,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM Tb_XeTonKho AS A INNER JOIN
					XeNhapMua AS B ON A.XeNhapMuaID = B.ID INNER JOIN
					Xe AS X ON A.XeID = X.ID INNER JOIN 
					KhoHang AS K ON A.KhoHangID = K.ID 
			WHERE SLNhap-SLXuat<>0 AND (B.SoMay Like N'%' + @SoMay)
		else
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS SLTON,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM Tb_XeTonKho AS A INNER JOIN
					XeNh
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRALE (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRALE (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanLe  AS A INNER JOIN
			XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID    
	WHERE (B.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA_GROUP (KhoHangID INT,
	 TuNgay ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA_GROUP (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, SUM(B.SoLuong) AS SoLuong, SUM(B.ThanhTien) AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS A INNER JOIN
            DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA (KhoHangID INT,
	 TuNgay VARCHA...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS A INNER JOIN
            DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRASI (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRASI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanSi AS A INNER JOIN
            DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANSI (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANSI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanSi AS A INNER JOIN
            DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure uspGetChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc uspGetChiTien1
ID int
BEGIN
SELECT       ...' at line 1 (SQL: DELIMITER //
CREATE         proc uspGetChiTien1
ID int
BEGIN
SELECT        ChiTien.ID, KhachHang.TenKhachHang, ChiTienLyDo.TenLyDo, ChiTien.SoTien, TaiKhoan.TenTaiKhoan, ChiTien.GhiChu, ChiTien.CuaHangID, ChiTien.CreatedBy, 
                         ChiTien.CreatedAt, ChiTien.UpdatedBy, ChiTien.UpdatedAt
FROM            ChiTien INNER JOIN
                         KhachHang ON ChiTien.KhachHangID = KhachHang.ID INNER JOIN
                         ChiTienLyDo ON ChiTien.ChiTienLyDoID = ChiTienLyDo.ID INNER JOIN
                         TaiKhoan ON ChiTien.TaiKhoanID = TaiKhoan.ID
WHERE ChiTien.ID= @ID
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure uspChiTien2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
create         proc uspChiTien2
ID int,
Status int,
ApprovalB...' at line 1 (SQL: DELIMITER //
create         proc uspChiTien2
ID int,
Status int,
ApprovalBy int
BEGIN
UPDATE ChiTien SET Status2 = @Status, Approval2By = @ApprovalBy, Approval2At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_XE_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_NHAPMUA (KhoHangID INT,
	 TuNgay VARCHA...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_NHAPMUA (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT KhoHangNhapID, XeID, ID AS XeNhapMuaID, 1 AS SoLuong 
	FROM XeNhapMua 
	WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (KhoHangNhapID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure uspChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc uspChiTien1
ID int,
Status int,
ApprovalB...' at line 1 (SQL: DELIMITER //
CREATE         proc uspChiTien1
ID int,
Status int,
ApprovalBy int
BEGIN
UPDATE ChiTien SET Status1 = @Status, Approval1By = @ApprovalBy, Approval1At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE_GROUP (KhoHangID INT,
	 TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE_GROUP (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, SUM(B.SoLuong) AS SoLuong, SUM(B.ThanhTien) AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS A INNER JOIN
            DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure upsChiTienPowerApps: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE upsChiTienPowerApps (BEGIN
SET nocount  ON    ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE upsChiTienPowerApps (BEGIN
SET nocount  ON    
	Declare TuNgay VARCHAR(10), DenNgay VARCHAR(10)

	set @TuNgay = CONVERT(VARCHAR(10), DATEADD(DAY, -30, NOW()), 101)
	set @DenNgay = CONVERT(VARCHAR(10), NOW(), 101)

	SELECT * FROM ChiTien WHERE NgayCT between TuNgay and DenNgay END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON_KHOHANG: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //



CREATE PROCEDURE SP_VT_GET_GIAVON_KHOHANG (TuNgay VARCHAR(1...' at line 1 (SQL: DELIMITER //



CREATE PROCEDURE SP_VT_GET_GIAVON_KHOHANG (TuNgay VARCHAR(10),	 
     DenNgay VARCHAR(10),
	 KhoHangID int,
	 VatTuID int
BEGIN
SET NOCOUNT ON
	Declare NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	Declare Tb_VTTonDau Table (KhoHangID int, VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert Tb_VTTonDau SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS KhoHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS KhoHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
				XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		
		
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.SoPhieu, A.KhoHangXuatID, A.KhachHangID, B.NgayXuat, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS A INNER JOIN
            DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure spCheckPhieuChi: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE spCheckPhieuChi ((
		khohangID varchar(10)
) ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE spCheckPhieuChi ((
		khohangID varchar(10)
) BEGIN
				select	* from ChiTien
				where	KhoHangID = khohangID  END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_FIX_SLVT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_FIX_SLVT (BEGIN
SET nocount  ON    
	Decla...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_FIX_SLVT (BEGIN
SET nocount  ON    
	Declare Tb_SLVT Table (DVBanLeID int, SoLuongVT float)

	Insert @Tb_SLVT(DVBanLeID, SoLuongVT) 
	select DVBanLeID, Sum(SoLuong) AS SoLuongVT from DVBanLeVatTu group by DVBanLeID
	
	UPDATE DVBanLe 
    SET DVBanLe.TongSoLuongVatTu = B.SoLuongVT            
	FROM DVBanLe INNER JOIN Tb_SLVT AS B ON DVBanLe.ID = B.DVBanLeID 
	where B.SoLuongVT is not null
	
 
	
	
END;
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_TC_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_TC_TONDAU (TaiKhoanID INT,
                ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_TC_TONDAU (TaiKhoanID INT,
                                 TuNgay VARCHAR(10),
	                             DenNgay VARCHAR(10)	 
                            BEGIN
                            SET NOCOUNT ON
	                            SELECT T.TaiKhoanID, T.TacNghiep, SUM(T.SoTien) AS SoTien
	                            FROM (
		                            
		                            SELECT 1 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM XeBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 2 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM XeBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 3 AS MaTN, TaiKhoanID, SUM(GiaNhap) AS SoTien, 1 AS TacNghiep
		                            FROM XeSonXe 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 4 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, 0 AS TacNghiep
		                            FROM ThuTien 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 5 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, 1 AS TacNghiep
		                            FROM ChiTien 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 6 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM DVBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 7 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM DVBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 8 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM DVBanBuonThanhToan 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 9 AS MaTN, T.TaiKhoanID, SUM(G.ChiPhi) AS SoTien, 1 AS TacNghiep 
                                    FROM DVBanLe AS A INNER JOIN 
                                        KhoHang AS K ON A.KhoHangXuatID = K.ID INNER JOIN 
	
//
DELIMITER ;)  
[2024-07-18 16:52:31] local.ERROR: Error creating stored procedure SP_VT_NHAPTRABUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRABUON (KhoHangID INT,
	 TuNgay VA...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRABUON (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanBuon AS A INNER JOIN
            DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanbuonID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_XUATBANBUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANBUON (KhoHangID INT,
	 TuNgay VA...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANBUON (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanBuon AS A INNER JOIN
            DVBanBuonVatTu AS B ON A.ID = B.DVBanBuonID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC_TONGHOP (TuNgay VARCHAR(10),
 ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC_TONGHOP (TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeXuatKhac AS A INNER JOIN
			XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay)		
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_XE_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATKHAC (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeXuatKhac AS A INNER JOIN
			XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_XE_BANGGIA2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_BANGGIA2 (DenNgay nvarchar(20),
	 XeNha...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_BANGGIA2 (DenNgay nvarchar(20),
	 XeNhapMuaID int,
	 TenType nvarchar(50) BEGIN
SET nocount  ON    
	Declare TenModel nvarchar(30)

	
	SELECT		@TenModel = X.TenModel FROM XeNhapMua AS M INNER JOIN Xe AS X ON M.XeID = X.ID INNER JOIN V_XeThayVanh AS TV ON M.ID = TV.XeNhapMuaID 
	WHERE		TV.XeNhapMuaID = XeNhapMuaID GROUP BY	X.TenModel	

	
	Declare V_Xe_BangGia_MaxID Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT  MAX(B.ID) AS MaxID, B.XeID
			FROM    XeBangGia AS A INNER JOIN
                    XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID INNER JOIN
                    Xe AS X ON B.XeID = X.ID
			WHERE   (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive = 1) AND (X.TenModel = @TenModel) AND (X.TenType = @TenType)
			GROUP BY B.XeID, X.TenModel, X.TenType

	
	SELECT TOP (1) X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	FROM   XeBangGia AS B INNER JOIN
           XeBangGiaChiTiet AS C ON B.ID = C.XeBangGiaID INNER JOIN
           V_Xe_BangGia_MaxID AS V ON C.ID = V.MaxID INNER JOIN
           Xe AS X ON C.XeID = X.ID	
	GROUP BY X.TenModel, X.TenType, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, C.GiaApThue
	ORDER BY C.GiaHaiQuan DESC
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_XUATKMDV: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMDV (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMDV (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            DVBanLe AS A INNER JOIN
            DVBanLeKhuyenMai AS B ON A.ID = B.DVBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure dt_setpropertybyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_setpropertybyid (id int,
	property varcha...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_setpropertybyid (id int,
	property varchar(64),
	value varchar(255),
	lvalue image
BEGIN
	set nocount on
	declare uvalue nvarchar(255) 
	set @uvalue = convert(nvarchar(255), @value) 
	if exists (select * from dtproperties 
			where objectid=id and property=@property) BEGIN update dtproperties set value=@value, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=id and property=property END;
	else
	begin
		
		
		
		insert dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @value, @uvalue, @lvalue)
	 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure dt_getpropertiesbyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid_u (id int,
	property va...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid_u (id int,
	property varchar(64)
BEGIN
	set nocount on

	if (property is null) or (@property = '')
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, uvalue, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure dt_getpropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid (id int,
	property varc...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getpropertiesbyid (id int,
	property varchar(64)
BEGIN
	set nocount on

	if (property is null) or (@property = '')
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid
	else
		select property, version, value, lvalue
			from dtproperties
			where  @id=objectid and @property=property
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure dt_getobjwithprop_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getobjwithprop_u (property varchar(30),
	...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getobjwithprop_u (property varchar(30),
	uvalue nvarchar(255) BEGIN set nocount on

	if (property is null) or (@property = '')
	begin
		raiserror('Must specify a property name.',-1,-1)
		return (1)
	 END;

	if (uvalue is null)
		select objectid id from dtproperties
			where property=property else
		select objectid id from dtproperties
			where property=property and uvalue=@uvalue
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure dt_getobjwithprop: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_getobjwithprop (property varchar(30),
	va...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_getobjwithprop (property varchar(30),
	value varchar(255) BEGIN set nocount on

	if (property is null) or (@property = '')
	begin
		raiserror('Must specify a property name.',-1,-1)
		return (1)
	 END;

	if (value is null)
		select objectid id from dtproperties
			where property=property else
		select objectid id from dtproperties
			where property=property and value=@value
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure dt_generateansiname: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
 
CREATE PROCEDURE dt_generateansiname ((name varchar(255) outp...' at line 1 (SQL: DELIMITER //
 
CREATE PROCEDURE dt_generateansiname ((name varchar(255) output) BEGIN declare prologue varchar(20) 
	declare indexstring varchar(20) 
	declare index integer 
 
	set @prologue = 'MSDT-A-' 
	set @index = 1 
 
	while 1 = 1 
	begin 
		set @indexstring = cast(index as varchar(20)) 
		set @name = @prologue + indexstring if not exists (select value from dtproperties where value = @name) 
			break 
		 
		set @index = @index + 1 
 
		if (@index = 10000) 
			goto TooMany 
	 END; 
 
Leave: 
 
	return 
 
TooMany: 
 
	set @name = 'DIAGRAM' 
	goto Leave
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure dt_setpropertybyid_u: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_setpropertybyid_u (id int,
	property varc...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_setpropertybyid_u (id int,
	property varchar(64),
	uvalue nvarchar(255),
	lvalue image
BEGIN
	set nocount on
	
	
	
	
	declare avalue varchar(255) 
	set @avalue = null 
	if (uvalue is not null) BEGIN if (convert(nvarchar(255), convert(varchar(255), @uvalue)) = @uvalue) 
		begin 
			set @avalue = convert(varchar(255), @uvalue) 
		END; 
		else 
		begin 
			if 'DtgSchemaNAME' = property begin 
				exec dt_generateansiname avalue output 
			END; 
		END; 
	END; 
	if exists (select * from dtproperties 
			where objectid=id and property=@property)
	begin
		
		
		
		update dtproperties set value=@avalue, uvalue=@uvalue, lvalue=@lvalue, version=version+1
			where objectid=id and property=property END;
	else
	begin
		
		
		
		insert dtproperties (property, objectid, value, uvalue, lvalue)
			values (@property, @id, @avalue, @uvalue, @lvalue)
	 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_Old (KhoHangID INT,
	 TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_Old (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS A INNER JOIN
            XePhuKienChiTiet AS B ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 1) AND (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure dt_dropuserobjectbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_dropuserobjectbyid (id int
BEGIN
	set no...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_dropuserobjectbyid (id int
BEGIN
	set nocount on
	delete from dtproperties where objectid=@id
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN (KhoHangID INT,
	 TuNgay VA...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XePhuKien AS A INNER JOIN
            XePhuKienChiTiet AS B ON A.ID = B.XePhuKienID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE   (A.IsTacNghiep = 0) AND (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure dt_droppropertiesbyid: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_droppropertiesbyid (id int,
	property var...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_droppropertiesbyid (id int,
	property varchar(64)
BEGIN
	set nocount on

	if (property is null) or (@property = '')
		delete from dtproperties where objectid=id else
		delete from dtproperties 
			where objectid=id and property=@property
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure dt_adduserobject: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_adduserobject (BEGIN
	set nocount on
	
...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_adduserobject (BEGIN
	set nocount on
	
	begin transaction
		insert dtproperties (property) VALUES ('DtgSchemaOBJECT')
		update dtproperties set objectid=@identity where id=@identity and property='DtgSchemaOBJECT'
	commit
	return @@identity
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_XUATKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKHAC (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKHAC (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVXuatKhac AS A INNER JOIN
			DVXuatKhacVatTu AS B ON A.ID = B.DVXuatKhacID INNER JOIN
			VatTu AS V ON B.VatTuID = V.ID INNER JOIN
			VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_XUATDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATDOIDONVI (KhoHangID INT,
	 TuNgay V...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATDOIDONVI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, A.SoLuong, A.DonGia, A.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS A INNER JOIN
            VatTu AS V ON A.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_XE_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_BANGGIA (DenNgay nvarchar(20) BEGIN
SET ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_BANGGIA (DenNgay nvarchar(20) BEGIN
SET nocount  ON    
	Declare V_Xe_BangGia_MaxID Table (MaxID int, XeID int)
	Insert @V_Xe_BangGia_MaxID(MaxID, XeID) 
			SELECT Max(B.ID) AS MaxID, B.XeID
			FROM   XeBangGia AS A INNER JOIN
				   XeBangGiaChiTiet AS B ON A.ID = B.XeBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.IsActive =1)
			GROUP BY B.XeID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.XeID, C.SoKhung, C.SoMay, X.MaXe, X.TenXe, X.SortDoiXe, X.SortLoaiXe, C.GiaHaiQuan, C.GiaBaoBienThanhPho, C.GiaBaoBienHuyen, C.GiaBaoBienThiXa, c.GiaApThue
	FROM   XeBangGia AS B INNER JOIN
           XeBangGiaChiTiet AS C ON B.ID = C.XeBangGiaID INNER JOIN
           V_Xe_BangGia_MaxID AS V ON C.ID = V.MaxID INNER JOIN
           Xe AS X ON C.XeID = X.ID	
	ORDER BY X.SortDoiXe
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON2 (TuNgay VARCHAR(10),	 
 ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON2 (TuNgay VARCHAR(10),	 
     DenNgay VARCHAR(10)	 
BEGIN
SET NOCOUNT ON
	Declare NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	
	FROM (
		
		SELECT	1 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	2 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	3 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	5 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	6 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  8 as a, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  9 as a, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)		
		UNION ALL
		
		SELECT	10 as a, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	11 as a, B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	12 as a, B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanSi AS A INNER JOIN
				DVBanSiVatTu AS B ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_UPDATE_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON (TuNgay VARCHAR(10),	 
  ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_UPDATE_GIAVON (TuNgay VARCHAR(10),	 
     DenNgay VARCHAR(10)	 
BEGIN
SET NOCOUNT ON
	Declare NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat,
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_TONDAU_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU_ALL (KhoHangID INT,
     DenNgay...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU_ALL (KhoHangID INT,
     DenNgay VARCHAR(10)
BEGIN
SET NOCOUNT ON
	Declare NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'	

	SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.TienNhap) AS TDTienNhap, SUM(T.SLXuat) AS TDSLXuat, SUM(T.TienXuat) AS TDTienXuat 
	FROM (
		
		SELECT	'N01' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N02' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N03' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT	'N04' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNoiBo AS A INNER JOIN
				DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT	'N05' AS MaTN, A.KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID)
		UNION ALL
		
		SELECT	'N06' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT  'N07' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNoiBo AS A INNER JOIN
                XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) 
		UNION ALL
		
		SELECT  'N08' AS MaTN, A.KhoHangXuatID AS KhoHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON A.ID = B.XeBanLeID INNER JOIN
				Va
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL_TEST (KhoHangID int,
     Den...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL_TEST (KhoHangID int,
     DenNgay nvarchar(10) BEGIN
SET nocount  ON    
	Declare Tb_VTTonDau Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert Tb_VTTonDau Exec SP_VT_TONDAU_ALL @KhoHangID, DenNgay SELECT A.KhoHangID AS KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, A.TDSLNhap, A.TDSLXuat, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon
	FROM Tb_VTTonDau AS A INNER JOIN
			VatTu AS V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) < 0
	order by  A.VatTuID

	
	
	
	
	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_XE_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_XUATNOIBO (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_XUATNOIBO (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeNoiBo AS A INNER JOIN
			XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.IsXacNhan=1)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_TONKHO_ALL: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL (KhoHangID int,
     DenNgay ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO_ALL (KhoHangID int,
     DenNgay nvarchar(10) BEGIN
SET nocount  ON    
	Declare Tb_VTTonDau Table (KhoHangID int, VatTuID int, TDSLNhap int, TDTienNhap float, TDSLXuat int, TDTienXuat float)
	Insert Tb_VTTonDau Exec SP_VT_TONDAU_ALL @KhoHangID, DenNgay SELECT A.KhoHangID AS KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon
	FROM Tb_VTTonDau AS A INNER JOIN
			VatTu AS V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_XE_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_NHAPNOIBO (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_NHAPNOIBO (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, A.KhoHangNhapID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeNoiBo AS A INNER JOIN
			XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU (KhoHangID INT,
     DenNgay VAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_TONDAU (KhoHangID INT,
     DenNgay VARCHAR(10),	 
	 VatTuID INT,
	 MaTacNghiep VARCHAR(1),
	 IDTacNghiep INT
BEGIN
	SET NOCOUNT ON
	DECLARE NgayBatDauSuDung VARCHAR(10), 
		DVBanLeID INT, DVBanSiID INT, DVNoiBoID INT, DoiDonViID INT, DVXuatKhacID INT, XeBanLeKMID INT, 
		DVBanLeKMID INT, XePhuKienID INT, XePhuKienNoiBoID INT, DVBanBuonID INT, XeBanSiKMID INT, XeBanLeBHID INT
	SET @NgayBatDauSuDung = '2019-12-19'
	SET @DVBanLeID = 0 	
	SET @DVBanSiID = 0
	SET @DVNoiBoID = 0
	SET @DoiDonViID = 0
	SET @DVXuatKhacID = 0
	SET @XeBanLeKMID = 0
	SET @DVBanLeKMID = 0
	SET @XePhuKienID = 0
	SET @XePhuKienNoiBoID = 0
	SET @DVBanBuonID = 0
	SET @XeBanSiKMID = 0
	SET @XeBanLeBHID = 0

	IF(@MaTacNghiep ='I')			SET @DVBanLeID = IDTacNghiep ELSE IF(@MaTacNghiep='J')		SET @DVBanSiID = IDTacNghiep ELSE IF(@MaTacNghiep='K')		SET @DVNoiBoID = IDTacNghiep ELSE IF(@MaTacNghiep='L')		SET @DoiDonViID = IDTacNghiep ELSE IF(@MaTacNghiep='M')		SET @DVXuatKhacID = IDTacNghiep ELSE IF(@MaTacNghiep='N')		SET @XeBanLeKMID = IDTacNghiep ELSE IF(@MaTacNghiep='O')		SET @DVBanLeKMID = IDTacNghiep ELSE IF(@MaTacNghiep='P')		SET @XePhuKienID = IDTacNghiep ELSE IF(@MaTacNghiep='Q')		SET @XePhuKienNoiBoID = IDTacNghiep ELSE IF(@MaTacNghiep='R')		SET @DVBanBuonID = IDTacNghiep ELSE IF(@MaTacNghiep='S')		SET @XeBanSiKMID = IDTacNghiep ELSE IF(@MaTacNghiep='T')		SET @XeBanLeBHID = IDTacNghiep SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.TienNhap) AS TDTienNhap, SUM(T.SLXuat) AS TDSLXuat, SUM(T.TienXuat) AS TDTienXuat 
	FROM (
		
		SELECT	'N01' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS MaTN, A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNoiBo AS A INNER JOIN
				DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS MaTN, A.KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
				VatTu AS V ON B.VatTuID = V.ID
		WHERE	(V.IsKoQLKho = 0) AND (A.NgayCT >= @NgayBatDauSuDung) AND (
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_XUATNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATNOIBO (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATNOIBO (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS A INNER JOIN
            DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	
	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO (KhoHangID INT,
     DenNgay nvar...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_VT_TONKHO (KhoHangID INT,
     DenNgay nvarchar(10),
	 VatTuID INT,
	 MaTacNghiep VARCHAR(1),
	 IDTacNghiep INT
BEGIN
	SET NOCOUNT  ON    
	DECLARE Tb_VTTonDau Table (KhoHangID INT, VatTuID INT, TDSLNhap INT, TDTienNhap FLOAT, TDSLXuat INT, TDTienXuat FLOAT)
	INSERT Tb_VTTonDau Exec SP_VT_TONDAU @KhoHangID, @DenNgay, @VatTuID, @MaTacNghiep, IDTacNghiep SELECT A.KhoHangID AS KhoHangID, A.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, V.VatTuLoaiID, L.VatTuNhomID, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon
	FROM Tb_VTTonDau AS A INNER JOIN
			VatTu AS V ON A.VatTuID = V.ID  LEFT OUTER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.TDSLNhap - A.TDSLXuat) <> 0
END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_NHAPNOIBO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPNOIBO (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPNOIBO (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNoiBo AS A INNER JOIN
            DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.IsXacNhan = 1) AND (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_SELECT_GIAVON_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_SELECT_GIAVON_TEST (TuNgay VARCHAR(10),	...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_SELECT_GIAVON_TEST (TuNgay VARCHAR(10),	 
     DenNgay VARCHAR(10)	 
BEGIN
SET NOCOUNT ON
	Declare NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	Declare Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, (1 - A.TyLeCK*0.01) * B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, 1 AS SLNhap, C.GiaBanBH AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLeBaoHiem AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(B.NgayCT >= @NgayBatDauSuDung) AND (B.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.NgayXuat < @TuNgay)
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanSi AS A INNER JOIN
				DVBanSiVatTu AS B ON A.ID = B.DVBanSiID  
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT < @TuNgay)
		UNION ALL
		
		SELECT  VatTuID, 0 AS SLNhap, 0 AS TienNhap, SoLuong AS SLXuat, ThanhTien AS TienXuat
		FROM    DoiDonVi AS A    
	
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_NHAPXUAT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPXUAT (KhoHangID INT,
	 VatTuID INT,...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPXUAT (KhoHangID INT,
	 VatTuID INT,
	 TuNgay VARCHAR(10),	 
     DenNgay VARCHAR(10)	 	 
BEGIN
	SET NOCOUNT ON
	SELECT T.SoCT, T.NgayCT, T.NgayNXK, T.KhoHangNhapID, T.KhoHangXuatID, T.KhachHangID, T.VatTuID, T.SLNhap, T.SLXuat 
	FROM (
		
		SELECT	'N01' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, A.KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N02' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, C.KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
                DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
                DVBanLe AS C ON A.DVBanLeID = C.ID   
		WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N03' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, C.KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
                DVBanSi AS C ON A.DVBanSiID = C.ID
		WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N04' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, A.KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNoiBo AS A INNER JOIN
				DVNoiBoVatTu AS B ON A.ID = B.DVNoiBoID
		WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N05' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangID AS KhoHangNhapID, NULL AS KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	'N06' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  'N07' AS MaTN, A.SoCT, A.NgayCT, A.NgayCT AS NgayNXK, A.KhoHangNhapID, NULL AS KhoHangXuatID, NULL AS KhachHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNoiBo AS A INNER JOIN
                XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID
		WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1) AND (B.VatTuID = @VatTuID)		
		UNION ALL
		
		SELECT  'N08' AS MaTN, B.SoCT, B.NgayCT, B.NgayCT AS NgayNXK, A.KhoHangXuatID AS KhoHangNhapID, NULL AS KhoHangXuatID, a.KhachHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_NHAPDOIDONVI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPDOIDONVI (KhoHangID INT,
	 TuNgay V...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPDOIDONVI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DoiDonVi AS A INNER JOIN
            DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XECHUYENKHO (KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XECHUYENKHO (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS A INNER JOIN
            XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
	
	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_GET_GIAVON (TuNgay VARCHAR(10),	 
     ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_GET_GIAVON (TuNgay VARCHAR(10),	 
     DenNgay VARCHAR(10),
	 VatTuID int
BEGIN
SET NOCOUNT ON
	Declare NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	
	
	Declare Tb_VTTonDau Table (VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert Tb_VTTonDau SELECT T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT  C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID 
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay)
		UNION ALL
		
		SELECT	B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay)
		
		
		
		
  
  
		
		UNION ALL
		
		SELECT	B.VatTuID, 0 AS SLNhap, 0 AS TienNhap, B.SoLuong AS SLXuat, B.TienVon AS TienXuat
		FROM	DVBanLe AS A INNER JOIN
				DVBanLeVatTu AS B ON A.ID = B.DVBanLeID
		WHERE	(B.NgayXuat >= @NgayBatDauSuDung) AND (B.Nga
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_XECHUYENKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_XECHUYENKHO (KhoHangID INT,...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_XECHUYENKHO (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID AS KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNoiBo AS A INNER JOIN
            XeNoiBoPhuKien AS B ON A.ID = B.XeNoiBoID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan = 1)
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_DELETE_DUPLICATE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_DELETE_DUPLICATE (VatTuID_DEL int,	 
  ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_DELETE_DUPLICATE (VatTuID_DEL int,	 
     VatTuID int	 
BEGIN
SET NOCOUNT ON
	update DoiDonVi						set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DoiDonViChiTiet				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVBanLeVatTu					set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVBanSiVatTu					set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVNhapKhacVatTu				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVNhapMuaVatTu				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVNhapTraLaiBanLeChiTiet		set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVNhapTraLaiBanSiChiTiet		set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVNoiBoVatTu					set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update DVXuatKhacVatTu				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update VTBangGiaChiTiet				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update XeBanLeKhuyenMai				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update XeBanLePhuKien				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update XeNhapTraLaiBanLeKhuyenMai	set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update XeNhapTraLaiBanLePhuKien		set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update XeNoiBoPhuKien				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL update XePhuKienChiTiet				set VATTUID = VatTuID WHERE VATTUID = VatTuID_DEL Delete VatTu where (ID = @VatTuID_DEL)

END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_XUATPHUKIEN_XEBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XEBANLE (KhoHangID INT,
	 T...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATPHUKIEN_XEBANLE (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID AS KhoHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, b.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeBanLe AS A INNER JOIN
            XeBanLePhuKien AS B ON A.ID = B.XeBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE   (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHLE (KhoHangID INT,
	 TuNgay VAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHLE (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS A INNER JOIN
            XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure dt_verstamp007: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_verstamp007 (BEGIN
	select 7005
//
DELIMITER' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_verstamp007 (BEGIN
	select 7005
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_XUATKMBH_Old: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBH_Old (KhoHangID INT,
	 TuNgay V...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBH_Old (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS A INNER JOIN
            XeBanLeKhuyenMai AS B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure dt_verstamp006: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE dt_verstamp006 (BEGIN
	select 7000
//
DELIMITER' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE dt_verstamp006 (BEGIN
	select 7000
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_XUATBAOHIEM_BHLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBAOHIEM_BHLE (KhoHangID INT,
	 TuNg...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBAOHIEM_BHLE (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, B.NgayXuat AS NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, 1 AS SoLuong, B.GiaBanBH, B.GiaBanBH AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanLe AS A INNER JOIN
            XeBanLeBaoHiem AS B ON A.ID = B.XeBanLeID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_NHAPPHUKIEN_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_TRALAI (KhoHangID INT,
	 Tu...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPPHUKIEN_TRALAI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  B.ID, B.SoCT, C.NgayNhap AS NgayCT, A.KhoHangXuatID AS KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS B INNER JOIN
            XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_NHAPKHUYENMAI_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHUYENMAI_TRALAI (KhoHangID INT,
	 ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHUYENMAI_TRALAI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  B.ID, B.SoCT, B.NgayCT, A.KhoHangXuatID AS KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, C.SoLuong, C.DonGia, C.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS B INNER JOIN
            XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_XE_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRASI (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRASI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanSi AS A INNER JOIN
			XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID
	WHERE (B.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.XeNhapMuaID IS NOT NULL)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_NHAPBAOHIEM_TRALAI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPBAOHIEM_TRALAI (KhoHangID INT,
	 Tu...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPBAOHIEM_TRALAI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  B.ID, B.SoCT, C.NgayNhap AS NgayCT, A.KhoHangXuatID AS KhoHangID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, 1 AS SoLuong, C.GiaBanBH AS DonGia, C.GiaBanBH AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    XeNhapTraLaiBanLe AS B INNER JOIN
            XeNhapTraLaiBanLeBaoHiem AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
            XeBanLe AS A ON B.XeBanLeID = A.ID INNER JOIN
            VatTu AS V ON C.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE	(C.NgayNhap BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRALE (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRALE (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanLe AS A INNER JOIN
            DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_TEST_1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_TEST_1 (BEGIN
SET NOCOUNT ON
	select count...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_TEST_1 (BEGIN
SET NOCOUNT ON
	select count(ID) as 'VT' from VatTu
END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_TEST: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_TEST (VatTuID INT     
BEGIN
SET NOCOUNT O...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_TEST (VatTuID INT     
BEGIN
SET NOCOUNT ON
	
	

	
	
	
	
	
	
	select * from VatTu where ID = VatTuID END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_DV_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_DV_BANGGIA (DenNgay nvarchar(10),
	 CuaHang...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_DV_BANGGIA (DenNgay nvarchar(10),
	 CuaHangID nvarchar(2) BEGIN
SET nocount  ON    
	Declare V_DV_BangGia_MaxID Table (MaxID int, DichVuID int)
	Insert @V_DV_BangGia_MaxID(MaxID, DichVuID) 
			SELECT Max(B.ID) AS MaxID, B.DichVuID
			FROM   DVBangGia AS A INNER JOIN
				   DVBangGiaChiTiet AS B ON A.ID = B.DVBangGiaID
			WHERE (A.ApDungTu <= @DenNgay) AND (A.ApDungDen >= @DenNgay) AND (A.CuaHangID = @CuaHangID)
			GROUP BY B.DichVuID	

	SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.DichVuID, V.MaDichVu, V.HangMuc, C.DonGia
	FROM   DVBangGia AS B INNER JOIN
           DVBangGiaChiTiet AS C ON B.ID = C.DVBangGiaID INNER JOIN
           V_DV_BangGia_MaxID AS M ON C.ID = M.MaxID INNER JOIN
           DichVu AS V ON C.DichVuID = V.ID	
	ORDER BY V.MaDichVu
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:44] local.ERROR: Error creating stored procedure SP_VT_XUATKMBHSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHSI (KhoHangID INT,
	 TuNgay VAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATKMBHSI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    VatTuLoai AS L INNER JOIN
            VatTu AS V ON L.ID = V.VatTuLoaiID INNER JOIN
            XeBanSi AS A INNER JOIN
            XeBanSiKhuyenMai AS B ON A.ID = B.XeBanSiID ON V.ID = B.VatTuID
	WHERE (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_VT_BANGGIA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE   PROCEDURESP_VT_BANGGIA
                               ...' at line 1 (SQL: DELIMITER //
CREATE   PROCEDURESP_VT_BANGGIA
                                DenNgay nvarchar(10),
	                            CuaHangID nvarchar(2)
                            BEGIN
                            SET nocount  ON
                                Declare V_VT_BangGia_MaxID Table(MaxID int, VatTuID int)
                                Insert @V_VT_BangGia_MaxID(MaxID, VatTuID)
                                        SELECT Max(B.ID) AS MaxID, B.VatTuID
                                        FROM   VTBangGia AS A CROSS APPLY STRING_SPLIT(CuaHangID, ',') INNER JOIN
                                               VTBangGiaChiTiet AS B ON A.ID = B.VTBangGiaID
                                        WHERE(A.ApDungTu <= @DenNgay) AND(A.ApDungDen >= @DenNgay) AND (value = @CuaHangID)
                                        GROUP BY B.VatTuID

                                SELECT B.SoCT, B.ApDungTu, B.ApDungDen, B.IsActive, C.ID, C.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.VatTuLoaiID, L.VatTuNhomID, C.GiaNhap, C.GiaXuat
                                FROM   VTBangGia AS B INNER JOIN
                                       VTBangGiaChiTiet AS C ON B.ID = C.VTBangGiaID INNER JOIN
                                       V_VT_BangGia_MaxID AS M ON C.ID = M.MaxID INNER JOIN
                                       VatTu AS V ON C.VatTuID = V.ID INNER JOIN
                                       VatTuLoai AS L ON V.VatTuLoaiID = L.ID
                            END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_VT_NHAPKHAC: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHAC (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPKHAC (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapKhac AS A INNER JOIN
            DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI_TONGHOP (TuNgay VARCHAR(10),
...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI_TONGHOP (TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanSi AS A INNER JOIN
			XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay)		
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_XE_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANSI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanSi AS A INNER JOIN
			XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_XE_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_TONDAU (KhoHangID INT,
     DenNgay VAR...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_TONDAU (KhoHangID INT,
     DenNgay VARCHAR(10),
	 XeBanLeID INT,
	 XeBanSiID INT,
	 XeNoiBoID INT,
	 XeXuatKhacID INT
BEGIN
SET NOCOUNT ON
	SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.SLXuat) AS TDSLXuat
	FROM (
		
		SELECT 'A' AS MaTN, KhoHangNhapID AS KhoHangID, XeID, ID AS XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat 
		FROM XeNhapMua 
		WHERE (NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID)
		UNION ALL
		
		SELECT 'B' AS TN, A.KhoHangNhapID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
		FROM XeNoiBo AS A INNER JOIN
				XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (KhoHangNhapID = @KhoHangID) AND (A.IsXacNhan=1)
		UNION ALL
		
		SELECT 'C' AS TN, A.KhoHangXuatID AS KhoHangID, A.XeID, A.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
		FROM XeBanLe  AS A INNER JOIN
				XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID    
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'D' AS TN, A.KhoHangXuatID, C.XeID, C.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
		FROM XeBanSi AS A INNER JOIN
				XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
				XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID
		WHERE (B.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)
		UNION ALL
		
		SELECT 'E' AS TN, KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeBanLe     
		WHERE (NgayBan <= @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
		UNION ALL
		
		SELECT 'F' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeBanSi AS A INNER JOIN
				XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeBanSiID)
		UNION ALL
		
		SELECT 'G' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeNoiBo AS A INNER JOIN
				XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeNoiBoID) 
		UNION ALL
		
		SELECT 'H' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
		FROM XeXuatKhac AS A INNER JOIN
				XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
		WHERE (A.NgayCT <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.ID <> @XeXuatKhacID)
	) AS T
	GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID
END;


//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_XE_TONKHO: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_TONKHO (KhoHangID int,
                 ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_TONKHO (KhoHangID int,
                                 DenNgay nvarchar(10),
	                             XeBanLeID INT,
	                             XeBanSiID INT,
	                             XeNoiBoID INT,
	                             XeXuatKhacID INT
                            BEGIN
                            SET nocount  ON 
	                            Declare Tb_XeTonDau Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)
	                            Insert Tb_XeTonDau Exec SP_XE_TONDAU @KhoHangID, @DenNgay, @XeBanLeID, @XeBanSiID, @XeNoiBoID, XeXuatKhacID SELECT A.KhoHangID, B.KhoHangNhapID, A.XeID, X.MaXe, X.TenXe, A.XeNhapMuaID, B.KhachHangID AS NhaCungCapID, B.DonGia_CoVAT, B.NgayCT, B.SoKhung, B.SoMay, B.MaChiaKhoa, (A.TDSLNhap - A.TDSLXuat) AS SoLuongTon, B.GhiChu, B.MaChiaKhoa
	                            FROM Tb_XeTonDau AS A INNER JOIN
			                            XeNhapMua AS B ON A.XeNhapMuaID = B.ID INNER JOIN
			                            Xe AS X ON A.XeID = X.ID 
	                            WHERE (A.TDSLNhap - A.TDSLXuat) <>0
                            END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_NHAPXUATTON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_NHAPXUATTON (KhoHangID int,
	 TuNgay nvarch...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_NHAPXUATTON (KhoHangID int,
	 TuNgay nvarchar(10),
     DenNgay nvarchar(10) BEGIN
SET nocount  ON    

	Declare Tb_XeTonDau Table (KhoHangID int, XeID int, XeNhapMuaID int, TDSLNhap int, TDSLXuat int)

	declare XeBanLeID int, XeBanSiID int, XeNoiBoID int
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0

	Insert Tb_XeTonDau Exec SP_XE_TONDAU @KhoHangID, @TuNgay, @XeBanLeID, @XeBanSiID, XeNoiBoID SELECT NXT.* FROM (
		SELECT 'T' AS TN, KhoHangID, XeID, XeNhapMuaID, (TDSLNhap - TDSLXuat) AS TDSL
		FROM Tb_XeTonDau UNION ALL
		SELECT 'B' AS TN, A.KhoHangNhapID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SoLuong
		FROM XeNoiBo AS A INNER JOIN
			 XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
		WHERE A.NgayCT < DenNgay AND KhoHangNhapID = @KhoHangID   
	) AS NXT 
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_XE_LICHSU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_LICHSU (XeNhapMuaID INT
BEGIN
SET NOCO...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_LICHSU (XeNhapMuaID INT
BEGIN
SET NOCOUNT ON
	
	SELECT 'A' AS MaTN, ID, KhoHangNhapID, Null AS KhoHangXuatID, XeID, ID AS XeNhapMuaID, SoCT, NgayCT, NULL AS NgayBan, CreatedBy, SoKhung, SoMay 
	FROM XeNhapMua 
	WHERE (ID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'B' AS TN, A.ID, A.KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, NULL AS NgayBan, A.CreatedBy, M.SoKhung, M.SoMay 
	FROM XeNoiBo AS A INNER JOIN
			XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID INNER JOIN
			XeNhapMua AS M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'C' AS TN, B.ID, A.KhoHangXuatID AS KhoHangNhapID, null AS KhoHangXuatID, A.XeID, A.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS NgayBan, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe  AS A INNER JOIN
			XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID INNER JOIN
			XeNhapMua AS M ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'D' AS TN, B.ID, A.KhoHangXuatID AS KhoHangNhapID, null AS KhoHangXuatID, C.XeID, C.XeNhapMuaID, B.SoCT, B.NgayCT, NULL AS NgayBan, B.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS A INNER JOIN
			XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID INNER JOIN
			XeNhapMua AS M ON C.XeNhapMuaID = M.ID
	WHERE (C.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'E' AS TN, A.ID, Null AS KhoHangNhapID, A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanLe AS A INNER JOIN
			XeNhapMua AS M ON A.XeNhapMuaID = M.ID
	WHERE (A.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'F' AS TN, A.ID, Null AS KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeBanSi AS A INNER JOIN
			XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID INNER JOIN
			XeNhapMua AS M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	UNION ALL
	
	SELECT 'G' AS TN, A.ID, Null AS KhoHangNhapID, A.KhoHangXuatID, B.XeID, B.XeNhapMuaID, A.SoCT, A.NgayCT, A.NgayCT AS NgayBan, A.CreatedBy, M.SoKhung, M.SoMay
	FROM XeXuatKhac AS A INNER JOIN
			XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID INNER JOIN
			XeNhapMua AS M ON B.XeNhapMuaID = M.ID
	WHERE (B.XeNhapMuaID = @XeNhapMuaID)
	
	
	
	
	
	
END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE_TONGHOP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE_TONGHOP (TuNgay VARCHAR(10),
...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE_TONGHOP (TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 1 AS SoLuong
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN TuNgay AND @DenNgay) AND (XeNhapMuaID IS NOT NULL)
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_XE_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_XUATBANLE (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 1 AS SoLuong
	FROM XeBanLe     
	WHERE (NgayBan BETWEEN TuNgay AND @DenNgay) AND (KhoHangXuatID = @KhoHangID) AND (XeNhapMuaID IS NOT NULL)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_XE_TONKHO_BY_XEID: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_TONKHO_BY_XEID (DenNgay VARCHAR(10),
	 ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_TONKHO_BY_XEID (DenNgay VARCHAR(10),
	 XeID INT,
	 IDPhieu INT,
	 LoaiPhieu INT,
	 SoMay VARCHAR(20)
BEGIN
SET NOCOUNT ON
	Declare XeBanLeID INT,	XeBanSiID INT, XeNoiBoID INT, XeXuatKhacID INT
	SET @XeBanLeID = 0
	SET @XeBanSiID = 0
	SET @XeNoiBoID = 0
	SET @XeXuatKhacID = 0

	if(@LoaiPhieu = 1)
		SET @XeBanLeID = IDPhieu else if(@LoaiPhieu = 2)
		SET @XeBanSiID = IDPhieu else if(@LoaiPhieu = 3)
		SET @XeNoiBoID = IDPhieu else if(@LoaiPhieu = 4)
		SET @XeXuatKhacID = IDPhieu Declare Tb_XeTonKho Table (KhoHangID int, XeID int, XeNhapMuaID int, SLNhap int, SLXuat int)

	Insert Tb_XeTonKho SELECT T.KhoHangID, T.XeID, T.XeNhapMuaID, SUM(T.SLNhap) AS TDSLNhap, SUM(T.SLXuat) AS TDSLXuat
		FROM (
			
			SELECT 'A' AS MaTN, KhoHangNhapID AS KhoHangID, XeID, ID AS XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat 
			FROM XeNhapMua 
			WHERE (NgayCT <= @DenNgay) AND (XeID = @XeID)
			UNION ALL
			
			SELECT 'B' AS TN, A.KhoHangNhapID AS KhoHangID, B.XeID, B.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
			FROM XeNoiBo AS A INNER JOIN
					XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.IsXacNhan=1)
			UNION ALL
			
			SELECT 'C' AS TN, A.KhoHangXuatID AS KhoHangID, A.XeID, A.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
			FROM XeBanLe  AS A INNER JOIN
					XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID    
			WHERE (B.NgayCT <= @DenNgay) AND (A.XeID = @XeID) AND (A.XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'D' AS TN, A.KhoHangXuatID AS KhoHangID, C.XeID, C.XeNhapMuaID, 1 AS SLNhap, 0 AS SLXuat
			FROM XeBanSi AS A INNER JOIN
					XeNhapTraLaiBanSi AS B ON A.ID = B.XeBanSiID INNER JOIN
					XeNhapTraLaiBanSiChiTiet AS C ON B.ID = C.XeNhapTraLaiBanSiID
			WHERE (B.NgayCT <= @DenNgay) AND (C.XeID = @XeID)
			UNION ALL
			
			SELECT 'E' AS TN, KhoHangXuatID AS KhoHangID, XeID, XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeBanLe     
			WHERE (NgayBan <= @DenNgay) AND (XeID = @XeID) AND (ID <> @XeBanLeID) AND (XeNhapMuaID IS NOT NULL)
			UNION ALL
			
			SELECT 'F' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeBanSi AS A INNER JOIN
					XeBanSiChiTiet AS B ON A.ID = B.XeBanSiID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeBanSiID)
			UNION ALL
			
			SELECT 'G' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeNoiBo AS A INNER JOIN
					XeNoiBoChiTiet AS B ON A.ID = B.XeNoiBoID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeNoiBoID) 
			UNION ALL
			
			SELECT 'F' AS TN, A.KhoHangXuatID AS KhoHangID, B.XeID, B.XeNhapMuaID, 0 AS SLNhap, 1 AS SLXuat
			FROM XeXuatKhac AS A INNER JOIN
					XeXuatKhacChiTiet AS B ON A.ID = B.XeXuatKhacID    
			WHERE (A.NgayCT <= @DenNgay) AND (B.XeID = @XeID) AND (A.ID <> @XeXuatKhacID)
		) AS T
		GROUP BY T.KhoHangID, T.XeID, T.XeNhapMuaID

		if(LEN(@SoMay)>0)
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS SLTON,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM Tb_XeTonKho AS A INNER JOIN
					XeNhapMua AS B ON A.XeNhapMuaID = B.ID INNER JOIN
					Xe AS X ON A.XeID = X.ID INNER JOIN 
					KhoHang AS K ON A.KhoHangID = K.ID 
			WHERE SLNhap-SLXuat<>0 AND (B.SoMay Like N'%' + @SoMay)
		else
			SELECT A.KhoHangID, A.XeID, A.XeNhapMuaID, (A.SLNhap-A.SLXuat) AS SLTON,
					X.MaXe, X.TenXe, B.SoMay, B.SoKhung, B.MaChiaKhoa, K.MaKhoHang 
			FROM Tb_XeTonKho AS A INNER JOIN
					XeNh
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_XE_NHAPTRALE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRALE (KhoHangID INT,
	 TuNgay VARCH...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_XE_NHAPTRALE (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT A.KhoHangXuatID, A.XeID, A.XeNhapMuaID, 1 AS SoLuong
	FROM XeBanLe  AS A INNER JOIN
			XeNhapTraLaiBanLe  AS B ON A.ID = B.XeBanLeID    
	WHERE (B.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (A.XeNhapMuaID IS NOT NULL)
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA_GROUP (KhoHangID INT,
	 TuNgay ...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA_GROUP (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, SUM(B.SoLuong) AS SoLuong, SUM(B.ThanhTien) AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS A INNER JOIN
            DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_VT_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA (KhoHangID INT,
	 TuNgay VARCHA...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPMUA (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapMua AS A INNER JOIN
            DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_VT_NHAPTRASI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRASI (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRASI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanSi AS A INNER JOIN
            DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_VT_XUATBANSI: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANSI (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANSI (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangXuatID, A.KhachHangID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanSi AS A INNER JOIN
            DVBanSiVatTu AS B ON A.ID = B.DVBanSiID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure uspGetChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc uspGetChiTien1
ID int
BEGIN
SELECT       ...' at line 1 (SQL: DELIMITER //
CREATE         proc uspGetChiTien1
ID int
BEGIN
SELECT        ChiTien.ID, KhachHang.TenKhachHang, ChiTienLyDo.TenLyDo, ChiTien.SoTien, TaiKhoan.TenTaiKhoan, ChiTien.GhiChu, ChiTien.CuaHangID, ChiTien.CreatedBy, 
                         ChiTien.CreatedAt, ChiTien.UpdatedBy, ChiTien.UpdatedAt
FROM            ChiTien INNER JOIN
                         KhachHang ON ChiTien.KhachHangID = KhachHang.ID INNER JOIN
                         ChiTienLyDo ON ChiTien.ChiTienLyDoID = ChiTienLyDo.ID INNER JOIN
                         TaiKhoan ON ChiTien.TaiKhoanID = TaiKhoan.ID
WHERE ChiTien.ID= @ID
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure uspChiTien2: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
create         proc uspChiTien2
ID int,
Status int,
ApprovalB...' at line 1 (SQL: DELIMITER //
create         proc uspChiTien2
ID int,
Status int,
ApprovalBy int
BEGIN
UPDATE ChiTien SET Status2 = @Status, Approval2By = @ApprovalBy, Approval2At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_XE_NHAPMUA: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_XE_NHAPMUA (KhoHangID INT,
	 TuNgay VARCHA...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_XE_NHAPMUA (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT KhoHangNhapID, XeID, ID AS XeNhapMuaID, 1 AS SoLuong 
	FROM XeNhapMua 
	WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (KhoHangNhapID = @KhoHangID)		
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure uspChiTien1: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE         proc uspChiTien1
ID int,
Status int,
ApprovalB...' at line 1 (SQL: DELIMITER //
CREATE         proc uspChiTien1
ID int,
Status int,
ApprovalBy int
BEGIN
UPDATE ChiTien SET Status1 = @Status, Approval1By = @ApprovalBy, Approval1At = DATEADD(HOUR, 7, NOW()) WHERE ID = @ID
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE_GROUP: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE_GROUP (KhoHangID INT,
	 TuNga...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE_GROUP (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, SUM(B.SoLuong) AS SoLuong, SUM(B.ThanhTien) AS ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS A INNER JOIN
            DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
	GROUP BY B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet, V.DVT, V.VatTuLoaiID, L.VatTuNhomID
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure upsChiTienPowerApps: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE upsChiTienPowerApps (BEGIN
SET nocount  ON    ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE upsChiTienPowerApps (BEGIN
SET nocount  ON    
	Declare TuNgay VARCHAR(10), DenNgay VARCHAR(10)

	set @TuNgay = CONVERT(VARCHAR(10), DATEADD(DAY, -30, NOW()), 101)
	set @DenNgay = CONVERT(VARCHAR(10), NOW(), 101)

	SELECT * FROM ChiTien WHERE NgayCT between TuNgay and DenNgay END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_VT_GET_GIAVON_KHOHANG: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //



CREATE PROCEDURE SP_VT_GET_GIAVON_KHOHANG (TuNgay VARCHAR(1...' at line 1 (SQL: DELIMITER //



CREATE PROCEDURE SP_VT_GET_GIAVON_KHOHANG (TuNgay VARCHAR(10),	 
     DenNgay VARCHAR(10),
	 KhoHangID int,
	 VatTuID int
BEGIN
SET NOCOUNT ON
	Declare NgayBatDauSuDung VARCHAR(10)	
	SET @NgayBatDauSuDung = '2019-12-19'		

	Declare Tb_VTTonDau Table (KhoHangID int, VatTuID int, SLNhap int, TienNhap float, SLXuat int, TienXuat float)

	Insert Tb_VTTonDau SELECT T.KhoHangID, T.VatTuID, SUM(T.SLNhap) AS SLNhap, SUM(T.TienNhap) AS TienNhap, SUM(T.SLXuat) AS SLXuat, SUM(T.TienXuat) AS TienXuat 
	FROM (
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapMua AS A INNER JOIN
				DVNhapMuaVatTu AS B ON A.ID = B.DVNhapMuaID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanLe AS A INNER JOIN
				DVNhapTraLaiBanLeChiTiet AS B ON A.ID = B.DVNhapTraLaiBanLeID   
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanSi AS A INNER JOIN
				DVNhapTraLaiBanSiChiTiet AS B ON A.ID = B.DVNhapTraLaiBanSiID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DoiDonVi AS A INNER JOIN
				DoiDonViChiTiet AS B ON A.ID = B.DoiDonViID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapKhac AS A INNER JOIN
				DVNhapKhacVatTu AS B ON A.ID = B.DVNhapKhacID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS KhoHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
                XeNhapTraLaiBanLePhuKien AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
                XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT  A.KhoHangXuatID AS KhoHangID, C.VatTuID, C.SoLuong AS SLNhap, C.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM    XeNhapTraLaiBanLe AS B INNER JOIN
				XeNhapTraLaiBanLeKhuyenMai AS C ON B.ID = C.XeNhapTraLaiBanLeID INNER JOIN
				XeBanLe AS A ON B.XeBanLeID = A.ID
		WHERE	(C.NgayNhap >= @NgayBatDauSuDung) AND (C.NgayNhap <= @DenNgay) AND (A.KhoHangXuatID = @KhoHangID) AND (C.VatTuID = @VatTuID)
		UNION ALL
		
		SELECT	A.KhoHangNhapID AS KhoHangID, B.VatTuID, B.SoLuong AS SLNhap, B.ThanhTien AS TienNhap, 0 AS SLXuat, 0 AS TienXuat
		FROM	DVNhapTraLaiBanBuon AS A INNER JOIN
				DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanBuonID
		WHERE	(A.NgayCT >= @NgayBatDauSuDung) AND (A.NgayCT <= @DenNgay) AND (A.KhoHangNhapID = @KhoHangID) AND (B.VatTuID = @VatTuID)
		
		
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_VT_XUATBANLE: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE (KhoHangID INT,
	 TuNgay VARC...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_XUATBANLE (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.SoPhieu, A.KhoHangXuatID, A.KhachHangID, B.NgayXuat, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.DonGiaTG, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVBanLe AS A INNER JOIN
            DVBanLeVatTu AS B ON A.ID = B.DVBanLeID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (B.NgayXuat BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangXuatID = @KhoHangID)	
 END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure spCheckPhieuChi: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE spCheckPhieuChi ((
		khohangID varchar(10)
) ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE spCheckPhieuChi ((
		khohangID varchar(10)
) BEGIN
				select	* from ChiTien
				where	KhoHangID = khohangID  END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_FIX_SLVT: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_FIX_SLVT (BEGIN
SET nocount  ON    
	Decla...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_FIX_SLVT (BEGIN
SET nocount  ON    
	Declare Tb_SLVT Table (DVBanLeID int, SoLuongVT float)

	Insert @Tb_SLVT(DVBanLeID, SoLuongVT) 
	select DVBanLeID, Sum(SoLuong) AS SoLuongVT from DVBanLeVatTu group by DVBanLeID
	
	UPDATE DVBanLe 
    SET DVBanLe.TongSoLuongVatTu = B.SoLuongVT            
	FROM DVBanLe INNER JOIN Tb_SLVT AS B ON DVBanLe.ID = B.DVBanLeID 
	where B.SoLuongVT is not null
	
 
	
	
END;
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_TC_TONDAU: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //
CREATE PROCEDURE SP_TC_TONDAU (TaiKhoanID INT,
                ...' at line 1 (SQL: DELIMITER //
CREATE PROCEDURE SP_TC_TONDAU (TaiKhoanID INT,
                                 TuNgay VARCHAR(10),
	                             DenNgay VARCHAR(10)	 
                            BEGIN
                            SET NOCOUNT ON
	                            SELECT T.TaiKhoanID, T.TacNghiep, SUM(T.SoTien) AS SoTien
	                            FROM (
		                            
		                            SELECT 1 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM XeBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 2 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM XeBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 3 AS MaTN, TaiKhoanID, SUM(GiaNhap) AS SoTien, 1 AS TacNghiep
		                            FROM XeSonXe 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 4 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, 0 AS TacNghiep
		                            FROM ThuTien 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 5 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, 1 AS TacNghiep
		                            FROM ChiTien 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID		
		                            UNION ALL
		                            
		                            SELECT 6 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM DVBanLeThanhToan 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 7 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM DVBanSiThanhToan 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 8 AS MaTN, TaiKhoanID, SUM(SoTien) AS SoTien, TacNghiep 
		                            FROM DVBanBuonThanhToan 
		                            WHERE (NgayCT BETWEEN TuNgay AND @DenNgay) AND (TaiKhoanID = @TaiKhoanID)
		                            GROUP BY TaiKhoanID, TacNghiep
		                            UNION ALL
		                            
		                            SELECT 9 AS MaTN, T.TaiKhoanID, SUM(G.ChiPhi) AS SoTien, 1 AS TacNghiep 
                                    FROM DVBanLe AS A INNER JOIN 
                                        KhoHang AS K ON A.KhoHangXuatID = K.ID INNER JOIN 
	
//
DELIMITER ;)  
[2024-07-18 17:02:45] local.ERROR: Error creating stored procedure SP_VT_NHAPTRABUON: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRABUON (KhoHangID INT,
	 TuNgay VA...' at line 1 (SQL: DELIMITER //

CREATE PROCEDURE SP_VT_NHAPTRABUON (KhoHangID INT,
	 TuNgay VARCHAR(10),
     DenNgay VARCHAR(10) BEGIN
SET NOCOUNT ON
	SELECT  A.ID, A.SoCT, A.NgayCT, A.KhoHangNhapID, B.VatTuID, V.MaVatTu, V.TenVatTu_TiengViet AS TenVatTu, V.DVT, B.SoLuong, B.DonGia, B.ThanhTien, V.VatTuLoaiID, L.VatTuNhomID
	FROM    DVNhapTraLaiBanBuon AS A INNER JOIN
            DVNhapTraLaiBanBuonChiTiet AS B ON A.ID = B.DVNhapTraLaiBanbuonID INNER JOIN
            VatTu AS V ON B.VatTuID = V.ID INNER JOIN
            VatTuLoai AS L ON V.VatTuLoaiID = L.ID
	WHERE (A.NgayCT BETWEEN TuNgay AND @DenNgay) AND (A.KhoHangNhapID = @KhoHangID)	
 END;
//
DELIMITER ;)  
